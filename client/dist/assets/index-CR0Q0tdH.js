var wI=Object.defineProperty;var jI=(e,t,r)=>t in e?wI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ax=(e,t,r)=>jI(e,typeof t!="symbol"?t+"":t,r);function cw(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();function vs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _I(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Tx={exports:{}},Bd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m2;function kI(){if(m2)return Bd;m2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:e,type:n,key:c,ref:a!==void 0?a:null,props:l}}return Bd.Fragment=t,Bd.jsx=r,Bd.jsxs=r,Bd}var p2;function NI(){return p2||(p2=1,Tx.exports=kI()),Tx.exports}var s=NI(),Ox={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g2;function SI(){if(g2)return ot;g2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),x=Symbol.iterator;function b(B){return B===null||typeof B!="object"?null:(B=x&&B[x]||B["@@iterator"],typeof B=="function"?B:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,_={};function N(B,G,ie){this.props=B,this.context=G,this.refs=_,this.updater=ie||j}N.prototype.isReactComponent={},N.prototype.setState=function(B,G){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,G,"setState")},N.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function C(){}C.prototype=N.prototype;function A(B,G,ie){this.props=B,this.context=G,this.refs=_,this.updater=ie||j}var E=A.prototype=new C;E.constructor=A,w(E,N.prototype),E.isPureReactComponent=!0;var S=Array.isArray;function T(){}var D={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function I(B,G,ie){var he=ie.ref;return{$$typeof:e,type:B,key:G,ref:he!==void 0?he:null,props:ie}}function $(B,G){return I(B.type,G,B.props)}function M(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function R(B){var G={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ie){return G[ie]})}var F=/\/+/g;function V(B,G){return typeof B=="object"&&B!==null&&B.key!=null?R(""+B.key):G.toString(36)}function H(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(T,T):(B.status="pending",B.then(function(G){B.status==="pending"&&(B.status="fulfilled",B.value=G)},function(G){B.status==="pending"&&(B.status="rejected",B.reason=G)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function L(B,G,ie,he,_e){var Ee=typeof B;(Ee==="undefined"||Ee==="boolean")&&(B=null);var we=!1;if(B===null)we=!0;else switch(Ee){case"bigint":case"string":case"number":we=!0;break;case"object":switch(B.$$typeof){case e:case t:we=!0;break;case m:return we=B._init,L(we(B._payload),G,ie,he,_e)}}if(we)return _e=_e(B),we=he===""?"."+V(B,0):he,S(_e)?(ie="",we!=null&&(ie=we.replace(F,"$&/")+"/"),L(_e,G,ie,"",function(ke){return ke})):_e!=null&&(M(_e)&&(_e=$(_e,ie+(_e.key==null||B&&B.key===_e.key?"":(""+_e.key).replace(F,"$&/")+"/")+we)),G.push(_e)),1;we=0;var ye=he===""?".":he+":";if(S(B))for(var ee=0;ee<B.length;ee++)he=B[ee],Ee=ye+V(he,ee),we+=L(he,G,ie,Ee,_e);else if(ee=b(B),typeof ee=="function")for(B=ee.call(B),ee=0;!(he=B.next()).done;)he=he.value,Ee=ye+V(he,ee++),we+=L(he,G,ie,Ee,_e);else if(Ee==="object"){if(typeof B.then=="function")return L(H(B),G,ie,he,_e);throw G=String(B),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return we}function U(B,G,ie){if(B==null)return B;var he=[],_e=0;return L(B,he,"","",function(Ee){return G.call(ie,Ee,_e++)}),he}function W(B){if(B._status===-1){var G=B._result;G=G(),G.then(function(ie){(B._status===0||B._status===-1)&&(B._status=1,B._result=ie)},function(ie){(B._status===0||B._status===-1)&&(B._status=2,B._result=ie)}),B._status===-1&&(B._status=0,B._result=G)}if(B._status===1)return B._result.default;throw B._result}var le=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},ve={map:U,forEach:function(B,G,ie){U(B,function(){G.apply(this,arguments)},ie)},count:function(B){var G=0;return U(B,function(){G++}),G},toArray:function(B){return U(B,function(G){return G})||[]},only:function(B){if(!M(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return ot.Activity=g,ot.Children=ve,ot.Component=N,ot.Fragment=r,ot.Profiler=a,ot.PureComponent=A,ot.StrictMode=n,ot.Suspense=h,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ot.__COMPILER_RUNTIME={__proto__:null,c:function(B){return D.H.useMemoCache(B)}},ot.cache=function(B){return function(){return B.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(B,G,ie){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var he=w({},B.props),_e=B.key;if(G!=null)for(Ee in G.key!==void 0&&(_e=""+G.key),G)!P.call(G,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&G.ref===void 0||(he[Ee]=G[Ee]);var Ee=arguments.length-2;if(Ee===1)he.children=ie;else if(1<Ee){for(var we=Array(Ee),ye=0;ye<Ee;ye++)we[ye]=arguments[ye+2];he.children=we}return I(B.type,_e,he)},ot.createContext=function(B){return B={$$typeof:c,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},ot.createElement=function(B,G,ie){var he,_e={},Ee=null;if(G!=null)for(he in G.key!==void 0&&(Ee=""+G.key),G)P.call(G,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(_e[he]=G[he]);var we=arguments.length-2;if(we===1)_e.children=ie;else if(1<we){for(var ye=Array(we),ee=0;ee<we;ee++)ye[ee]=arguments[ee+2];_e.children=ye}if(B&&B.defaultProps)for(he in we=B.defaultProps,we)_e[he]===void 0&&(_e[he]=we[he]);return I(B,Ee,_e)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(B){return{$$typeof:d,render:B}},ot.isValidElement=M,ot.lazy=function(B){return{$$typeof:m,_payload:{_status:-1,_result:B},_init:W}},ot.memo=function(B,G){return{$$typeof:f,type:B,compare:G===void 0?null:G}},ot.startTransition=function(B){var G=D.T,ie={};D.T=ie;try{var he=B(),_e=D.S;_e!==null&&_e(ie,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(T,le)}catch(Ee){le(Ee)}finally{G!==null&&ie.types!==null&&(G.types=ie.types),D.T=G}},ot.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ot.use=function(B){return D.H.use(B)},ot.useActionState=function(B,G,ie){return D.H.useActionState(B,G,ie)},ot.useCallback=function(B,G){return D.H.useCallback(B,G)},ot.useContext=function(B){return D.H.useContext(B)},ot.useDebugValue=function(){},ot.useDeferredValue=function(B,G){return D.H.useDeferredValue(B,G)},ot.useEffect=function(B,G){return D.H.useEffect(B,G)},ot.useEffectEvent=function(B){return D.H.useEffectEvent(B)},ot.useId=function(){return D.H.useId()},ot.useImperativeHandle=function(B,G,ie){return D.H.useImperativeHandle(B,G,ie)},ot.useInsertionEffect=function(B,G){return D.H.useInsertionEffect(B,G)},ot.useLayoutEffect=function(B,G){return D.H.useLayoutEffect(B,G)},ot.useMemo=function(B,G){return D.H.useMemo(B,G)},ot.useOptimistic=function(B,G){return D.H.useOptimistic(B,G)},ot.useReducer=function(B,G,ie){return D.H.useReducer(B,G,ie)},ot.useRef=function(B){return D.H.useRef(B)},ot.useState=function(B){return D.H.useState(B)},ot.useSyncExternalStore=function(B,G,ie){return D.H.useSyncExternalStore(B,G,ie)},ot.useTransition=function(){return D.H.useTransition()},ot.version="19.2.3",ot}var x2;function $c(){return x2||(x2=1,Ox.exports=SI()),Ox.exports}var v=$c();const Ur=vs(v),CI=cw({__proto__:null,default:Ur},[v]);var Px={exports:{}},Ud={},Dx={exports:{}},Mx={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b2;function EI(){return b2||(b2=1,(function(e){function t(L,U){var W=L.length;L.push(U);e:for(;0<W;){var le=W-1>>>1,ve=L[le];if(0<a(ve,U))L[le]=U,L[W]=ve,W=le;else break e}}function r(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var U=L[0],W=L.pop();if(W!==U){L[0]=W;e:for(var le=0,ve=L.length,B=ve>>>1;le<B;){var G=2*(le+1)-1,ie=L[G],he=G+1,_e=L[he];if(0>a(ie,W))he<ve&&0>a(_e,ie)?(L[le]=_e,L[he]=W,le=he):(L[le]=ie,L[G]=W,le=G);else if(he<ve&&0>a(_e,W))L[le]=_e,L[he]=W,le=he;else break e}}return U}function a(L,U){var W=L.sortIndex-U.sortIndex;return W!==0?W:L.id-U.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var h=[],f=[],m=1,g=null,x=3,b=!1,j=!1,w=!1,_=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function E(L){for(var U=r(f);U!==null;){if(U.callback===null)n(f);else if(U.startTime<=L)n(f),U.sortIndex=U.expirationTime,t(h,U);else break;U=r(f)}}function S(L){if(w=!1,E(L),!j)if(r(h)!==null)j=!0,T||(T=!0,R());else{var U=r(f);U!==null&&H(S,U.startTime-L)}}var T=!1,D=-1,P=5,I=-1;function $(){return _?!0:!(e.unstable_now()-I<P)}function M(){if(_=!1,T){var L=e.unstable_now();I=L;var U=!0;try{e:{j=!1,w&&(w=!1,C(D),D=-1),b=!0;var W=x;try{t:{for(E(L),g=r(h);g!==null&&!(g.expirationTime>L&&$());){var le=g.callback;if(typeof le=="function"){g.callback=null,x=g.priorityLevel;var ve=le(g.expirationTime<=L);if(L=e.unstable_now(),typeof ve=="function"){g.callback=ve,E(L),U=!0;break t}g===r(h)&&n(h),E(L)}else n(h);g=r(h)}if(g!==null)U=!0;else{var B=r(f);B!==null&&H(S,B.startTime-L),U=!1}}break e}finally{g=null,x=W,b=!1}U=void 0}}finally{U?R():T=!1}}}var R;if(typeof A=="function")R=function(){A(M)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=M,R=function(){V.postMessage(null)}}else R=function(){N(M,0)};function H(L,U){D=N(function(){L(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(L){switch(x){case 1:case 2:case 3:var U=3;break;default:U=x}var W=x;x=U;try{return L()}finally{x=W}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(L,U){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var W=x;x=L;try{return U()}finally{x=W}},e.unstable_scheduleCallback=function(L,U,W){var le=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?le+W:le):W=le,L){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=W+ve,L={id:m++,callback:U,priorityLevel:L,startTime:W,expirationTime:ve,sortIndex:-1},W>le?(L.sortIndex=W,t(f,L),r(h)===null&&L===r(f)&&(w?(C(D),D=-1):w=!0,H(S,W-le))):(L.sortIndex=ve,t(h,L),j||b||(j=!0,T||(T=!0,R()))),L},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(L){var U=x;return function(){var W=x;x=U;try{return L.apply(this,arguments)}finally{x=W}}}})(Mx)),Mx}var v2;function AI(){return v2||(v2=1,Dx.exports=EI()),Dx.exports}var Rx={exports:{}},Sn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y2;function TI(){if(y2)return Sn;y2=1;var e=$c();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,f,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:h,containerInfo:f,implementation:m}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Sn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Sn.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,m)},Sn.flushSync=function(h){var f=c.T,m=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=f,n.p=m,n.d.f()}},Sn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Sn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Sn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,g=d(m,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:x,fetchPriority:b}):m==="script"&&n.d.X(h,{crossOrigin:g,integrity:x,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Sn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=d(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Sn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,g=d(m,f.crossOrigin);n.d.L(h,m,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Sn.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=d(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Sn.requestFormReset=function(h){n.d.r(h)},Sn.unstable_batchedUpdates=function(h,f){return h(f)},Sn.useFormState=function(h,f,m){return c.H.useFormState(h,f,m)},Sn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Sn.version="19.2.3",Sn}var w2;function _E(){if(w2)return Rx.exports;w2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Rx.exports=TI(),Rx.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j2;function OI(){if(j2)return Ud;j2=1;var e=AI(),t=$c(),r=_E();function n(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function c(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function d(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function h(i){if(l(i)!==i)throw Error(n(188))}function f(i){var o=i.alternate;if(!o){if(o=l(i),o===null)throw Error(n(188));return o!==i?null:i}for(var u=i,p=o;;){var y=u.return;if(y===null)break;var k=y.alternate;if(k===null){if(p=y.return,p!==null){u=p;continue}break}if(y.child===k.child){for(k=y.child;k;){if(k===u)return h(y),i;if(k===p)return h(y),o;k=k.sibling}throw Error(n(188))}if(u.return!==p.return)u=y,p=k;else{for(var O=!1,z=y.child;z;){if(z===u){O=!0,u=y,p=k;break}if(z===p){O=!0,p=y,u=k;break}z=z.sibling}if(!O){for(z=k.child;z;){if(z===u){O=!0,u=k,p=y;break}if(z===p){O=!0,p=k,u=y;break}z=z.sibling}if(!O)throw Error(n(189))}}if(u.alternate!==p)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?i:o}function m(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=m(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),A=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function R(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var F=Symbol.for("react.client.reference");function V(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===F?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case N:return"Profiler";case _:return"StrictMode";case S:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case j:return"Portal";case A:return i.displayName||"Context";case C:return(i._context.displayName||"Context")+".Consumer";case E:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return o=i.displayName||null,o!==null?o:V(i.type)||"Memo";case P:o=i._payload,i=i._init;try{return V(i(o))}catch{}}return null}var H=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},le=[],ve=-1;function B(i){return{current:i}}function G(i){0>ve||(i.current=le[ve],le[ve]=null,ve--)}function ie(i,o){ve++,le[ve]=i.current,i.current=o}var he=B(null),_e=B(null),Ee=B(null),we=B(null);function ye(i,o){switch(ie(Ee,o),ie(_e,i),ie(he,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?$N(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=$N(o),i=LN(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}G(he),ie(he,i)}function ee(){G(he),G(_e),G(Ee)}function ke(i){i.memoizedState!==null&&ie(we,i);var o=he.current,u=LN(o,i.type);o!==u&&(ie(_e,i),ie(he,u))}function Te(i){_e.current===i&&(G(he),G(_e)),we.current===i&&(G(we),Id._currentValue=W)}var J,Le;function $e(i){if(J===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);J=o&&o[1]||"",Le=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+i+Le}var ut=!1;function yt(i,o){if(!i||ut)return"";ut=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(oe){var se=oe}Reflect.construct(i,[],xe)}else{try{xe.call()}catch(oe){se=oe}i.call(xe.prototype)}}else{try{throw Error()}catch(oe){se=oe}(xe=i())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(oe){if(oe&&se&&typeof oe.stack=="string")return[oe.stack,se.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=p.DetermineComponentFrameRoot(),O=k[0],z=k[1];if(O&&z){var q=O.split(`
`),ne=z.split(`
`);for(y=p=0;p<q.length&&!q[p].includes("DetermineComponentFrameRoot");)p++;for(;y<ne.length&&!ne[y].includes("DetermineComponentFrameRoot");)y++;if(p===q.length||y===ne.length)for(p=q.length-1,y=ne.length-1;1<=p&&0<=y&&q[p]!==ne[y];)y--;for(;1<=p&&0<=y;p--,y--)if(q[p]!==ne[y]){if(p!==1||y!==1)do if(p--,y--,0>y||q[p]!==ne[y]){var ue=`
`+q[p].replace(" at new "," at ");return i.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",i.displayName)),ue}while(1<=p&&0<=y);break}}}finally{ut=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?$e(u):""}function Dt(i,o){switch(i.tag){case 26:case 27:case 5:return $e(i.type);case 16:return $e("Lazy");case 13:return i.child!==o&&o!==null?$e("Suspense Fallback"):$e("Suspense");case 19:return $e("SuspenseList");case 0:case 15:return yt(i.type,!1);case 11:return yt(i.type.render,!1);case 1:return yt(i.type,!0);case 31:return $e("Activity");default:return""}}function Zt(i){try{var o="",u=null;do o+=Dt(i,u),u=i,i=i.return;while(i);return o}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var dr=Object.prototype.hasOwnProperty,Y=e.unstable_scheduleCallback,Z=e.unstable_cancelCallback,fe=e.unstable_shouldYield,Ve=e.unstable_requestPaint,rt=e.unstable_now,pe=e.unstable_getCurrentPriorityLevel,qe=e.unstable_ImmediatePriority,nt=e.unstable_UserBlockingPriority,ae=e.unstable_NormalPriority,Ne=e.unstable_LowPriority,Ge=e.unstable_IdlePriority,vt=e.log,st=e.unstable_setDisableYieldValue,mt=null,wt=null;function ct(i){if(typeof vt=="function"&&st(i),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(mt,i)}catch{}}var dt=Math.clz32?Math.clz32:dn,Zr=Math.log,ws=Math.LN2;function dn(i){return i>>>=0,i===0?32:31-(Zr(i)/ws|0)|0}var Ae=256,tt=262144,pt=4194304;function te(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ze(i,o,u){var p=i.pendingLanes;if(p===0)return 0;var y=0,k=i.suspendedLanes,O=i.pingedLanes;i=i.warmLanes;var z=p&134217727;return z!==0?(p=z&~k,p!==0?y=te(p):(O&=z,O!==0?y=te(O):u||(u=z&~i,u!==0&&(y=te(u))))):(z=p&~k,z!==0?y=te(z):O!==0?y=te(O):u||(u=p&~i,u!==0&&(y=te(u)))),y===0?0:o!==0&&o!==y&&(o&k)===0&&(k=y&-y,u=o&-o,k>=u||k===32&&(u&4194048)!==0)?o:y}function Pe(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function gt(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var i=pt;return pt<<=1,(pt&62914560)===0&&(pt=4194304),i}function Et(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Ot(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function er(i,o,u,p,y,k){var O=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var z=i.entanglements,q=i.expirationTimes,ne=i.hiddenUpdates;for(u=O&~u;0<u;){var ue=31-dt(u),xe=1<<ue;z[ue]=0,q[ue]=-1;var se=ne[ue];if(se!==null)for(ne[ue]=null,ue=0;ue<se.length;ue++){var oe=se[ue];oe!==null&&(oe.lane&=-536870913)}u&=~xe}p!==0&&un(i,p,0),k!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=k&~(O&~o))}function un(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-dt(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|u&261930}function ur(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var p=31-dt(u),y=1<<p;y&o|i[p]&o&&(i[p]|=o),u&=~y}}function Sr(i,o){var u=o&-o;return u=(u&42)!==0?1:Ut(u),(u&(i.suspendedLanes|o))!==0?0:u}function Ut(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ye(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Gt(){var i=U.p;return i!==0?i:(i=window.event,i===void 0?32:l2(i.type))}function hr(i,o){var u=U.p;try{return U.p=i,o()}finally{U.p=u}}var X=Math.random().toString(36).slice(2),Se="__reactFiber$"+X,be="__reactProps$"+X,Oe="__reactContainer$"+X,lt="__reactEvents$"+X,Tt="__reactListeners$"+X,Ea="__reactHandles$"+X,hl="__reactResources$"+X,js="__reactMarker$"+X;function zn(i){delete i[Se],delete i[be],delete i[lt],delete i[Tt],delete i[Ea]}function Ni(i){var o=i[Se];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Oe]||u[Se]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=VN(i);i!==null;){if(u=i[Se])return u;i=VN(i)}return o}i=u,u=i.parentNode}return null}function ua(i){if(i=i[Se]||i[Oe]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function Si(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(n(33))}function Aa(i){var o=i[hl];return o||(o=i[hl]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Cr(i){i[js]=!0}var at=new Set,mo={};function Zn(i,o){Ta(i,o),Ta(i+"Capture",o)}function Ta(i,o){for(mo[i]=o,i=0;i<o.length;i++)at.add(o[i])}var hR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cj={},Ej={};function fR(i){return dr.call(Ej,i)?!0:dr.call(Cj,i)?!1:hR.test(i)?Ej[i]=!0:(Cj[i]=!0,!1)}function oh(i,o,u){if(fR(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function ch(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Oa(i,o,u,p){if(p===null)i.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+p)}}function _s(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Aj(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function mR(i,o,u){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var y=p.get,k=p.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return y.call(this)},set:function(O){u=""+O,k.call(this,O)}}),Object.defineProperty(i,o,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(O){u=""+O},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function jp(i){if(!i._valueTracker){var o=Aj(i)?"checked":"value";i._valueTracker=mR(i,o,""+i[o])}}function Tj(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return i&&(p=Aj(i)?i.checked?"true":"false":i.value),i=p,i!==u?(o.setValue(i),!0):!1}function dh(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var pR=/[\n"\\]/g;function ks(i){return i.replace(pR,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function _p(i,o,u,p,y,k,O,z){i.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?i.type=O:i.removeAttribute("type"),o!=null?O==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+_s(o)):i.value!==""+_s(o)&&(i.value=""+_s(o)):O!=="submit"&&O!=="reset"||i.removeAttribute("value"),o!=null?kp(i,O,_s(o)):u!=null?kp(i,O,_s(u)):p!=null&&i.removeAttribute("value"),y==null&&k!=null&&(i.defaultChecked=!!k),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?i.name=""+_s(z):i.removeAttribute("name")}function Oj(i,o,u,p,y,k,O,z){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.type=k),o!=null||u!=null){if(!(k!=="submit"&&k!=="reset"||o!=null)){jp(i);return}u=u!=null?""+_s(u):"",o=o!=null?""+_s(o):u,z||o===i.value||(i.value=o),i.defaultValue=o}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=z?i.checked:!!p,i.defaultChecked=!!p,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(i.name=O),jp(i)}function kp(i,o,u){o==="number"&&dh(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function po(i,o,u,p){if(i=i.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<i.length;u++)y=o.hasOwnProperty("$"+i[u].value),i[u].selected!==y&&(i[u].selected=y),y&&p&&(i[u].defaultSelected=!0)}else{for(u=""+_s(u),o=null,y=0;y<i.length;y++){if(i[y].value===u){i[y].selected=!0,p&&(i[y].defaultSelected=!0);return}o!==null||i[y].disabled||(o=i[y])}o!==null&&(o.selected=!0)}}function Pj(i,o,u){if(o!=null&&(o=""+_s(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+_s(u):""}function Dj(i,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(n(92));if(H(p)){if(1<p.length)throw Error(n(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=_s(o),i.defaultValue=u,p=i.textContent,p===u&&p!==""&&p!==null&&(i.value=p),jp(i)}function go(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var gR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mj(i,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,u):typeof u!="number"||u===0||gR.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function Rj(i,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(i=i.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var y in o)p=o[y],o.hasOwnProperty(y)&&u[y]!==p&&Mj(i,y,p)}else for(var k in o)o.hasOwnProperty(k)&&Mj(i,k,o[k])}function Np(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function uh(i){return bR.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Pa(){}var Sp=null;function Cp(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var xo=null,bo=null;function Ij(i){var o=ua(i);if(o&&(i=o.stateNode)){var u=i[be]||null;e:switch(i=o.stateNode,o.type){case"input":if(_p(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+ks(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==i&&p.form===i.form){var y=p[be]||null;if(!y)throw Error(n(90));_p(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===i.form&&Tj(p)}break e;case"textarea":Pj(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&po(i,!!u.multiple,o,!1)}}}var Ep=!1;function $j(i,o,u){if(Ep)return i(o,u);Ep=!0;try{var p=i(o);return p}finally{if(Ep=!1,(xo!==null||bo!==null)&&(Qh(),xo&&(o=xo,i=bo,bo=xo=null,Ij(o),i)))for(o=0;o<i.length;o++)Ij(i[o])}}function Zc(i,o){var u=i.stateNode;if(u===null)return null;var p=u[be]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ap=!1;if(Da)try{var ed={};Object.defineProperty(ed,"passive",{get:function(){Ap=!0}}),window.addEventListener("test",ed,ed),window.removeEventListener("test",ed,ed)}catch{Ap=!1}var Ci=null,Tp=null,hh=null;function Lj(){if(hh)return hh;var i,o=Tp,u=o.length,p,y="value"in Ci?Ci.value:Ci.textContent,k=y.length;for(i=0;i<u&&o[i]===y[i];i++);var O=u-i;for(p=1;p<=O&&o[u-p]===y[k-p];p++);return hh=y.slice(i,1<p?1-p:void 0)}function fh(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function mh(){return!0}function zj(){return!1}function Bn(i){function o(u,p,y,k,O){this._reactName=u,this._targetInst=y,this.type=p,this.nativeEvent=k,this.target=O,this.currentTarget=null;for(var z in i)i.hasOwnProperty(z)&&(u=i[z],this[z]=u?u(k):k[z]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?mh:zj,this.isPropagationStopped=zj,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=mh)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=mh)},persist:function(){},isPersistent:mh}),o}var fl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ph=Bn(fl),td=g({},fl,{view:0,detail:0}),vR=Bn(td),Op,Pp,rd,gh=g({},td,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mp,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==rd&&(rd&&i.type==="mousemove"?(Op=i.screenX-rd.screenX,Pp=i.screenY-rd.screenY):Pp=Op=0,rd=i),Op)},movementY:function(i){return"movementY"in i?i.movementY:Pp}}),Bj=Bn(gh),yR=g({},gh,{dataTransfer:0}),wR=Bn(yR),jR=g({},td,{relatedTarget:0}),Dp=Bn(jR),_R=g({},fl,{animationName:0,elapsedTime:0,pseudoElement:0}),kR=Bn(_R),NR=g({},fl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),SR=Bn(NR),CR=g({},fl,{data:0}),Uj=Bn(CR),ER={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OR(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=TR[i])?!!o[i]:!1}function Mp(){return OR}var PR=g({},td,{key:function(i){if(i.key){var o=ER[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=fh(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?AR[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mp,charCode:function(i){return i.type==="keypress"?fh(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?fh(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),DR=Bn(PR),MR=g({},gh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qj=Bn(MR),RR=g({},td,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mp}),IR=Bn(RR),$R=g({},fl,{propertyName:0,elapsedTime:0,pseudoElement:0}),LR=Bn($R),zR=g({},gh,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),BR=Bn(zR),UR=g({},fl,{newState:0,oldState:0}),qR=Bn(UR),FR=[9,13,27,32],Rp=Da&&"CompositionEvent"in window,nd=null;Da&&"documentMode"in document&&(nd=document.documentMode);var HR=Da&&"TextEvent"in window&&!nd,Fj=Da&&(!Rp||nd&&8<nd&&11>=nd),Hj=" ",Vj=!1;function Wj(i,o){switch(i){case"keyup":return FR.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gj(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var vo=!1;function VR(i,o){switch(i){case"compositionend":return Gj(o);case"keypress":return o.which!==32?null:(Vj=!0,Hj);case"textInput":return i=o.data,i===Hj&&Vj?null:i;default:return null}}function WR(i,o){if(vo)return i==="compositionend"||!Rp&&Wj(i,o)?(i=Lj(),hh=Tp=Ci=null,vo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Fj&&o.locale!=="ko"?null:o.data;default:return null}}var GR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kj(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!GR[i.type]:o==="textarea"}function Yj(i,o,u,p){xo?bo?bo.push(p):bo=[p]:xo=p,o=af(o,"onChange"),0<o.length&&(u=new ph("onChange","change",null,u,p),i.push({event:u,listeners:o}))}var sd=null,ad=null;function KR(i){ON(i,0)}function xh(i){var o=Si(i);if(Tj(o))return i}function Xj(i,o){if(i==="change")return o}var Jj=!1;if(Da){var Ip;if(Da){var $p="oninput"in document;if(!$p){var Qj=document.createElement("div");Qj.setAttribute("oninput","return;"),$p=typeof Qj.oninput=="function"}Ip=$p}else Ip=!1;Jj=Ip&&(!document.documentMode||9<document.documentMode)}function Zj(){sd&&(sd.detachEvent("onpropertychange",e_),ad=sd=null)}function e_(i){if(i.propertyName==="value"&&xh(ad)){var o=[];Yj(o,ad,i,Cp(i)),$j(KR,o)}}function YR(i,o,u){i==="focusin"?(Zj(),sd=o,ad=u,sd.attachEvent("onpropertychange",e_)):i==="focusout"&&Zj()}function XR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return xh(ad)}function JR(i,o){if(i==="click")return xh(o)}function QR(i,o){if(i==="input"||i==="change")return xh(o)}function ZR(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var es=typeof Object.is=="function"?Object.is:ZR;function id(i,o){if(es(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var y=u[p];if(!dr.call(o,y)||!es(i[y],o[y]))return!1}return!0}function t_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function r_(i,o){var u=t_(i);i=0;for(var p;u;){if(u.nodeType===3){if(p=i+u.textContent.length,i<=o&&p>=o)return{node:u,offset:o-i};i=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=t_(u)}}function n_(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?n_(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function s_(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=dh(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=dh(i.document)}return o}function Lp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var e8=Da&&"documentMode"in document&&11>=document.documentMode,yo=null,zp=null,ld=null,Bp=!1;function a_(i,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Bp||yo==null||yo!==dh(p)||(p=yo,"selectionStart"in p&&Lp(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ld&&id(ld,p)||(ld=p,p=af(zp,"onSelect"),0<p.length&&(o=new ph("onSelect","select",null,o,u),i.push({event:o,listeners:p}),o.target=yo)))}function ml(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var wo={animationend:ml("Animation","AnimationEnd"),animationiteration:ml("Animation","AnimationIteration"),animationstart:ml("Animation","AnimationStart"),transitionrun:ml("Transition","TransitionRun"),transitionstart:ml("Transition","TransitionStart"),transitioncancel:ml("Transition","TransitionCancel"),transitionend:ml("Transition","TransitionEnd")},Up={},i_={};Da&&(i_=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function pl(i){if(Up[i])return Up[i];if(!wo[i])return i;var o=wo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in i_)return Up[i]=o[u];return i}var l_=pl("animationend"),o_=pl("animationiteration"),c_=pl("animationstart"),t8=pl("transitionrun"),r8=pl("transitionstart"),n8=pl("transitioncancel"),d_=pl("transitionend"),u_=new Map,qp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qp.push("scrollEnd");function Hs(i,o){u_.set(i,o),Zn(o,[i])}var bh=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ns=[],jo=0,Fp=0;function vh(){for(var i=jo,o=Fp=jo=0;o<i;){var u=Ns[o];Ns[o++]=null;var p=Ns[o];Ns[o++]=null;var y=Ns[o];Ns[o++]=null;var k=Ns[o];if(Ns[o++]=null,p!==null&&y!==null){var O=p.pending;O===null?y.next=y:(y.next=O.next,O.next=y),p.pending=y}k!==0&&h_(u,y,k)}}function yh(i,o,u,p){Ns[jo++]=i,Ns[jo++]=o,Ns[jo++]=u,Ns[jo++]=p,Fp|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Hp(i,o,u,p){return yh(i,o,u,p),wh(i)}function gl(i,o){return yh(i,null,null,o),wh(i)}function h_(i,o,u){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u);for(var y=!1,k=i.return;k!==null;)k.childLanes|=u,p=k.alternate,p!==null&&(p.childLanes|=u),k.tag===22&&(i=k.stateNode,i===null||i._visibility&1||(y=!0)),i=k,k=k.return;return i.tag===3?(k=i.stateNode,y&&o!==null&&(y=31-dt(u),i=k.hiddenUpdates,p=i[y],p===null?i[y]=[o]:p.push(o),o.lane=u|536870912),k):null}function wh(i){if(50<Ad)throw Ad=0,Zg=null,Error(n(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var _o={};function s8(i,o,u,p){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(i,o,u,p){return new s8(i,o,u,p)}function Vp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ma(i,o){var u=i.alternate;return u===null?(u=ts(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function f_(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function jh(i,o,u,p,y,k){var O=0;if(p=i,typeof i=="function")Vp(i)&&(O=1);else if(typeof i=="string")O=cI(i,u,he.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case I:return i=ts(31,u,o,y),i.elementType=I,i.lanes=k,i;case w:return xl(u.children,y,k,o);case _:O=8,y|=24;break;case N:return i=ts(12,u,o,y|2),i.elementType=N,i.lanes=k,i;case S:return i=ts(13,u,o,y),i.elementType=S,i.lanes=k,i;case T:return i=ts(19,u,o,y),i.elementType=T,i.lanes=k,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case A:O=10;break e;case C:O=9;break e;case E:O=11;break e;case D:O=14;break e;case P:O=16,p=null;break e}O=29,u=Error(n(130,i===null?"null":typeof i,"")),p=null}return o=ts(O,u,o,y),o.elementType=i,o.type=p,o.lanes=k,o}function xl(i,o,u,p){return i=ts(7,i,p,o),i.lanes=u,i}function Wp(i,o,u){return i=ts(6,i,null,o),i.lanes=u,i}function m_(i){var o=ts(18,null,null,0);return o.stateNode=i,o}function Gp(i,o,u){return o=ts(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var p_=new WeakMap;function Ss(i,o){if(typeof i=="object"&&i!==null){var u=p_.get(i);return u!==void 0?u:(o={value:i,source:o,stack:Zt(o)},p_.set(i,o),o)}return{value:i,source:o,stack:Zt(o)}}var ko=[],No=0,_h=null,od=0,Cs=[],Es=0,Ei=null,ha=1,fa="";function Ra(i,o){ko[No++]=od,ko[No++]=_h,_h=i,od=o}function g_(i,o,u){Cs[Es++]=ha,Cs[Es++]=fa,Cs[Es++]=Ei,Ei=i;var p=ha;i=fa;var y=32-dt(p)-1;p&=~(1<<y),u+=1;var k=32-dt(o)+y;if(30<k){var O=y-y%5;k=(p&(1<<O)-1).toString(32),p>>=O,y-=O,ha=1<<32-dt(o)+y|u<<y|p,fa=k+i}else ha=1<<k|u<<y|p,fa=i}function Kp(i){i.return!==null&&(Ra(i,1),g_(i,1,0))}function Yp(i){for(;i===_h;)_h=ko[--No],ko[No]=null,od=ko[--No],ko[No]=null;for(;i===Ei;)Ei=Cs[--Es],Cs[Es]=null,fa=Cs[--Es],Cs[Es]=null,ha=Cs[--Es],Cs[Es]=null}function x_(i,o){Cs[Es++]=ha,Cs[Es++]=fa,Cs[Es++]=Ei,ha=o.id,fa=o.overflow,Ei=i}var hn=null,ir=null,At=!1,Ai=null,As=!1,Xp=Error(n(519));function Ti(i){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cd(Ss(o,i)),Xp}function b_(i){var o=i.stateNode,u=i.type,p=i.memoizedProps;switch(o[Se]=i,o[be]=p,u){case"dialog":_t("cancel",o),_t("close",o);break;case"iframe":case"object":case"embed":_t("load",o);break;case"video":case"audio":for(u=0;u<Od.length;u++)_t(Od[u],o);break;case"source":_t("error",o);break;case"img":case"image":case"link":_t("error",o),_t("load",o);break;case"details":_t("toggle",o);break;case"input":_t("invalid",o),Oj(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":_t("invalid",o);break;case"textarea":_t("invalid",o),Dj(o,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||RN(o.textContent,u)?(p.popover!=null&&(_t("beforetoggle",o),_t("toggle",o)),p.onScroll!=null&&_t("scroll",o),p.onScrollEnd!=null&&_t("scrollend",o),p.onClick!=null&&(o.onclick=Pa),o=!0):o=!1,o||Ti(i,!0)}function v_(i){for(hn=i.return;hn;)switch(hn.tag){case 5:case 31:case 13:As=!1;return;case 27:case 3:As=!0;return;default:hn=hn.return}}function So(i){if(i!==hn)return!1;if(!At)return v_(i),At=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||mx(i.type,i.memoizedProps)),u=!u),u&&ir&&Ti(i),v_(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ir=HN(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ir=HN(i)}else o===27?(o=ir,Hi(i.type)?(i=vx,vx=null,ir=i):ir=o):ir=hn?Os(i.stateNode.nextSibling):null;return!0}function bl(){ir=hn=null,At=!1}function Jp(){var i=Ai;return i!==null&&(Hn===null?Hn=i:Hn.push.apply(Hn,i),Ai=null),i}function cd(i){Ai===null?Ai=[i]:Ai.push(i)}var Qp=B(null),vl=null,Ia=null;function Oi(i,o,u){ie(Qp,o._currentValue),o._currentValue=u}function $a(i){i._currentValue=Qp.current,G(Qp)}function Zp(i,o,u){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===u)break;i=i.return}}function eg(i,o,u,p){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var k=y.dependencies;if(k!==null){var O=y.child;k=k.firstContext;e:for(;k!==null;){var z=k;k=y;for(var q=0;q<o.length;q++)if(z.context===o[q]){k.lanes|=u,z=k.alternate,z!==null&&(z.lanes|=u),Zp(k.return,u,i),p||(O=null);break e}k=z.next}}else if(y.tag===18){if(O=y.return,O===null)throw Error(n(341));O.lanes|=u,k=O.alternate,k!==null&&(k.lanes|=u),Zp(O,u,i),O=null}else O=y.child;if(O!==null)O.return=y;else for(O=y;O!==null;){if(O===i){O=null;break}if(y=O.sibling,y!==null){y.return=O.return,O=y;break}O=O.return}y=O}}function Co(i,o,u,p){i=null;for(var y=o,k=!1;y!==null;){if(!k){if((y.flags&524288)!==0)k=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var O=y.alternate;if(O===null)throw Error(n(387));if(O=O.memoizedProps,O!==null){var z=y.type;es(y.pendingProps.value,O.value)||(i!==null?i.push(z):i=[z])}}else if(y===we.current){if(O=y.alternate,O===null)throw Error(n(387));O.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(Id):i=[Id])}y=y.return}i!==null&&eg(o,i,u,p),o.flags|=262144}function kh(i){for(i=i.firstContext;i!==null;){if(!es(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function yl(i){vl=i,Ia=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fn(i){return y_(vl,i)}function Nh(i,o){return vl===null&&yl(i),y_(i,o)}function y_(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Ia===null){if(i===null)throw Error(n(308));Ia=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Ia=Ia.next=o;return u}var a8=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},i8=e.unstable_scheduleCallback,l8=e.unstable_NormalPriority,Mr={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function tg(){return{controller:new a8,data:new Map,refCount:0}}function dd(i){i.refCount--,i.refCount===0&&i8(l8,function(){i.controller.abort()})}var ud=null,rg=0,Eo=0,Ao=null;function o8(i,o){if(ud===null){var u=ud=[];rg=0,Eo=ax(),Ao={status:"pending",value:void 0,then:function(p){u.push(p)}}}return rg++,o.then(w_,w_),o}function w_(){if(--rg===0&&ud!==null){Ao!==null&&(Ao.status="fulfilled");var i=ud;ud=null,Eo=0,Ao=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function c8(i,o){var u=[],p={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(p.status="rejected",p.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),p}var j_=L.S;L.S=function(i,o){aN=rt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&o8(i,o),j_!==null&&j_(i,o)};var wl=B(null);function ng(){var i=wl.current;return i!==null?i:tr.pooledCache}function Sh(i,o){o===null?ie(wl,wl.current):ie(wl,o.pool)}function __(){var i=ng();return i===null?null:{parent:Mr._currentValue,pool:i}}var To=Error(n(460)),sg=Error(n(474)),Ch=Error(n(542)),Eh={then:function(){}};function k_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function N_(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(Pa,Pa),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,C_(i),i;default:if(typeof o.status=="string")o.then(Pa,Pa);else{if(i=tr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=p}},function(p){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,C_(i),i}throw _l=o,To}}function jl(i){try{var o=i._init;return o(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(_l=u,To):u}}var _l=null;function S_(){if(_l===null)throw Error(n(459));var i=_l;return _l=null,i}function C_(i){if(i===To||i===Ch)throw Error(n(483))}var Oo=null,hd=0;function Ah(i){var o=hd;return hd+=1,Oo===null&&(Oo=[]),N_(Oo,i,o)}function fd(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Th(i,o){throw o.$$typeof===x?Error(n(525)):(i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function E_(i){function o(Q,K){if(i){var re=Q.deletions;re===null?(Q.deletions=[K],Q.flags|=16):re.push(K)}}function u(Q,K){if(!i)return null;for(;K!==null;)o(Q,K),K=K.sibling;return null}function p(Q){for(var K=new Map;Q!==null;)Q.key!==null?K.set(Q.key,Q):K.set(Q.index,Q),Q=Q.sibling;return K}function y(Q,K){return Q=Ma(Q,K),Q.index=0,Q.sibling=null,Q}function k(Q,K,re){return Q.index=re,i?(re=Q.alternate,re!==null?(re=re.index,re<K?(Q.flags|=67108866,K):re):(Q.flags|=67108866,K)):(Q.flags|=1048576,K)}function O(Q){return i&&Q.alternate===null&&(Q.flags|=67108866),Q}function z(Q,K,re,me){return K===null||K.tag!==6?(K=Wp(re,Q.mode,me),K.return=Q,K):(K=y(K,re),K.return=Q,K)}function q(Q,K,re,me){var Ke=re.type;return Ke===w?ue(Q,K,re.props.children,me,re.key):K!==null&&(K.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===P&&jl(Ke)===K.type)?(K=y(K,re.props),fd(K,re),K.return=Q,K):(K=jh(re.type,re.key,re.props,null,Q.mode,me),fd(K,re),K.return=Q,K)}function ne(Q,K,re,me){return K===null||K.tag!==4||K.stateNode.containerInfo!==re.containerInfo||K.stateNode.implementation!==re.implementation?(K=Gp(re,Q.mode,me),K.return=Q,K):(K=y(K,re.children||[]),K.return=Q,K)}function ue(Q,K,re,me,Ke){return K===null||K.tag!==7?(K=xl(re,Q.mode,me,Ke),K.return=Q,K):(K=y(K,re),K.return=Q,K)}function xe(Q,K,re){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=Wp(""+K,Q.mode,re),K.return=Q,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case b:return re=jh(K.type,K.key,K.props,null,Q.mode,re),fd(re,K),re.return=Q,re;case j:return K=Gp(K,Q.mode,re),K.return=Q,K;case P:return K=jl(K),xe(Q,K,re)}if(H(K)||R(K))return K=xl(K,Q.mode,re,null),K.return=Q,K;if(typeof K.then=="function")return xe(Q,Ah(K),re);if(K.$$typeof===A)return xe(Q,Nh(Q,K),re);Th(Q,K)}return null}function se(Q,K,re,me){var Ke=K!==null?K.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return Ke!==null?null:z(Q,K,""+re,me);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return re.key===Ke?q(Q,K,re,me):null;case j:return re.key===Ke?ne(Q,K,re,me):null;case P:return re=jl(re),se(Q,K,re,me)}if(H(re)||R(re))return Ke!==null?null:ue(Q,K,re,me,null);if(typeof re.then=="function")return se(Q,K,Ah(re),me);if(re.$$typeof===A)return se(Q,K,Nh(Q,re),me);Th(Q,re)}return null}function oe(Q,K,re,me,Ke){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Q=Q.get(re)||null,z(K,Q,""+me,Ke);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case b:return Q=Q.get(me.key===null?re:me.key)||null,q(K,Q,me,Ke);case j:return Q=Q.get(me.key===null?re:me.key)||null,ne(K,Q,me,Ke);case P:return me=jl(me),oe(Q,K,re,me,Ke)}if(H(me)||R(me))return Q=Q.get(re)||null,ue(K,Q,me,Ke,null);if(typeof me.then=="function")return oe(Q,K,re,Ah(me),Ke);if(me.$$typeof===A)return oe(Q,K,re,Nh(K,me),Ke);Th(K,me)}return null}function Ue(Q,K,re,me){for(var Ke=null,Mt=null,Fe=K,xt=K=0,Nt=null;Fe!==null&&xt<re.length;xt++){Fe.index>xt?(Nt=Fe,Fe=null):Nt=Fe.sibling;var Rt=se(Q,Fe,re[xt],me);if(Rt===null){Fe===null&&(Fe=Nt);break}i&&Fe&&Rt.alternate===null&&o(Q,Fe),K=k(Rt,K,xt),Mt===null?Ke=Rt:Mt.sibling=Rt,Mt=Rt,Fe=Nt}if(xt===re.length)return u(Q,Fe),At&&Ra(Q,xt),Ke;if(Fe===null){for(;xt<re.length;xt++)Fe=xe(Q,re[xt],me),Fe!==null&&(K=k(Fe,K,xt),Mt===null?Ke=Fe:Mt.sibling=Fe,Mt=Fe);return At&&Ra(Q,xt),Ke}for(Fe=p(Fe);xt<re.length;xt++)Nt=oe(Fe,Q,xt,re[xt],me),Nt!==null&&(i&&Nt.alternate!==null&&Fe.delete(Nt.key===null?xt:Nt.key),K=k(Nt,K,xt),Mt===null?Ke=Nt:Mt.sibling=Nt,Mt=Nt);return i&&Fe.forEach(function(Yi){return o(Q,Yi)}),At&&Ra(Q,xt),Ke}function Je(Q,K,re,me){if(re==null)throw Error(n(151));for(var Ke=null,Mt=null,Fe=K,xt=K=0,Nt=null,Rt=re.next();Fe!==null&&!Rt.done;xt++,Rt=re.next()){Fe.index>xt?(Nt=Fe,Fe=null):Nt=Fe.sibling;var Yi=se(Q,Fe,Rt.value,me);if(Yi===null){Fe===null&&(Fe=Nt);break}i&&Fe&&Yi.alternate===null&&o(Q,Fe),K=k(Yi,K,xt),Mt===null?Ke=Yi:Mt.sibling=Yi,Mt=Yi,Fe=Nt}if(Rt.done)return u(Q,Fe),At&&Ra(Q,xt),Ke;if(Fe===null){for(;!Rt.done;xt++,Rt=re.next())Rt=xe(Q,Rt.value,me),Rt!==null&&(K=k(Rt,K,xt),Mt===null?Ke=Rt:Mt.sibling=Rt,Mt=Rt);return At&&Ra(Q,xt),Ke}for(Fe=p(Fe);!Rt.done;xt++,Rt=re.next())Rt=oe(Fe,Q,xt,Rt.value,me),Rt!==null&&(i&&Rt.alternate!==null&&Fe.delete(Rt.key===null?xt:Rt.key),K=k(Rt,K,xt),Mt===null?Ke=Rt:Mt.sibling=Rt,Mt=Rt);return i&&Fe.forEach(function(yI){return o(Q,yI)}),At&&Ra(Q,xt),Ke}function Xt(Q,K,re,me){if(typeof re=="object"&&re!==null&&re.type===w&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case b:e:{for(var Ke=re.key;K!==null;){if(K.key===Ke){if(Ke=re.type,Ke===w){if(K.tag===7){u(Q,K.sibling),me=y(K,re.props.children),me.return=Q,Q=me;break e}}else if(K.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===P&&jl(Ke)===K.type){u(Q,K.sibling),me=y(K,re.props),fd(me,re),me.return=Q,Q=me;break e}u(Q,K);break}else o(Q,K);K=K.sibling}re.type===w?(me=xl(re.props.children,Q.mode,me,re.key),me.return=Q,Q=me):(me=jh(re.type,re.key,re.props,null,Q.mode,me),fd(me,re),me.return=Q,Q=me)}return O(Q);case j:e:{for(Ke=re.key;K!==null;){if(K.key===Ke)if(K.tag===4&&K.stateNode.containerInfo===re.containerInfo&&K.stateNode.implementation===re.implementation){u(Q,K.sibling),me=y(K,re.children||[]),me.return=Q,Q=me;break e}else{u(Q,K);break}else o(Q,K);K=K.sibling}me=Gp(re,Q.mode,me),me.return=Q,Q=me}return O(Q);case P:return re=jl(re),Xt(Q,K,re,me)}if(H(re))return Ue(Q,K,re,me);if(R(re)){if(Ke=R(re),typeof Ke!="function")throw Error(n(150));return re=Ke.call(re),Je(Q,K,re,me)}if(typeof re.then=="function")return Xt(Q,K,Ah(re),me);if(re.$$typeof===A)return Xt(Q,K,Nh(Q,re),me);Th(Q,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,K!==null&&K.tag===6?(u(Q,K.sibling),me=y(K,re),me.return=Q,Q=me):(u(Q,K),me=Wp(re,Q.mode,me),me.return=Q,Q=me),O(Q)):u(Q,K)}return function(Q,K,re,me){try{hd=0;var Ke=Xt(Q,K,re,me);return Oo=null,Ke}catch(Fe){if(Fe===To||Fe===Ch)throw Fe;var Mt=ts(29,Fe,null,Q.mode);return Mt.lanes=me,Mt.return=Q,Mt}finally{}}}var kl=E_(!0),A_=E_(!1),Pi=!1;function ag(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ig(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Di(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Mi(i,o,u){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,($t&2)!==0){var y=p.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),p.pending=o,o=wh(i),h_(i,null,u),o}return yh(i,p,o,u),wh(i)}function md(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,ur(i,u)}}function lg(i,o){var u=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var y=null,k=null;if(u=u.firstBaseUpdate,u!==null){do{var O={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};k===null?y=k=O:k=k.next=O,u=u.next}while(u!==null);k===null?y=k=o:k=k.next=o}else y=k=o;u={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:k,shared:p.shared,callbacks:p.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var og=!1;function pd(){if(og){var i=Ao;if(i!==null)throw i}}function gd(i,o,u,p){og=!1;var y=i.updateQueue;Pi=!1;var k=y.firstBaseUpdate,O=y.lastBaseUpdate,z=y.shared.pending;if(z!==null){y.shared.pending=null;var q=z,ne=q.next;q.next=null,O===null?k=ne:O.next=ne,O=q;var ue=i.alternate;ue!==null&&(ue=ue.updateQueue,z=ue.lastBaseUpdate,z!==O&&(z===null?ue.firstBaseUpdate=ne:z.next=ne,ue.lastBaseUpdate=q))}if(k!==null){var xe=y.baseState;O=0,ue=ne=q=null,z=k;do{var se=z.lane&-536870913,oe=se!==z.lane;if(oe?(kt&se)===se:(p&se)===se){se!==0&&se===Eo&&(og=!0),ue!==null&&(ue=ue.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Ue=i,Je=z;se=o;var Xt=u;switch(Je.tag){case 1:if(Ue=Je.payload,typeof Ue=="function"){xe=Ue.call(Xt,xe,se);break e}xe=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Je.payload,se=typeof Ue=="function"?Ue.call(Xt,xe,se):Ue,se==null)break e;xe=g({},xe,se);break e;case 2:Pi=!0}}se=z.callback,se!==null&&(i.flags|=64,oe&&(i.flags|=8192),oe=y.callbacks,oe===null?y.callbacks=[se]:oe.push(se))}else oe={lane:se,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ue===null?(ne=ue=oe,q=xe):ue=ue.next=oe,O|=se;if(z=z.next,z===null){if(z=y.shared.pending,z===null)break;oe=z,z=oe.next,oe.next=null,y.lastBaseUpdate=oe,y.shared.pending=null}}while(!0);ue===null&&(q=xe),y.baseState=q,y.firstBaseUpdate=ne,y.lastBaseUpdate=ue,k===null&&(y.shared.lanes=0),zi|=O,i.lanes=O,i.memoizedState=xe}}function T_(i,o){if(typeof i!="function")throw Error(n(191,i));i.call(o)}function O_(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)T_(u[i],o)}var Po=B(null),Oh=B(0);function P_(i,o){i=Wa,ie(Oh,i),ie(Po,o),Wa=i|o.baseLanes}function cg(){ie(Oh,Wa),ie(Po,Po.current)}function dg(){Wa=Oh.current,G(Po),G(Oh)}var rs=B(null),Ts=null;function Ri(i){var o=i.alternate;ie(Er,Er.current&1),ie(rs,i),Ts===null&&(o===null||Po.current!==null||o.memoizedState!==null)&&(Ts=i)}function ug(i){ie(Er,Er.current),ie(rs,i),Ts===null&&(Ts=i)}function D_(i){i.tag===22?(ie(Er,Er.current),ie(rs,i),Ts===null&&(Ts=i)):Ii()}function Ii(){ie(Er,Er.current),ie(rs,rs.current)}function ns(i){G(rs),Ts===i&&(Ts=null),G(Er)}var Er=B(0);function Ph(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||xx(u)||bx(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var La=0,ht=null,Kt=null,Rr=null,Dh=!1,Do=!1,Nl=!1,Mh=0,xd=0,Mo=null,d8=0;function jr(){throw Error(n(321))}function hg(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!es(i[u],o[u]))return!1;return!0}function fg(i,o,u,p,y,k){return La=k,ht=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,L.H=i===null||i.memoizedState===null?gk:Eg,Nl=!1,k=u(p,y),Nl=!1,Do&&(k=R_(o,u,p,y)),M_(i),k}function M_(i){L.H=yd;var o=Kt!==null&&Kt.next!==null;if(La=0,Rr=Kt=ht=null,Dh=!1,xd=0,Mo=null,o)throw Error(n(300));i===null||Ir||(i=i.dependencies,i!==null&&kh(i)&&(Ir=!0))}function R_(i,o,u,p){ht=i;var y=0;do{if(Do&&(Mo=null),xd=0,Do=!1,25<=y)throw Error(n(301));if(y+=1,Rr=Kt=null,i.updateQueue!=null){var k=i.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}L.H=xk,k=o(u,p)}while(Do);return k}function u8(){var i=L.H,o=i.useState()[0];return o=typeof o.then=="function"?bd(o):o,i=i.useState()[0],(Kt!==null?Kt.memoizedState:null)!==i&&(ht.flags|=1024),o}function mg(){var i=Mh!==0;return Mh=0,i}function pg(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function gg(i){if(Dh){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Dh=!1}La=0,Rr=Kt=ht=null,Do=!1,xd=Mh=0,Mo=null}function On(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rr===null?ht.memoizedState=Rr=i:Rr=Rr.next=i,Rr}function Ar(){if(Kt===null){var i=ht.alternate;i=i!==null?i.memoizedState:null}else i=Kt.next;var o=Rr===null?ht.memoizedState:Rr.next;if(o!==null)Rr=o,Kt=i;else{if(i===null)throw ht.alternate===null?Error(n(467)):Error(n(310));Kt=i,i={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},Rr===null?ht.memoizedState=Rr=i:Rr=Rr.next=i}return Rr}function Rh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bd(i){var o=xd;return xd+=1,Mo===null&&(Mo=[]),i=N_(Mo,i,o),o=ht,(Rr===null?o.memoizedState:Rr.next)===null&&(o=o.alternate,L.H=o===null||o.memoizedState===null?gk:Eg),i}function Ih(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return bd(i);if(i.$$typeof===A)return fn(i)}throw Error(n(438,String(i)))}function xg(i){var o=null,u=ht.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=ht.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Rh(),ht.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),p=0;p<i;p++)u[p]=$;return o.index++,u}function za(i,o){return typeof o=="function"?o(i):o}function $h(i){var o=Ar();return bg(o,Kt,i)}function bg(i,o,u){var p=i.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=u;var y=i.baseQueue,k=p.pending;if(k!==null){if(y!==null){var O=y.next;y.next=k.next,k.next=O}o.baseQueue=y=k,p.pending=null}if(k=i.baseState,y===null)i.memoizedState=k;else{o=y.next;var z=O=null,q=null,ne=o,ue=!1;do{var xe=ne.lane&-536870913;if(xe!==ne.lane?(kt&xe)===xe:(La&xe)===xe){var se=ne.revertLane;if(se===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),xe===Eo&&(ue=!0);else if((La&se)===se){ne=ne.next,se===Eo&&(ue=!0);continue}else xe={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(z=q=xe,O=k):q=q.next=xe,ht.lanes|=se,zi|=se;xe=ne.action,Nl&&u(k,xe),k=ne.hasEagerState?ne.eagerState:u(k,xe)}else se={lane:xe,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(z=q=se,O=k):q=q.next=se,ht.lanes|=xe,zi|=xe;ne=ne.next}while(ne!==null&&ne!==o);if(q===null?O=k:q.next=z,!es(k,i.memoizedState)&&(Ir=!0,ue&&(u=Ao,u!==null)))throw u;i.memoizedState=k,i.baseState=O,i.baseQueue=q,p.lastRenderedState=k}return y===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function vg(i){var o=Ar(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=i;var p=u.dispatch,y=u.pending,k=o.memoizedState;if(y!==null){u.pending=null;var O=y=y.next;do k=i(k,O.action),O=O.next;while(O!==y);es(k,o.memoizedState)||(Ir=!0),o.memoizedState=k,o.baseQueue===null&&(o.baseState=k),u.lastRenderedState=k}return[k,p]}function I_(i,o,u){var p=ht,y=Ar(),k=At;if(k){if(u===void 0)throw Error(n(407));u=u()}else u=o();var O=!es((Kt||y).memoizedState,u);if(O&&(y.memoizedState=u,Ir=!0),y=y.queue,jg(z_.bind(null,p,y,i),[i]),y.getSnapshot!==o||O||Rr!==null&&Rr.memoizedState.tag&1){if(p.flags|=2048,Ro(9,{destroy:void 0},L_.bind(null,p,y,u,o),null),tr===null)throw Error(n(349));k||(La&127)!==0||$_(p,o,u)}return u}function $_(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ht.updateQueue,o===null?(o=Rh(),ht.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function L_(i,o,u,p){o.value=u,o.getSnapshot=p,B_(o)&&U_(i)}function z_(i,o,u){return u(function(){B_(o)&&U_(i)})}function B_(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!es(i,u)}catch{return!0}}function U_(i){var o=gl(i,2);o!==null&&Vn(o,i,2)}function yg(i){var o=On();if(typeof i=="function"){var u=i;if(i=u(),Nl){ct(!0);try{u()}finally{ct(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:i},o}function q_(i,o,u,p){return i.baseState=u,bg(i,Kt,typeof p=="function"?p:za)}function h8(i,o,u,p,y){if(Bh(i))throw Error(n(485));if(i=o.action,i!==null){var k={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){k.listeners.push(O)}};L.T!==null?u(!0):k.isTransition=!1,p(k),u=o.pending,u===null?(k.next=o.pending=k,F_(o,k)):(k.next=u.next,o.pending=u.next=k)}}function F_(i,o){var u=o.action,p=o.payload,y=i.state;if(o.isTransition){var k=L.T,O={};L.T=O;try{var z=u(y,p),q=L.S;q!==null&&q(O,z),H_(i,o,z)}catch(ne){wg(i,o,ne)}finally{k!==null&&O.types!==null&&(k.types=O.types),L.T=k}}else try{k=u(y,p),H_(i,o,k)}catch(ne){wg(i,o,ne)}}function H_(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){V_(i,o,p)},function(p){return wg(i,o,p)}):V_(i,o,u)}function V_(i,o,u){o.status="fulfilled",o.value=u,W_(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,F_(i,u)))}function wg(i,o,u){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,W_(o),o=o.next;while(o!==p)}i.action=null}function W_(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function G_(i,o){return o}function K_(i,o){if(At){var u=tr.formState;if(u!==null){e:{var p=ht;if(At){if(ir){t:{for(var y=ir,k=As;y.nodeType!==8;){if(!k){y=null;break t}if(y=Os(y.nextSibling),y===null){y=null;break t}}k=y.data,y=k==="F!"||k==="F"?y:null}if(y){ir=Os(y.nextSibling),p=y.data==="F!";break e}}Ti(p)}p=!1}p&&(o=u[0])}}return u=On(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:G_,lastRenderedState:o},u.queue=p,u=fk.bind(null,ht,p),p.dispatch=u,p=yg(!1),k=Cg.bind(null,ht,!1,p.queue),p=On(),y={state:o,dispatch:null,action:i,pending:null},p.queue=y,u=h8.bind(null,ht,y,k,u),y.dispatch=u,p.memoizedState=i,[o,u,!1]}function Y_(i){var o=Ar();return X_(o,Kt,i)}function X_(i,o,u){if(o=bg(i,o,G_)[0],i=$h(za)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=bd(o)}catch(O){throw O===To?Ch:O}else p=o;o=Ar();var y=o.queue,k=y.dispatch;return u!==o.memoizedState&&(ht.flags|=2048,Ro(9,{destroy:void 0},f8.bind(null,y,u),null)),[p,k,i]}function f8(i,o){i.action=o}function J_(i){var o=Ar(),u=Kt;if(u!==null)return X_(o,u,i);Ar(),o=o.memoizedState,u=Ar();var p=u.queue.dispatch;return u.memoizedState=i,[o,p,!1]}function Ro(i,o,u,p){return i={tag:i,create:u,deps:p,inst:o,next:null},o=ht.updateQueue,o===null&&(o=Rh(),ht.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(p=u.next,u.next=i,i.next=p,o.lastEffect=i),i}function Q_(){return Ar().memoizedState}function Lh(i,o,u,p){var y=On();ht.flags|=i,y.memoizedState=Ro(1|o,{destroy:void 0},u,p===void 0?null:p)}function zh(i,o,u,p){var y=Ar();p=p===void 0?null:p;var k=y.memoizedState.inst;Kt!==null&&p!==null&&hg(p,Kt.memoizedState.deps)?y.memoizedState=Ro(o,k,u,p):(ht.flags|=i,y.memoizedState=Ro(1|o,k,u,p))}function Z_(i,o){Lh(8390656,8,i,o)}function jg(i,o){zh(2048,8,i,o)}function m8(i){ht.flags|=4;var o=ht.updateQueue;if(o===null)o=Rh(),ht.updateQueue=o,o.events=[i];else{var u=o.events;u===null?o.events=[i]:u.push(i)}}function ek(i){var o=Ar().memoizedState;return m8({ref:o,nextImpl:i}),function(){if(($t&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function tk(i,o){return zh(4,2,i,o)}function rk(i,o){return zh(4,4,i,o)}function nk(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function sk(i,o,u){u=u!=null?u.concat([i]):null,zh(4,4,nk.bind(null,o,i),u)}function _g(){}function ak(i,o){var u=Ar();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&hg(o,p[1])?p[0]:(u.memoizedState=[i,o],i)}function ik(i,o){var u=Ar();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&hg(o,p[1]))return p[0];if(p=i(),Nl){ct(!0);try{i()}finally{ct(!1)}}return u.memoizedState=[p,o],p}function kg(i,o,u){return u===void 0||(La&1073741824)!==0&&(kt&261930)===0?i.memoizedState=o:(i.memoizedState=u,i=lN(),ht.lanes|=i,zi|=i,u)}function lk(i,o,u,p){return es(u,o)?u:Po.current!==null?(i=kg(i,u,p),es(i,o)||(Ir=!0),i):(La&42)===0||(La&1073741824)!==0&&(kt&261930)===0?(Ir=!0,i.memoizedState=u):(i=lN(),ht.lanes|=i,zi|=i,o)}function ok(i,o,u,p,y){var k=U.p;U.p=k!==0&&8>k?k:8;var O=L.T,z={};L.T=z,Cg(i,!1,o,u);try{var q=y(),ne=L.S;if(ne!==null&&ne(z,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ue=c8(q,p);vd(i,o,ue,is(i))}else vd(i,o,p,is(i))}catch(xe){vd(i,o,{then:function(){},status:"rejected",reason:xe},is())}finally{U.p=k,O!==null&&z.types!==null&&(O.types=z.types),L.T=O}}function p8(){}function Ng(i,o,u,p){if(i.tag!==5)throw Error(n(476));var y=ck(i).queue;ok(i,y,o,W,u===null?p8:function(){return dk(i),u(p)})}function ck(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:W},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function dk(i){var o=ck(i);o.next===null&&(o=i.alternate.memoizedState),vd(i,o.next.queue,{},is())}function Sg(){return fn(Id)}function uk(){return Ar().memoizedState}function hk(){return Ar().memoizedState}function g8(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=is();i=Di(u);var p=Mi(o,i,u);p!==null&&(Vn(p,o,u),md(p,o,u)),o={cache:tg()},i.payload=o;return}o=o.return}}function x8(i,o,u){var p=is();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Bh(i)?mk(o,u):(u=Hp(i,o,u,p),u!==null&&(Vn(u,i,p),pk(u,o,p)))}function fk(i,o,u){var p=is();vd(i,o,u,p)}function vd(i,o,u,p){var y={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Bh(i))mk(o,y);else{var k=i.alternate;if(i.lanes===0&&(k===null||k.lanes===0)&&(k=o.lastRenderedReducer,k!==null))try{var O=o.lastRenderedState,z=k(O,u);if(y.hasEagerState=!0,y.eagerState=z,es(z,O))return yh(i,o,y,0),tr===null&&vh(),!1}catch{}finally{}if(u=Hp(i,o,y,p),u!==null)return Vn(u,i,p),pk(u,o,p),!0}return!1}function Cg(i,o,u,p){if(p={lane:2,revertLane:ax(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Bh(i)){if(o)throw Error(n(479))}else o=Hp(i,u,p,2),o!==null&&Vn(o,i,2)}function Bh(i){var o=i.alternate;return i===ht||o!==null&&o===ht}function mk(i,o){Do=Dh=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function pk(i,o,u){if((u&4194048)!==0){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,ur(i,u)}}var yd={readContext:fn,use:Ih,useCallback:jr,useContext:jr,useEffect:jr,useImperativeHandle:jr,useLayoutEffect:jr,useInsertionEffect:jr,useMemo:jr,useReducer:jr,useRef:jr,useState:jr,useDebugValue:jr,useDeferredValue:jr,useTransition:jr,useSyncExternalStore:jr,useId:jr,useHostTransitionStatus:jr,useFormState:jr,useActionState:jr,useOptimistic:jr,useMemoCache:jr,useCacheRefresh:jr};yd.useEffectEvent=jr;var gk={readContext:fn,use:Ih,useCallback:function(i,o){return On().memoizedState=[i,o===void 0?null:o],i},useContext:fn,useEffect:Z_,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,Lh(4194308,4,nk.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Lh(4194308,4,i,o)},useInsertionEffect:function(i,o){Lh(4,2,i,o)},useMemo:function(i,o){var u=On();o=o===void 0?null:o;var p=i();if(Nl){ct(!0);try{i()}finally{ct(!1)}}return u.memoizedState=[p,o],p},useReducer:function(i,o,u){var p=On();if(u!==void 0){var y=u(o);if(Nl){ct(!0);try{u(o)}finally{ct(!1)}}}else y=o;return p.memoizedState=p.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},p.queue=i,i=i.dispatch=x8.bind(null,ht,i),[p.memoizedState,i]},useRef:function(i){var o=On();return i={current:i},o.memoizedState=i},useState:function(i){i=yg(i);var o=i.queue,u=fk.bind(null,ht,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:_g,useDeferredValue:function(i,o){var u=On();return kg(u,i,o)},useTransition:function(){var i=yg(!1);return i=ok.bind(null,ht,i.queue,!0,!1),On().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var p=ht,y=On();if(At){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),tr===null)throw Error(n(349));(kt&127)!==0||$_(p,o,u)}y.memoizedState=u;var k={value:u,getSnapshot:o};return y.queue=k,Z_(z_.bind(null,p,k,i),[i]),p.flags|=2048,Ro(9,{destroy:void 0},L_.bind(null,p,k,u,o),null),u},useId:function(){var i=On(),o=tr.identifierPrefix;if(At){var u=fa,p=ha;u=(p&~(1<<32-dt(p)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Mh++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=d8++,o="_"+o+"r_"+u.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:Sg,useFormState:K_,useActionState:K_,useOptimistic:function(i){var o=On();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Cg.bind(null,ht,!0,u),u.dispatch=o,[i,o]},useMemoCache:xg,useCacheRefresh:function(){return On().memoizedState=g8.bind(null,ht)},useEffectEvent:function(i){var o=On(),u={impl:i};return o.memoizedState=u,function(){if(($t&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Eg={readContext:fn,use:Ih,useCallback:ak,useContext:fn,useEffect:jg,useImperativeHandle:sk,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:ik,useReducer:$h,useRef:Q_,useState:function(){return $h(za)},useDebugValue:_g,useDeferredValue:function(i,o){var u=Ar();return lk(u,Kt.memoizedState,i,o)},useTransition:function(){var i=$h(za)[0],o=Ar().memoizedState;return[typeof i=="boolean"?i:bd(i),o]},useSyncExternalStore:I_,useId:uk,useHostTransitionStatus:Sg,useFormState:Y_,useActionState:Y_,useOptimistic:function(i,o){var u=Ar();return q_(u,Kt,i,o)},useMemoCache:xg,useCacheRefresh:hk};Eg.useEffectEvent=ek;var xk={readContext:fn,use:Ih,useCallback:ak,useContext:fn,useEffect:jg,useImperativeHandle:sk,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:ik,useReducer:vg,useRef:Q_,useState:function(){return vg(za)},useDebugValue:_g,useDeferredValue:function(i,o){var u=Ar();return Kt===null?kg(u,i,o):lk(u,Kt.memoizedState,i,o)},useTransition:function(){var i=vg(za)[0],o=Ar().memoizedState;return[typeof i=="boolean"?i:bd(i),o]},useSyncExternalStore:I_,useId:uk,useHostTransitionStatus:Sg,useFormState:J_,useActionState:J_,useOptimistic:function(i,o){var u=Ar();return Kt!==null?q_(u,Kt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:xg,useCacheRefresh:hk};xk.useEffectEvent=ek;function Ag(i,o,u,p){o=i.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Tg={enqueueSetState:function(i,o,u){i=i._reactInternals;var p=is(),y=Di(p);y.payload=o,u!=null&&(y.callback=u),o=Mi(i,y,p),o!==null&&(Vn(o,i,p),md(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var p=is(),y=Di(p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Mi(i,y,p),o!==null&&(Vn(o,i,p),md(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=is(),p=Di(u);p.tag=2,o!=null&&(p.callback=o),o=Mi(i,p,u),o!==null&&(Vn(o,i,u),md(o,i,u))}};function bk(i,o,u,p,y,k,O){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,k,O):o.prototype&&o.prototype.isPureReactComponent?!id(u,p)||!id(y,k):!0}function vk(i,o,u,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==i&&Tg.enqueueReplaceState(o,o.state,null)}function Sl(i,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(i=i.defaultProps){u===o&&(u=g({},u));for(var y in i)u[y]===void 0&&(u[y]=i[y])}return u}function yk(i){bh(i)}function wk(i){console.error(i)}function jk(i){bh(i)}function Uh(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function _k(i,o,u){try{var p=i.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Og(i,o,u){return u=Di(u),u.tag=3,u.payload={element:null},u.callback=function(){Uh(i,o)},u}function kk(i){return i=Di(i),i.tag=3,i}function Nk(i,o,u,p){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var k=p.value;i.payload=function(){return y(k)},i.callback=function(){_k(o,u,p)}}var O=u.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(i.callback=function(){_k(o,u,p),typeof y!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var z=p.stack;this.componentDidCatch(p.value,{componentStack:z!==null?z:""})})}function b8(i,o,u,p,y){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Co(o,u,y,!0),u=rs.current,u!==null){switch(u.tag){case 31:case 13:return Ts===null?Zh():u.alternate===null&&_r===0&&(_r=3),u.flags&=-257,u.flags|=65536,u.lanes=y,p===Eh?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),rx(i,p,y)),!1;case 22:return u.flags|=65536,p===Eh?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),rx(i,p,y)),!1}throw Error(n(435,u.tag))}return rx(i,p,y),Zh(),!1}if(At)return o=rs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,p!==Xp&&(i=Error(n(422),{cause:p}),cd(Ss(i,u)))):(p!==Xp&&(o=Error(n(423),{cause:p}),cd(Ss(o,u))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,p=Ss(p,u),y=Og(i.stateNode,p,y),lg(i,y),_r!==4&&(_r=2)),!1;var k=Error(n(520),{cause:p});if(k=Ss(k,u),Ed===null?Ed=[k]:Ed.push(k),_r!==4&&(_r=2),o===null)return!0;p=Ss(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=y&-y,u.lanes|=i,i=Og(u.stateNode,p,i),lg(u,i),!1;case 1:if(o=u.type,k=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Bi===null||!Bi.has(k))))return u.flags|=65536,y&=-y,u.lanes|=y,y=kk(y),Nk(y,i,u,p),lg(u,y),!1}u=u.return}while(u!==null);return!1}var Pg=Error(n(461)),Ir=!1;function mn(i,o,u,p){o.child=i===null?A_(o,null,u,p):kl(o,i.child,u,p)}function Sk(i,o,u,p,y){u=u.render;var k=o.ref;if("ref"in p){var O={};for(var z in p)z!=="ref"&&(O[z]=p[z])}else O=p;return yl(o),p=fg(i,o,u,O,k,y),z=mg(),i!==null&&!Ir?(pg(i,o,y),Ba(i,o,y)):(At&&z&&Kp(o),o.flags|=1,mn(i,o,p,y),o.child)}function Ck(i,o,u,p,y){if(i===null){var k=u.type;return typeof k=="function"&&!Vp(k)&&k.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=k,Ek(i,o,k,p,y)):(i=jh(u.type,null,p,o,o.mode,y),i.ref=o.ref,i.return=o,o.child=i)}if(k=i.child,!Bg(i,y)){var O=k.memoizedProps;if(u=u.compare,u=u!==null?u:id,u(O,p)&&i.ref===o.ref)return Ba(i,o,y)}return o.flags|=1,i=Ma(k,p),i.ref=o.ref,i.return=o,o.child=i}function Ek(i,o,u,p,y){if(i!==null){var k=i.memoizedProps;if(id(k,p)&&i.ref===o.ref)if(Ir=!1,o.pendingProps=p=k,Bg(i,y))(i.flags&131072)!==0&&(Ir=!0);else return o.lanes=i.lanes,Ba(i,o,y)}return Dg(i,o,u,p,y)}function Ak(i,o,u,p){var y=p.children,k=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((o.flags&128)!==0){if(k=k!==null?k.baseLanes|u:u,i!==null){for(p=o.child=i.child,y=0;p!==null;)y=y|p.lanes|p.childLanes,p=p.sibling;p=y&~k}else p=0,o.child=null;return Tk(i,o,k,u,p)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Sh(o,k!==null?k.cachePool:null),k!==null?P_(o,k):cg(),D_(o);else return p=o.lanes=536870912,Tk(i,o,k!==null?k.baseLanes|u:u,u,p)}else k!==null?(Sh(o,k.cachePool),P_(o,k),Ii(),o.memoizedState=null):(i!==null&&Sh(o,null),cg(),Ii());return mn(i,o,y,u),o.child}function wd(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Tk(i,o,u,p,y){var k=ng();return k=k===null?null:{parent:Mr._currentValue,pool:k},o.memoizedState={baseLanes:u,cachePool:k},i!==null&&Sh(o,null),cg(),D_(o),i!==null&&Co(i,o,p,!0),o.childLanes=y,null}function qh(i,o){return o=Hh({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function Ok(i,o,u){return kl(o,i.child,null,u),i=qh(o,o.pendingProps),i.flags|=2,ns(o),o.memoizedState=null,i}function v8(i,o,u){var p=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(At){if(p.mode==="hidden")return i=qh(o,p),o.lanes=536870912,wd(null,i);if(ug(o),(i=ir)?(i=FN(i,As),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ei!==null?{id:ha,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},u=m_(i),u.return=o,o.child=u,hn=o,ir=null)):i=null,i===null)throw Ti(o);return o.lanes=536870912,null}return qh(o,p)}var k=i.memoizedState;if(k!==null){var O=k.dehydrated;if(ug(o),y)if(o.flags&256)o.flags&=-257,o=Ok(i,o,u);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(n(558));else if(Ir||Co(i,o,u,!1),y=(u&i.childLanes)!==0,Ir||y){if(p=tr,p!==null&&(O=Sr(p,u),O!==0&&O!==k.retryLane))throw k.retryLane=O,gl(i,O),Vn(p,i,O),Pg;Zh(),o=Ok(i,o,u)}else i=k.treeContext,ir=Os(O.nextSibling),hn=o,At=!0,Ai=null,As=!1,i!==null&&x_(o,i),o=qh(o,p),o.flags|=4096;return o}return i=Ma(i.child,{mode:p.mode,children:p.children}),i.ref=o.ref,o.child=i,i.return=o,i}function Fh(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function Dg(i,o,u,p,y){return yl(o),u=fg(i,o,u,p,void 0,y),p=mg(),i!==null&&!Ir?(pg(i,o,y),Ba(i,o,y)):(At&&p&&Kp(o),o.flags|=1,mn(i,o,u,y),o.child)}function Pk(i,o,u,p,y,k){return yl(o),o.updateQueue=null,u=R_(o,p,u,y),M_(i),p=mg(),i!==null&&!Ir?(pg(i,o,k),Ba(i,o,k)):(At&&p&&Kp(o),o.flags|=1,mn(i,o,u,k),o.child)}function Dk(i,o,u,p,y){if(yl(o),o.stateNode===null){var k=_o,O=u.contextType;typeof O=="object"&&O!==null&&(k=fn(O)),k=new u(p,k),o.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Tg,o.stateNode=k,k._reactInternals=o,k=o.stateNode,k.props=p,k.state=o.memoizedState,k.refs={},ag(o),O=u.contextType,k.context=typeof O=="object"&&O!==null?fn(O):_o,k.state=o.memoizedState,O=u.getDerivedStateFromProps,typeof O=="function"&&(Ag(o,u,O,p),k.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(O=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),O!==k.state&&Tg.enqueueReplaceState(k,k.state,null),gd(o,p,k,y),pd(),k.state=o.memoizedState),typeof k.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){k=o.stateNode;var z=o.memoizedProps,q=Sl(u,z);k.props=q;var ne=k.context,ue=u.contextType;O=_o,typeof ue=="object"&&ue!==null&&(O=fn(ue));var xe=u.getDerivedStateFromProps;ue=typeof xe=="function"||typeof k.getSnapshotBeforeUpdate=="function",z=o.pendingProps!==z,ue||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(z||ne!==O)&&vk(o,k,p,O),Pi=!1;var se=o.memoizedState;k.state=se,gd(o,p,k,y),pd(),ne=o.memoizedState,z||se!==ne||Pi?(typeof xe=="function"&&(Ag(o,u,xe,p),ne=o.memoizedState),(q=Pi||bk(o,u,q,p,se,ne,O))?(ue||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(o.flags|=4194308)):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=ne),k.props=p,k.state=ne,k.context=O,p=q):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{k=o.stateNode,ig(i,o),O=o.memoizedProps,ue=Sl(u,O),k.props=ue,xe=o.pendingProps,se=k.context,ne=u.contextType,q=_o,typeof ne=="object"&&ne!==null&&(q=fn(ne)),z=u.getDerivedStateFromProps,(ne=typeof z=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(O!==xe||se!==q)&&vk(o,k,p,q),Pi=!1,se=o.memoizedState,k.state=se,gd(o,p,k,y),pd();var oe=o.memoizedState;O!==xe||se!==oe||Pi||i!==null&&i.dependencies!==null&&kh(i.dependencies)?(typeof z=="function"&&(Ag(o,u,z,p),oe=o.memoizedState),(ue=Pi||bk(o,u,ue,p,se,oe,q)||i!==null&&i.dependencies!==null&&kh(i.dependencies))?(ne||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(p,oe,q),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(p,oe,q)),typeof k.componentDidUpdate=="function"&&(o.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof k.componentDidUpdate!="function"||O===i.memoizedProps&&se===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&se===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=oe),k.props=p,k.state=oe,k.context=q,p=ue):(typeof k.componentDidUpdate!="function"||O===i.memoizedProps&&se===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&se===i.memoizedState||(o.flags|=1024),p=!1)}return k=p,Fh(i,o),p=(o.flags&128)!==0,k||p?(k=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:k.render(),o.flags|=1,i!==null&&p?(o.child=kl(o,i.child,null,y),o.child=kl(o,null,u,y)):mn(i,o,u,y),o.memoizedState=k.state,i=o.child):i=Ba(i,o,y),i}function Mk(i,o,u,p){return bl(),o.flags|=256,mn(i,o,u,p),o.child}var Mg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rg(i){return{baseLanes:i,cachePool:__()}}function Ig(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=as),i}function Rk(i,o,u){var p=o.pendingProps,y=!1,k=(o.flags&128)!==0,O;if((O=k)||(O=i!==null&&i.memoizedState===null?!1:(Er.current&2)!==0),O&&(y=!0,o.flags&=-129),O=(o.flags&32)!==0,o.flags&=-33,i===null){if(At){if(y?Ri(o):Ii(),(i=ir)?(i=FN(i,As),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ei!==null?{id:ha,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},u=m_(i),u.return=o,o.child=u,hn=o,ir=null)):i=null,i===null)throw Ti(o);return bx(i)?o.lanes=32:o.lanes=536870912,null}var z=p.children;return p=p.fallback,y?(Ii(),y=o.mode,z=Hh({mode:"hidden",children:z},y),p=xl(p,y,u,null),z.return=o,p.return=o,z.sibling=p,o.child=z,p=o.child,p.memoizedState=Rg(u),p.childLanes=Ig(i,O,u),o.memoizedState=Mg,wd(null,p)):(Ri(o),$g(o,z))}var q=i.memoizedState;if(q!==null&&(z=q.dehydrated,z!==null)){if(k)o.flags&256?(Ri(o),o.flags&=-257,o=Lg(i,o,u)):o.memoizedState!==null?(Ii(),o.child=i.child,o.flags|=128,o=null):(Ii(),z=p.fallback,y=o.mode,p=Hh({mode:"visible",children:p.children},y),z=xl(z,y,u,null),z.flags|=2,p.return=o,z.return=o,p.sibling=z,o.child=p,kl(o,i.child,null,u),p=o.child,p.memoizedState=Rg(u),p.childLanes=Ig(i,O,u),o.memoizedState=Mg,o=wd(null,p));else if(Ri(o),bx(z)){if(O=z.nextSibling&&z.nextSibling.dataset,O)var ne=O.dgst;O=ne,p=Error(n(419)),p.stack="",p.digest=O,cd({value:p,source:null,stack:null}),o=Lg(i,o,u)}else if(Ir||Co(i,o,u,!1),O=(u&i.childLanes)!==0,Ir||O){if(O=tr,O!==null&&(p=Sr(O,u),p!==0&&p!==q.retryLane))throw q.retryLane=p,gl(i,p),Vn(O,i,p),Pg;xx(z)||Zh(),o=Lg(i,o,u)}else xx(z)?(o.flags|=192,o.child=i.child,o=null):(i=q.treeContext,ir=Os(z.nextSibling),hn=o,At=!0,Ai=null,As=!1,i!==null&&x_(o,i),o=$g(o,p.children),o.flags|=4096);return o}return y?(Ii(),z=p.fallback,y=o.mode,q=i.child,ne=q.sibling,p=Ma(q,{mode:"hidden",children:p.children}),p.subtreeFlags=q.subtreeFlags&65011712,ne!==null?z=Ma(ne,z):(z=xl(z,y,u,null),z.flags|=2),z.return=o,p.return=o,p.sibling=z,o.child=p,wd(null,p),p=o.child,z=i.child.memoizedState,z===null?z=Rg(u):(y=z.cachePool,y!==null?(q=Mr._currentValue,y=y.parent!==q?{parent:q,pool:q}:y):y=__(),z={baseLanes:z.baseLanes|u,cachePool:y}),p.memoizedState=z,p.childLanes=Ig(i,O,u),o.memoizedState=Mg,wd(i.child,p)):(Ri(o),u=i.child,i=u.sibling,u=Ma(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,i!==null&&(O=o.deletions,O===null?(o.deletions=[i],o.flags|=16):O.push(i)),o.child=u,o.memoizedState=null,u)}function $g(i,o){return o=Hh({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Hh(i,o){return i=ts(22,i,null,o),i.lanes=0,i}function Lg(i,o,u){return kl(o,i.child,null,u),i=$g(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Ik(i,o,u){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),Zp(i.return,o,u)}function zg(i,o,u,p,y,k){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:y,treeForkCount:k}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=p,O.tail=u,O.tailMode=y,O.treeForkCount=k)}function $k(i,o,u){var p=o.pendingProps,y=p.revealOrder,k=p.tail;p=p.children;var O=Er.current,z=(O&2)!==0;if(z?(O=O&1|2,o.flags|=128):O&=1,ie(Er,O),mn(i,o,p,u),p=At?od:0,!z&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ik(i,u,o);else if(i.tag===19)Ik(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)i=u.alternate,i!==null&&Ph(i)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),zg(o,!1,y,u,k,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(i=y.alternate,i!==null&&Ph(i)===null){o.child=y;break}i=y.sibling,y.sibling=u,u=y,y=i}zg(o,!0,u,null,k,p);break;case"together":zg(o,!1,null,null,void 0,p);break;default:o.memoizedState=null}return o.child}function Ba(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),zi|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(Co(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,u=Ma(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Ma(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function Bg(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&kh(i)))}function y8(i,o,u){switch(o.tag){case 3:ye(o,o.stateNode.containerInfo),Oi(o,Mr,i.memoizedState.cache),bl();break;case 27:case 5:ke(o);break;case 4:ye(o,o.stateNode.containerInfo);break;case 10:Oi(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,ug(o),null;break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(Ri(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Rk(i,o,u):(Ri(o),i=Ba(i,o,u),i!==null?i.sibling:null);Ri(o);break;case 19:var y=(i.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Co(i,o,u,!1),p=(u&o.childLanes)!==0),y){if(p)return $k(i,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ie(Er,Er.current),p)break;return null;case 22:return o.lanes=0,Ak(i,o,u,o.pendingProps);case 24:Oi(o,Mr,i.memoizedState.cache)}return Ba(i,o,u)}function Lk(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)Ir=!0;else{if(!Bg(i,u)&&(o.flags&128)===0)return Ir=!1,y8(i,o,u);Ir=(i.flags&131072)!==0}else Ir=!1,At&&(o.flags&1048576)!==0&&g_(o,od,o.index);switch(o.lanes=0,o.tag){case 16:e:{var p=o.pendingProps;if(i=jl(o.elementType),o.type=i,typeof i=="function")Vp(i)?(p=Sl(i,p),o.tag=1,o=Dk(null,o,i,p,u)):(o.tag=0,o=Dg(null,o,i,p,u));else{if(i!=null){var y=i.$$typeof;if(y===E){o.tag=11,o=Sk(null,o,i,p,u);break e}else if(y===D){o.tag=14,o=Ck(null,o,i,p,u);break e}}throw o=V(i)||i,Error(n(306,o,""))}}return o;case 0:return Dg(i,o,o.type,o.pendingProps,u);case 1:return p=o.type,y=Sl(p,o.pendingProps),Dk(i,o,p,y,u);case 3:e:{if(ye(o,o.stateNode.containerInfo),i===null)throw Error(n(387));p=o.pendingProps;var k=o.memoizedState;y=k.element,ig(i,o),gd(o,p,null,u);var O=o.memoizedState;if(p=O.cache,Oi(o,Mr,p),p!==k.cache&&eg(o,[Mr],u,!0),pd(),p=O.element,k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:O.cache},o.updateQueue.baseState=k,o.memoizedState=k,o.flags&256){o=Mk(i,o,p,u);break e}else if(p!==y){y=Ss(Error(n(424)),o),cd(y),o=Mk(i,o,p,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ir=Os(i.firstChild),hn=o,At=!0,Ai=null,As=!0,u=A_(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(bl(),p===y){o=Ba(i,o,u);break e}mn(i,o,p,u)}o=o.child}return o;case 26:return Fh(i,o),i===null?(u=YN(o.type,null,o.pendingProps,null))?o.memoizedState=u:At||(u=o.type,i=o.pendingProps,p=lf(Ee.current).createElement(u),p[Se]=o,p[be]=i,pn(p,u,i),Cr(p),o.stateNode=p):o.memoizedState=YN(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return ke(o),i===null&&At&&(p=o.stateNode=WN(o.type,o.pendingProps,Ee.current),hn=o,As=!0,y=ir,Hi(o.type)?(vx=y,ir=Os(p.firstChild)):ir=y),mn(i,o,o.pendingProps.children,u),Fh(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&At&&((y=p=ir)&&(p=X8(p,o.type,o.pendingProps,As),p!==null?(o.stateNode=p,hn=o,ir=Os(p.firstChild),As=!1,y=!0):y=!1),y||Ti(o)),ke(o),y=o.type,k=o.pendingProps,O=i!==null?i.memoizedProps:null,p=k.children,mx(y,k)?p=null:O!==null&&mx(y,O)&&(o.flags|=32),o.memoizedState!==null&&(y=fg(i,o,u8,null,null,u),Id._currentValue=y),Fh(i,o),mn(i,o,p,u),o.child;case 6:return i===null&&At&&((i=u=ir)&&(u=J8(u,o.pendingProps,As),u!==null?(o.stateNode=u,hn=o,ir=null,i=!0):i=!1),i||Ti(o)),null;case 13:return Rk(i,o,u);case 4:return ye(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=kl(o,null,p,u):mn(i,o,p,u),o.child;case 11:return Sk(i,o,o.type,o.pendingProps,u);case 7:return mn(i,o,o.pendingProps,u),o.child;case 8:return mn(i,o,o.pendingProps.children,u),o.child;case 12:return mn(i,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,Oi(o,o.type,p.value),mn(i,o,p.children,u),o.child;case 9:return y=o.type._context,p=o.pendingProps.children,yl(o),y=fn(y),p=p(y),o.flags|=1,mn(i,o,p,u),o.child;case 14:return Ck(i,o,o.type,o.pendingProps,u);case 15:return Ek(i,o,o.type,o.pendingProps,u);case 19:return $k(i,o,u);case 31:return v8(i,o,u);case 22:return Ak(i,o,u,o.pendingProps);case 24:return yl(o),p=fn(Mr),i===null?(y=ng(),y===null&&(y=tr,k=tg(),y.pooledCache=k,k.refCount++,k!==null&&(y.pooledCacheLanes|=u),y=k),o.memoizedState={parent:p,cache:y},ag(o),Oi(o,Mr,y)):((i.lanes&u)!==0&&(ig(i,o),gd(o,null,null,u),pd()),y=i.memoizedState,k=o.memoizedState,y.parent!==p?(y={parent:p,cache:p},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Oi(o,Mr,p)):(p=k.cache,Oi(o,Mr,p),p!==y.cache&&eg(o,[Mr],u,!0))),mn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ua(i){i.flags|=4}function Ug(i,o,u,p,y){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(uN())i.flags|=8192;else throw _l=Eh,sg}else i.flags&=-16777217}function zk(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!e2(o))if(uN())i.flags|=8192;else throw _l=Eh,sg}function Vh(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?et():536870912,i.lanes|=o,zo|=o)}function jd(i,o){if(!At)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function lr(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,p=0;if(o)for(var y=i.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=p,i.childLanes=u,o}function w8(i,o,u){var p=o.pendingProps;switch(Yp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(o),null;case 1:return lr(o),null;case 3:return u=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),$a(Mr),ee(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(So(o)?Ua(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Jp())),lr(o),null;case 26:var y=o.type,k=o.memoizedState;return i===null?(Ua(o),k!==null?(lr(o),zk(o,k)):(lr(o),Ug(o,y,null,p,u))):k?k!==i.memoizedState?(Ua(o),lr(o),zk(o,k)):(lr(o),o.flags&=-16777217):(i=i.memoizedProps,i!==p&&Ua(o),lr(o),Ug(o,y,i,p,u)),null;case 27:if(Te(o),u=Ee.current,y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(!p){if(o.stateNode===null)throw Error(n(166));return lr(o),null}i=he.current,So(o)?b_(o):(i=WN(y,p,u),o.stateNode=i,Ua(o))}return lr(o),null;case 5:if(Te(o),y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(!p){if(o.stateNode===null)throw Error(n(166));return lr(o),null}if(k=he.current,So(o))b_(o);else{var O=lf(Ee.current);switch(k){case 1:k=O.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:k=O.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":k=O.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":k=O.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":k=O.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof p.is=="string"?O.createElement("select",{is:p.is}):O.createElement("select"),p.multiple?k.multiple=!0:p.size&&(k.size=p.size);break;default:k=typeof p.is=="string"?O.createElement(y,{is:p.is}):O.createElement(y)}}k[Se]=o,k[be]=p;e:for(O=o.child;O!==null;){if(O.tag===5||O.tag===6)k.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===o)break e;for(;O.sibling===null;){if(O.return===null||O.return===o)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}o.stateNode=k;e:switch(pn(k,y,p),y){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Ua(o)}}return lr(o),Ug(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,u),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&Ua(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(n(166));if(i=Ee.current,So(o)){if(i=o.stateNode,u=o.memoizedProps,p=null,y=hn,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}i[Se]=o,i=!!(i.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||RN(i.nodeValue,u)),i||Ti(o,!0)}else i=lf(i).createTextNode(p),i[Se]=o,o.stateNode=i}return lr(o),null;case 31:if(u=o.memoizedState,i===null||i.memoizedState!==null){if(p=So(o),u!==null){if(i===null){if(!p)throw Error(n(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Se]=o}else bl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;lr(o),i=!1}else u=Jp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return o.flags&256?(ns(o),o):(ns(o),null);if((o.flags&128)!==0)throw Error(n(558))}return lr(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=So(o),p!==null&&p.dehydrated!==null){if(i===null){if(!y)throw Error(n(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Se]=o}else bl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;lr(o),y=!1}else y=Jp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(ns(o),o):(ns(o),null)}return ns(o),(o.flags&128)!==0?(o.lanes=u,o):(u=p!==null,i=i!==null&&i.memoizedState!==null,u&&(p=o.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool),k=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(k=p.memoizedState.cachePool.pool),k!==y&&(p.flags|=2048)),u!==i&&u&&(o.child.flags|=8192),Vh(o,o.updateQueue),lr(o),null);case 4:return ee(),i===null&&cx(o.stateNode.containerInfo),lr(o),null;case 10:return $a(o.type),lr(o),null;case 19:if(G(Er),p=o.memoizedState,p===null)return lr(o),null;if(y=(o.flags&128)!==0,k=p.rendering,k===null)if(y)jd(p,!1);else{if(_r!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(k=Ph(i),k!==null){for(o.flags|=128,jd(p,!1),i=k.updateQueue,o.updateQueue=i,Vh(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)f_(u,i),u=u.sibling;return ie(Er,Er.current&1|2),At&&Ra(o,p.treeForkCount),o.child}i=i.sibling}p.tail!==null&&rt()>Xh&&(o.flags|=128,y=!0,jd(p,!1),o.lanes=4194304)}else{if(!y)if(i=Ph(k),i!==null){if(o.flags|=128,y=!0,i=i.updateQueue,o.updateQueue=i,Vh(o,i),jd(p,!0),p.tail===null&&p.tailMode==="hidden"&&!k.alternate&&!At)return lr(o),null}else 2*rt()-p.renderingStartTime>Xh&&u!==536870912&&(o.flags|=128,y=!0,jd(p,!1),o.lanes=4194304);p.isBackwards?(k.sibling=o.child,o.child=k):(i=p.last,i!==null?i.sibling=k:o.child=k,p.last=k)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=rt(),i.sibling=null,u=Er.current,ie(Er,y?u&1|2:u&1),At&&Ra(o,p.treeForkCount),i):(lr(o),null);case 22:case 23:return ns(o),dg(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(lr(o),o.subtreeFlags&6&&(o.flags|=8192)):lr(o),u=o.updateQueue,u!==null&&Vh(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),i!==null&&G(wl),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),$a(Mr),lr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function j8(i,o){switch(Yp(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return $a(Mr),ee(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Te(o),null;case 31:if(o.memoizedState!==null){if(ns(o),o.alternate===null)throw Error(n(340));bl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(ns(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));bl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return G(Er),null;case 4:return ee(),null;case 10:return $a(o.type),null;case 22:case 23:return ns(o),dg(),i!==null&&G(wl),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return $a(Mr),null;case 25:return null;default:return null}}function Bk(i,o){switch(Yp(o),o.tag){case 3:$a(Mr),ee();break;case 26:case 27:case 5:Te(o);break;case 4:ee();break;case 31:o.memoizedState!==null&&ns(o);break;case 13:ns(o);break;case 19:G(Er);break;case 10:$a(o.type);break;case 22:case 23:ns(o),dg(),i!==null&&G(wl);break;case 24:$a(Mr)}}function _d(i,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&i)===i){p=void 0;var k=u.create,O=u.inst;p=k(),O.destroy=p}u=u.next}while(u!==y)}}catch(z){Ft(o,o.return,z)}}function $i(i,o,u){try{var p=o.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var k=y.next;p=k;do{if((p.tag&i)===i){var O=p.inst,z=O.destroy;if(z!==void 0){O.destroy=void 0,y=o;var q=u,ne=z;try{ne()}catch(ue){Ft(y,q,ue)}}}p=p.next}while(p!==k)}}catch(ue){Ft(o,o.return,ue)}}function Uk(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{O_(o,u)}catch(p){Ft(i,i.return,p)}}}function qk(i,o,u){u.props=Sl(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(p){Ft(i,o,p)}}function kd(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof u=="function"?i.refCleanup=u(p):u.current=p}}catch(y){Ft(i,o,y)}}function ma(i,o){var u=i.ref,p=i.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(y){Ft(i,o,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Ft(i,o,y)}else u.current=null}function Fk(i){var o=i.type,u=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(y){Ft(i,i.return,y)}}function qg(i,o,u){try{var p=i.stateNode;H8(p,i.type,u,o),p[be]=o}catch(y){Ft(i,i.return,y)}}function Hk(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Hi(i.type)||i.tag===4}function Fg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Hk(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Hi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Hg(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Pa));else if(p!==4&&(p===27&&Hi(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(Hg(i,o,u),i=i.sibling;i!==null;)Hg(i,o,u),i=i.sibling}function Wh(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(p!==4&&(p===27&&Hi(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Wh(i,o,u),i=i.sibling;i!==null;)Wh(i,o,u),i=i.sibling}function Vk(i){var o=i.stateNode,u=i.memoizedProps;try{for(var p=i.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);pn(o,p,u),o[Se]=i,o[be]=u}catch(k){Ft(i,i.return,k)}}var qa=!1,$r=!1,Vg=!1,Wk=typeof WeakSet=="function"?WeakSet:Set,en=null;function _8(i,o){if(i=i.containerInfo,hx=mf,i=s_(i),Lp(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var y=p.anchorOffset,k=p.focusNode;p=p.focusOffset;try{u.nodeType,k.nodeType}catch{u=null;break e}var O=0,z=-1,q=-1,ne=0,ue=0,xe=i,se=null;t:for(;;){for(var oe;xe!==u||y!==0&&xe.nodeType!==3||(z=O+y),xe!==k||p!==0&&xe.nodeType!==3||(q=O+p),xe.nodeType===3&&(O+=xe.nodeValue.length),(oe=xe.firstChild)!==null;)se=xe,xe=oe;for(;;){if(xe===i)break t;if(se===u&&++ne===y&&(z=O),se===k&&++ue===p&&(q=O),(oe=xe.nextSibling)!==null)break;xe=se,se=xe.parentNode}xe=oe}u=z===-1||q===-1?null:{start:z,end:q}}else u=null}u=u||{start:0,end:0}}else u=null;for(fx={focusedElem:i,selectionRange:u},mf=!1,en=o;en!==null;)if(o=en,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,en=i;else for(;en!==null;){switch(o=en,k=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)y=i[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&k!==null){i=void 0,u=o,y=k.memoizedProps,k=k.memoizedState,p=u.stateNode;try{var Ue=Sl(u.type,y);i=p.getSnapshotBeforeUpdate(Ue,k),p.__reactInternalSnapshotBeforeUpdate=i}catch(Je){Ft(u,u.return,Je)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)gx(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":gx(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=o.sibling,i!==null){i.return=o.return,en=i;break}en=o.return}}function Gk(i,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Ha(i,u),p&4&&_d(5,u);break;case 1:if(Ha(i,u),p&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(O){Ft(u,u.return,O)}else{var y=Sl(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(y,o,i.__reactInternalSnapshotBeforeUpdate)}catch(O){Ft(u,u.return,O)}}p&64&&Uk(u),p&512&&kd(u,u.return);break;case 3:if(Ha(i,u),p&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{O_(i,o)}catch(O){Ft(u,u.return,O)}}break;case 27:o===null&&p&4&&Vk(u);case 26:case 5:Ha(i,u),o===null&&p&4&&Fk(u),p&512&&kd(u,u.return);break;case 12:Ha(i,u);break;case 31:Ha(i,u),p&4&&Xk(i,u);break;case 13:Ha(i,u),p&4&&Jk(i,u),p&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=P8.bind(null,u),Q8(i,u))));break;case 22:if(p=u.memoizedState!==null||qa,!p){o=o!==null&&o.memoizedState!==null||$r,y=qa;var k=$r;qa=p,($r=o)&&!k?Va(i,u,(u.subtreeFlags&8772)!==0):Ha(i,u),qa=y,$r=k}break;case 30:break;default:Ha(i,u)}}function Kk(i){var o=i.alternate;o!==null&&(i.alternate=null,Kk(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&zn(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var fr=null,Un=!1;function Fa(i,o,u){for(u=u.child;u!==null;)Yk(i,o,u),u=u.sibling}function Yk(i,o,u){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(mt,u)}catch{}switch(u.tag){case 26:$r||ma(u,o),Fa(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:$r||ma(u,o);var p=fr,y=Un;Hi(u.type)&&(fr=u.stateNode,Un=!1),Fa(i,o,u),Dd(u.stateNode),fr=p,Un=y;break;case 5:$r||ma(u,o);case 6:if(p=fr,y=Un,fr=null,Fa(i,o,u),fr=p,Un=y,fr!==null)if(Un)try{(fr.nodeType===9?fr.body:fr.nodeName==="HTML"?fr.ownerDocument.body:fr).removeChild(u.stateNode)}catch(k){Ft(u,o,k)}else try{fr.removeChild(u.stateNode)}catch(k){Ft(u,o,k)}break;case 18:fr!==null&&(Un?(i=fr,UN(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Go(i)):UN(fr,u.stateNode));break;case 4:p=fr,y=Un,fr=u.stateNode.containerInfo,Un=!0,Fa(i,o,u),fr=p,Un=y;break;case 0:case 11:case 14:case 15:$i(2,u,o),$r||$i(4,u,o),Fa(i,o,u);break;case 1:$r||(ma(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&qk(u,o,p)),Fa(i,o,u);break;case 21:Fa(i,o,u);break;case 22:$r=(p=$r)||u.memoizedState!==null,Fa(i,o,u),$r=p;break;default:Fa(i,o,u)}}function Xk(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Go(i)}catch(u){Ft(o,o.return,u)}}}function Jk(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Go(i)}catch(u){Ft(o,o.return,u)}}function k8(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Wk),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Wk),o;default:throw Error(n(435,i.tag))}}function Gh(i,o){var u=k8(i);o.forEach(function(p){if(!u.has(p)){u.add(p);var y=D8.bind(null,i,p);p.then(y,y)}})}function qn(i,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var y=u[p],k=i,O=o,z=O;e:for(;z!==null;){switch(z.tag){case 27:if(Hi(z.type)){fr=z.stateNode,Un=!1;break e}break;case 5:fr=z.stateNode,Un=!1;break e;case 3:case 4:fr=z.stateNode.containerInfo,Un=!0;break e}z=z.return}if(fr===null)throw Error(n(160));Yk(k,O,y),fr=null,Un=!1,k=y.alternate,k!==null&&(k.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Qk(o,i),o=o.sibling}var Vs=null;function Qk(i,o){var u=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:qn(o,i),Fn(i),p&4&&($i(3,i,i.return),_d(3,i),$i(5,i,i.return));break;case 1:qn(o,i),Fn(i),p&512&&($r||u===null||ma(u,u.return)),p&64&&qa&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var y=Vs;if(qn(o,i),Fn(i),p&512&&($r||u===null||ma(u,u.return)),p&4){var k=u!==null?u.memoizedState:null;if(p=i.memoizedState,u===null)if(p===null)if(i.stateNode===null){e:{p=i.type,u=i.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":k=y.getElementsByTagName("title")[0],(!k||k[js]||k[Se]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=y.createElement(p),y.head.insertBefore(k,y.querySelector("head > title"))),pn(k,p,u),k[Se]=i,Cr(k),p=k;break e;case"link":var O=QN("link","href",y).get(p+(u.href||""));if(O){for(var z=0;z<O.length;z++)if(k=O[z],k.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&k.getAttribute("rel")===(u.rel==null?null:u.rel)&&k.getAttribute("title")===(u.title==null?null:u.title)&&k.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){O.splice(z,1);break t}}k=y.createElement(p),pn(k,p,u),y.head.appendChild(k);break;case"meta":if(O=QN("meta","content",y).get(p+(u.content||""))){for(z=0;z<O.length;z++)if(k=O[z],k.getAttribute("content")===(u.content==null?null:""+u.content)&&k.getAttribute("name")===(u.name==null?null:u.name)&&k.getAttribute("property")===(u.property==null?null:u.property)&&k.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&k.getAttribute("charset")===(u.charSet==null?null:u.charSet)){O.splice(z,1);break t}}k=y.createElement(p),pn(k,p,u),y.head.appendChild(k);break;default:throw Error(n(468,p))}k[Se]=i,Cr(k),p=k}i.stateNode=p}else ZN(y,i.type,i.stateNode);else i.stateNode=JN(y,p,i.memoizedProps);else k!==p?(k===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):k.count--,p===null?ZN(y,i.type,i.stateNode):JN(y,p,i.memoizedProps)):p===null&&i.stateNode!==null&&qg(i,i.memoizedProps,u.memoizedProps)}break;case 27:qn(o,i),Fn(i),p&512&&($r||u===null||ma(u,u.return)),u!==null&&p&4&&qg(i,i.memoizedProps,u.memoizedProps);break;case 5:if(qn(o,i),Fn(i),p&512&&($r||u===null||ma(u,u.return)),i.flags&32){y=i.stateNode;try{go(y,"")}catch(Ue){Ft(i,i.return,Ue)}}p&4&&i.stateNode!=null&&(y=i.memoizedProps,qg(i,y,u!==null?u.memoizedProps:y)),p&1024&&(Vg=!0);break;case 6:if(qn(o,i),Fn(i),p&4){if(i.stateNode===null)throw Error(n(162));p=i.memoizedProps,u=i.stateNode;try{u.nodeValue=p}catch(Ue){Ft(i,i.return,Ue)}}break;case 3:if(df=null,y=Vs,Vs=of(o.containerInfo),qn(o,i),Vs=y,Fn(i),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Go(o.containerInfo)}catch(Ue){Ft(i,i.return,Ue)}Vg&&(Vg=!1,Zk(i));break;case 4:p=Vs,Vs=of(i.stateNode.containerInfo),qn(o,i),Fn(i),Vs=p;break;case 12:qn(o,i),Fn(i);break;case 31:qn(o,i),Fn(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Gh(i,p)));break;case 13:qn(o,i),Fn(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Yh=rt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Gh(i,p)));break;case 22:y=i.memoizedState!==null;var q=u!==null&&u.memoizedState!==null,ne=qa,ue=$r;if(qa=ne||y,$r=ue||q,qn(o,i),$r=ue,qa=ne,Fn(i),p&8192)e:for(o=i.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||q||qa||$r||Cl(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){q=u=o;try{if(k=q.stateNode,y)O=k.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{z=q.stateNode;var xe=q.memoizedProps.style,se=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;z.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Ue){Ft(q,q.return,Ue)}}}else if(o.tag===6){if(u===null){q=o;try{q.stateNode.nodeValue=y?"":q.memoizedProps}catch(Ue){Ft(q,q.return,Ue)}}}else if(o.tag===18){if(u===null){q=o;try{var oe=q.stateNode;y?qN(oe,!0):qN(q.stateNode,!1)}catch(Ue){Ft(q,q.return,Ue)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,Gh(i,u))));break;case 19:qn(o,i),Fn(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Gh(i,p)));break;case 30:break;case 21:break;default:qn(o,i),Fn(i)}}function Fn(i){var o=i.flags;if(o&2){try{for(var u,p=i.return;p!==null;){if(Hk(p)){u=p;break}p=p.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,k=Fg(i);Wh(i,k,y);break;case 5:var O=u.stateNode;u.flags&32&&(go(O,""),u.flags&=-33);var z=Fg(i);Wh(i,z,O);break;case 3:case 4:var q=u.stateNode.containerInfo,ne=Fg(i);Hg(i,ne,q);break;default:throw Error(n(161))}}catch(ue){Ft(i,i.return,ue)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function Zk(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;Zk(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Ha(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Gk(i,o.alternate,o),o=o.sibling}function Cl(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:$i(4,o,o.return),Cl(o);break;case 1:ma(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&qk(o,o.return,u),Cl(o);break;case 27:Dd(o.stateNode);case 26:case 5:ma(o,o.return),Cl(o);break;case 22:o.memoizedState===null&&Cl(o);break;case 30:Cl(o);break;default:Cl(o)}i=i.sibling}}function Va(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,y=i,k=o,O=k.flags;switch(k.tag){case 0:case 11:case 15:Va(y,k,u),_d(4,k);break;case 1:if(Va(y,k,u),p=k,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ne){Ft(p,p.return,ne)}if(p=k,y=p.updateQueue,y!==null){var z=p.stateNode;try{var q=y.shared.hiddenCallbacks;if(q!==null)for(y.shared.hiddenCallbacks=null,y=0;y<q.length;y++)T_(q[y],z)}catch(ne){Ft(p,p.return,ne)}}u&&O&64&&Uk(k),kd(k,k.return);break;case 27:Vk(k);case 26:case 5:Va(y,k,u),u&&p===null&&O&4&&Fk(k),kd(k,k.return);break;case 12:Va(y,k,u);break;case 31:Va(y,k,u),u&&O&4&&Xk(y,k);break;case 13:Va(y,k,u),u&&O&4&&Jk(y,k);break;case 22:k.memoizedState===null&&Va(y,k,u),kd(k,k.return);break;case 30:break;default:Va(y,k,u)}o=o.sibling}}function Wg(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&dd(u))}function Gg(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&dd(i))}function Ws(i,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)eN(i,o,u,p),o=o.sibling}function eN(i,o,u,p){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Ws(i,o,u,p),y&2048&&_d(9,o);break;case 1:Ws(i,o,u,p);break;case 3:Ws(i,o,u,p),y&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&dd(i)));break;case 12:if(y&2048){Ws(i,o,u,p),i=o.stateNode;try{var k=o.memoizedProps,O=k.id,z=k.onPostCommit;typeof z=="function"&&z(O,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(q){Ft(o,o.return,q)}}else Ws(i,o,u,p);break;case 31:Ws(i,o,u,p);break;case 13:Ws(i,o,u,p);break;case 23:break;case 22:k=o.stateNode,O=o.alternate,o.memoizedState!==null?k._visibility&2?Ws(i,o,u,p):Nd(i,o):k._visibility&2?Ws(i,o,u,p):(k._visibility|=2,Io(i,o,u,p,(o.subtreeFlags&10256)!==0||!1)),y&2048&&Wg(O,o);break;case 24:Ws(i,o,u,p),y&2048&&Gg(o.alternate,o);break;default:Ws(i,o,u,p)}}function Io(i,o,u,p,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var k=i,O=o,z=u,q=p,ne=O.flags;switch(O.tag){case 0:case 11:case 15:Io(k,O,z,q,y),_d(8,O);break;case 23:break;case 22:var ue=O.stateNode;O.memoizedState!==null?ue._visibility&2?Io(k,O,z,q,y):Nd(k,O):(ue._visibility|=2,Io(k,O,z,q,y)),y&&ne&2048&&Wg(O.alternate,O);break;case 24:Io(k,O,z,q,y),y&&ne&2048&&Gg(O.alternate,O);break;default:Io(k,O,z,q,y)}o=o.sibling}}function Nd(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,p=o,y=p.flags;switch(p.tag){case 22:Nd(u,p),y&2048&&Wg(p.alternate,p);break;case 24:Nd(u,p),y&2048&&Gg(p.alternate,p);break;default:Nd(u,p)}o=o.sibling}}var Sd=8192;function $o(i,o,u){if(i.subtreeFlags&Sd)for(i=i.child;i!==null;)tN(i,o,u),i=i.sibling}function tN(i,o,u){switch(i.tag){case 26:$o(i,o,u),i.flags&Sd&&i.memoizedState!==null&&dI(u,Vs,i.memoizedState,i.memoizedProps);break;case 5:$o(i,o,u);break;case 3:case 4:var p=Vs;Vs=of(i.stateNode.containerInfo),$o(i,o,u),Vs=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Sd,Sd=16777216,$o(i,o,u),Sd=p):$o(i,o,u));break;default:$o(i,o,u)}}function rN(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Cd(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];en=p,sN(p,i)}rN(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)nN(i),i=i.sibling}function nN(i){switch(i.tag){case 0:case 11:case 15:Cd(i),i.flags&2048&&$i(9,i,i.return);break;case 3:Cd(i);break;case 12:Cd(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Kh(i)):Cd(i);break;default:Cd(i)}}function Kh(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];en=p,sN(p,i)}rN(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:$i(8,o,o.return),Kh(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Kh(o));break;default:Kh(o)}i=i.sibling}}function sN(i,o){for(;en!==null;){var u=en;switch(u.tag){case 0:case 11:case 15:$i(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:dd(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,en=p;else e:for(u=i;en!==null;){p=en;var y=p.sibling,k=p.return;if(Kk(p),p===u){en=null;break e}if(y!==null){y.return=k,en=y;break e}en=k}}}var N8={getCacheForType:function(i){var o=fn(Mr),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u},cacheSignal:function(){return fn(Mr).controller.signal}},S8=typeof WeakMap=="function"?WeakMap:Map,$t=0,tr=null,jt=null,kt=0,qt=0,ss=null,Li=!1,Lo=!1,Kg=!1,Wa=0,_r=0,zi=0,El=0,Yg=0,as=0,zo=0,Ed=null,Hn=null,Xg=!1,Yh=0,aN=0,Xh=1/0,Jh=null,Bi=null,Hr=0,Ui=null,Bo=null,Ga=0,Jg=0,Qg=null,iN=null,Ad=0,Zg=null;function is(){return($t&2)!==0&&kt!==0?kt&-kt:L.T!==null?ax():Gt()}function lN(){if(as===0)if((kt&536870912)===0||At){var i=tt;tt<<=1,(tt&3932160)===0&&(tt=262144),as=i}else as=536870912;return i=rs.current,i!==null&&(i.flags|=32),as}function Vn(i,o,u){(i===tr&&(qt===2||qt===9)||i.cancelPendingCommit!==null)&&(Uo(i,0),qi(i,kt,as,!1)),Ot(i,u),(($t&2)===0||i!==tr)&&(i===tr&&(($t&2)===0&&(El|=u),_r===4&&qi(i,kt,as,!1)),pa(i))}function oN(i,o,u){if(($t&6)!==0)throw Error(n(327));var p=!u&&(o&127)===0&&(o&i.expiredLanes)===0||Pe(i,o),y=p?A8(i,o):tx(i,o,!0),k=p;do{if(y===0){Lo&&!p&&qi(i,o,0,!1);break}else{if(u=i.current.alternate,k&&!C8(u)){y=tx(i,o,!1),k=!1;continue}if(y===2){if(k=o,i.errorRecoveryDisabledLanes&k)var O=0;else O=i.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){o=O;e:{var z=i;y=Ed;var q=z.current.memoizedState.isDehydrated;if(q&&(Uo(z,O).flags|=256),O=tx(z,O,!1),O!==2){if(Kg&&!q){z.errorRecoveryDisabledLanes|=k,El|=k,y=4;break e}k=Hn,Hn=y,k!==null&&(Hn===null?Hn=k:Hn.push.apply(Hn,k))}y=O}if(k=!1,y!==2)continue}}if(y===1){Uo(i,0),qi(i,o,0,!0);break}e:{switch(p=i,k=y,k){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:qi(p,o,as,!Li);break e;case 2:Hn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(y=Yh+300-rt(),10<y)){if(qi(p,o,as,!Li),ze(p,0,!0)!==0)break e;Ga=o,p.timeoutHandle=zN(cN.bind(null,p,u,Hn,Jh,Xg,o,as,El,zo,Li,k,"Throttled",-0,0),y);break e}cN(p,u,Hn,Jh,Xg,o,as,El,zo,Li,k,null,-0,0)}}break}while(!0);pa(i)}function cN(i,o,u,p,y,k,O,z,q,ne,ue,xe,se,oe){if(i.timeoutHandle=-1,xe=o.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pa},tN(o,k,xe);var Ue=(k&62914560)===k?Yh-rt():(k&4194048)===k?aN-rt():0;if(Ue=uI(xe,Ue),Ue!==null){Ga=k,i.cancelPendingCommit=Ue(xN.bind(null,i,o,k,u,p,y,O,z,q,ue,xe,null,se,oe)),qi(i,k,O,!ne);return}}xN(i,o,k,u,p,y,O,z,q)}function C8(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var y=u[p],k=y.getSnapshot;y=y.value;try{if(!es(k(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function qi(i,o,u,p){o&=~Yg,o&=~El,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var y=o;0<y;){var k=31-dt(y),O=1<<k;p[k]=-1,y&=~O}u!==0&&un(i,u,o)}function Qh(){return($t&6)===0?(Td(0),!1):!0}function ex(){if(jt!==null){if(qt===0)var i=jt.return;else i=jt,Ia=vl=null,gg(i),Oo=null,hd=0,i=jt;for(;i!==null;)Bk(i.alternate,i),i=i.return;jt=null}}function Uo(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,G8(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Ga=0,ex(),tr=i,jt=u=Ma(i.current,null),kt=o,qt=0,ss=null,Li=!1,Lo=Pe(i,o),Kg=!1,zo=as=Yg=El=zi=_r=0,Hn=Ed=null,Xg=!1,(o&8)!==0&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var y=31-dt(p),k=1<<y;o|=i[y],p&=~k}return Wa=o,vh(),u}function dN(i,o){ht=null,L.H=yd,o===To||o===Ch?(o=S_(),qt=3):o===sg?(o=S_(),qt=4):qt=o===Pg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ss=o,jt===null&&(_r=1,Uh(i,Ss(o,i.current)))}function uN(){var i=rs.current;return i===null?!0:(kt&4194048)===kt?Ts===null:(kt&62914560)===kt||(kt&536870912)!==0?i===Ts:!1}function hN(){var i=L.H;return L.H=yd,i===null?yd:i}function fN(){var i=L.A;return L.A=N8,i}function Zh(){_r=4,Li||(kt&4194048)!==kt&&rs.current!==null||(Lo=!0),(zi&134217727)===0&&(El&134217727)===0||tr===null||qi(tr,kt,as,!1)}function tx(i,o,u){var p=$t;$t|=2;var y=hN(),k=fN();(tr!==i||kt!==o)&&(Jh=null,Uo(i,o)),o=!1;var O=_r;e:do try{if(qt!==0&&jt!==null){var z=jt,q=ss;switch(qt){case 8:ex(),O=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(o=!0);var ne=qt;if(qt=0,ss=null,qo(i,z,q,ne),u&&Lo){O=0;break e}break;default:ne=qt,qt=0,ss=null,qo(i,z,q,ne)}}E8(),O=_r;break}catch(ue){dN(i,ue)}while(!0);return o&&i.shellSuspendCounter++,Ia=vl=null,$t=p,L.H=y,L.A=k,jt===null&&(tr=null,kt=0,vh()),O}function E8(){for(;jt!==null;)mN(jt)}function A8(i,o){var u=$t;$t|=2;var p=hN(),y=fN();tr!==i||kt!==o?(Jh=null,Xh=rt()+500,Uo(i,o)):Lo=Pe(i,o);e:do try{if(qt!==0&&jt!==null){o=jt;var k=ss;t:switch(qt){case 1:qt=0,ss=null,qo(i,o,k,1);break;case 2:case 9:if(k_(k)){qt=0,ss=null,pN(o);break}o=function(){qt!==2&&qt!==9||tr!==i||(qt=7),pa(i)},k.then(o,o);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:k_(k)?(qt=0,ss=null,pN(o)):(qt=0,ss=null,qo(i,o,k,7));break;case 5:var O=null;switch(jt.tag){case 26:O=jt.memoizedState;case 5:case 27:var z=jt;if(O?e2(O):z.stateNode.complete){qt=0,ss=null;var q=z.sibling;if(q!==null)jt=q;else{var ne=z.return;ne!==null?(jt=ne,ef(ne)):jt=null}break t}}qt=0,ss=null,qo(i,o,k,5);break;case 6:qt=0,ss=null,qo(i,o,k,6);break;case 8:ex(),_r=6;break e;default:throw Error(n(462))}}T8();break}catch(ue){dN(i,ue)}while(!0);return Ia=vl=null,L.H=p,L.A=y,$t=u,jt!==null?0:(tr=null,kt=0,vh(),_r)}function T8(){for(;jt!==null&&!fe();)mN(jt)}function mN(i){var o=Lk(i.alternate,i,Wa);i.memoizedProps=i.pendingProps,o===null?ef(i):jt=o}function pN(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=Pk(u,o,o.pendingProps,o.type,void 0,kt);break;case 11:o=Pk(u,o,o.pendingProps,o.type.render,o.ref,kt);break;case 5:gg(o);default:Bk(u,o),o=jt=f_(o,Wa),o=Lk(u,o,Wa)}i.memoizedProps=i.pendingProps,o===null?ef(i):jt=o}function qo(i,o,u,p){Ia=vl=null,gg(o),Oo=null,hd=0;var y=o.return;try{if(b8(i,y,o,u,kt)){_r=1,Uh(i,Ss(u,i.current)),jt=null;return}}catch(k){if(y!==null)throw jt=y,k;_r=1,Uh(i,Ss(u,i.current)),jt=null;return}o.flags&32768?(At||p===1?i=!0:Lo||(kt&536870912)!==0?i=!1:(Li=i=!0,(p===2||p===9||p===3||p===6)&&(p=rs.current,p!==null&&p.tag===13&&(p.flags|=16384))),gN(o,i)):ef(o)}function ef(i){var o=i;do{if((o.flags&32768)!==0){gN(o,Li);return}i=o.return;var u=w8(o.alternate,o,Wa);if(u!==null){jt=u;return}if(o=o.sibling,o!==null){jt=o;return}jt=o=i}while(o!==null);_r===0&&(_r=5)}function gN(i,o){do{var u=j8(i.alternate,i);if(u!==null){u.flags&=32767,jt=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){jt=i;return}jt=i=u}while(i!==null);_r=6,jt=null}function xN(i,o,u,p,y,k,O,z,q){i.cancelPendingCommit=null;do tf();while(Hr!==0);if(($t&6)!==0)throw Error(n(327));if(o!==null){if(o===i.current)throw Error(n(177));if(k=o.lanes|o.childLanes,k|=Fp,er(i,u,k,O,z,q),i===tr&&(jt=tr=null,kt=0),Bo=o,Ui=i,Ga=u,Jg=k,Qg=y,iN=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,M8(ae,function(){return jN(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=L.T,L.T=null,y=U.p,U.p=2,O=$t,$t|=4;try{_8(i,o,u)}finally{$t=O,U.p=y,L.T=p}}Hr=1,bN(),vN(),yN()}}function bN(){if(Hr===1){Hr=0;var i=Ui,o=Bo,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=L.T,L.T=null;var p=U.p;U.p=2;var y=$t;$t|=4;try{Qk(o,i);var k=fx,O=s_(i.containerInfo),z=k.focusedElem,q=k.selectionRange;if(O!==z&&z&&z.ownerDocument&&n_(z.ownerDocument.documentElement,z)){if(q!==null&&Lp(z)){var ne=q.start,ue=q.end;if(ue===void 0&&(ue=ne),"selectionStart"in z)z.selectionStart=ne,z.selectionEnd=Math.min(ue,z.value.length);else{var xe=z.ownerDocument||document,se=xe&&xe.defaultView||window;if(se.getSelection){var oe=se.getSelection(),Ue=z.textContent.length,Je=Math.min(q.start,Ue),Xt=q.end===void 0?Je:Math.min(q.end,Ue);!oe.extend&&Je>Xt&&(O=Xt,Xt=Je,Je=O);var Q=r_(z,Je),K=r_(z,Xt);if(Q&&K&&(oe.rangeCount!==1||oe.anchorNode!==Q.node||oe.anchorOffset!==Q.offset||oe.focusNode!==K.node||oe.focusOffset!==K.offset)){var re=xe.createRange();re.setStart(Q.node,Q.offset),oe.removeAllRanges(),Je>Xt?(oe.addRange(re),oe.extend(K.node,K.offset)):(re.setEnd(K.node,K.offset),oe.addRange(re))}}}}for(xe=[],oe=z;oe=oe.parentNode;)oe.nodeType===1&&xe.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<xe.length;z++){var me=xe[z];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}mf=!!hx,fx=hx=null}finally{$t=y,U.p=p,L.T=u}}i.current=o,Hr=2}}function vN(){if(Hr===2){Hr=0;var i=Ui,o=Bo,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=L.T,L.T=null;var p=U.p;U.p=2;var y=$t;$t|=4;try{Gk(i,o.alternate,o)}finally{$t=y,U.p=p,L.T=u}}Hr=3}}function yN(){if(Hr===4||Hr===3){Hr=0,Ve();var i=Ui,o=Bo,u=Ga,p=iN;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Hr=5:(Hr=0,Bo=Ui=null,wN(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Bi=null),Ye(u),o=o.stateNode,wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(mt,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=L.T,y=U.p,U.p=2,L.T=null;try{for(var k=i.onRecoverableError,O=0;O<p.length;O++){var z=p[O];k(z.value,{componentStack:z.stack})}}finally{L.T=o,U.p=y}}(Ga&3)!==0&&tf(),pa(i),y=i.pendingLanes,(u&261930)!==0&&(y&42)!==0?i===Zg?Ad++:(Ad=0,Zg=i):Ad=0,Td(0)}}function wN(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,dd(o)))}function tf(){return bN(),vN(),yN(),jN()}function jN(){if(Hr!==5)return!1;var i=Ui,o=Jg;Jg=0;var u=Ye(Ga),p=L.T,y=U.p;try{U.p=32>u?32:u,L.T=null,u=Qg,Qg=null;var k=Ui,O=Ga;if(Hr=0,Bo=Ui=null,Ga=0,($t&6)!==0)throw Error(n(331));var z=$t;if($t|=4,nN(k.current),eN(k,k.current,O,u),$t=z,Td(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(mt,k)}catch{}return!0}finally{U.p=y,L.T=p,wN(i,o)}}function _N(i,o,u){o=Ss(u,o),o=Og(i.stateNode,o,2),i=Mi(i,o,2),i!==null&&(Ot(i,2),pa(i))}function Ft(i,o,u){if(i.tag===3)_N(i,i,u);else for(;o!==null;){if(o.tag===3){_N(o,i,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Bi===null||!Bi.has(p))){i=Ss(u,i),u=kk(2),p=Mi(o,u,2),p!==null&&(Nk(u,p,o,i),Ot(p,2),pa(p));break}}o=o.return}}function rx(i,o,u){var p=i.pingCache;if(p===null){p=i.pingCache=new S8;var y=new Set;p.set(o,y)}else y=p.get(o),y===void 0&&(y=new Set,p.set(o,y));y.has(u)||(Kg=!0,y.add(u),i=O8.bind(null,i,o,u),o.then(i,i))}function O8(i,o,u){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,tr===i&&(kt&u)===u&&(_r===4||_r===3&&(kt&62914560)===kt&&300>rt()-Yh?($t&2)===0&&Uo(i,0):Yg|=u,zo===kt&&(zo=0)),pa(i)}function kN(i,o){o===0&&(o=et()),i=gl(i,o),i!==null&&(Ot(i,o),pa(i))}function P8(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),kN(i,u)}function D8(i,o){var u=0;switch(i.tag){case 31:case 13:var p=i.stateNode,y=i.memoizedState;y!==null&&(u=y.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(o),kN(i,u)}function M8(i,o){return Y(i,o)}var rf=null,Fo=null,nx=!1,nf=!1,sx=!1,Fi=0;function pa(i){i!==Fo&&i.next===null&&(Fo===null?rf=Fo=i:Fo=Fo.next=i),nf=!0,nx||(nx=!0,I8())}function Td(i,o){if(!sx&&nf){sx=!0;do for(var u=!1,p=rf;p!==null;){if(i!==0){var y=p.pendingLanes;if(y===0)var k=0;else{var O=p.suspendedLanes,z=p.pingedLanes;k=(1<<31-dt(42|i)+1)-1,k&=y&~(O&~z),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(u=!0,EN(p,k))}else k=kt,k=ze(p,p===tr?k:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(k&3)===0||Pe(p,k)||(u=!0,EN(p,k));p=p.next}while(u);sx=!1}}function R8(){NN()}function NN(){nf=nx=!1;var i=0;Fi!==0&&W8()&&(i=Fi);for(var o=rt(),u=null,p=rf;p!==null;){var y=p.next,k=SN(p,o);k===0?(p.next=null,u===null?rf=y:u.next=y,y===null&&(Fo=u)):(u=p,(i!==0||(k&3)!==0)&&(nf=!0)),p=y}Hr!==0&&Hr!==5||Td(i),Fi!==0&&(Fi=0)}function SN(i,o){for(var u=i.suspendedLanes,p=i.pingedLanes,y=i.expirationTimes,k=i.pendingLanes&-62914561;0<k;){var O=31-dt(k),z=1<<O,q=y[O];q===-1?((z&u)===0||(z&p)!==0)&&(y[O]=gt(z,o)):q<=o&&(i.expiredLanes|=z),k&=~z}if(o=tr,u=kt,u=ze(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,u===0||i===o&&(qt===2||qt===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Z(p),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Pe(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(p!==null&&Z(p),Ye(u)){case 2:case 8:u=nt;break;case 32:u=ae;break;case 268435456:u=Ge;break;default:u=ae}return p=CN.bind(null,i),u=Y(u,p),i.callbackPriority=o,i.callbackNode=u,o}return p!==null&&p!==null&&Z(p),i.callbackPriority=2,i.callbackNode=null,2}function CN(i,o){if(Hr!==0&&Hr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(tf()&&i.callbackNode!==u)return null;var p=kt;return p=ze(i,i===tr?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(oN(i,p,o),SN(i,rt()),i.callbackNode!=null&&i.callbackNode===u?CN.bind(null,i):null)}function EN(i,o){if(tf())return null;oN(i,o,!0)}function I8(){K8(function(){($t&6)!==0?Y(qe,R8):NN()})}function ax(){if(Fi===0){var i=Eo;i===0&&(i=Ae,Ae<<=1,(Ae&261888)===0&&(Ae=256)),Fi=i}return Fi}function AN(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:uh(""+i)}function TN(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function $8(i,o,u,p,y){if(o==="submit"&&u&&u.stateNode===y){var k=AN((y[be]||null).action),O=p.submitter;O&&(o=(o=O[be]||null)?AN(o.formAction):O.getAttribute("formAction"),o!==null&&(k=o,O=null));var z=new ph("action","action",null,p,y);i.push({event:z,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Fi!==0){var q=O?TN(y,O):new FormData(y);Ng(u,{pending:!0,data:q,method:y.method,action:k},null,q)}}else typeof k=="function"&&(z.preventDefault(),q=O?TN(y,O):new FormData(y),Ng(u,{pending:!0,data:q,method:y.method,action:k},k,q))},currentTarget:y}]})}}for(var ix=0;ix<qp.length;ix++){var lx=qp[ix],L8=lx.toLowerCase(),z8=lx[0].toUpperCase()+lx.slice(1);Hs(L8,"on"+z8)}Hs(l_,"onAnimationEnd"),Hs(o_,"onAnimationIteration"),Hs(c_,"onAnimationStart"),Hs("dblclick","onDoubleClick"),Hs("focusin","onFocus"),Hs("focusout","onBlur"),Hs(t8,"onTransitionRun"),Hs(r8,"onTransitionStart"),Hs(n8,"onTransitionCancel"),Hs(d_,"onTransitionEnd"),Ta("onMouseEnter",["mouseout","mouseover"]),Ta("onMouseLeave",["mouseout","mouseover"]),Ta("onPointerEnter",["pointerout","pointerover"]),Ta("onPointerLeave",["pointerout","pointerover"]),Zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Od="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B8=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Od));function ON(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var p=i[u],y=p.event;p=p.listeners;e:{var k=void 0;if(o)for(var O=p.length-1;0<=O;O--){var z=p[O],q=z.instance,ne=z.currentTarget;if(z=z.listener,q!==k&&y.isPropagationStopped())break e;k=z,y.currentTarget=ne;try{k(y)}catch(ue){bh(ue)}y.currentTarget=null,k=q}else for(O=0;O<p.length;O++){if(z=p[O],q=z.instance,ne=z.currentTarget,z=z.listener,q!==k&&y.isPropagationStopped())break e;k=z,y.currentTarget=ne;try{k(y)}catch(ue){bh(ue)}y.currentTarget=null,k=q}}}}function _t(i,o){var u=o[lt];u===void 0&&(u=o[lt]=new Set);var p=i+"__bubble";u.has(p)||(PN(o,i,2,!1),u.add(p))}function ox(i,o,u){var p=0;o&&(p|=4),PN(u,i,p,o)}var sf="_reactListening"+Math.random().toString(36).slice(2);function cx(i){if(!i[sf]){i[sf]=!0,at.forEach(function(u){u!=="selectionchange"&&(B8.has(u)||ox(u,!1,i),ox(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[sf]||(o[sf]=!0,ox("selectionchange",!1,o))}}function PN(i,o,u,p){switch(l2(o)){case 2:var y=mI;break;case 8:y=pI;break;default:y=kx}u=y.bind(null,o,u,i),y=void 0,!Ap||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),p?y!==void 0?i.addEventListener(o,u,{capture:!0,passive:y}):i.addEventListener(o,u,!0):y!==void 0?i.addEventListener(o,u,{passive:y}):i.addEventListener(o,u,!1)}function dx(i,o,u,p,y){var k=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var O=p.tag;if(O===3||O===4){var z=p.stateNode.containerInfo;if(z===y)break;if(O===4)for(O=p.return;O!==null;){var q=O.tag;if((q===3||q===4)&&O.stateNode.containerInfo===y)return;O=O.return}for(;z!==null;){if(O=Ni(z),O===null)return;if(q=O.tag,q===5||q===6||q===26||q===27){p=k=O;continue e}z=z.parentNode}}p=p.return}$j(function(){var ne=k,ue=Cp(u),xe=[];e:{var se=u_.get(i);if(se!==void 0){var oe=ph,Ue=i;switch(i){case"keypress":if(fh(u)===0)break e;case"keydown":case"keyup":oe=DR;break;case"focusin":Ue="focus",oe=Dp;break;case"focusout":Ue="blur",oe=Dp;break;case"beforeblur":case"afterblur":oe=Dp;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Bj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=wR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=IR;break;case l_:case o_:case c_:oe=kR;break;case d_:oe=LR;break;case"scroll":case"scrollend":oe=vR;break;case"wheel":oe=BR;break;case"copy":case"cut":case"paste":oe=SR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=qj;break;case"toggle":case"beforetoggle":oe=qR}var Je=(o&4)!==0,Xt=!Je&&(i==="scroll"||i==="scrollend"),Q=Je?se!==null?se+"Capture":null:se;Je=[];for(var K=ne,re;K!==null;){var me=K;if(re=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||re===null||Q===null||(me=Zc(K,Q),me!=null&&Je.push(Pd(K,me,re))),Xt)break;K=K.return}0<Je.length&&(se=new oe(se,Ue,null,u,ue),xe.push({event:se,listeners:Je}))}}if((o&7)===0){e:{if(se=i==="mouseover"||i==="pointerover",oe=i==="mouseout"||i==="pointerout",se&&u!==Sp&&(Ue=u.relatedTarget||u.fromElement)&&(Ni(Ue)||Ue[Oe]))break e;if((oe||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,oe?(Ue=u.relatedTarget||u.toElement,oe=ne,Ue=Ue?Ni(Ue):null,Ue!==null&&(Xt=l(Ue),Je=Ue.tag,Ue!==Xt||Je!==5&&Je!==27&&Je!==6)&&(Ue=null)):(oe=null,Ue=ne),oe!==Ue)){if(Je=Bj,me="onMouseLeave",Q="onMouseEnter",K="mouse",(i==="pointerout"||i==="pointerover")&&(Je=qj,me="onPointerLeave",Q="onPointerEnter",K="pointer"),Xt=oe==null?se:Si(oe),re=Ue==null?se:Si(Ue),se=new Je(me,K+"leave",oe,u,ue),se.target=Xt,se.relatedTarget=re,me=null,Ni(ue)===ne&&(Je=new Je(Q,K+"enter",Ue,u,ue),Je.target=re,Je.relatedTarget=Xt,me=Je),Xt=me,oe&&Ue)t:{for(Je=U8,Q=oe,K=Ue,re=0,me=Q;me;me=Je(me))re++;me=0;for(var Ke=K;Ke;Ke=Je(Ke))me++;for(;0<re-me;)Q=Je(Q),re--;for(;0<me-re;)K=Je(K),me--;for(;re--;){if(Q===K||K!==null&&Q===K.alternate){Je=Q;break t}Q=Je(Q),K=Je(K)}Je=null}else Je=null;oe!==null&&DN(xe,se,oe,Je,!1),Ue!==null&&Xt!==null&&DN(xe,Xt,Ue,Je,!0)}}e:{if(se=ne?Si(ne):window,oe=se.nodeName&&se.nodeName.toLowerCase(),oe==="select"||oe==="input"&&se.type==="file")var Mt=Xj;else if(Kj(se))if(Jj)Mt=QR;else{Mt=XR;var Fe=YR}else oe=se.nodeName,!oe||oe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ne&&Np(ne.elementType)&&(Mt=Xj):Mt=JR;if(Mt&&(Mt=Mt(i,ne))){Yj(xe,Mt,u,ue);break e}Fe&&Fe(i,se,ne),i==="focusout"&&ne&&se.type==="number"&&ne.memoizedProps.value!=null&&kp(se,"number",se.value)}switch(Fe=ne?Si(ne):window,i){case"focusin":(Kj(Fe)||Fe.contentEditable==="true")&&(yo=Fe,zp=ne,ld=null);break;case"focusout":ld=zp=yo=null;break;case"mousedown":Bp=!0;break;case"contextmenu":case"mouseup":case"dragend":Bp=!1,a_(xe,u,ue);break;case"selectionchange":if(e8)break;case"keydown":case"keyup":a_(xe,u,ue)}var xt;if(Rp)e:{switch(i){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else vo?Wj(i,u)&&(Nt="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Nt="onCompositionStart");Nt&&(Fj&&u.locale!=="ko"&&(vo||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&vo&&(xt=Lj()):(Ci=ue,Tp="value"in Ci?Ci.value:Ci.textContent,vo=!0)),Fe=af(ne,Nt),0<Fe.length&&(Nt=new Uj(Nt,i,null,u,ue),xe.push({event:Nt,listeners:Fe}),xt?Nt.data=xt:(xt=Gj(u),xt!==null&&(Nt.data=xt)))),(xt=HR?VR(i,u):WR(i,u))&&(Nt=af(ne,"onBeforeInput"),0<Nt.length&&(Fe=new Uj("onBeforeInput","beforeinput",null,u,ue),xe.push({event:Fe,listeners:Nt}),Fe.data=xt)),$8(xe,i,ne,u,ue)}ON(xe,o)})}function Pd(i,o,u){return{instance:i,listener:o,currentTarget:u}}function af(i,o){for(var u=o+"Capture",p=[];i!==null;){var y=i,k=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||k===null||(y=Zc(i,u),y!=null&&p.unshift(Pd(i,y,k)),y=Zc(i,o),y!=null&&p.push(Pd(i,y,k))),i.tag===3)return p;i=i.return}return[]}function U8(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function DN(i,o,u,p,y){for(var k=o._reactName,O=[];u!==null&&u!==p;){var z=u,q=z.alternate,ne=z.stateNode;if(z=z.tag,q!==null&&q===p)break;z!==5&&z!==26&&z!==27||ne===null||(q=ne,y?(ne=Zc(u,k),ne!=null&&O.unshift(Pd(u,ne,q))):y||(ne=Zc(u,k),ne!=null&&O.push(Pd(u,ne,q)))),u=u.return}O.length!==0&&i.push({event:o,listeners:O})}var q8=/\r\n?/g,F8=/\u0000|\uFFFD/g;function MN(i){return(typeof i=="string"?i:""+i).replace(q8,`
`).replace(F8,"")}function RN(i,o){return o=MN(o),MN(i)===o}function Yt(i,o,u,p,y,k){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||go(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&go(i,""+p);break;case"className":ch(i,"class",p);break;case"tabIndex":ch(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":ch(i,u,p);break;case"style":Rj(i,p,k);break;case"data":if(o!=="object"){ch(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=uh(""+p),i.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(u==="formAction"?(o!=="input"&&Yt(i,o,"name",y.name,y,null),Yt(i,o,"formEncType",y.formEncType,y,null),Yt(i,o,"formMethod",y.formMethod,y,null),Yt(i,o,"formTarget",y.formTarget,y,null)):(Yt(i,o,"encType",y.encType,y,null),Yt(i,o,"method",y.method,y,null),Yt(i,o,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=uh(""+p),i.setAttribute(u,p);break;case"onClick":p!=null&&(i.onclick=Pa);break;case"onScroll":p!=null&&_t("scroll",i);break;case"onScrollEnd":p!=null&&_t("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}u=uh(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""+p):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":p===!0?i.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,p):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(u,p):i.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(u):i.setAttribute(u,p);break;case"popover":_t("beforetoggle",i),_t("toggle",i),oh(i,"popover",p);break;case"xlinkActuate":Oa(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Oa(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Oa(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Oa(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Oa(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Oa(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Oa(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Oa(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Oa(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":oh(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=xR.get(u)||u,oh(i,u,p))}}function ux(i,o,u,p,y,k){switch(u){case"style":Rj(i,p,k);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"children":typeof p=="string"?go(i,p):(typeof p=="number"||typeof p=="bigint")&&go(i,""+p);break;case"onScroll":p!=null&&_t("scroll",i);break;case"onScrollEnd":p!=null&&_t("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Pa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!mo.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),k=i[be]||null,k=k!=null?k[u]:null,typeof k=="function"&&i.removeEventListener(o,k,y),typeof p=="function")){typeof k!="function"&&k!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,p,y);break e}u in i?i[u]=p:p===!0?i.setAttribute(u,""):oh(i,u,p)}}}function pn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",i),_t("load",i);var p=!1,y=!1,k;for(k in u)if(u.hasOwnProperty(k)){var O=u[k];if(O!=null)switch(k){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Yt(i,o,k,O,u,null)}}y&&Yt(i,o,"srcSet",u.srcSet,u,null),p&&Yt(i,o,"src",u.src,u,null);return;case"input":_t("invalid",i);var z=k=O=y=null,q=null,ne=null;for(p in u)if(u.hasOwnProperty(p)){var ue=u[p];if(ue!=null)switch(p){case"name":y=ue;break;case"type":O=ue;break;case"checked":q=ue;break;case"defaultChecked":ne=ue;break;case"value":k=ue;break;case"defaultValue":z=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(n(137,o));break;default:Yt(i,o,p,ue,u,null)}}Oj(i,k,z,q,ne,O,y,!1);return;case"select":_t("invalid",i),p=O=k=null;for(y in u)if(u.hasOwnProperty(y)&&(z=u[y],z!=null))switch(y){case"value":k=z;break;case"defaultValue":O=z;break;case"multiple":p=z;default:Yt(i,o,y,z,u,null)}o=k,u=O,i.multiple=!!p,o!=null?po(i,!!p,o,!1):u!=null&&po(i,!!p,u,!0);return;case"textarea":_t("invalid",i),k=y=p=null;for(O in u)if(u.hasOwnProperty(O)&&(z=u[O],z!=null))switch(O){case"value":p=z;break;case"defaultValue":y=z;break;case"children":k=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(91));break;default:Yt(i,o,O,z,u,null)}Dj(i,p,y,k);return;case"option":for(q in u)if(u.hasOwnProperty(q)&&(p=u[q],p!=null))switch(q){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Yt(i,o,q,p,u,null)}return;case"dialog":_t("beforetoggle",i),_t("toggle",i),_t("cancel",i),_t("close",i);break;case"iframe":case"object":_t("load",i);break;case"video":case"audio":for(p=0;p<Od.length;p++)_t(Od[p],i);break;case"image":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"embed":case"source":case"link":_t("error",i),_t("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in u)if(u.hasOwnProperty(ne)&&(p=u[ne],p!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Yt(i,o,ne,p,u,null)}return;default:if(Np(o)){for(ue in u)u.hasOwnProperty(ue)&&(p=u[ue],p!==void 0&&ux(i,o,ue,p,u,void 0));return}}for(z in u)u.hasOwnProperty(z)&&(p=u[z],p!=null&&Yt(i,o,z,p,u,null))}function H8(i,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,k=null,O=null,z=null,q=null,ne=null,ue=null;for(oe in u){var xe=u[oe];if(u.hasOwnProperty(oe)&&xe!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":q=xe;default:p.hasOwnProperty(oe)||Yt(i,o,oe,null,p,xe)}}for(var se in p){var oe=p[se];if(xe=u[se],p.hasOwnProperty(se)&&(oe!=null||xe!=null))switch(se){case"type":k=oe;break;case"name":y=oe;break;case"checked":ne=oe;break;case"defaultChecked":ue=oe;break;case"value":O=oe;break;case"defaultValue":z=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(n(137,o));break;default:oe!==xe&&Yt(i,o,se,oe,p,xe)}}_p(i,O,z,q,ne,ue,k,y);return;case"select":oe=O=z=se=null;for(k in u)if(q=u[k],u.hasOwnProperty(k)&&q!=null)switch(k){case"value":break;case"multiple":oe=q;default:p.hasOwnProperty(k)||Yt(i,o,k,null,p,q)}for(y in p)if(k=p[y],q=u[y],p.hasOwnProperty(y)&&(k!=null||q!=null))switch(y){case"value":se=k;break;case"defaultValue":z=k;break;case"multiple":O=k;default:k!==q&&Yt(i,o,y,k,p,q)}o=z,u=O,p=oe,se!=null?po(i,!!u,se,!1):!!p!=!!u&&(o!=null?po(i,!!u,o,!0):po(i,!!u,u?[]:"",!1));return;case"textarea":oe=se=null;for(z in u)if(y=u[z],u.hasOwnProperty(z)&&y!=null&&!p.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Yt(i,o,z,null,p,y)}for(O in p)if(y=p[O],k=u[O],p.hasOwnProperty(O)&&(y!=null||k!=null))switch(O){case"value":se=y;break;case"defaultValue":oe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==k&&Yt(i,o,O,y,p,k)}Pj(i,se,oe);return;case"option":for(var Ue in u)if(se=u[Ue],u.hasOwnProperty(Ue)&&se!=null&&!p.hasOwnProperty(Ue))switch(Ue){case"selected":i.selected=!1;break;default:Yt(i,o,Ue,null,p,se)}for(q in p)if(se=p[q],oe=u[q],p.hasOwnProperty(q)&&se!==oe&&(se!=null||oe!=null))switch(q){case"selected":i.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:Yt(i,o,q,se,p,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in u)se=u[Je],u.hasOwnProperty(Je)&&se!=null&&!p.hasOwnProperty(Je)&&Yt(i,o,Je,null,p,se);for(ne in p)if(se=p[ne],oe=u[ne],p.hasOwnProperty(ne)&&se!==oe&&(se!=null||oe!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(n(137,o));break;default:Yt(i,o,ne,se,p,oe)}return;default:if(Np(o)){for(var Xt in u)se=u[Xt],u.hasOwnProperty(Xt)&&se!==void 0&&!p.hasOwnProperty(Xt)&&ux(i,o,Xt,void 0,p,se);for(ue in p)se=p[ue],oe=u[ue],!p.hasOwnProperty(ue)||se===oe||se===void 0&&oe===void 0||ux(i,o,ue,se,p,oe);return}}for(var Q in u)se=u[Q],u.hasOwnProperty(Q)&&se!=null&&!p.hasOwnProperty(Q)&&Yt(i,o,Q,null,p,se);for(xe in p)se=p[xe],oe=u[xe],!p.hasOwnProperty(xe)||se===oe||se==null&&oe==null||Yt(i,o,xe,se,p,oe)}function IN(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function V8(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var y=u[p],k=y.transferSize,O=y.initiatorType,z=y.duration;if(k&&z&&IN(O)){for(O=0,z=y.responseEnd,p+=1;p<u.length;p++){var q=u[p],ne=q.startTime;if(ne>z)break;var ue=q.transferSize,xe=q.initiatorType;ue&&IN(xe)&&(q=q.responseEnd,O+=ue*(q<z?1:(z-ne)/(q-ne)))}if(--p,o+=8*(k+O)/(y.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var hx=null,fx=null;function lf(i){return i.nodeType===9?i:i.ownerDocument}function $N(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function LN(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function mx(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var px=null;function W8(){var i=window.event;return i&&i.type==="popstate"?i===px?!1:(px=i,!0):(px=null,!1)}var zN=typeof setTimeout=="function"?setTimeout:void 0,G8=typeof clearTimeout=="function"?clearTimeout:void 0,BN=typeof Promise=="function"?Promise:void 0,K8=typeof queueMicrotask=="function"?queueMicrotask:typeof BN<"u"?function(i){return BN.resolve(null).then(i).catch(Y8)}:zN;function Y8(i){setTimeout(function(){throw i})}function Hi(i){return i==="head"}function UN(i,o){var u=o,p=0;do{var y=u.nextSibling;if(i.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(p===0){i.removeChild(y),Go(o);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")Dd(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Dd(u);for(var k=u.firstChild;k;){var O=k.nextSibling,z=k.nodeName;k[js]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&k.rel.toLowerCase()==="stylesheet"||u.removeChild(k),k=O}}else u==="body"&&Dd(i.ownerDocument.body);u=y}while(u);Go(o)}function qN(i,o){var u=i;i=0;do{var p=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=p}while(u)}function gx(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":gx(u),zn(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function X8(i,o,u,p){for(;i.nodeType===1;){var y=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[js])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(k=i.getAttribute("rel"),k==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(k!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(k=i.getAttribute("src"),(k!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&k&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var k=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===k)return i}else return i;if(i=Os(i.nextSibling),i===null)break}return null}function J8(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Os(i.nextSibling),i===null))return null;return i}function FN(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Os(i.nextSibling),i===null))return null;return i}function xx(i){return i.data==="$?"||i.data==="$~"}function bx(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Q8(i,o){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||u.readyState!=="loading")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Os(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var vx=null;function HN(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(o===0)return Os(i.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}i=i.nextSibling}return null}function VN(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return i;o--}else u!=="/$"&&u!=="/&"||o++}i=i.previousSibling}return null}function WN(i,o,u){switch(o=lf(u),i){case"html":if(i=o.documentElement,!i)throw Error(n(452));return i;case"head":if(i=o.head,!i)throw Error(n(453));return i;case"body":if(i=o.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Dd(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);zn(i)}var Ps=new Map,GN=new Set;function of(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ka=U.d;U.d={f:Z8,r:eI,D:tI,C:rI,L:nI,m:sI,X:iI,S:aI,M:lI};function Z8(){var i=Ka.f(),o=Qh();return i||o}function eI(i){var o=ua(i);o!==null&&o.tag===5&&o.type==="form"?dk(o):Ka.r(i)}var Ho=typeof document>"u"?null:document;function KN(i,o,u){var p=Ho;if(p&&typeof o=="string"&&o){var y=ks(o);y='link[rel="'+i+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),GN.has(y)||(GN.add(y),i={rel:i,crossOrigin:u,href:o},p.querySelector(y)===null&&(o=p.createElement("link"),pn(o,"link",i),Cr(o),p.head.appendChild(o)))}}function tI(i){Ka.D(i),KN("dns-prefetch",i,null)}function rI(i,o){Ka.C(i,o),KN("preconnect",i,o)}function nI(i,o,u){Ka.L(i,o,u);var p=Ho;if(p&&i&&o){var y='link[rel="preload"][as="'+ks(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+ks(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+ks(u.imageSizes)+'"]')):y+='[href="'+ks(i)+'"]';var k=y;switch(o){case"style":k=Vo(i);break;case"script":k=Wo(i)}Ps.has(k)||(i=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Ps.set(k,i),p.querySelector(y)!==null||o==="style"&&p.querySelector(Md(k))||o==="script"&&p.querySelector(Rd(k))||(o=p.createElement("link"),pn(o,"link",i),Cr(o),p.head.appendChild(o)))}}function sI(i,o){Ka.m(i,o);var u=Ho;if(u&&i){var p=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+ks(p)+'"][href="'+ks(i)+'"]',k=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Wo(i)}if(!Ps.has(k)&&(i=g({rel:"modulepreload",href:i},o),Ps.set(k,i),u.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Rd(k)))return}p=u.createElement("link"),pn(p,"link",i),Cr(p),u.head.appendChild(p)}}}function aI(i,o,u){Ka.S(i,o,u);var p=Ho;if(p&&i){var y=Aa(p).hoistableStyles,k=Vo(i);o=o||"default";var O=y.get(k);if(!O){var z={loading:0,preload:null};if(O=p.querySelector(Md(k)))z.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Ps.get(k))&&yx(i,u);var q=O=p.createElement("link");Cr(q),pn(q,"link",i),q._p=new Promise(function(ne,ue){q.onload=ne,q.onerror=ue}),q.addEventListener("load",function(){z.loading|=1}),q.addEventListener("error",function(){z.loading|=2}),z.loading|=4,cf(O,o,p)}O={type:"stylesheet",instance:O,count:1,state:z},y.set(k,O)}}}function iI(i,o){Ka.X(i,o);var u=Ho;if(u&&i){var p=Aa(u).hoistableScripts,y=Wo(i),k=p.get(y);k||(k=u.querySelector(Rd(y)),k||(i=g({src:i,async:!0},o),(o=Ps.get(y))&&wx(i,o),k=u.createElement("script"),Cr(k),pn(k,"link",i),u.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(y,k))}}function lI(i,o){Ka.M(i,o);var u=Ho;if(u&&i){var p=Aa(u).hoistableScripts,y=Wo(i),k=p.get(y);k||(k=u.querySelector(Rd(y)),k||(i=g({src:i,async:!0,type:"module"},o),(o=Ps.get(y))&&wx(i,o),k=u.createElement("script"),Cr(k),pn(k,"link",i),u.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(y,k))}}function YN(i,o,u,p){var y=(y=Ee.current)?of(y):null;if(!y)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Vo(u.href),u=Aa(y).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Vo(u.href);var k=Aa(y).hoistableStyles,O=k.get(i);if(O||(y=y.ownerDocument||y,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(i,O),(k=y.querySelector(Md(i)))&&!k._p&&(O.instance=k,O.state.loading=5),Ps.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ps.set(i,u),k||oI(y,i,u,O.state))),o&&p===null)throw Error(n(528,""));return O}if(o&&p!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Wo(u),u=Aa(y).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Vo(i){return'href="'+ks(i)+'"'}function Md(i){return'link[rel="stylesheet"]['+i+"]"}function XN(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function oI(i,o,u,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),pn(o,"link",u),Cr(o),i.head.appendChild(o))}function Wo(i){return'[src="'+ks(i)+'"]'}function Rd(i){return"script[async]"+i}function JN(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+ks(u.href)+'"]');if(p)return o.instance=p,Cr(p),p;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Cr(p),pn(p,"style",y),cf(p,u.precedence,i),o.instance=p;case"stylesheet":y=Vo(u.href);var k=i.querySelector(Md(y));if(k)return o.state.loading|=4,o.instance=k,Cr(k),k;p=XN(u),(y=Ps.get(y))&&yx(p,y),k=(i.ownerDocument||i).createElement("link"),Cr(k);var O=k;return O._p=new Promise(function(z,q){O.onload=z,O.onerror=q}),pn(k,"link",p),o.state.loading|=4,cf(k,u.precedence,i),o.instance=k;case"script":return k=Wo(u.src),(y=i.querySelector(Rd(k)))?(o.instance=y,Cr(y),y):(p=u,(y=Ps.get(k))&&(p=g({},u),wx(p,y)),i=i.ownerDocument||i,y=i.createElement("script"),Cr(y),pn(y,"link",p),i.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,cf(p,u.precedence,i));return o.instance}function cf(i,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,k=y,O=0;O<p.length;O++){var z=p[O];if(z.dataset.precedence===o)k=z;else if(k!==y)break}k?k.parentNode.insertBefore(i,k.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function yx(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function wx(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var df=null;function QN(i,o,u){if(df===null){var p=new Map,y=df=new Map;y.set(u,p)}else y=df,p=y.get(u),p||(p=new Map,y.set(u,p));if(p.has(i))return p;for(p.set(i,null),u=u.getElementsByTagName(i),y=0;y<u.length;y++){var k=u[y];if(!(k[js]||k[Se]||i==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var O=k.getAttribute(o)||"";O=i+O;var z=p.get(O);z?z.push(k):p.set(O,[k])}}return p}function ZN(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function cI(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function e2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function dI(i,o,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Vo(p.href),k=o.querySelector(Md(y));if(k){o=k._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=uf.bind(i),o.then(i,i)),u.state.loading|=4,u.instance=k,Cr(k);return}k=o.ownerDocument||o,p=XN(p),(y=Ps.get(y))&&yx(p,y),k=k.createElement("link"),Cr(k);var O=k;O._p=new Promise(function(z,q){O.onload=z,O.onerror=q}),pn(k,"link",p),u.instance=k}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=uf.bind(i),o.addEventListener("load",u),o.addEventListener("error",u))}}var jx=0;function uI(i,o){return i.stylesheets&&i.count===0&&ff(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var p=setTimeout(function(){if(i.stylesheets&&ff(i,i.stylesheets),i.unsuspend){var k=i.unsuspend;i.unsuspend=null,k()}},6e4+o);0<i.imgBytes&&jx===0&&(jx=62500*V8());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&ff(i,i.stylesheets),i.unsuspend)){var k=i.unsuspend;i.unsuspend=null,k()}},(i.imgBytes>jx?50:800)+o);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(y)}}:null}function uf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ff(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var hf=null;function ff(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,hf=new Map,o.forEach(hI,i),hf=null,uf.call(i))}function hI(i,o){if(!(o.state.loading&4)){var u=hf.get(i);if(u)var p=u.get(null);else{u=new Map,hf.set(i,u);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<y.length;k++){var O=y[k];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(u.set(O.dataset.precedence,O),p=O)}p&&u.set(null,p)}y=o.instance,O=y.getAttribute("data-precedence"),k=u.get(O)||p,k===p&&u.set(null,y),u.set(O,y),this.count++,p=uf.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),k?k.parentNode.insertBefore(y,k.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),o.state.loading|=4}}var Id={$$typeof:A,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function fI(i,o,u,p,y,k,O,z,q){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Et(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Et(0),this.hiddenUpdates=Et(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=k,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function t2(i,o,u,p,y,k,O,z,q,ne,ue,xe){return i=new fI(i,o,u,O,q,ne,ue,xe,z),o=1,k===!0&&(o|=24),k=ts(3,null,null,o),i.current=k,k.stateNode=i,o=tg(),o.refCount++,i.pooledCache=o,o.refCount++,k.memoizedState={element:p,isDehydrated:u,cache:o},ag(k),i}function r2(i){return i?(i=_o,i):_o}function n2(i,o,u,p,y,k){y=r2(y),p.context===null?p.context=y:p.pendingContext=y,p=Di(o),p.payload={element:u},k=k===void 0?null:k,k!==null&&(p.callback=k),u=Mi(i,p,o),u!==null&&(Vn(u,i,o),md(u,i,o))}function s2(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function _x(i,o){s2(i,o),(i=i.alternate)&&s2(i,o)}function a2(i){if(i.tag===13||i.tag===31){var o=gl(i,67108864);o!==null&&Vn(o,i,67108864),_x(i,67108864)}}function i2(i){if(i.tag===13||i.tag===31){var o=is();o=Ut(o);var u=gl(i,o);u!==null&&Vn(u,i,o),_x(i,o)}}var mf=!0;function mI(i,o,u,p){var y=L.T;L.T=null;var k=U.p;try{U.p=2,kx(i,o,u,p)}finally{U.p=k,L.T=y}}function pI(i,o,u,p){var y=L.T;L.T=null;var k=U.p;try{U.p=8,kx(i,o,u,p)}finally{U.p=k,L.T=y}}function kx(i,o,u,p){if(mf){var y=Nx(p);if(y===null)dx(i,o,p,pf,u),o2(i,p);else if(xI(y,i,o,u,p))p.stopPropagation();else if(o2(i,p),o&4&&-1<gI.indexOf(i)){for(;y!==null;){var k=ua(y);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var O=te(k.pendingLanes);if(O!==0){var z=k;for(z.pendingLanes|=2,z.entangledLanes|=2;O;){var q=1<<31-dt(O);z.entanglements[1]|=q,O&=~q}pa(k),($t&6)===0&&(Xh=rt()+500,Td(0))}}break;case 31:case 13:z=gl(k,2),z!==null&&Vn(z,k,2),Qh(),_x(k,2)}if(k=Nx(p),k===null&&dx(i,o,p,pf,u),k===y)break;y=k}y!==null&&p.stopPropagation()}else dx(i,o,p,null,u)}}function Nx(i){return i=Cp(i),Sx(i)}var pf=null;function Sx(i){if(pf=null,i=Ni(i),i!==null){var o=l(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=c(o),i!==null)return i;i=null}else if(u===31){if(i=d(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return pf=i,null}function l2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pe()){case qe:return 2;case nt:return 8;case ae:case Ne:return 32;case Ge:return 268435456;default:return 32}default:return 32}}var Cx=!1,Vi=null,Wi=null,Gi=null,$d=new Map,Ld=new Map,Ki=[],gI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function o2(i,o){switch(i){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Gi=null;break;case"pointerover":case"pointerout":$d.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ld.delete(o.pointerId)}}function zd(i,o,u,p,y,k){return i===null||i.nativeEvent!==k?(i={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:k,targetContainers:[y]},o!==null&&(o=ua(o),o!==null&&a2(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),i)}function xI(i,o,u,p,y){switch(o){case"focusin":return Vi=zd(Vi,i,o,u,p,y),!0;case"dragenter":return Wi=zd(Wi,i,o,u,p,y),!0;case"mouseover":return Gi=zd(Gi,i,o,u,p,y),!0;case"pointerover":var k=y.pointerId;return $d.set(k,zd($d.get(k)||null,i,o,u,p,y)),!0;case"gotpointercapture":return k=y.pointerId,Ld.set(k,zd(Ld.get(k)||null,i,o,u,p,y)),!0}return!1}function c2(i){var o=Ni(i.target);if(o!==null){var u=l(o);if(u!==null){if(o=u.tag,o===13){if(o=c(u),o!==null){i.blockedOn=o,hr(i.priority,function(){i2(u)});return}}else if(o===31){if(o=d(u),o!==null){i.blockedOn=o,hr(i.priority,function(){i2(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function gf(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=Nx(i.nativeEvent);if(u===null){u=i.nativeEvent;var p=new u.constructor(u.type,u);Sp=p,u.target.dispatchEvent(p),Sp=null}else return o=ua(u),o!==null&&a2(o),i.blockedOn=u,!1;o.shift()}return!0}function d2(i,o,u){gf(i)&&u.delete(o)}function bI(){Cx=!1,Vi!==null&&gf(Vi)&&(Vi=null),Wi!==null&&gf(Wi)&&(Wi=null),Gi!==null&&gf(Gi)&&(Gi=null),$d.forEach(d2),Ld.forEach(d2)}function xf(i,o){i.blockedOn===o&&(i.blockedOn=null,Cx||(Cx=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bI)))}var bf=null;function u2(i){bf!==i&&(bf=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){bf===i&&(bf=null);for(var o=0;o<i.length;o+=3){var u=i[o],p=i[o+1],y=i[o+2];if(typeof p!="function"){if(Sx(p||u)===null)continue;break}var k=ua(u);k!==null&&(i.splice(o,3),o-=3,Ng(k,{pending:!0,data:y,method:u.method,action:p},p,y))}}))}function Go(i){function o(q){return xf(q,i)}Vi!==null&&xf(Vi,i),Wi!==null&&xf(Wi,i),Gi!==null&&xf(Gi,i),$d.forEach(o),Ld.forEach(o);for(var u=0;u<Ki.length;u++){var p=Ki[u];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Ki.length&&(u=Ki[0],u.blockedOn===null);)c2(u),u.blockedOn===null&&Ki.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var y=u[p],k=u[p+1],O=y[be]||null;if(typeof k=="function")O||u2(u);else if(O){var z=null;if(k&&k.hasAttribute("formAction")){if(y=k,O=k[be]||null)z=O.formAction;else if(Sx(y)!==null)continue}else z=O.action;typeof z=="function"?u[p+1]=z:(u.splice(p,3),p-=3),u2(u)}}}function h2(){function i(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(O){return y=O})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function Ex(i){this._internalRoot=i}vf.prototype.render=Ex.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,p=is();n2(u,p,i,o,null,null)},vf.prototype.unmount=Ex.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;n2(i.current,2,null,i,null,null),Qh(),o[Oe]=null}};function vf(i){this._internalRoot=i}vf.prototype.unstable_scheduleHydration=function(i){if(i){var o=Gt();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ki.length&&o!==0&&o<Ki[u].priority;u++);Ki.splice(u,0,i),u===0&&c2(i)}};var f2=t.version;if(f2!=="19.2.3")throw Error(n(527,f2,"19.2.3"));U.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=f(o),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var vI={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yf.isDisabled&&yf.supportsFiber)try{mt=yf.inject(vI),wt=yf}catch{}}return Ud.createRoot=function(i,o){if(!a(i))throw Error(n(299));var u=!1,p="",y=yk,k=wk,O=jk;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(k=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError)),o=t2(i,1,!1,null,null,u,p,null,y,k,O,h2),i[Oe]=o.current,cx(i),new Ex(o)},Ud.hydrateRoot=function(i,o,u){if(!a(i))throw Error(n(299));var p=!1,y="",k=yk,O=wk,z=jk,q=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(k=u.onUncaughtError),u.onCaughtError!==void 0&&(O=u.onCaughtError),u.onRecoverableError!==void 0&&(z=u.onRecoverableError),u.formState!==void 0&&(q=u.formState)),o=t2(i,1,!0,o,u??null,p,y,q,k,O,z,h2),o.context=r2(null),u=o.current,p=is(),p=Ut(p),y=Di(p),y.callback=null,Mi(u,y,p),u=p,o.current.lanes=u,Ot(o,u),pa(o),i[Oe]=o.current,cx(i),new vf(o)},Ud.version="19.2.3",Ud}var _2;function PI(){if(_2)return Px.exports;_2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Px.exports=OI(),Px.exports}var DI=PI();const MI=vs(DI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),II=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),k2=e=>{const t=II(e);return t.charAt(0).toUpperCase()+t.slice(1)},kE=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),$I=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=v.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:c,...d},h)=>v.createElement("svg",{ref:h,...LI,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:kE("lucide",a),...!l&&!$I(d)&&{"aria-hidden":"true"},...d},[...c.map(([f,m])=>v.createElement(f,m)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=(e,t)=>{const r=v.forwardRef(({className:n,...a},l)=>v.createElement(zI,{ref:l,iconNode:t,className:kE(`lucide-${RI(k2(e))}`,`lucide-${e}`,n),...a}));return r.displayName=k2(e),r};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],si=ce("activity",BI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],NE=ce("arrow-down-right",UI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],FI=ce("arrow-down",qI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],SE=ce("arrow-left",HI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Zl=ce("arrow-right",VI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],GI=ce("arrow-up-down",WI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ou=ce("arrow-up-right",KI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],XI=ce("arrow-up",YI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],sl=ce("award",JI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],ZI=ce("banknote",QI);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],t9=ce("bell-ring",e9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ai=ce("bell",r9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Pu=ce("book-open",n9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],a9=ce("book",s9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],N2=ce("bot",i9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],dw=ce("briefcase",l9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Na=ce("building-2",o9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wn=ce("calendar",c9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],u9=ce("camera",d9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],hc=ce("chart-column",h9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],m9=ce("chart-no-axes-column",f9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],g9=ce("chart-pie",p9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],CE=ce("check-check",x9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b9=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Or=ce("check",b9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Pt=ce("chevron-down",v9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ls=ce("chevron-left",y9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w9=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],j9=ce("chevron-right",w9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _9=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],eo=ce("chevron-up",_9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],cu=ce("circle-alert",k9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m12 8-4 4 4 4",key:"15vm53"}],["path",{d:"M16 12H8",key:"1fr5h0"}]],S9=ce("circle-arrow-left",N9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],uw=ce("circle-check-big",C9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ct=ce("circle-check",E9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],hw=ce("circle-pause",A9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],EE=ce("circle-play",T9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fw=ce("circle-question-mark",O9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],du=ce("circle-x",P9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pr=ce("clock",D9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],R9=ce("code",M9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]],$9=ce("command",I9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],p0=ce("copy",L9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],g0=ce("credit-card",z9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],mw=ce("crown",B9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],q9=ce("database",U9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],AE=ce("dollar-sign",F9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Du=ce("download",H9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V9=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],pw=ce("ellipsis-vertical",V9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W9=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],S2=ce("ellipsis",W9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G9=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],TE=ce("external-link",G9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K9=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],OE=ce("eye-off",K9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y9=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wm=ce("eye",Y9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X9=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],C2=ce("file-exclamation-point",X9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J9=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ps=ce("file-text",J9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q9=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],uu=ce("flame",Q9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],e$=ce("frown",Z9);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],gw=ce("funnel",t$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r$=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],n$=ce("git-merge",r$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],vc=ce("globe",s$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a$=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],xw=ce("grip-vertical",a$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],l$=ce("hash",i$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=[["path",{d:"M12.409 5.824c-.702.792-1.15 1.496-1.415 2.166l2.153 2.156a.5.5 0 0 1 0 .707l-2.293 2.293a.5.5 0 0 0 0 .707L12 15",key:"idzbju"}],["path",{d:"M13.508 20.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.677.6.6 0 0 0 .818.001A5.5 5.5 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5z",key:"1su70f"}]],c$=ce("heart-crack",o$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],PE=ce("headphones",d$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],h$=ce("info",u$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],DE=ce("key",f$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m$=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],x0=ce("layout-dashboard",m$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],g$=ce("layout-grid",p$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x$=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],b$=ce("layout-list",x$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v$=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],ME=ce("layout-template",v$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],su=ce("lightbulb",y$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w$=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],RE=ce("list-todo",w$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j$=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],it=ce("loader-circle",j$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _$=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],b0=ce("lock",_$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k$=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],bw=ce("log-out",k$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N$=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gs=ce("mail",N$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],C$=ce("maximize-2",S$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E$=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],IE=ce("medal",E$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A$=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],T$=ce("menu",A$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O$=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],au=ce("message-circle",O$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P$=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M12 15h.01",key:"q59x07"}],["path",{d:"M12 7v4",key:"xawao1"}]],E2=ce("message-square-warning",P$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D$=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Xn=ce("message-square",D$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M$=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],R$=ce("mic-off",M$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I$=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],$$=ce("mic",I$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L$=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],z$=ce("minimize-2",L$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B$=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],$E=ce("moon",B$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U$=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],q$=ce("octagon-alert",U$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F$=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],H$=ce("palette",F$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],W$=ce("panel-left",V$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]],K$=ce("panel-right",G$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],X$=ce("panels-top-left",Y$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J$=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],LE=ce("paperclip",J$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q$=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Z$=ce("pause",Q$);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eL=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],tL=ce("pen-line",eL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rL=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Mu=ce("pen",rL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nL=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],zE=ce("pencil",nL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sL=[["path",{d:"M13 2a9 9 0 0 1 9 9",key:"1itnx2"}],["path",{d:"M13 6a5 5 0 0 1 5 5",key:"11nki7"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],aL=ce("phone-call",sL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iL=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],BE=ce("phone-off",iL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lL=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ft=ce("phone",lL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oL=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Kl=ce("play",oL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cL=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z",key:"1xoxul"}],["path",{d:"M9 8V2",key:"14iosj"}]],vw=ce("plug",cL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Nn=ce("plus",dL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],hL=ce("quote",uL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],yw=ce("refresh-cw",fL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],pL=ce("repeat",mL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ru=ce("rotate-ccw",gL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ol=ce("save",xL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],na=ce("search",bL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],yc=ce("send",vL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Iu=ce("settings",yL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],jm=ce("shield-alert",wL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_m=ce("shield-check",jL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],km=ce("shield",_L);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],NL=ce("skip-forward",kL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],CL=ce("sliders-vertical",SL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EL=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],UE=ce("smartphone",EL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AL=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Nr=ce("sparkles",AL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ww=ce("square-check-big",TL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],PL=ce("square-pen",OL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ML=ce("square",DL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],IL=ce("sun",RL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],LL=ce("swords",$L);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],vr=ce("target",zL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]],A2=ce("thumbs-down",BL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],qL=ce("timer",UL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],sa=ce("trash-2",FL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Jd=ce("trending-down",HL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Lc=ce("trending-up",VL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_n=ce("triangle-alert",WL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],jw=ce("trophy",GL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],qE=ce("upload",KL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],XL=ce("user-check",YL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],hu=ce("user-plus",JL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Rn=ce("user",QL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Kr=ce("users",ZL);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e7=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Av=ce("volume-2",e7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t7=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],r7=ce("volume-x",t7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n7=[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]],s7=ce("webhook",n7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],i7=ce("wifi-off",a7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l7=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],o7=ce("wifi",l7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Lt=ce("x",c7);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d7=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],al=ce("zap",d7),u7=({activePage:e,onNavigate:t,userRole:r,centerType:n="sales",isOpen:a,onClose:l})=>{const c=[{id:"dashboard",icon:x0,label:" ",page:"dashboard"},{id:"pipeline",icon:g9,label:n==="support"?"":"",page:"pipeline"},{id:"leads",icon:Kr,label:n==="support"?"":"",page:"leads"},{id:"calls",icon:ft,label:"",page:"calls"},{id:"tasks",icon:ww,label:"",page:"tasks"},{id:"chat",icon:Xn,label:"'",page:"chat"},{id:"targets",icon:vr,label:r==="manager"?"":" ",page:"targets"},{id:"gamification",icon:jw,label:"",page:"gamification"},{id:"reports",icon:m9,label:"",page:"dashboard"}],d=h=>{t(h),l()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-40 lg:hidden transition-opacity duration-300 ${a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:l}),s.jsxs("div",{className:`
        fixed lg:relative inset-y-0 right-0 z-50 
        flex flex-col w-64 lg:w-20 
        bg-[#0B1120] border-l lg:border-l-0 lg:border-e border-white/5 
        items-center py-6 shadow-2xl lg:shadow-xl 
        transform transition-transform duration-300 ease-in-out
        ${a?"translate-x-0":"translate-x-full lg:translate-x-0"}
      `,children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-40 bg-gradient-to-b from-brand-500/10 to-transparent pointer-events-none"}),s.jsx("button",{onClick:l,className:"absolute top-4 left-4 p-2 text-slate-400 hover:text-white lg:hidden",children:s.jsx(Lt,{className:"w-6 h-6"})}),s.jsxs("div",{className:"mb-8 p-3 bg-gradient-to-br from-brand-600 to-brand-700 rounded-2xl shadow-lg shadow-brand-500/20 cursor-pointer hover:scale-105 transition-transform duration-200 group relative z-10",onClick:()=>d("dashboard"),children:[s.jsx($9,{className:"w-6 h-6 text-white relative z-10"}),s.jsx("div",{className:"absolute inset-0 rounded-2xl bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity"})]}),s.jsx("nav",{className:"flex-1 flex flex-col gap-2 w-full px-3 relative z-10 overflow-y-auto lg:overflow-visible",children:c.map(h=>{const f=e===h.page&&(h.page!=="dashboard"||h.id==="dashboard");return s.jsxs("button",{onClick:()=>d(h.page),className:`
                  flex items-center lg:flex-col lg:justify-center w-full lg:aspect-square p-3 lg:p-0 rounded-xl lg:rounded-2xl transition-all duration-300 group relative
                  ${f?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-slate-400 hover:text-white hover:bg-white/5"}
                `,title:h.label,children:[s.jsx("div",{className:`transition-transform duration-300 ${f?"scale-110":"group-hover:scale-110"}`,children:s.jsx(h.icon,{className:"w-5 h-5 lg:mx-auto",strokeWidth:f?2.5:2})}),s.jsx("span",{className:`
                  text-sm lg:text-[9px] font-medium mr-4 lg:mr-0 lg:mt-1.5 transition-opacity duration-300 
                  ${f?"text-white":"text-slate-500 group-hover:text-slate-300"}
                `,children:h.label}),f&&s.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 h-8 w-1 bg-brand-400 rounded-l-full lg:left-[-4px] lg:right-auto lg:w-1 lg:h-8 lg:rounded-r-full shadow-[0_0_12px_rgba(129,140,248,0.5)]"})]},h.id)})}),s.jsxs("div",{className:"mt-auto px-3 w-full flex flex-col gap-3",children:[s.jsxs("button",{onClick:()=>d("settings"),className:`
              flex items-center lg:flex-col lg:justify-center w-full lg:aspect-square p-3 lg:p-0 rounded-xl lg:rounded-2xl transition-all
              ${e==="settings"?"bg-white/10 text-white border border-white/5":"text-slate-400 hover:text-slate-200 hover:bg-white/5"}
            `,children:[s.jsx(Iu,{className:"w-5 h-5 lg:mx-auto"}),s.jsx("span",{className:"lg:hidden text-sm font-medium mr-4",children:""})]}),s.jsx("div",{className:"w-full lg:w-8 h-px bg-white/10 mx-auto my-1"}),s.jsxs("div",{className:"w-full flex lg:justify-center px-2 lg:px-0 items-center gap-3 lg:gap-0",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-tr from-slate-700 to-slate-600 border border-white/10 shadow-sm flex-shrink-0"}),s.jsx("span",{className:"lg:hidden text-sm text-slate-300",children:" "})]})]})]})]})};var Tv=function(e,t){return Tv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Tv(e,t)};function FE(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Tv(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var v0=function(){return v0=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},v0.apply(this,arguments)};function zc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function HE(e,t,r,n){var a=arguments.length,l=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,n);else for(var d=e.length-1;d>=0;d--)(c=e[d])&&(l=(a<3?c(l):a>3?c(t,r,l):c(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function VE(e,t){return function(r,n){t(r,n,e)}}function WE(e,t,r,n,a,l){function c(N){if(N!==void 0&&typeof N!="function")throw new TypeError("Function expected");return N}for(var d=n.kind,h=d==="getter"?"get":d==="setter"?"set":"value",f=!t&&e?n.static?e:e.prototype:null,m=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),g,x=!1,b=r.length-1;b>=0;b--){var j={};for(var w in n)j[w]=w==="access"?{}:n[w];for(var w in n.access)j.access[w]=n.access[w];j.addInitializer=function(N){if(x)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(N||null))};var _=(0,r[b])(d==="accessor"?{get:m.get,set:m.set}:m[h],j);if(d==="accessor"){if(_===void 0)continue;if(_===null||typeof _!="object")throw new TypeError("Object expected");(g=c(_.get))&&(m.get=g),(g=c(_.set))&&(m.set=g),(g=c(_.init))&&a.unshift(g)}else(g=c(_))&&(d==="field"?a.unshift(g):m[h]=g)}f&&Object.defineProperty(f,n.name,m),x=!0}function GE(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function KE(e){return typeof e=="symbol"?e:"".concat(e)}function YE(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function XE(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ce(e,t,r,n){function a(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(m){try{f(n.next(m))}catch(g){c(g)}}function h(m){try{f(n.throw(m))}catch(g){c(g)}}function f(m){m.done?l(m.value):a(m.value).then(d,h)}f((n=n.apply(e,t||[])).next())})}function JE(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(f){return function(m){return h([f,m])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,f[0]&&(r=0)),r;)try{if(n=1,a&&(l=f[0]&2?a.return:f[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,f[1])).done)return l;switch(a=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,a=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){r.label=f[1];break}if(f[0]===6&&r.label<l[1]){r.label=l[1],l=f;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(f);break}l[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(m){f=[6,m],a=0}finally{n=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Nm=Object.create?(function(e,t,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}):(function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]});function QE(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Nm(t,e,r)}function y0(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function _w(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,l=[],c;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)l.push(a.value)}catch(d){c={error:d}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return l}function ZE(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_w(arguments[t]));return e}function eA(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var l=arguments[t],c=0,d=l.length;c<d;c++,a++)n[a]=l[c];return n}function tA(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}function wc(e){return this instanceof wc?(this.v=e,this):new wc(e)}function rA(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(b){return function(j){return Promise.resolve(j).then(b,g)}}function d(b,j){n[b]&&(a[b]=function(w){return new Promise(function(_,N){l.push([b,w,_,N])>1||h(b,w)})},j&&(a[b]=j(a[b])))}function h(b,j){try{f(n[b](j))}catch(w){x(l[0][3],w)}}function f(b){b.value instanceof wc?Promise.resolve(b.value.v).then(m,g):x(l[0][2],b)}function m(b){h("next",b)}function g(b){h("throw",b)}function x(b,j){b(j),l.shift(),l.length&&h(l[0][0],l[0][1])}}function nA(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,l){t[a]=e[a]?function(c){return(r=!r)?{value:wc(e[a](c)),done:!1}:l?l(c):c}:l}}function sA(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof y0=="function"?y0(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=e[l]&&function(c){return new Promise(function(d,h){c=e[l](c),a(d,h,c.done,c.value)})}}function a(l,c,d,h){Promise.resolve(h).then(function(f){l({value:f,done:d})},c)}}function aA(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var h7=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},Ov=function(e){return Ov=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Ov(e)};function iA(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Ov(e),n=0;n<r.length;n++)r[n]!=="default"&&Nm(t,e,r[n]);return h7(t,e),t}function lA(e){return e&&e.__esModule?e:{default:e}}function oA(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function cA(e,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,r):a?a.value=r:t.set(e,r),r}function dA(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function uA(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var f7=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function hA(e){function t(l){e.error=e.hasError?new f7(l,e.error,"An error was suppressed during disposal."):l,e.hasError=!0}var r,n=0;function a(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var l=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(l).then(a,function(c){return t(c),a()})}else n|=1}catch(c){t(c)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return a()}function fA(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,a,l,c){return n?t?".jsx":".js":a&&(!l||!c)?r:a+l+"."+c.toLowerCase()+"js"}):e}const m7={__extends:FE,__assign:v0,__rest:zc,__decorate:HE,__param:VE,__esDecorate:WE,__runInitializers:GE,__propKey:KE,__setFunctionName:YE,__metadata:XE,__awaiter:Ce,__generator:JE,__createBinding:Nm,__exportStar:QE,__values:y0,__read:_w,__spread:ZE,__spreadArrays:eA,__spreadArray:tA,__await:wc,__asyncGenerator:rA,__asyncDelegator:nA,__asyncValues:sA,__makeTemplateObject:aA,__importStar:iA,__importDefault:lA,__classPrivateFieldGet:oA,__classPrivateFieldSet:cA,__classPrivateFieldIn:dA,__addDisposableResource:uA,__disposeResources:hA,__rewriteRelativeImportExtension:fA},p7=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:uA,get __assign(){return v0},__asyncDelegator:nA,__asyncGenerator:rA,__asyncValues:sA,__await:wc,__awaiter:Ce,__classPrivateFieldGet:oA,__classPrivateFieldIn:dA,__classPrivateFieldSet:cA,__createBinding:Nm,__decorate:HE,__disposeResources:hA,__esDecorate:WE,__exportStar:QE,__extends:FE,__generator:JE,__importDefault:lA,__importStar:iA,__makeTemplateObject:aA,__metadata:XE,__param:VE,__propKey:KE,__read:_w,__rest:zc,__rewriteRelativeImportExtension:fA,__runInitializers:GE,__setFunctionName:YE,__spread:ZE,__spreadArray:tA,__spreadArrays:eA,__values:y0,default:m7},Symbol.toStringTag,{value:"Module"})),g7=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Sm extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class mA extends Sm{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Pv extends Sm{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Dv extends Sm{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var w0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(w0||(w0={}));class x7{constructor(t,{headers:r={},customFetch:n,region:a=w0.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=g7(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ce(this,arguments,void 0,function*(r,n={}){var a;let l,c;try{const{headers:d,method:h,body:f,signal:m,timeout:g}=n;let x={},{region:b}=n;b||(b=this.region);const j=new URL(`${this.url}/${r}`);b&&b!=="any"&&(x["x-region"]=b,j.searchParams.set("forceFunctionRegion",b));let w;f&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",w=f):typeof f=="string"?(x["Content-Type"]="text/plain",w=f):typeof FormData<"u"&&f instanceof FormData?w=f:(x["Content-Type"]="application/json",w=JSON.stringify(f)):w=f;let _=m;g&&(c=new AbortController,l=setTimeout(()=>c.abort(),g),m?(_=c.signal,m.addEventListener("abort",()=>c.abort())):_=c.signal);const N=yield this.fetch(j.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),d),body:w,signal:_}).catch(S=>{throw new mA(S)}),C=N.headers.get("x-relay-error");if(C&&C==="true")throw new Pv(N);if(!N.ok)throw new Dv(N);let A=((a=N.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),E;return A==="application/json"?E=yield N.json():A==="application/octet-stream"||A==="application/pdf"?E=yield N.blob():A==="text/event-stream"?E=N:A==="multipart/form-data"?E=yield N.formData():E=yield N.text(),{data:E,error:null,response:N}}catch(d){return{data:null,error:d,response:d instanceof Dv||d instanceof Pv?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var Cn={};const Bc=_I(p7);var wf={},jf={},_f={},kf={},Nf={},Sf={},T2;function pA(){if(T2)return Sf;T2=1,Object.defineProperty(Sf,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Sf.default=e,Sf}var O2;function gA(){if(O2)return Nf;O2=1,Object.defineProperty(Nf,"__esModule",{value:!0});const t=Bc.__importDefault(pA());class r{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var f,m,g,x;let b=null,j=null,w=null,_=h.status,N=h.statusText;if(h.ok){if(this.method!=="HEAD"){const S=await h.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?j=S:j=JSON.parse(S))}const A=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),E=(g=h.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");A&&E&&E.length>1&&(w=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(b={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,w=null,_=406,N="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const A=await h.text();try{b=JSON.parse(A),Array.isArray(b)&&h.status===404&&(j=[],b=null,_=200,N="OK")}catch{h.status===404&&A===""?(_=204,N="No Content"):b={message:A}}if(b&&this.isMaybeSingle&&(!((x=b==null?void 0:b.details)===null||x===void 0)&&x.includes("0 rows"))&&(b=null,_=200,N="OK"),b&&this.shouldThrowOnError)throw new t.default(b)}return{error:b,data:j,count:w,status:_,statusText:N}});return this.shouldThrowOnError||(d=d.catch(h=>{var f,m,g,x,b,j;let w="";const _=h==null?void 0:h.cause;if(_){const N=(f=_==null?void 0:_.message)!==null&&f!==void 0?f:"",C=(m=_==null?void 0:_.code)!==null&&m!==void 0?m:"";w=`${(g=h==null?void 0:h.name)!==null&&g!==void 0?g:"FetchError"}: ${h==null?void 0:h.message}`,w+=`

Caused by: ${(x=_==null?void 0:_.name)!==null&&x!==void 0?x:"Error"}: ${N}`,C&&(w+=` (${C})`),_!=null&&_.stack&&(w+=`
${_.stack}`)}else w=(b=h==null?void 0:h.stack)!==null&&b!==void 0?b:"";return{error:{message:`${(j=h==null?void 0:h.name)!==null&&j!==void 0?j:"FetchError"}: ${h==null?void 0:h.message}`,details:w,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return Nf.default=r,Nf}var P2;function xA(){if(P2)return kf;P2=1,Object.defineProperty(kf,"__esModule",{value:!0});const t=Bc.__importDefault(gA());class r extends t.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:h=d}={}){const f=h?`${h}.order`:"order",m=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${m?`${m},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const h=typeof d>"u"?"offset":`${d}.offset`,f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(h,`${a}`),this.url.searchParams.set(f,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:h=!1,format:f="text"}={}){var m;const g=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,h?"wal":null].filter(Boolean).join("|"),x=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${x}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return kf.default=r,kf}var D2;function kw(){if(D2)return _f;D2=1,Object.defineProperty(_f,"__esModule",{value:!0});const t=Bc.__importDefault(xA()),r=new RegExp("[,()]");class n extends t.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}regexMatch(l,c){return this.url.searchParams.append(l,`match.${c}`),this}regexIMatch(l,c){return this.url.searchParams.append(l,`imatch.${c}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}isDistinct(l,c){return this.url.searchParams.append(l,`isdistinct.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map(h=>typeof h=="string"&&r.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:h}={}){let f="";h==="plain"?f="pl":h==="phrase"?f="ph":h==="websearch"&&(f="w");const m=d===void 0?"":`(${d})`;return this.url.searchParams.append(l,`${f}fts${m}.${c}`),this}match(l){return Object.entries(l).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}}return _f.default=n,_f}var M2;function bA(){if(M2)return jf;M2=1,Object.defineProperty(jf,"__esModule",{value:!0});const t=Bc.__importDefault(kw());class r{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,l){const{head:c=!1,count:d}=l??{},h=c?"HEAD":"GET";let f=!1;const m=(a??"*").split("").map(g=>/\s/.test(g)&&!f?"":(g==='"'&&(f=!f),g)).join("");return this.url.searchParams.set("select",m),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const f=a.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(f.length>0){const m=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",m.join(","))}}return new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:h=!0}={}){var f;const m="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const g=a.reduce((x,b)=>x.concat(Object.keys(b)),[]);if(g.length>0){const x=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",x.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return jf.default=r,jf}var R2;function b7(){if(R2)return wf;R2=1,Object.defineProperty(wf,"__esModule",{value:!0});const e=Bc,t=e.__importDefault(bA()),r=e.__importDefault(kw());class n{constructor(l,{headers:c={},schema:d,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=h}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:h=!1,count:f}={}){var m;let g;const x=new URL(`${this.url}/rpc/${l}`);let b;d||h?(g=d?"HEAD":"GET",Object.entries(c).filter(([w,_])=>_!==void 0).map(([w,_])=>[w,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([w,_])=>{x.searchParams.append(w,_)})):(g="POST",b=c);const j=new Headers(this.headers);return f&&j.set("Prefer",`count=${f}`),new r.default({method:g,url:x,headers:j,schema:this.schemaName,body:b,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return wf.default=n,wf}var I2;function v7(){if(I2)return Cn;I2=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.PostgrestError=Cn.PostgrestBuilder=Cn.PostgrestTransformBuilder=Cn.PostgrestFilterBuilder=Cn.PostgrestQueryBuilder=Cn.PostgrestClient=void 0;const e=Bc,t=e.__importDefault(b7());Cn.PostgrestClient=t.default;const r=e.__importDefault(bA());Cn.PostgrestQueryBuilder=r.default;const n=e.__importDefault(kw());Cn.PostgrestFilterBuilder=n.default;const a=e.__importDefault(xA());Cn.PostgrestTransformBuilder=a.default;const l=e.__importDefault(gA());Cn.PostgrestBuilder=l.default;const c=e.__importDefault(pA());return Cn.PostgrestError=c.default,Cn.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Cn}var vA=v7();const yA=vs(vA),y7=cw({__proto__:null,default:yA},[vA]),{PostgrestClient:w7,PostgrestQueryBuilder:Wde,PostgrestFilterBuilder:Gde,PostgrestTransformBuilder:Kde,PostgrestBuilder:Yde,PostgrestError:j7}=yA||y7;class wA{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const _7="2.87.3",k7=`realtime-js/${_7}`,jA="1.0.0",N7="2.0.0",$2=jA,Mv=1e4,S7=1e3,C7=100;var zl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(zl||(zl={}));var Lr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Lr||(Lr={}));var Js;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Js||(Js={}));var Rv;(function(e){e.websocket="websocket"})(Rv||(Rv={}));var Bl;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Bl||(Bl={}));class E7{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,n){var a,l;const c=t.topic,d=(a=t.ref)!==null&&a!==void 0?a:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",f=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(m).length===0?"":JSON.stringify(m);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+d.length+c.length+f.length+g.length,b=new ArrayBuffer(this.HEADER_LENGTH+x);let j=new DataView(b),w=0;j.setUint8(w++,this.KINDS.userBroadcastPush),j.setUint8(w++,h.length),j.setUint8(w++,d.length),j.setUint8(w++,c.length),j.setUint8(w++,f.length),j.setUint8(w++,g.length),j.setUint8(w++,r),Array.from(h,N=>j.setUint8(w++,N.charCodeAt(0))),Array.from(d,N=>j.setUint8(w++,N.charCodeAt(0))),Array.from(c,N=>j.setUint8(w++,N.charCodeAt(0))),Array.from(f,N=>j.setUint8(w++,N.charCodeAt(0))),Array.from(g,N=>j.setUint8(w++,N.charCodeAt(0)));var _=new Uint8Array(b.byteLength+n.byteLength);return _.set(new Uint8Array(b),0),_.set(new Uint8Array(n),b.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,l,c,d,h]=n;return r({join_ref:a,ref:l,topic:c,event:d,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),l=r.getUint8(2),c=r.getUint8(3),d=r.getUint8(4);let h=this.HEADER_LENGTH+4;const f=n.decode(t.slice(h,h+a));h=h+a;const m=n.decode(t.slice(h,h+l));h=h+l;const g=n.decode(t.slice(h,h+c));h=h+c;const x=t.slice(h,t.byteLength),b=d===this.JSON_ENCODING?JSON.parse(n.decode(x)):x,j={type:this.BROADCAST_EVENT,event:m,payload:b};return c>0&&(j.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:j}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class _A{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(nr||(nr={}));const L2=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=A7(c,e,t,a),l),{}):{}},A7=(e,t,r,n)=>{const a=t.find(d=>d.name===e),l=a==null?void 0:a.type,c=r[e];return l&&!n.includes(l)?kA(l,c):Iv(c)},kA=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return D7(t,r)}switch(e){case nr.bool:return T7(t);case nr.float4:case nr.float8:case nr.int2:case nr.int4:case nr.int8:case nr.numeric:case nr.oid:return O7(t);case nr.json:case nr.jsonb:return P7(t);case nr.timestamp:return M7(t);case nr.abstime:case nr.date:case nr.daterange:case nr.int4range:case nr.int8range:case nr.money:case nr.reltime:case nr.text:case nr.time:case nr.timestamptz:case nr.timetz:case nr.tsrange:case nr.tstzrange:return Iv(t);default:return Iv(t)}},Iv=e=>e,T7=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},O7=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},P7=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},D7=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>kA(t,d))}return e},M7=e=>typeof e=="string"?e.replace(" ","T"):e,NA=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ix{constructor(t,r,n={},a=Mv){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var $v;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})($v||($v={}));class fc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(h=>{this.state=fc.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=fc.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const l=this.cloneDeep(t),c=this.transformState(r),d={},h={};return this.map(l,(f,m)=>{c[f]||(h[f]=m)}),this.map(c,(f,m)=>{const g=l[f];if(g){const x=m.map(_=>_.presence_ref),b=g.map(_=>_.presence_ref),j=m.filter(_=>b.indexOf(_.presence_ref)<0),w=g.filter(_=>x.indexOf(_.presence_ref)<0);j.length>0&&(d[f]=j),w.length>0&&(h[f]=w)}else d[f]=m}),this.syncDiff(l,{joins:d,leaves:h},n,a)}static syncDiff(t,r,n,a){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(d,h)=>{var f;const m=(f=t[d])!==null&&f!==void 0?f:[];if(t[d]=this.cloneDeep(h),m.length>0){const g=t[d].map(b=>b.presence_ref),x=m.filter(b=>g.indexOf(b.presence_ref)<0);t[d].unshift(...x)}n(d,m,h)}),this.map(c,(d,h)=>{let f=t[d];if(!f)return;const m=h.map(g=>g.presence_ref);f=f.filter(g=>m.indexOf(g.presence_ref)<0),t[d]=f,a(d,f,h),f.length===0&&delete t[d]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Lv||(Lv={}));var mc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(mc||(mc={}));var xa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(xa||(xa={}));const R7=Lr;class Ul{constructor(t,r={config:{}},n){var a,l;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Lr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ix(this,Js.join,this.params,this.timeout),this.rejoinTimer=new _A(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Lr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Lr.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Lr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Js.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new fc(this),this.broadcastEndpointURL=NA(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Lr.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params,f=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(b=>b.filter))!==null&&a!==void 0?a:[],m=!!this.bindings[mc.PRESENCE]&&this.bindings[mc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},x={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:m}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>t==null?void 0:t(xa.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(xa.CLOSED)),this.updateJoinPayload(Object.assign({config:x},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var j;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t==null||t(xa.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,_=(j=w==null?void 0:w.length)!==null&&j!==void 0?j:0,N=[];for(let C=0;C<_;C++){const A=w[C],{filter:{event:E,schema:S,table:T,filter:D}}=A,P=b&&b[C];if(P&&P.event===E&&Ul.isFilterValueEqual(P.schema,S)&&Ul.isFilterValueEqual(P.table,T)&&Ul.isFilterValueEqual(P.filter,D))N.push(Object.assign(Object.assign({},A),{id:P.id}));else{this.unsubscribe(),this.state=Lr.errored,t==null||t(xa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,t&&t(xa.SUBSCRIBED);return}}).receive("error",b=>{this.state=Lr.errored,t==null||t(xa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(xa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Lr.joined&&t===mc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let h=d.statusText;try{const f=await d.json();h=f.error||f.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,h;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Lr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Js.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Ix(this,Js.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Lr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(l),c}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ix(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>C7){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,l;const c=t.toLocaleLowerCase(),{close:d,error:h,leave:f,join:m}=Js;if(n&&[d,h,f,m].indexOf(c)>=0&&n!==this._joinRef())return;let x=this._onMessage(c,r,n);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(b=>{var j,w,_;return((j=b.filter)===null||j===void 0?void 0:j.event)==="*"||((_=(w=b.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===c}).map(b=>b.callback(x,n)):(l=this.bindings[c])===null||l===void 0||l.filter(b=>{var j,w,_,N,C,A;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const E=b.id,S=(j=b.filter)===null||j===void 0?void 0:j.event;return E&&((w=r.ids)===null||w===void 0?void 0:w.includes(E))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const E=(C=(N=b==null?void 0:b.filter)===null||N===void 0?void 0:N.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return E==="*"||E===((A=r==null?void 0:r.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof x=="object"&&"ids"in x){const j=x.data,{schema:w,table:_,commit_timestamp:N,type:C,errors:A}=j;x=Object.assign(Object.assign({},{schema:w,table:_,commit_timestamp:N,eventType:C,new:{},old:{},errors:A}),this._getPayloadRecords(j))}b.callback(x,n)})}_isClosed(){return this.state===Lr.closed}_isJoined(){return this.state===Lr.joined}_isJoining(){return this.state===Lr.joining}_isLeaving(){return this.state===Lr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),l={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Ul.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Js.close,{},t)}_onError(t){this._on(Js.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Lr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=L2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=L2(t.columns,t.old_record)),r}}const $x=()=>{},Cf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},I7=[1e3,2e3,5e3,1e4],$7=1e4,L7=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class SA{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Mv,this.transport=null,this.heartbeatIntervalMs=Cf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$x,this.ref=0,this.reconnectTimer=null,this.vsn=$2,this.logger=$x,this.conn=null,this.sendBuffer=[],this.serializer=new E7,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Rv.websocket}`,this.httpEndpoint=NA(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=wA.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case zl.connecting:return Bl.Connecting;case zl.open:return Bl.Open;case zl.closing:return Bl.Closing;default:return Bl.Closed}}isConnected(){return this.connectionState()===Bl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new Ul(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:a,ref:l}=t,c=()=>{this.encode(t,d=>{var h;(h=this.conn)===null||h===void 0||h.send(d)})};this.log("push",`${r} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(S7,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Cf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:l,ref:c}=r,d=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${n} ${a} ${d}`.trim(),l),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(a,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===zl.open||this.conn.readyState===zl.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Js.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([L7],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const l={access_token:r,version:k7};r&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(Js.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new _A(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Cf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,l,c,d,h,f,m,g,x,b;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Mv,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Cf.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t==null?void 0:t.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=t==null?void 0:t.heartbeatCallback)!==null&&d!==void 0?d:$x,this.vsn=(h=t==null?void 0:t.vsn)!==null&&h!==void 0?h:$2,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t==null?void 0:t.reconnectAfterMs)!==null&&f!==void 0?f:(j=>I7[j-1]||$7),this.vsn){case jA:this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((j,w)=>w(JSON.stringify(j))),this.decode=(g=t==null?void 0:t.decode)!==null&&g!==void 0?g:((j,w)=>w(JSON.parse(j)));break;case N7:this.encode=(x=t==null?void 0:t.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(b=t==null?void 0:t.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Cm extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function br(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class z7 extends Cm{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class zv extends Cm{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const Nw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),B7=()=>Response,Bv=e=>{if(Array.isArray(e))return e.map(r=>Bv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=Bv(n)}),t},U7=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},q7=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),Lx=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},F7=(e,t,r)=>Ce(void 0,void 0,void 0,function*(){const n=yield B7();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const l=e.status||500,c=(a==null?void 0:a.statusCode)||l+"";t(new z7(Lx(a),l,c))}).catch(a=>{t(new zv(Lx(a),a))}):t(new zv(Lx(e),e))}),H7=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(U7(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function $u(e,t,r,n,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{e(r,H7(t,n,a,l)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>F7(h,d,n))})})}function fu(e,t,r,n){return Ce(this,void 0,void 0,function*(){return $u(e,"GET",t,r,n)})}function Ys(e,t,r,n,a){return Ce(this,void 0,void 0,function*(){return $u(e,"POST",t,n,a,r)})}function Uv(e,t,r,n,a){return Ce(this,void 0,void 0,function*(){return $u(e,"PUT",t,n,a,r)})}function V7(e,t,r,n){return Ce(this,void 0,void 0,function*(){return $u(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Sw(e,t,r,n,a){return Ce(this,void 0,void 0,function*(){return $u(e,"DELETE",t,n,a,r)})}class W7{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(br(t))return{data:null,error:t};throw t}})}}var CA;class G7{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[CA]="BlobDownloadBuilder",this.promise=null}asStream(){return new W7(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(br(t))return{data:null,error:t};throw t}})}}CA=Symbol.toStringTag;const K7={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},z2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Y7{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Nw(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Ce(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},z2),a);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(h))):(l=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,h&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a!=null&&a.headers&&(d=Object.assign(Object.assign({},d),a.headers));const f=this._removeEmptyFolders(r),m=this._getFinalPath(f),g=yield(t=="PUT"?Uv:Ys)(this.fetch,`${this.url}/object/${m}`,l,Object.assign({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(br(l))return{data:null,error:l};throw l}})}upload(t,r,n){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Ce(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",r);try{let h;const f=Object.assign({upsert:z2.upsert},a),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",f.cacheControl)):(h=n,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType);const g=yield Uv(this.fetch,d.toString(),h,{headers:m});return{data:{path:l,fullPath:g.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(br(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t,r){return Ce(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const l=yield Ys(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Cm("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:d},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(br(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ys(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Ce(this,void 0,void 0,function*(){try{return{data:{path:(yield Ys(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Ce(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield Ys(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Ce(this,void 0,void 0,function*(){try{const a=yield Ys(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),c=l?`?${l}`:"",d=this._getFinalPath(t),h=()=>fu(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new G7(h,this.shouldThrowOnError)}info(t){return Ce(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield fu(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Bv(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(br(n))return{data:null,error:n};throw n}})}exists(t){return Ce(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield V7(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(br(n)&&n instanceof zv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&a.push(l);const d=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});h!==""&&a.push(h);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${f}`)}}}remove(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Sw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ce(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},K7),r),{prefix:t||""});return{data:yield Ys(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}listV2(t,r){return Ce(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ys(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(br(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const EA="2.87.3",AA={"X-Client-Info":`storage-js/${EA}`};class X7{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const l=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},AA),r),this.fetch=Nw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ce(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield fu(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}getBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield fu(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}createBucket(t){return Ce(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Ys(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(br(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Ce(this,void 0,void 0,function*(){try{return{data:yield Uv(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(br(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ys(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Sw(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var mu=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function J7(e,t,r){const n=new URL(t,e);if(r)for(const[a,l]of Object.entries(r))l!==void 0&&n.searchParams.set(a,l);return n.toString()}async function Q7(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Z7(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:l,headers:c}){const d=J7(e.baseUrl,n,a),h=await Q7(e.auth),f=await t(d,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),m=await f.text(),g=(f.headers.get("content-type")||"").includes("application/json"),x=g&&m?JSON.parse(m):m;if(!f.ok){const b=g?x:void 0,j=b==null?void 0:b.error;throw new mu((j==null?void 0:j.message)??`Request failed with status ${f.status}`,{status:f.status,icebergType:j==null?void 0:j.type,icebergCode:j==null?void 0:j.code,details:b})}return{status:f.status,headers:f.headers,data:x}}}}function Ef(e){return e.join("")}var ez=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Ef(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ef(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ef(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ef(e.namespace)}`}),!0}catch(t){if(t instanceof mu&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof mu&&r.status===409)return;throw r}}};function Ko(e){return e.join("")}var tz=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ko(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof mu&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof mu&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},rz=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Z7({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new ez(this.client,t),this.tableOps=new tz(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class nz{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},AA),r),this.fetch=Nw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ys(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ce(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),a=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield fu(this.fetch,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Sw(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(br(r))return{data:null,error:r};throw r}})}from(t){if(!q7(t))throw new Cm("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new rz({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:()=>Ce(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(l,c){const d=l[c];return typeof d!="function"?d:(...h)=>Ce(this,void 0,void 0,function*(){try{return{data:yield d.apply(l,h),error:null}}catch(f){if(n)throw f;return{data:null,error:f}}})}})}}const Cw={"X-Client-Info":`storage-js/${EA}`,"Content-Type":"application/json"};class TA extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ds(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class zx extends TA{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sz extends TA{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var B2;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(B2||(B2={}));const Ew=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),az=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},U2=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iz=(e,t,r)=>Ce(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e.status||500,l=e;if(typeof l.json=="function")l.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||a+"";t(new zx(U2(c),a,d))}).catch(()=>{const c=a+"",d=l.statusText||`HTTP ${a} error`;t(new zx(d,a,c))});else{const c=a+"",d=l.statusText||`HTTP ${a} error`;t(new zx(d,a,c))}}else t(new sz(U2(e),e))}),lz=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(az(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function oz(e,t,r,n,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{e(r,lz(t,n,a,l)).then(h=>{if(!h.ok)throw h;if(n!=null&&n.noResolveJson)return h;const f=h.headers.get("content-type");return!f||!f.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>iz(h,d,n))})})}function us(e,t,r,n,a){return Ce(this,void 0,void 0,function*(){return oz(e,"POST",t,n,a,r)})}class cz{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Cw),r),this.fetch=Ew(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ce(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ce(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ds(n))return{data:null,error:n};throw n}})}listIndexes(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ce(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ds(n))return{data:null,error:n};throw n}})}}class dz{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Cw),r),this.fetch=Ew(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ce(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield us(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}getVectors(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}listVectors(t){return Ce(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield us(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ce(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield us(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}}class uz{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Cw),r),this.fetch=Ew(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}getBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}listBuckets(){return Ce(this,arguments,void 0,function*(t={}){try{return{data:yield us(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ds(r))return{data:null,error:r};throw r}})}}class hz extends uz{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new fz(this.url,this.headers,t,this.fetch)}createBucket(t){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Ce(this,void 0,void 0,function*(){return r.createBucket.call(this,t)})}getBucket(t){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Ce(this,void 0,void 0,function*(){return r.getBucket.call(this,t)})}listBuckets(){const t=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Ce(this,arguments,void 0,function*(r={}){return t.listBuckets.call(this,r)})}deleteBucket(t){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Ce(this,void 0,void 0,function*(){return r.deleteBucket.call(this,t)})}}class fz extends cz{constructor(t,r,n,a){super(t,r,a),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ce(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ce(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ce(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ce(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new mz(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class mz extends dz{constructor(t,r,n,a,l){super(t,r,l),this.vectorBucketName=n,this.indexName=a}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ce(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ce(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ce(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ce(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ce(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class pz extends X7{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Y7(this.url,this.headers,t,this.fetch)}get vectors(){return new hz(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new nz(this.url+"/iceberg",this.headers,this.fetch)}}const gz="2.87.3";let Qd="";typeof Deno<"u"?Qd="deno":typeof document<"u"?Qd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qd="react-native":Qd="node";const xz={"X-Client-Info":`supabase-js-${Qd}/${gz}`},bz={headers:xz},vz={schema:"public"},yz={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wz={},jz=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),_z=()=>Headers,kz=(e,t,r)=>{const n=jz(r),a=_z();return async(l,c)=>{var d;const h=(d=await t())!==null&&d!==void 0?d:e;let f=new a(c==null?void 0:c.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),n(l,Object.assign(Object.assign({},c),{headers:f}))}};function Nz(e){return e.endsWith("/")?e:e+"/"}function Sz(e,t){var r,n;const{db:a,auth:l,realtime:c,global:d}=e,{db:h,auth:f,realtime:m,global:g}=t,x={db:Object.assign(Object.assign({},h),a),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},m),c),storage:{},global:Object.assign(Object.assign(Object.assign({},g),d),{headers:Object.assign(Object.assign({},(r=g==null?void 0:g.headers)!==null&&r!==void 0?r:{}),(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?x.accessToken=e.accessToken:delete x.accessToken,x}function Cz(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Nz(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const OA="2.87.3",nc=30*1e3,qv=3,Bx=qv*nc,Ez="http://localhost:9999",Az="supabase.auth.token",Tz={"X-Client-Info":`gotrue-js/${OA}`},Fv="X-Supabase-Api-Version",PA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Oz=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Pz=600*1e3;class jc extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function He(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class DA extends jc{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function MA(e){return He(e)&&e.name==="AuthApiError"}class el extends jc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Sa extends jc{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Wn extends Sa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function RA(e){return He(e)&&e.name==="AuthSessionMissingError"}class Dl extends Sa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zd extends Sa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class eu extends Sa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function IA(e){return He(e)&&e.name==="AuthImplicitGrantRedirectError"}class Hv extends Sa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $A extends Sa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}function Dz(e){return He(e)&&e.name==="AuthPKCECodeVerifierMissingError"}class j0 extends Sa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function t0(e){return He(e)&&e.name==="AuthRetryableFetchError"}class Vv extends Sa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}function Mz(e){return He(e)&&e.name==="AuthWeakPasswordError"}class _0 extends Sa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const k0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),q2=` 	
\r=`.split(""),Rz=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<q2.length;t+=1)e[q2[t].charCodeAt(0)]=-2;for(let t=0;t<k0.length;t+=1)e[k0[t].charCodeAt(0)]=t;return e})();function F2(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(k0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(k0[n]),t.queuedBits-=6}}function LA(e,t,r){const n=Rz[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function H2(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{Lz(c,n,r)};for(let c=0;c<e.length;c+=1)LA(e.charCodeAt(c),a,l);return t.join("")}function Iz(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function $z(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Iz(n,t)}}function Lz(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function pc(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)LA(e.charCodeAt(a),r,n);return new Uint8Array(t)}function zz(e){const t=[];return $z(e,r=>t.push(r)),new Uint8Array(t)}function ql(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>F2(a,r,n)),F2(null,r,n),t.join("")}function Bz(e){return Math.round(Date.now()/1e3)+e}function Uz(){return Symbol("auth-callback")}const xn=()=>typeof window<"u"&&typeof document<"u",Al={tested:!1,writable:!1},zA=()=>{if(!xn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Al.tested)return Al.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Al.tested=!0,Al.writable=!0}catch{Al.tested=!0,Al.writable=!1}return Al.writable};function qz(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const BA=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Fz=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",sc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Tl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},gn=async(e,t)=>{await e.removeItem(t)};let UA=class qA{constructor(){this.promise=new qA.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}};UA.promiseConstructor=Promise;function Ux(e){const t=e.split(".");if(t.length!==3)throw new _0("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Oz.test(t[n]))throw new _0("JWT not in base64url format");return{header:JSON.parse(H2(t[0])),payload:JSON.parse(H2(t[1])),signature:pc(t[2]),raw:{header:t[0],payload:t[1]}}}async function Hz(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Vz(e,t){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){n(c);return}}catch(c){if(!t(l,c)){a(c);return}}})()})}function Wz(e){return("0"+e.toString(16)).substr(-2)}function Gz(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let l=0;l<56;l++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Wz).join("")}async function Kz(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function Yz(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Kz(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Yo(e,t,r=!1){const n=Gz();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await sc(e,`${t}-code-verifier`,a);const l=await Yz(n);return[l,n===l?"plain":"s256"]}const Xz=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Jz(e){const t=e.headers.get(Fv);if(!t||!t.match(Xz))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Qz(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Zz(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const eB=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Xo(e){if(!eB.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function qx(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tB(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function V2(e){return JSON.parse(JSON.stringify(e))}const Ml=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),rB=[502,503,504];async function W2(e){var t;if(!Fz(e))throw new j0(Ml(e),0);if(rB.includes(e.status))throw new j0(Ml(e),e.status);let r;try{r=await e.json()}catch(l){throw new el(Ml(l),l)}let n;const a=Jz(e);if(a&&a.getTime()>=PA["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Vv(Ml(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Wn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Vv(Ml(r),e.status,r.weak_password.reasons);throw new DA(Ml(r),e.status||500,n)}const nB=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ze(e,t,r,n){var a;const l=Object.assign({},n==null?void 0:n.headers);l[Fv]||(l[Fv]=PA["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await sB(e,t,r+d,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(h):{data:Object.assign({},h),error:null}}async function sB(e,t,r,n,a,l){const c=nB(t,n,a,l);let d;try{d=await e(r,Object.assign({},c))}catch(h){throw console.error(h),new j0(Ml(h),0)}if(d.ok||await W2(d),n!=null&&n.noResolveJson)return d;try{return await d.json()}catch(h){await W2(h)}}function Ks(e){var t;let r=null;lB(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Bz(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function G2(e){const t=Ks(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function tl(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function aB(e){return{data:e,error:null}}function iB(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l}=e,c=zc(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:l},h=Object.assign({},c);return{data:{properties:d,user:h},error:null}}function K2(e){return e}function lB(e){return e.access_token&&e.refresh_token&&e.expires_in}const r0=["global","local","others"];class Aw{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=BA(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=r0[0]){if(r0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${r0.join(", ")}`);try{return await Ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:tl})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=zc(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:iB,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(He(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ze(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:tl})}catch(r){if(He(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},m=await Ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:K2});if(m.error)throw m.error;const g=await m.json(),x=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(d=m.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(j=>{const w=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(j.split(";")[1].split("=")[1]);f[`${_}Page`]=w}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(He(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){Xo(t);try{return await Ze(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:tl})}catch(r){if(He(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Xo(t);try{return await Ze(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:tl})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Xo(t);try{return await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:tl})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Xo(t.userId);try{const{data:r,error:n}=await Ze(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(He(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Xo(t.userId),Xo(t.id);try{return{data:await Ze(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},m=await Ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:K2});if(m.error)throw m.error;const g=await m.json(),x=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(d=m.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(j=>{const w=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(j.split(";")[1].split("=")[1]);f[`${_}Page`]=w}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(He(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await Ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(He(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(He(r))return{data:null,error:r};throw r}}}function Y2(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Rl={debug:!!(globalThis&&zA()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Tw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class FA extends Tw{}class oB extends Tw{}async function HA(e,t,r){Rl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Rl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Rl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Rl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Rl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new FA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Rl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const X2={};async function cB(e,t,r){var n;const a=(n=X2[e])!==null&&n!==void 0?n:Promise.resolve(),l=Promise.race([a.catch(()=>null),t>=0?new Promise((c,d)=>{setTimeout(()=>{d(new oB(`Acquiring process lock with name "${e}" timed out`))},t)}):null].filter(c=>c)).catch(c=>{if(c&&c.isAcquireTimeout)throw c;return null}).then(async()=>await r());return X2[e]=l.catch(async c=>{if(c&&c.isAcquireTimeout)return await a,null;throw c}),await l}function dB(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function VA(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function uB(e){return parseInt(e,16)}function hB(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function fB(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:h,resources:f,scheme:m,uri:g,version:x}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const b=VA(e.address),j=m?`${m}://${n}`:n,w=e.statement?`${e.statement}
`:"",_=`${j} wants you to sign in with your Ethereum account:
${b}

${w}`;let N=`URI: ${g}
Version: ${x}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(N+=`
Expiration Time: ${a.toISOString()}`),d&&(N+=`
Not Before: ${d.toISOString()}`),h&&(N+=`
Request ID: ${h}`),f){let C=`
Resources:`;for(const A of f){if(!A||typeof A!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${A}`);C+=`
- ${A}`}N+=C}return`${_}
${N}`}class zr extends Error{constructor({message:t,code:r,cause:n,name:a}){var l;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=a??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class N0 extends zr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function mB({error:e,options:t}){var r,n,a;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new zr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new zr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new zr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new zr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new zr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new zr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new zr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(WA(c)){if(l.rp.id!==c)return new zr({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new zr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new zr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function pB({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new zr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(WA(n)){if(r.rpId!==n)return new zr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new zr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class gB{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const xB=new gB;function bB(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=zc(e,["challenge","user","excludeCredentials"]),l=pc(t).buffer,c=Object.assign(Object.assign({},r),{id:pc(r.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(n&&n.length>0){d.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const f=n[h];d.excludeCredentials[h]=Object.assign(Object.assign({},f),{id:pc(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return d}function vB(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=zc(e,["challenge","allowCredentials"]),a=pc(t).buffer,l=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:pc(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function yB(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ql(new Uint8Array(e.response.attestationObject)),clientDataJSON:ql(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function wB(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ql(new Uint8Array(a.authenticatorData)),clientDataJSON:ql(new Uint8Array(a.clientDataJSON)),signature:ql(new Uint8Array(a.signature)),userHandle:a.userHandle?ql(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function WA(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function J2(){var e,t;return!!(xn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function jB(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new N0("Browser returned unexpected credential type",t)}:{data:null,error:new N0("Empty credential response",t)}}catch(t){return{data:null,error:mB({error:t,options:e})}}}async function _B(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new N0("Browser returned unexpected credential type",t)}:{data:null,error:new N0("Empty credential response",t)}}catch(t){return{data:null,error:pB({error:t,options:e})}}}const kB={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},NB={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function S0(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))n[l]=c;else if(r(c))n[l]=c;else if(t(c)){const d=n[l];t(d)?n[l]=S0(d,c):n[l]=S0(c)}else n[l]=c}return n}function SB(e,t){return S0(kB,e,t||{})}function CB(e,t){return S0(NB,e,t||{})}class EB{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:d};const h=a??xB.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:f}=c.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${n}`),f.displayName||(f.displayName=f.name)}switch(c.webauthn.type){case"create":{const f=SB(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:m,error:g}=await jB({publicKey:f,signal:h});return m?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:g}}case"request":{const f=CB(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:m,error:g}=await _B(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:f,signal:h}));return m?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:g}}}}catch(c){return He(c)?{data:null,error:c}:{data:null,error:new el("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!r)return{data:null,error:new jc("rpId is required for WebAuthn authentication")};try{if(!J2())return{data:null,error:new el("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:n,credential_response:h.credential_response}})}catch(c){return He(c)?{data:null,error:c}:{data:null,error:new el("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!r)return{data:null,error:new jc("rpId is required for WebAuthn registration")};try{if(!J2())return{data:null,error:new el("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(m=>{var g;return(g=m.data)===null||g===void 0?void 0:g.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===t&&x.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m==null?void 0:m.id}):void 0),{data:null,error:d};const{data:h,error:f}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:f}}catch(c){return He(c)?{data:null,error:c}:{data:null,error:new el("Unexpected error in register",c)}}}}dB();const AB={url:Ez,storageKey:Az,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Tz,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Q2(e,t,r){return await r()}const Jo={};class _c{get jwks(){var t,r;return(r=(t=Jo[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Jo[this.storageKey]=Object.assign(Object.assign({},Jo[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Jo[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Jo[this.storageKey]=Object.assign(Object.assign({},Jo[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},AB),t);if(this.storageKey=l.storageKey,this.instanceID=(r=_c.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,_c.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&xn()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new Aw({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=BA(l.fetch),this.lock=l.lock||Q2,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&xn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=HA:this.lock=Q2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new EB(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:zA()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Y2(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Y2(this.memoryStorage)),xn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${OA}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(xn()&&(r=qz(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),xn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),IA(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return He(r)?this._returnResult({error:r}):this._returnResult({error:new el("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const l=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ks}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(He(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,n,a;try{let l;if("email"in t){const{email:m,password:g,options:x}=t;let b=null,j=null;this.flowType==="pkce"&&([b,j]=await Yo(this.storage,this.storageKey)),l=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:m,password:g,data:(r=x==null?void 0:x.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:b,code_challenge_method:j},xform:Ks})}else if("phone"in t){const{phone:m,password:g,options:x}=t;l=await Ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:g,data:(n=x==null?void 0:x.data)!==null&&n!==void 0?n:{},channel:(a=x==null?void 0:x.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:Ks})}else throw new Zd("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return await gn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:d}=t;r=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:G2})}else if("phone"in t){const{phone:l,password:c,options:d}=t;r=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:G2})}else throw new Zd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const l=new Dl;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(He(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,l,c,d,h,f,m,g,x;let b,j;if("message"in t)b=t.message,j=t.signature;else{const{chain:w,wallet:_,statement:N,options:C}=t;let A;if(xn())if(typeof _=="object")A=_;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")A=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=_}const E=new URL((r=C==null?void 0:C.url)!==null&&r!==void 0?r:window.location.href),S=await A.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=VA(S[0]);let D=(n=C==null?void 0:C.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!D){const I=await A.request({method:"eth_chainId"});D=uB(I)}const P={domain:E.host,address:T,statement:N,uri:E.href,version:"1",chainId:D,nonce:(a=C==null?void 0:C.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=C==null?void 0:C.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=C==null?void 0:C.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(h=C==null?void 0:C.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(f=C==null?void 0:C.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(m=C==null?void 0:C.signInWithEthereum)===null||m===void 0?void 0:m.resources};b=fB(P),j=await A.request({method:"personal_sign",params:[hB(b),T]})}try{const{data:w,error:_}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:j},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Ks});if(_)throw _;if(!w||!w.session||!w.user){const N=new Dl;return this._returnResult({data:{user:null,session:null},error:N})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:_})}catch(w){if(He(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var r,n,a,l,c,d,h,f,m,g,x,b;let j,w;if("message"in t)j=t.message,w=t.signature;else{const{chain:_,wallet:N,statement:C,options:A}=t;let E;if(xn())if(typeof N=="object")E=N;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))E=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=N}const S=new URL((r=A==null?void 0:A.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const T=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A==null?void 0:A.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),C?{statement:C}:null));let D;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")D=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)D=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)j=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),w=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${S.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=A==null?void 0:A.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=A==null?void 0:A.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((c=A==null?void 0:A.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((d=A==null?void 0:A.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((h=A==null?void 0:A.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((f=A==null?void 0:A.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((g=(m=A==null?void 0:A.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||g===void 0)&&g.length?["Resources",...A.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const T=await E.signMessage(new TextEncoder().encode(j),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=T}}try{const{data:_,error:N}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:ql(w)},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Ks});if(N)throw N;if(!_||!_.session||!_.user){const C=new Dl;return this._returnResult({data:{user:null,session:null},error:C})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:N})}catch(_){if(He(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await Tl(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new $A;const{data:l,error:c}=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ks});if(await gn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new Dl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:l,nonce:c}=t,d=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ks}),{data:h,error:f}=d;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h||!h.session||!h.user){const m=new Dl;return this._returnResult({data:{user:null,session:null},error:m})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:f})}catch(r){if(He(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,l,c;try{if("email"in t){const{email:d,options:h}=t;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Yo(this.storage,this.storageKey));const{error:g}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},create_user:(n=h==null?void 0:h.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:d,options:h}=t,{data:f,error:m}=await Ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(c=h==null?void 0:h.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:m})}throw new Zd("You must provide either an email or phone number.")}catch(d){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(t){var r,n;try{let a,l;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await Ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Ks});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(a){if(He(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,l,c;try{let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Yo(this.storage,this.storageKey));const f=await Ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:h}),headers:this.headers,xform:aB});return!((l=f.data)===null||l===void 0)&&l.url&&xn()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(d){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Wn;const{error:a}=await Ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(He(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:l}=t,{error:c}=await Ze(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:n,type:a,options:l}=t,{data:c,error:d}=await Ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new Zd("You must provide either an email or phone number and a type")}catch(r){if(He(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Tl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Bx:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const c=await Tl(this.userStorage,this.storageKey+"-user");c!=null&&c.user?t.user=c.user:t.user=qx()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=tB(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:tl}):await this._useSession(async r=>{var n,a,l;const{data:c,error:d}=r;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wn}:await Ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:tl})})}catch(r){if(He(r))return RA(r)&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new Wn;const c=a.session;let d=null,h=null;this.flowType==="pkce"&&t.email!=null&&([d,h]=await Yo(this.storage,this.storageKey));const{data:f,error:m}=await Ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:h}),jwt:c.access_token,xform:tl});if(m)throw m;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(n){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Wn;const r=Date.now()/1e3;let n=r,a=!0,l=null;const{payload:c}=Ux(t.access_token);if(c.exp&&(n=c.exp,a=n<=r),a){const{data:d,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(He(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:c,error:d}=r;if(d)throw d;t=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Wn;const{data:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(He(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!xn())throw new eu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new eu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Hv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new eu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Hv("No code detected.");const{data:C,error:A}=await this._exchangeCodeForSession(t.code);if(A)throw A;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:h,token_type:f}=t;if(!l||!d||!c||!f)throw new eu("No session defined in URL");const m=Math.round(Date.now()/1e3),g=parseInt(d);let x=m+g;h&&(x=parseInt(h));const b=x-m;b*1e3<=nc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const j=x-g;m-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,x,m):m-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,x,m);const{data:w,error:_}=await this._getUser(l);if(_)throw _;const N={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:g,expires_at:x,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:t.type},error:null})}catch(n){if(He(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Tl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return this._returnResult({error:l});const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,t);if(d&&!(MA(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return t!=="others"&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Uz(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:l},error:c}=r;if(c)throw c;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Yo(this.storage,this.storageKey,!0));try{return await Ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async l=>{var c,d,h,f,m;const{data:g,error:x}=l;if(x)throw x;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ze(this.fetch,"GET",b,{headers:this.headers,jwt:(m=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return xn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(He(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:l}}=r;if(a)throw a;const{options:c,provider:d,token:h,access_token:f,nonce:m}=t,g=await Ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l==null?void 0:l.access_token)!==null&&n!==void 0?n:void 0,body:{provider:d,id_token:h,access_token:f,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Ks}),{data:x,error:b}=g;return b?this._returnResult({data:{user:null,session:null},error:b}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Dl}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:b}))}catch(a){if(await gn(this.storage,`${this.storageKey}-code-verifier`),He(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:c}=r;if(c)throw c;return await Ze(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Vz(async a=>(a>0&&await Hz(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ks})),(a,l)=>{const c=200*Math.pow(2,a);return l&&t0(l)&&Date.now()+c-n<nc})}catch(n){if(this._debug(r,"error",n),He(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),xn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Tl(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Tl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await sc(this.userStorage,this.storageKey+"-user",c)),a.user=(t=c==null?void 0:c.user)!==null&&t!==void 0?t:qx()}else if(a&&!a.user&&!a.user){const c=await Tl(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await gn(this.storage,this.storageKey+"-user"),await sc(this.storage,this.storageKey,a)):a.user=qx()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Bx;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${Bx}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),t0(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Wn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new UA;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new Wn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),He(l)){const c={data:null,error:l};return t0(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await gn(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await sc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const l=V2(a);await sc(this.storage,this.storageKey,l)}else{const a=V2(r);await sc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await gn(this.storage,this.storageKey),await gn(this.storage,this.storageKey+"-code-verifier"),await gn(this.storage,this.storageKey+"-user"),this.userStorage&&await gn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&xn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),nc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/nc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${nc}ms, refresh threshold is ${qv} ticks`),a<=qv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Tw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await Yo(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;return l?this._returnResult({data:null,error:l}):await Ze(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:f}=await Ze(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return f?this._returnResult({data:null,error:f}):(t.factorType==="totp"&&h.type==="totp"&&(!((a=h==null?void 0:h.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?yB(t.webauthn.credential_response):wB(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:h}=await Ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:h}))})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=await Ze(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:bB(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:vB(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Ux(n.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const f=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Wn})})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Wn});const c=await Ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&xn()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(He(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Wn});const c=await Ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&xn()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(He(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Wn})})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Wn})})}catch(r){if(He(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(d=>d.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===t),n&&this.jwks_cached_at+Pz>a)return n;const{data:l,error:c}=await Ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(d=>d.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:b,error:j}=await this.getSession();if(j||!b.session)return this._returnResult({data:null,error:j});n=b.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:h}}=Ux(n);r!=null&&r.allowExpired||Qz(l.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:b}=await this.getUser(n);if(b)throw b;return{data:{claims:l,header:a,signature:c},error:null}}const m=Zz(a.alg),g=await crypto.subtle.importKey("jwk",f,m,!0,["verify"]);if(!await crypto.subtle.verify(m,g,c,zz(`${d}.${h}`)))throw new _0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(He(n))return this._returnResult({data:null,error:n});throw n}}}_c.nextInstanceID={};const TB=Aw,GA=_c;class OB extends GA{constructor(t){super(t)}}class KA{constructor(t,r,n){var a,l,c;this.supabaseUrl=t,this.supabaseKey=r;const d=Cz(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,f={db:vz,realtime:wz,auth:Object.assign(Object.assign({},yz),{storageKey:h}),global:bz},m=Sz(n??{},f);this.storageKey=(a=m.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=m.global.headers)!==null&&l!==void 0?l:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(g,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=m.auth)!==null&&c!==void 0?c:{},this.headers,m.global.fetch),this.fetch=kz(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new w7(new URL("rest/v1",d).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new pz(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new x7(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:l,storageKey:c,flowType:d,lock:h,debug:f,throwOnError:m},g,x){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new OB({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),g),storageKey:c,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:l,flowType:d,lock:h,debug:f,throwOnError:m,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new SA(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const PB=(e,t,r)=>new KA(e,t,r);function DB(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}DB()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const MB=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:TB,AuthApiError:DA,AuthClient:GA,AuthError:jc,AuthImplicitGrantRedirectError:eu,AuthInvalidCredentialsError:Zd,AuthInvalidJwtError:_0,AuthInvalidTokenResponseError:Dl,AuthPKCECodeVerifierMissingError:$A,AuthPKCEGrantCodeExchangeError:Hv,AuthRetryableFetchError:j0,AuthSessionMissingError:Wn,AuthUnknownError:el,AuthWeakPasswordError:Vv,CustomAuthError:Sa,get FunctionRegion(){return w0},FunctionsError:Sm,FunctionsFetchError:mA,FunctionsHttpError:Dv,FunctionsRelayError:Pv,GoTrueAdminApi:Aw,GoTrueClient:_c,NavigatorLockAcquireTimeoutError:FA,PostgrestError:j7,REALTIME_CHANNEL_STATES:R7,get REALTIME_LISTEN_TYPES(){return mc},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Lv},get REALTIME_PRESENCE_LISTEN_EVENTS(){return $v},get REALTIME_SUBSCRIBE_STATES(){return xa},RealtimeChannel:Ul,RealtimeClient:SA,RealtimePresence:fc,SIGN_OUT_SCOPES:r0,SupabaseClient:KA,WebSocketFactory:wA,createClient:PB,isAuthApiError:MA,isAuthError:He,isAuthImplicitGrantRedirectError:IA,isAuthPKCECodeVerifierMissingError:Dz,isAuthRetryableFetchError:t0,isAuthSessionMissingError:RA,isAuthWeakPasswordError:Mz,lockInternals:Rl,navigatorLock:HA,processLock:cB},Symbol.toStringTag,{value:"Module"})),{createClient:RB}=MB,IB="https://ofrnqqvujueivirduyqv.supabase.co",$B="sb_publishable_2DfGc-fRJ9cQlY_0h60U6g_WE7Mdyu1",ge=RB(IB,$B),LB=async()=>{const{data:{session:e}}=await ge.auth.getSession();return e},zB=Object.freeze(Object.defineProperty({__proto__:null,getCurrentSession:LB,supabase:ge},Symbol.toStringTag,{value:"Module"})),BB={urgent_task:{icon:_n,color:"text-rose-500",bg:"bg-rose-50",label:" "},alert:{icon:_n,color:"text-rose-500",bg:"bg-rose-50",label:" "},manager_message:{icon:ai,color:"text-blue-500",bg:"bg-blue-50",label:" "},followup:{icon:ft,color:"text-emerald-500",bg:"bg-emerald-50",label:""},reminder:{icon:Pr,color:"text-amber-500",bg:"bg-amber-50",label:""},lead:{icon:ft,color:"text-emerald-500",bg:"bg-emerald-50",label:""},system:{icon:ai,color:"text-slate-500",bg:"bg-slate-50",label:""}},UB=["urgent_task","alert","manager_message","followup","reminder"],qB=({userId:e,orgId:t,onNavigateToLead:r,onOpenReminders:n})=>{const[a,l]=v.useState(!1),[c,d]=v.useState([]),[h,f]=v.useState(!1),[m,g]=v.useState("today"),x=v.useRef(null);v.useEffect(()=>{(async()=>{if(!(!e||!a)){f(!0);try{let A=ge.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(50);if(m==="today"){const T=new Date;T.setHours(0,0,0,0),A=A.gte("created_at",T.toISOString())}else if(m==="week"){const T=new Date;T.setDate(T.getDate()-7),A=A.gte("created_at",T.toISOString())}A=A.in("type",UB);const{data:E,error:S}=await A;if(S)throw S;d(E||[])}catch(A){console.error("Failed to fetch notifications:",A)}finally{f(!1)}}})()},[e,a,m]),v.useEffect(()=>{const C=A=>{x.current&&!x.current.contains(A.target)&&l(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const b=async C=>{await ge.from("notifications").update({is_read:!0}).eq("id",C),d(A=>A.map(E=>E.id===C?{...E,is_read:!0}:E))},j=async()=>{await ge.from("notifications").update({is_read:!0}).eq("user_id",e).eq("is_read",!1),d(C=>C.map(A=>({...A,is_read:!0})))},w=C=>{if(b(C.id),["reminder","followup","urgent_task","alert"].includes(C.type)){n==null||n(),l(!1);return}C.lead_id&&r&&(r(C.lead_id),l(!1))},_=c.filter(C=>!C.is_read).length,N=C=>{const A=new Date(C),S=new Date().getTime()-A.getTime(),T=Math.floor(S/6e4),D=Math.floor(S/36e5);return T<1?"":T<60?` ${T} '`:D<24?` ${D} `:A.toLocaleDateString("he-IL")};return s.jsxs("div",{className:"relative",ref:x,children:[s.jsxs("button",{onClick:()=>l(!a),className:"relative p-2 rounded-xl hover:bg-slate-100 transition-colors",children:[s.jsx(ai,{className:"w-5 h-5 text-slate-600"}),_>0&&s.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-rose-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:_>9?"9+":_})]}),a&&s.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden z-50",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-slate-800",children:"  "}),s.jsxs("div",{className:"flex items-center gap-2",children:[_>0&&s.jsx("button",{onClick:j,className:"text-xs text-brand-600 hover:underline",children:"  "}),s.jsxs("span",{className:"text-xs text-slate-400",children:[_," "]})]})]}),s.jsx("div",{className:"flex border-b border-slate-100",children:[{key:"today",label:""},{key:"week",label:""},{key:"all",label:""}].map(C=>s.jsx("button",{onClick:()=>g(C.key),className:`flex-1 py-2 text-sm font-medium transition-colors ${m===C.key?"text-brand-600 border-b-2 border-brand-500":"text-slate-500 hover:text-slate-700"}`,children:C.label},C.key))}),s.jsx("div",{className:"max-h-80 overflow-y-auto",children:h?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(it,{className:"w-5 h-5 animate-spin text-slate-400"})}):c.length===0?s.jsxs("div",{className:"py-8 text-center text-sm text-slate-400",children:[s.jsx(ai,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),s.jsx("p",{children:" "})]}):s.jsx("div",{className:"divide-y divide-slate-100",children:c.map(C=>{const A=BB[C.type],E=A.icon;return s.jsxs("div",{onClick:()=>w(C),className:`px-4 py-3 flex items-start gap-3 cursor-pointer hover:bg-slate-50 transition-colors ${C.is_read?"":"bg-brand-50/30"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${A.bg}`,children:s.jsx(E,{className:`w-4 h-4 ${A.color}`})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-start justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded ${A.bg} ${A.color}`,children:A.label}),!C.is_read&&s.jsx("span",{className:"w-2 h-2 rounded-full bg-brand-500 shrink-0"})]})}),s.jsx("p",{className:`text-sm font-medium mt-1 ${C.is_read?"text-slate-600":"text-slate-900"}`,children:C.title}),C.message&&s.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-2",children:C.message}),s.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:N(C.created_at)})]})]},C.id)})})}),s.jsx("div",{className:"px-4 py-3 border-t border-slate-100",children:s.jsx("button",{onClick:()=>{n==null||n(),l(!1)},className:"w-full py-2 text-sm font-medium text-brand-600 hover:bg-brand-50 rounded-lg transition-colors",children:" "})})]})]})},FB=({isOpen:e,onClose:t,orgId:r,userId:n,userRole:a,onNavigate:l,onSelectLead:c,onSelectTask:d})=>{const[h,f]=v.useState(""),[m,g]=v.useState([]),[x,b]=v.useState(!1),[j,w]=v.useState(0),_=v.useRef(null),N=v.useRef(null);v.useEffect(()=>{e&&(f(""),g([]),w(0),setTimeout(()=>{var S;return(S=_.current)==null?void 0:S.focus()},100))},[e]);const C=v.useCallback(async S=>{if(!S.trim()||S.length<2){g([]);return}b(!0);const T=a==="manager"||a==="sales_manager"||a==="admin"||a==="super_admin"||a==="platform_admin";try{let D=ge.from("leads").select("id, name, company, phone, email, status").or(`name.ilike.%${S}%,company.ilike.%${S}%,phone.ilike.%${S}%,email.ilike.%${S}%`).limit(6),P=ge.from("tasks").select("id, title, due_date, status").ilike("title",`%${S}%`).limit(4),I=T?ge.from("profiles").select("id, full_name, email, role").or(`full_name.ilike.%${S}%,email.ilike.%${S}%`).limit(3):null;r&&(D=D.eq("organization_id",r),P=P.eq("organization_id",r),I&&(I=I.eq("organization_id",r))),n&&!T&&(D=D.eq("owner_id",n),P=P.eq("assigned_to",n));const[$,M,R]=await Promise.all([D,P,I||Promise.resolve({data:[]})]),F=[];$.data&&$.data.forEach(V=>{F.push({id:V.id,type:"lead",title:V.name,subtitle:V.company||V.phone||"",icon:s.jsx(Rn,{className:"w-4 h-4 text-brand-500"}),metadata:{status:V.status,phone:V.phone,email:V.email}})}),M.data&&M.data.forEach(V=>{F.push({id:V.id,type:"task",title:V.title,subtitle:V.due_date?new Date(V.due_date).toLocaleDateString("he-IL"):"",icon:s.jsx(Ct,{className:"w-4 h-4 text-emerald-500"}),metadata:{status:V.status}})}),R&&R.data&&R.data.forEach(V=>{F.push({id:V.id,type:"profile",title:V.full_name,subtitle:V.role==="manager"?"":"",icon:s.jsx(Na,{className:"w-4 h-4 text-slate-500"})})}),g(F),w(0)}catch(D){console.error("Search error:",D)}finally{b(!1)}},[r,n,a]);v.useEffect(()=>{const S=setTimeout(()=>{C(h)},150);return()=>clearTimeout(S)},[h,C]);const A=S=>{S.key==="ArrowDown"?(S.preventDefault(),w(T=>Math.min(T+1,m.length-1))):S.key==="ArrowUp"?(S.preventDefault(),w(T=>Math.max(T-1,0))):S.key==="Enter"&&m[j]?E(m[j]):S.key==="Escape"&&t()},E=S=>{S.type==="lead"?(l("leads"),c&&setTimeout(()=>c(S.id),100)):S.type==="task"?(l("tasks"),d&&setTimeout(()=>d(S.id),100)):S.type==="profile"&&l("settings"),t()};return v.useEffect(()=>{if(N.current){const S=N.current.children[j];S&&S.scrollIntoView({block:"nearest"})}},[j]),e?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 animate-in fade-in duration-200",onClick:t}),s.jsxs("div",{className:"fixed top-[15%] left-1/2 -translate-x-1/2 w-full max-w-xl bg-white dark:bg-slate-900 rounded-2xl shadow-2xl z-50 overflow-hidden border border-slate-200 dark:border-slate-800 animate-in fade-in zoom-in-95 slide-in-from-top-4 duration-300",children:[s.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-slate-200 dark:border-slate-800",children:[s.jsx(na,{className:"w-5 h-5 text-slate-400 flex-shrink-0"}),s.jsx("input",{ref:_,type:"text",value:h,onChange:S=>f(S.target.value),onKeyDown:A,placeholder:" , ,  ...",className:"flex-1 bg-transparent outline-none text-slate-900 dark:text-white placeholder-slate-400 text-base"}),x&&s.jsx(it,{className:"w-5 h-5 text-brand-500 animate-spin"}),s.jsx("button",{onClick:t,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(Lt,{className:"w-4 h-4"})})]}),s.jsxs("div",{ref:N,className:"max-h-[400px] overflow-y-auto",children:[h.length>=2&&m.length===0&&!x&&s.jsxs("div",{className:"p-8 text-center text-slate-500 dark:text-slate-400",children:[s.jsx(na,{className:"w-10 h-10 mx-auto mb-3 opacity-30"}),s.jsxs("p",{className:"text-sm",children:['    "',h,'"']})]}),m.length>0&&s.jsx("div",{className:"p-2",children:["lead","task","profile"].map(S=>{const T=m.filter(P=>P.type===S);if(T.length===0)return null;const D={lead:"",task:"",profile:" "};return s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"px-3 py-1.5 text-xs font-bold text-slate-400 uppercase tracking-wider",children:D[S]}),T.map((P,I)=>{var R;const M=m.indexOf(P)===j;return s.jsxs("button",{onClick:()=>E(P),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-right transition-colors ${M?"bg-brand-50 dark:bg-brand-900/20 text-brand-900 dark:text-brand-100":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-900 dark:text-white"}`,children:[s.jsx("div",{className:`p-2 rounded-lg flex-shrink-0 ${M?"bg-brand-100 dark:bg-brand-900/40":"bg-slate-100 dark:bg-slate-800"}`,children:P.icon}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:P.title}),P.subtitle&&s.jsx("p",{className:"text-xs text-slate-500 truncate",children:P.subtitle})]}),((R=P.metadata)==null?void 0:R.status)&&s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hidden sm:block",children:P.metadata.status}),s.jsx(SE,{className:"w-4 h-4 text-slate-300 flex-shrink-0"})]},P.id)})]},S)})}),!h&&s.jsxs("div",{className:"p-6 text-center text-slate-400",children:[s.jsx("p",{className:"text-sm",children:"  ..."}),s.jsx("p",{className:"text-xs mt-2 opacity-60",children:"   , , ,   "})]})]}),s.jsxs("div",{className:"px-4 py-2.5 bg-slate-50 dark:bg-slate-950 border-t border-slate-200 dark:border-slate-800 flex items-center justify-between text-xs text-slate-400",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded text-[10px] font-mono",children:""}),""]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded text-[10px] font-mono",children:"Enter"}),""]})]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded text-[10px] font-mono",children:"Esc"}),""]})]})]})]}):null},HB=[{id:"h1",text:"  K      ."},{id:"h2",text:"       ."},{id:"h3",text:"-AI        ."}],VB=[{id:"a1",label:"   "},{id:"a2",label:"   "},{id:"a3",label:"    -AI"}],WB=({user:e,userId:t,orgId:r,isDarkMode:n,toggleTheme:a,onNavigate:l,onOpenChat:c,onOpenReminders:d,onToggleMobileMenu:h,onLogout:f,onNavigateToLead:m})=>{const g=e.type==="rep",[x,b]=v.useState(null),[j,w]=v.useState(!1),_=v.useRef(null);v.useEffect(()=>{function C(A){_.current&&!_.current.contains(A.target)&&b(null)}return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]),v.useEffect(()=>{function C(A){(A.metaKey||A.ctrlKey)&&A.key==="k"&&(A.preventDefault(),w(!0))}return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[]);const N=C=>{b(x===C?null:C)};return s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:`h-16 px-4 md:px-6 flex items-center justify-between flex-shrink-0 z-40 sticky top-0
      bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200/60 dark:border-slate-800/60 transition-colors`,children:[s.jsxs("div",{className:"flex items-center gap-3 w-full max-w-xl",children:[s.jsx("button",{onClick:h,className:"lg:hidden p-2 -mr-2 text-slate-500 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(T$,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:()=>w(!0),className:`relative w-full group hidden sm:flex items-center pr-10 pl-12 py-2 bg-slate-100/50 dark:bg-slate-800/50 border border-slate-200/60 dark:border-slate-700/60 
                     rounded-xl text-sm text-slate-400 
                     hover:bg-white dark:hover:bg-slate-900 hover:border-brand-500/50 hover:text-slate-600 dark:hover:text-slate-300
                     transition-all shadow-sm cursor-pointer`,children:[s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:s.jsx(na,{className:"w-4 h-4"})}),s.jsx("span",{children:"  (K)"}),s.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 flex items-center gap-1",children:s.jsx("span",{className:"text-[10px] font-mono text-slate-500 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded px-1.5 py-0.5",children:"K"})})]}),s.jsx("button",{onClick:()=>w(!0),className:"sm:hidden p-2 text-slate-500 dark:text-slate-400 hover:text-brand-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(na,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 md:gap-3 pl-2",ref:_,children:[g&&s.jsxs("button",{onClick:c,className:"hidden md:flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-brand-300 dark:hover:border-brand-700 text-slate-600 dark:text-slate-300 rounded-lg transition-all text-sm font-medium shadow-sm hover:shadow",children:[s.jsx(au,{className:"w-4 h-4 text-brand-500"}),s.jsx("span",{className:"hidden lg:inline",children:"' "})]}),s.jsxs("div",{className:"flex items-center gap-1 relative",children:[s.jsxs("div",{className:"relative hidden md:block",children:[s.jsx("button",{onClick:()=>N("help"),className:`p-2 rounded-full transition-colors ${x==="help"?"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400":"text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:"",children:s.jsx(fw,{className:"w-5 h-5"})}),x==="help"&&s.jsxs("div",{className:"absolute top-full left-0 mt-3 w-80 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-200 origin-top-left",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-white dark:from-slate-800 dark:to-slate-900 border-b border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"p-1 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:s.jsx(GB,{className:"w-4 h-4"})}),s.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:" ?"})]}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"        ."})]}),s.jsxs("div",{className:"p-4 space-y-5",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-bold text-slate-900 dark:text-white mb-2 flex items-center gap-1.5",children:[s.jsx(su,{className:"w-3.5 h-3.5 text-amber-500"})," "]}),s.jsx("ul",{className:"space-y-2",children:HB.map(C=>s.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-300 flex items-start gap-2 leading-relaxed",children:[s.jsx("span",{className:"w-1 h-1 rounded-full bg-slate-300 dark:bg-slate-600 mt-1.5 flex-shrink-0"}),C.text]},C.id))})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-bold text-slate-900 dark:text-white mb-2 flex items-center gap-1.5",children:[s.jsx(vr,{className:"w-3.5 h-3.5 text-blue-500"})," "]}),s.jsx("ul",{className:"space-y-1",children:VB.map(C=>s.jsx("li",{children:s.jsxs("button",{className:"w-full text-right text-xs py-1.5 px-2 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg text-slate-600 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors flex items-center justify-between group",children:[C.label,s.jsx(ls,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]})},C.id))})]})]}),s.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-950 border-t border-slate-100 dark:border-slate-800 text-center",children:s.jsxs("button",{className:"text-xs font-medium text-blue-600 dark:text-blue-400 hover:underline flex items-center justify-center gap-1.5",children:[s.jsx(Pu,{className:"w-3.5 h-3.5"}),"   "]})})]})]}),s.jsx("button",{onClick:a,className:"p-2 text-slate-400 hover:text-brand-600 dark:text-slate-500 dark:hover:text-brand-400 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:n?s.jsx(IL,{className:"w-5 h-5"}):s.jsx($E,{className:"w-5 h-5"})}),s.jsx(qB,{userId:t||e.id,orgId:r||e.organization_id,onNavigateToLead:m,onOpenReminders:d})]}),s.jsx("div",{className:"h-8 w-px bg-slate-200 dark:bg-slate-700 mx-2 hidden md:block"}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>b(x==="userMenu"?null:"userMenu"),className:"flex items-center gap-3 pl-1 pr-2 py-1 rounded-xl hover:bg-slate-100/50 dark:hover:bg-slate-800/50 transition-colors group",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:e.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name)}&background=random`,alt:e.name,className:"w-8 h-8 rounded-full object-cover border border-slate-200 dark:border-slate-600 shadow-sm group-hover:border-brand-300 transition-colors"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full"})]}),s.jsxs("div",{className:"text-right hidden md:block",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 leading-tight group-hover:text-brand-600 transition-colors",children:e.name}),s.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400 leading-tight",children:e.role})]})]}),x==="userMenu"&&s.jsxs("div",{className:"absolute top-full left-0 mt-2 w-56 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-200 origin-top-left",children:[s.jsxs("div",{className:"p-3 border-b border-slate-100 dark:border-slate-800",children:[s.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:e.name}),s.jsx("p",{className:"text-xs text-slate-500 truncate",children:e.email})]}),s.jsx("div",{className:"p-1",children:s.jsxs("button",{onClick:()=>{l("settings"),b(null)},className:"w-full text-right flex items-center gap-2 px-3 py-2 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg transition-colors",children:[s.jsx(Rn,{className:"w-4 h-4 text-slate-400"})," "]})}),s.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-800 my-1"}),s.jsx("div",{className:"p-1",children:s.jsxs("button",{onClick:f,className:"w-full text-right flex items-center gap-2 px-3 py-2 text-sm text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors font-medium",children:[s.jsx(bw,{className:"w-4 h-4"}),""]})})]})]})]})]}),s.jsx(FB,{isOpen:j,onClose:()=>w(!1),orgId:r||e.organization_id,userId:t||e.id,userRole:e.role||e.type,onNavigate:l,onSelectLead:m})]})};function GB({className:e}){return s.jsxs("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("circle",{cx:"12",cy:"12",r:"4"}),s.jsx("line",{x1:"4.93",y1:"4.93",x2:"9.17",y2:"9.17"}),s.jsx("line",{x1:"14.83",y1:"14.83",x2:"19.07",y2:"19.07"}),s.jsx("line",{x1:"14.83",y1:"9.17",x2:"19.07",y2:"4.93"}),s.jsx("line",{x1:"14.83",y1:"9.17",x2:"18.36",y2:"5.64"}),s.jsx("line",{x1:"4.93",y1:"19.07",x2:"9.17",y2:"14.83"})]})}const qr=({children:e,variant:t="neutral",className:r=""})=>{const n="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border border-transparent",a={neutral:"bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700",brand:"bg-brand-100 text-brand-800 dark:bg-brand-900/30 dark:text-brand-300 dark:border-brand-800/50",success:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-800/50",warning:"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-800/50",danger:"bg-rose-100 text-rose-800 dark:bg-rose-900/30 dark:text-rose-300 dark:border-rose-800/50",indigo:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300 dark:border-indigo-800/50",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800/50",pink:"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-300 dark:border-pink-800/50"};return s.jsx("span",{className:`${n} ${a[t]} ${r}`,children:e})},KB=[{id:"intro",title:"",icon:"intro",content:`,  [] -[].
      
      [].

   ?`},{id:"questions",title:" ",icon:"questions",content:`    ?
      ?
     ?
     ?
   ?`},{id:"objections",title:"",icon:"objections",content:`" "  " .     ROI  X ?"

" "  ".    ?"

"  "  "  .     ?"

"   "  "!    ?"`},{id:"close",title:"",icon:"close",content:`    
   
  

"  -    []   -[]. ?"`}],YB=e=>{switch(e){case"intro":return s.jsx(Xn,{className:"w-4 h-4"});case"questions":return s.jsx(fw,{className:"w-4 h-4"});case"objections":return s.jsx(_n,{className:"w-4 h-4"});case"close":return s.jsx(Ct,{className:"w-4 h-4"});default:return s.jsx(ps,{className:"w-4 h-4"})}},XB=({isVisible:e,onClose:t,campaignName:r,leadName:n,customScript:a})=>{const l=a||KB,[c,d]=v.useState(()=>{if(typeof window<"u"){const N=localStorage.getItem("callScriptPosition");if(N)try{return JSON.parse(N)}catch{}}return{x:100,y:100}}),[h,f]=v.useState(!1),[m,g]=v.useState("intro"),[x,b]=v.useState(!1),j=v.useRef({x:0,y:0}),w=v.useRef(null);v.useEffect(()=>{localStorage.setItem("callScriptPosition",JSON.stringify(c))},[c]);const _=N=>{if(!w.current)return;b(!0);const C=w.current.getBoundingClientRect();j.current={x:N.clientX-C.left,y:N.clientY-C.top},N.preventDefault()};return v.useEffect(()=>{if(!x)return;const N=A=>{const E=A.clientX-j.current.x,S=A.clientY-j.current.y,T=window.innerWidth-(h?200:380),D=window.innerHeight-60;d({x:Math.max(0,Math.min(E,T)),y:Math.max(0,Math.min(S,D))})},C=()=>{b(!1)};return window.addEventListener("mousemove",N),window.addEventListener("mouseup",C),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",C)}},[x,h]),e?s.jsxs("div",{ref:w,className:`fixed z-[200] transition-all duration-200 ${x?"cursor-grabbing":""}`,style:{left:c.x,top:c.y,width:h?"200px":"360px"},children:[s.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden ${x?"ring-2 ring-brand-500":""}`,children:[s.jsxs("div",{className:"bg-gradient-to-r from-brand-600 to-brand-700 text-white px-4 py-3 flex items-center gap-3 cursor-grab active:cursor-grabbing select-none",onMouseDown:_,children:[s.jsx(xw,{className:"w-4 h-4 opacity-60"}),s.jsx(ps,{className:"w-4 h-4"}),s.jsx("span",{className:"font-bold text-sm flex-1",children:h?"":" "}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>f(!h),className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",title:h?"":"",children:h?s.jsx(C$,{className:"w-4 h-4"}):s.jsx(z$,{className:"w-4 h-4"})}),s.jsx("button",{onClick:t,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",title:"",children:s.jsx(Lt,{className:"w-4 h-4"})})]})]}),!h&&s.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[(r||n)&&s.jsxs("div",{className:"px-4 py-2 bg-slate-50 border-b border-slate-100 text-xs text-slate-500 flex gap-4",children:[r&&s.jsxs("span",{children:[": ",s.jsx("strong",{className:"text-slate-700",children:r})]}),n&&s.jsxs("span",{children:[": ",s.jsx("strong",{className:"text-slate-700",children:n})]})]}),s.jsx("div",{className:"divide-y divide-slate-100",children:l.map(N=>s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>g(m===N.id?null:N.id),className:`w-full px-4 py-3 flex items-center gap-3 text-right hover:bg-slate-50 transition-colors
                                 ${m===N.id?"bg-brand-50 text-brand-700":"text-slate-700"}`,children:[s.jsx("span",{className:`p-1.5 rounded-lg ${m===N.id?"bg-brand-100 text-brand-600":"bg-slate-100 text-slate-500"}`,children:YB(N.icon)}),s.jsx("span",{className:"font-medium text-sm flex-1",children:N.title}),m===N.id?s.jsx(eo,{className:"w-4 h-4 text-slate-400"}):s.jsx(Pt,{className:"w-4 h-4 text-slate-400"})]}),m===N.id&&s.jsx("div",{className:"px-4 py-3 bg-slate-50 text-sm text-slate-600 leading-relaxed whitespace-pre-line",children:N.content})]},N.id))})]})]}),h&&s.jsx("div",{className:"mt-2 text-center",children:s.jsx("span",{className:"text-xs text-slate-500 bg-white/80 px-2 py-1 rounded-full shadow-sm",children:" "})})]}):null},YA=({leadPhone:e,leadName:t,leadEmail:r,onSendSummary:n,className:a="",callTranscript:l,callSummary:c})=>{const[d,h]=v.useState({whatsapp:"idle",quote:"idle",payment:"idle",summary:"idle"}),[f,m]=v.useState(!1),[g,x]=v.useState(!1),[b,j]=v.useState(""),[w,_]=v.useState(""),[N,C]=v.useState(""),[A,E]=v.useState(""),[S,T]=v.useState(!1),D=H=>{let L=H.replace(/[\s\-\(\)]/g,"");return L.startsWith("0")&&(L="972"+L.substring(1)),L=L.replace("+",""),L},P=async()=>{var H;if(!l&&!c){_("  "),j("1990");return}T(!0);try{const L=await fetch("/api/ai/generate-quote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:l,summary:c,leadName:t})});if(L.ok){const U=await L.json();_(U.description||"  "),j(((H=U.amount)==null?void 0:H.toString())||"1990")}else _("  "),j("1990")}catch(L){console.error("Failed to generate AI quote:",L),_("  "),j("1990")}finally{T(!1)}},I=()=>{if(!e)return;h(W=>({...W,whatsapp:"loading"}));const H=D(e),L=encodeURIComponent(` ${t||""},   !     .`),U=`https://wa.me/${H}?text=${L}`;window.open(U,"_blank"),setTimeout(()=>{h(W=>({...W,whatsapp:"success"})),setTimeout(()=>{h(W=>({...W,whatsapp:"idle"}))},2e3)},500)},$=()=>{if(!e||!b)return;h(W=>({...W,quote:"loading"}));const H=D(e),L=encodeURIComponent(` ${t||""},

 :
${w||""}
": ${b}

  !`),U=`https://wa.me/${H}?text=${L}`;window.open(U,"_blank"),setTimeout(()=>{h(W=>({...W,quote:"success"})),m(!1),j(""),_(""),setTimeout(()=>{h(W=>({...W,quote:"idle"}))},2e3)},500)},M=()=>{if(!e||!N)return;h(le=>({...le,payment:"loading"}));const H=D(e),L=`https://pay.example.com/${Date.now()}`,U=encodeURIComponent(` ${t||""},

 :
${A||""} - ${N}

${L}

!`),W=`https://wa.me/${H}?text=${U}`;window.open(W,"_blank"),setTimeout(()=>{h(le=>({...le,payment:"success"})),x(!1),C(""),E(""),setTimeout(()=>{h(le=>({...le,payment:"idle"}))},2e3)},500)},R=()=>{h(H=>({...H,summary:"loading"})),n&&n(),setTimeout(()=>{h(H=>({...H,summary:"success"})),setTimeout(()=>{h(H=>({...H,summary:"idle"}))},2e3)},1e3)},F=(H,L)=>{switch(H){case"loading":return s.jsx(it,{className:"w-4 h-4 animate-spin"});case"success":return s.jsx(Or,{className:"w-4 h-4"});default:return L}},V=H=>{switch(H){case"success":return"bg-emerald-50 border-emerald-200 text-emerald-600";case"loading":return"bg-slate-100 border-slate-200 text-slate-400 cursor-wait";default:return"bg-white border-slate-200 text-slate-700 hover:bg-slate-50 hover:border-slate-300"}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center gap-2 ${a}`,children:[s.jsxs("button",{onClick:I,disabled:!e||d.whatsapp==="loading",className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm font-medium transition-all ${V(d.whatsapp)}`,title:"  WhatsApp",children:[F(d.whatsapp,s.jsx(au,{className:"w-4 h-4"})),s.jsx("span",{className:"hidden md:inline",children:"WhatsApp"})]}),s.jsxs("button",{onClick:()=>m(!0),disabled:!e||d.quote==="loading",className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm font-medium transition-all ${V(d.quote)}`,title:"  ",children:[F(d.quote,s.jsx(ps,{className:"w-4 h-4"})),s.jsx("span",{className:"hidden md:inline",children:""})]}),s.jsxs("button",{onClick:()=>x(!0),disabled:!e||d.payment==="loading",className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm font-medium transition-all ${V(d.payment)}`,title:"  ",children:[F(d.payment,s.jsx(g0,{className:"w-4 h-4"})),s.jsx("span",{className:"hidden md:inline",children:""})]}),s.jsxs("button",{onClick:R,disabled:d.summary==="loading",className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm font-medium transition-all ${V(d.summary)}`,title:"  ",children:[F(d.summary,s.jsx(yc,{className:"w-4 h-4"})),s.jsx("span",{className:"hidden md:inline",children:""})]})]}),f&&s.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-brand-600 to-indigo-600 px-6 py-4 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:s.jsx(ps,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:" "}),s.jsxs("p",{className:"text-sm text-white/80",children:[" ",t||""]})]})]}),s.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]})}),s.jsxs("div",{className:"p-6 space-y-5",children:[(l||c)&&s.jsx("button",{onClick:P,disabled:S,className:"w-full p-4 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-3 hover:from-purple-600 hover:to-indigo-600 transition-all shadow-lg shadow-purple-500/25 disabled:opacity-70",children:S?s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nr,{className:"w-5 h-5"}),"    "]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"  "}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"",price:"990"},{name:"",price:"1,990"},{name:"",price:"3,990"}].map(H=>s.jsxs("button",{onClick:()=>{_(` ${H.name}`),j(H.price.replace(",",""))},className:`p-3 rounded-xl border-2 text-center transition-all ${w===` ${H.name}`?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 hover:border-brand-300 hover:bg-slate-50"}`,children:[s.jsx("div",{className:"text-sm font-bold",children:H.name}),s.jsxs("div",{className:"text-lg font-extrabold text-brand-600",children:["",H.price]})]},H.name))})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-1 h-px bg-slate-200"}),s.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"  "}),s.jsx("div",{className:"flex-1 h-px bg-slate-200"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:" "}),s.jsx("input",{type:"text",value:w,onChange:H=>_(H.target.value),placeholder:":   + ",className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:" ()"}),s.jsx("input",{type:"number",value:b,onChange:H=>j(H.target.value),placeholder:"0",className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-lg font-bold"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:" "}),s.jsxs("select",{className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all bg-white",children:[s.jsx("option",{value:"7",children:"7 "}),s.jsx("option",{value:"14",children:"14 "}),s.jsx("option",{value:"30",children:"30 "})]})]})]}),b&&s.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(au,{className:"w-4 h-4 text-emerald-600"}),s.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:" "})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-slate-100 text-sm text-slate-700 whitespace-pre-line",children:[" ",t||"[ ]",",  :",w||"",'": ',Number(b).toLocaleString("he-IL"),"  !"]})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex gap-3",children:[s.jsx("button",{onClick:()=>m(!1),className:"flex-1 px-4 py-2.5 border border-slate-300 rounded-xl text-slate-600 hover:bg-white font-medium transition-colors",children:""}),s.jsxs("button",{onClick:$,disabled:!b,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-xl hover:from-emerald-600 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-bold shadow-lg shadow-emerald-500/25 transition-all",children:[s.jsx(au,{className:"w-4 h-4"})," -WhatsApp"]})]})]})}),g&&s.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"  "}),s.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-slate-100 rounded-lg",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-500"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),s.jsx("input",{type:"text",value:A,onChange:H=>E(H.target.value),placeholder:": ",className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" ()"}),s.jsx("input",{type:"number",value:N,onChange:H=>C(H.target.value),placeholder:"0",className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500"})]}),s.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-amber-700 text-sm",children:[s.jsx("strong",{children:" :"}),"       (Grow, iCount ')    ."]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg text-slate-600 hover:bg-slate-50",children:""}),s.jsxs("button",{onClick:M,disabled:!N,className:"flex-1 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[s.jsx(g0,{className:"w-4 h-4"})," -WhatsApp"]})]})]})})]})},Z2=[{level:1,name:"Rookie",color:"border-slate-300",ring:"ring-slate-200",icon:km,bg:"bg-white"},{level:5,name:"Pro",color:"border-emerald-400",ring:"ring-emerald-200",icon:Ct,bg:"bg-emerald-50"},{level:10,name:"Elite",color:"border-blue-500",ring:"ring-blue-300",icon:IE,bg:"bg-blue-50"},{level:20,name:"Master",color:"border-purple-500",ring:"ring-purple-300",icon:mw,bg:"bg-purple-50"},{level:50,name:"Legend",color:"border-amber-400",ring:"ring-amber-200",icon:jw,bg:"bg-amber-50"}],Fx=[{level:1,name:"",minXp:0,maxXp:100},{level:2,name:"",minXp:100,maxXp:300},{level:3,name:"",minXp:300,maxXp:600},{level:4,name:"",minXp:600,maxXp:1e3},{level:5,name:"",minXp:1e3,maxXp:2e3}],JB=({userId:e,orgId:t,compact:r=!1})=>{const[n,a]=v.useState(null),[l,c]=v.useState([]),[d,h]=v.useState(!0);if(v.useEffect(()=>{(async()=>{if(!(!e||!t))try{const{data:N,error:C}=await ge.from("user_gamification").select("*").eq("user_id",e).single();if(C&&C.code!=="PGRST116"&&console.error("Gamification fetch error:",C),N)a(N);else{const{data:T}=await ge.from("user_gamification").insert({user_id:e,organization_id:t}).select().single();a(T||{xp_total:0,level:1,current_streak:0,achievements:[]})}const A=new Date().toISOString().split("T")[0],{data:E,error:S}=await ge.from("daily_missions").select("*").eq("user_id",e).eq("date",A);if(S&&console.error("Missions fetch error:",S),!E||E.length===0){await ge.rpc("create_daily_missions",{p_user_id:e,p_org_id:t});const{data:T}=await ge.from("daily_missions").select("*").eq("user_id",e).eq("date",A);c(T||[])}else c(E)}catch(N){console.error("Gamification error:",N)}finally{h(!1)}})()},[e,t]),d)return s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx(it,{className:"w-5 h-5 animate-spin text-brand-500"})});const f=Fx.find(_=>_.level===((n==null?void 0:n.level)||1))||Fx[0];Fx.find(_=>_.level===((n==null?void 0:n.level)||1)+1);const m=(n==null?void 0:n.level)||1,g=Z2.reduce((_,N)=>N.level<=m?N:_,Z2[0]),x=((n==null?void 0:n.xp_total)||0)-f.minXp,b=(f.maxXp||2e3)-f.minXp,j=Math.max(0,Math.min(x/(b||100)*100,100)),w=l.filter(_=>_.completed).length;return r?s.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-white rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group hover:border-indigo-200 transition-colors cursor-default",children:[s.jsx("div",{className:`relative w-10 h-10 shrink-0 rounded-full border-2 ${g.color} ${g.ring} flex items-center justify-center bg-white z-10`,children:s.jsx(g.icon,{className:`w-4 h-4 ${g.color.replace("border","text")}`})}),s.jsxs("div",{className:"flex-1 min-w-0 z-10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("span",{className:"text-xs font-bold text-slate-800 truncate",children:["LVL ",n==null?void 0:n.level,"  ",f.name]}),((n==null?void 0:n.current_streak)||0)>0&&s.jsxs("div",{className:"flex items-center gap-0.5 text-orange-500",children:[s.jsx(uu,{className:"w-3 h-3 fill-orange-500 animate-pulse"}),s.jsx("span",{className:"text-[10px] font-bold",children:n==null?void 0:n.current_streak})]})]}),s.jsxs("div",{className:"h-1.5 w-full bg-slate-100 rounded-full overflow-hidden relative",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 via-purple-400 to-amber-400 opacity-20 w-full animate-pulse"}),s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-amber-500 rounded-full transition-all duration-700",style:{width:`${j}%`}})]})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"relative overflow-hidden bg-white rounded-2xl p-4 border border-slate-200 shadow-sm",children:s.jsxs("div",{className:"relative flex items-center gap-4",children:[s.jsx("div",{className:`relative w-16 h-16 rounded-full border-4 ${g.color} ${g.ring} flex items-center justify-center bg-white z-10 shadow-lg`,children:s.jsx("div",{className:`w-full h-full rounded-full ${g.bg} flex items-center justify-center`,children:s.jsx(g.icon,{className:`w-8 h-8 ${g.color.replace("border","text")}`})})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"text-lg font-bold text-slate-900",children:["Level ",n==null?void 0:n.level]}),s.jsx("span",{className:"px-2 py-0.5 bg-slate-100 rounded-full text-xs font-bold text-slate-600",children:f.name})]}),s.jsxs("div",{className:"mb-2",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1 text-slate-400 font-medium",children:[s.jsxs("span",{children:[n==null?void 0:n.xp_total," XP"]}),s.jsxs("span",{children:[f.maxXp," XP"]})]}),s.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden border border-slate-100",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-amber-500 rounded-full transition-all duration-500",style:{width:`${j}%`}})})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(vr,{className:"w-4 h-4 text-slate-500"}),s.jsx("span",{className:"font-bold text-sm text-slate-700",children:""})]}),s.jsxs("span",{className:"text-xs font-bold bg-white px-2 py-0.5 rounded border border-slate-200 text-slate-500",children:[w,"/",l.length]})]}),s.jsx("div",{className:"divide-y divide-slate-50",children:l.map(_=>s.jsxs("div",{className:`p-3 flex items-center gap-3 ${_.completed?"bg-slate-50/50 opacity-60":"hover:bg-slate-50"}`,children:[s.jsx("div",{className:`shrink-0 w-6 h-6 rounded-full flex items-center justify-center ${_.completed?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-400"}`,children:_.completed?s.jsx(Ct,{className:"w-3.5 h-3.5"}):s.jsx(vr,{className:"w-3.5 h-3.5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:`text-xs font-bold truncate ${_.completed?"text-slate-500 line-through":"text-slate-700"}`,children:_.title}),s.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[s.jsx("div",{className:"flex-1 h-1 bg-slate-100 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${_.completed?"bg-emerald-500":"bg-blue-500"}`,style:{width:`${Math.min(_.progress/_.target*100,100)}%`}})}),s.jsxs("span",{className:"text-[10px] text-slate-400 font-medium",children:[_.progress,"/",_.target]})]})]})]},_.id))})]})]})},je=({children:e,variant:t="primary",size:r="md",className:n="",...a})=>{const l="inline-flex items-center justify-center font-medium transition-all focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg active:scale-[0.98]",c={primary:"bg-brand-600 text-white hover:bg-brand-700 shadow-sm border border-transparent focus:ring-brand-500",secondary:"bg-white text-slate-700 border border-slate-200 hover:bg-slate-50 hover:text-slate-900 hover:border-slate-300 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800 focus:ring-slate-200",ghost:"text-slate-500 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-400 dark:hover:bg-slate-800 dark:hover:text-slate-200 border border-transparent",danger:"bg-rose-600 text-white hover:bg-rose-700 shadow-sm border border-transparent focus:ring-rose-500"},d={sm:"px-3 py-1.5 text-xs h-8",md:"px-4 py-2 text-sm h-10",lg:"px-6 py-3 text-base h-12",icon:"p-2 h-9 w-9"};return s.jsx("button",{className:`${l} ${c[t]} ${d[r]} ${n}`,...a,children:e})};var Af={exports:{}},eS;function QB(){if(eS)return Af.exports;eS=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(S,T,D){return Function.prototype.apply.call(S,T,D)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:r=function(S){return Object.getOwnPropertyNames(S)};function n(E){console&&console.warn&&console.warn(E)}var a=Number.isNaN||function(S){return S!==S};function l(){l.init.call(this)}Af.exports=l,Af.exports.once=N,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function d(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(E){if(typeof E!="number"||E<0||a(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");c=E}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||a(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function h(E){return E._maxListeners===void 0?l.defaultMaxListeners:E._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(S){for(var T=[],D=1;D<arguments.length;D++)T.push(arguments[D]);var P=S==="error",I=this._events;if(I!==void 0)P=P&&I.error===void 0;else if(!P)return!1;if(P){var $;if(T.length>0&&($=T[0]),$ instanceof Error)throw $;var M=new Error("Unhandled error."+($?" ("+$.message+")":""));throw M.context=$,M}var R=I[S];if(R===void 0)return!1;if(typeof R=="function")t(R,this,T);else for(var F=R.length,V=j(R,F),D=0;D<F;++D)t(V[D],this,T);return!0};function f(E,S,T,D){var P,I,$;if(d(T),I=E._events,I===void 0?(I=E._events=Object.create(null),E._eventsCount=0):(I.newListener!==void 0&&(E.emit("newListener",S,T.listener?T.listener:T),I=E._events),$=I[S]),$===void 0)$=I[S]=T,++E._eventsCount;else if(typeof $=="function"?$=I[S]=D?[T,$]:[$,T]:D?$.unshift(T):$.push(T),P=h(E),P>0&&$.length>P&&!$.warned){$.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=E,M.type=S,M.count=$.length,n(M)}return E}l.prototype.addListener=function(S,T){return f(this,S,T,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(S,T){return f(this,S,T,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(E,S,T){var D={fired:!1,wrapFn:void 0,target:E,type:S,listener:T},P=m.bind(D);return P.listener=T,D.wrapFn=P,P}l.prototype.once=function(S,T){return d(T),this.on(S,g(this,S,T)),this},l.prototype.prependOnceListener=function(S,T){return d(T),this.prependListener(S,g(this,S,T)),this},l.prototype.removeListener=function(S,T){var D,P,I,$,M;if(d(T),P=this._events,P===void 0)return this;if(D=P[S],D===void 0)return this;if(D===T||D.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete P[S],P.removeListener&&this.emit("removeListener",S,D.listener||T));else if(typeof D!="function"){for(I=-1,$=D.length-1;$>=0;$--)if(D[$]===T||D[$].listener===T){M=D[$].listener,I=$;break}if(I<0)return this;I===0?D.shift():w(D,I),D.length===1&&(P[S]=D[0]),P.removeListener!==void 0&&this.emit("removeListener",S,M||T)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(S){var T,D,P;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete D[S]),this;if(arguments.length===0){var I=Object.keys(D),$;for(P=0;P<I.length;++P)$=I[P],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=D[S],typeof T=="function")this.removeListener(S,T);else if(T!==void 0)for(P=T.length-1;P>=0;P--)this.removeListener(S,T[P]);return this};function x(E,S,T){var D=E._events;if(D===void 0)return[];var P=D[S];return P===void 0?[]:typeof P=="function"?T?[P.listener||P]:[P]:T?_(P):j(P,P.length)}l.prototype.listeners=function(S){return x(this,S,!0)},l.prototype.rawListeners=function(S){return x(this,S,!1)},l.listenerCount=function(E,S){return typeof E.listenerCount=="function"?E.listenerCount(S):b.call(E,S)},l.prototype.listenerCount=b;function b(E){var S=this._events;if(S!==void 0){var T=S[E];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function j(E,S){for(var T=new Array(S),D=0;D<S;++D)T[D]=E[D];return T}function w(E,S){for(;S+1<E.length;S++)E[S]=E[S+1];E.pop()}function _(E){for(var S=new Array(E.length),T=0;T<S.length;++T)S[T]=E[T].listener||E[T];return S}function N(E,S){return new Promise(function(T,D){function P($){E.removeListener(S,I),D($)}function I(){typeof E.removeListener=="function"&&E.removeListener("error",P),T([].slice.call(arguments))}A(E,S,I,{once:!0}),S!=="error"&&C(E,P,{once:!0})})}function C(E,S,T){typeof E.on=="function"&&A(E,"error",S,T)}function A(E,S,T,D){if(typeof E.on=="function")D.once?E.once(S,T):E.on(S,T);else if(typeof E.addEventListener=="function")E.addEventListener(S,function P(I){D.once&&E.removeEventListener(S,P),T(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Af.exports}var zs=QB();class Wv extends zs.EventEmitter{constructor(t){super(),Object.defineProperties(this,{_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get(){let r=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){const n=Math.random(),a=Math.floor(n*this._jitter*r);r=(Math.floor(n*10)&1)===0?r-a:r+a}return Math.min(r,this._max)|0}},_factor:{value:t.factor||2},_jitter:{value:t.jitter>0&&t.jitter<=1?t.jitter:0},_max:{value:t.max||1e4},_min:{value:t.min||100},_timeoutID:{value:null,writable:!0}})}backoff(){const t=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this.emit("backoff",this._attempts,t),this._timeoutID=setTimeout(()=>{this.emit("ready",this._attempts,t),this._attempts++},t)}reset(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}}var n0={exports:{}},ZB=n0.exports,tS;function eU(){return tS||(tS=1,(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(ZB,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"],l={},c=null;function d(w,_){var N=w[_];if(typeof N.bind=="function")return N.bind(w);try{return Function.prototype.bind.call(N,w)}catch{return function(){return Function.prototype.apply.apply(N,[w,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(w){return w==="debug"&&(w="log"),typeof console===r?!1:w==="trace"&&n?h:console[w]!==void 0?d(console,w):console.log!==void 0?d(console,"log"):t}function m(){for(var w=this.getLevel(),_=0;_<a.length;_++){var N=a[_];this[N]=_<w?t:this.methodFactory(N,w,this.name)}if(this.log=this.debug,typeof console===r&&w<this.levels.SILENT)return"No console available for logging"}function g(w){return function(){typeof console!==r&&(m.call(this),this[w].apply(this,arguments))}}function x(w,_,N){return f(w)||g.apply(this,arguments)}function b(w,_){var N=this,C,A,E,S="loglevel";typeof w=="string"?S+=":"+w:typeof w=="symbol"&&(S=void 0);function T(M){var R=(a[M]||"silent").toUpperCase();if(!(typeof window===r||!S)){try{window.localStorage[S]=R;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+R+";"}catch{}}}function D(){var M;if(!(typeof window===r||!S)){try{M=window.localStorage[S]}catch{}if(typeof M===r)try{var R=window.document.cookie,F=encodeURIComponent(S),V=R.indexOf(F+"=");V!==-1&&(M=/^([^;]+)/.exec(R.slice(V+F.length+1))[1])}catch{}return N.levels[M]===void 0&&(M=void 0),M}}function P(){if(!(typeof window===r||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function I(M){var R=M;if(typeof R=="string"&&N.levels[R.toUpperCase()]!==void 0&&(R=N.levels[R.toUpperCase()]),typeof R=="number"&&R>=0&&R<=N.levels.SILENT)return R;throw new TypeError("log.setLevel() called with invalid level: "+M)}N.name=w,N.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},N.methodFactory=_||x,N.getLevel=function(){return E??A??C},N.setLevel=function(M,R){return E=I(M),R!==!1&&T(E),m.call(N)},N.setDefaultLevel=function(M){A=I(M),D()||N.setLevel(M,!1)},N.resetLevel=function(){E=null,P(),m.call(N)},N.enableAll=function(M){N.setLevel(N.levels.TRACE,M)},N.disableAll=function(M){N.setLevel(N.levels.SILENT,M)},N.rebuild=function(){if(c!==N&&(C=I(c.getLevel())),m.call(N),c===N)for(var M in l)l[M].rebuild()},C=I(c?c.getLevel():"WARN");var $=D();$!=null&&(E=I($)),m.call(N)}c=new b,c.getLogger=function(_){if(typeof _!="symbol"&&typeof _!="string"||_==="")throw new TypeError("You must supply a name when creating a logger.");var N=l[_];return N||(N=l[_]=new b(_,c.methodFactory)),N};var j=typeof window!==r?window.log:void 0;return c.noConflict=function(){return typeof window!==r&&window.log===c&&(window.log=j),c},c.getLoggers=function(){return l},c.default=c,c})})(n0)),n0.exports}var pu=eU();const tU=vs(pu),rU=cw({__proto__:null,default:tU},[pu]);class bt extends Error{constructor(t,r){super(),Object.setPrototypeOf(this,bt.prototype);const n=typeof t=="string"?t:this.explanation,a=typeof t=="object"?t:r;this.message=`${this.name} (${this.code}): ${n}`,this.originalError=a}}var Vr;(function(e){class t extends bt{constructor(l,c){super(l,c),this.causes=[],this.code=20101,this.description="Invalid access token",this.explanation="Twilio was unable to validate your Access Token",this.name="AccessTokenInvalid",this.solutions=[],Object.setPrototypeOf(this,e.AccessTokenInvalid.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.AccessTokenInvalid=t;class r extends bt{constructor(l,c){super(l,c),this.causes=[],this.code=20104,this.description="Access token expired or expiration date invalid",this.explanation="The Access Token provided to the Twilio API has expired, the expiration time specified in the token was invalid, or the expiration time specified was too far in the future",this.name="AccessTokenExpired",this.solutions=[],Object.setPrototypeOf(this,e.AccessTokenExpired.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.AccessTokenExpired=r;class n extends bt{constructor(l,c){super(l,c),this.causes=[],this.code=20151,this.description="Authentication Failed",this.explanation="The Authentication with the provided JWT failed",this.name="AuthenticationFailed",this.solutions=[],Object.setPrototypeOf(this,e.AuthenticationFailed.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.AuthenticationFailed=n})(Vr||(Vr={}));var Gv;(function(e){class t extends bt{constructor(n,a){super(n,a),this.causes=["The access token has an invalid Account SID, API Key, or API Key Secret."],this.code=31202,this.description="Signature validation failed.",this.explanation="The provided access token failed signature validation.",this.name="AccessTokenSignatureValidationFailed",this.solutions=["Ensure the Account SID, API Key, and API Key Secret are valid when generating your access token."],Object.setPrototypeOf(this,e.AccessTokenSignatureValidationFailed.prototype);const l=typeof n=="string"?n:this.explanation,c=typeof n=="object"?n:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=c}}e.AccessTokenSignatureValidationFailed=t})(Gv||(Gv={}));var Fl;(function(e){class t extends bt{constructor(c,d){super(c,d),this.causes=[],this.code=31400,this.description="Bad Request (HTTP/SIP)",this.explanation="The request could not be understood due to malformed syntax.",this.name="BadRequest",this.solutions=[],Object.setPrototypeOf(this,e.BadRequest.prototype);const h=typeof c=="string"?c:this.explanation,f=typeof c=="object"?c:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=f}}e.BadRequest=t;class r extends bt{constructor(c,d){super(c,d),this.causes=["The outbound call was made to an invalid phone number.","The TwiML application sid is missing a Voice URL."],this.code=31404,this.description="Not Found (HTTP/SIP)",this.explanation="The server has not found anything matching the request.",this.name="NotFound",this.solutions=["Ensure the phone number dialed is valid.","Ensure the TwiML application is configured correctly with a Voice URL link."],Object.setPrototypeOf(this,e.NotFound.prototype);const h=typeof c=="string"?c:this.explanation,f=typeof c=="object"?c:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=f}}e.NotFound=r;class n extends bt{constructor(c,d){super(c,d),this.causes=[],this.code=31480,this.description="Temporarily Unavailable (SIP)",this.explanation="The callee is currently unavailable.",this.name="TemporarilyUnavailable",this.solutions=[],Object.setPrototypeOf(this,e.TemporarilyUnavailable.prototype);const h=typeof c=="string"?c:this.explanation,f=typeof c=="object"?c:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=f}}e.TemporarilyUnavailable=n;class a extends bt{constructor(c,d){super(c,d),this.causes=[],this.code=31486,this.description="Busy Here (SIP)",this.explanation="The callee is busy.",this.name="BusyHere",this.solutions=[],Object.setPrototypeOf(this,e.BusyHere.prototype);const h=typeof c=="string"?c:this.explanation,f=typeof c=="object"?c:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=f}}e.BusyHere=a})(Fl||(Fl={}));var Kv;(function(e){class t extends bt{constructor(n,a){super(n,a),this.causes=[],this.code=31603,this.description="Decline (SIP)",this.explanation="The callee does not wish to participate in the call.",this.name="Decline",this.solutions=[],Object.setPrototypeOf(this,e.Decline.prototype);const l=typeof n=="string"?n:this.explanation,c=typeof n=="object"?n:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=c}}e.Decline=t})(Kv||(Kv={}));var An;(function(e){class t extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31e3,this.description="Unknown Error",this.explanation="An unknown error has occurred. See error details for more information.",this.name="UnknownError",this.solutions=[],Object.setPrototypeOf(this,e.UnknownError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.UnknownError=t;class r extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31001,this.description="Application Not Found",this.explanation="",this.name="ApplicationNotFoundError",this.solutions=[],Object.setPrototypeOf(this,e.ApplicationNotFoundError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.ApplicationNotFoundError=r;class n extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31002,this.description="Connection Declined",this.explanation="",this.name="ConnectionDeclinedError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionDeclinedError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.ConnectionDeclinedError=n;class a extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31003,this.description="Connection Timeout",this.explanation="The server could not produce a response within a suitable amount of time.",this.name="ConnectionTimeoutError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionTimeoutError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.ConnectionTimeoutError=a;class l extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31005,this.description="Connection error",this.explanation="A connection error occurred during the call",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.ConnectionError=l;class c extends bt{constructor(f,m){super(f,m),this.causes=["The incoming call was cancelled because it was not answered in time or it was accepted/rejected by another application instance registered with the same identity."],this.code=31008,this.description="Call cancelled",this.explanation="Unable to answer because the call has ended",this.name="CallCancelledError",this.solutions=[],Object.setPrototypeOf(this,e.CallCancelledError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.CallCancelledError=c;class d extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31009,this.description="Transport error",this.explanation="No transport available to send or receive messages",this.name="TransportError",this.solutions=[],Object.setPrototypeOf(this,e.TransportError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.TransportError=d})(An||(An={}));var Ya;(function(e){class t extends bt{constructor(f,m){super(f,m),this.causes=["Invalid content or MessageType passed to sendMessage method."],this.code=31100,this.description="The request had malformed syntax.",this.explanation="The request could not be understood due to malformed syntax.",this.name="MalformedRequestError",this.solutions=["Ensure content and MessageType passed to sendMessage method are valid."],Object.setPrototypeOf(this,e.MalformedRequestError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.MalformedRequestError=t;class r extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31101,this.description="Missing parameter array in request",this.explanation="",this.name="MissingParameterArrayError",this.solutions=[],Object.setPrototypeOf(this,e.MissingParameterArrayError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.MissingParameterArrayError=r;class n extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31102,this.description="Authorization token missing in request.",this.explanation="",this.name="AuthorizationTokenMissingError",this.solutions=[],Object.setPrototypeOf(this,e.AuthorizationTokenMissingError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.AuthorizationTokenMissingError=n;class a extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31103,this.description="Maximum parameter length has been exceeded.",this.explanation="Length of parameters cannot exceed MAX_PARAM_LENGTH.",this.name="MaxParameterLengthExceededError",this.solutions=[],Object.setPrototypeOf(this,e.MaxParameterLengthExceededError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.MaxParameterLengthExceededError=a;class l extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31104,this.description="Invalid bridge token",this.explanation="",this.name="InvalidBridgeTokenError",this.solutions=[],Object.setPrototypeOf(this,e.InvalidBridgeTokenError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.InvalidBridgeTokenError=l;class c extends bt{constructor(f,m){super(f,m),this.causes=["Client name contains invalid characters."],this.code=31105,this.description="Invalid client name",this.explanation="Client name should not contain control, space, delims, or unwise characters.",this.name="InvalidClientNameError",this.solutions=["Make sure that client name does not contain any of the invalid characters."],Object.setPrototypeOf(this,e.InvalidClientNameError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.InvalidClientNameError=c;class d extends bt{constructor(f,m){super(f,m),this.causes=[],this.code=31107,this.description="The reconnect parameter is invalid",this.explanation="",this.name="ReconnectParameterInvalidError",this.solutions=[],Object.setPrototypeOf(this,e.ReconnectParameterInvalidError.prototype);const g=typeof f=="string"?f:this.explanation,x=typeof f=="object"?f:m;this.message=`${this.name} (${this.code}): ${g}`,this.originalError=x}}e.ReconnectParameterInvalidError=d})(Ya||(Ya={}));(function(e){class t extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31201,this.description="Authorization error",this.explanation="The request requires user authentication. The server understood the request, but is refusing to fulfill it.",this.name="AuthorizationError",this.solutions=[],Object.setPrototypeOf(this,e.AuthorizationError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.AuthorizationError=t;class r extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31203,this.description="No valid account",this.explanation="",this.name="NoValidAccountError",this.solutions=[],Object.setPrototypeOf(this,e.NoValidAccountError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.NoValidAccountError=r;class n extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31204,this.description="Invalid JWT token",this.explanation="",this.name="InvalidJWTTokenError",this.solutions=[],Object.setPrototypeOf(this,e.InvalidJWTTokenError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.InvalidJWTTokenError=n;class a extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31205,this.description="JWT token expired",this.explanation="",this.name="JWTTokenExpiredError",this.solutions=[],Object.setPrototypeOf(this,e.JWTTokenExpiredError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.JWTTokenExpiredError=a;class l extends bt{constructor(g,x){super(g,x),this.causes=["Rate limit exceeded."],this.code=31206,this.description="Rate exceeded authorized limit.",this.explanation="The request performed exceeds the authorized limit.",this.name="RateExceededError",this.solutions=["Ensure message send rate does not exceed authorized limits."],Object.setPrototypeOf(this,e.RateExceededError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.RateExceededError=l;class c extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31207,this.description="JWT token expiration too long",this.explanation="",this.name="JWTTokenExpirationTooLongError",this.solutions=[],Object.setPrototypeOf(this,e.JWTTokenExpirationTooLongError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.JWTTokenExpirationTooLongError=c;class d extends bt{constructor(g,x){super(g,x),this.causes=[],this.code=31209,this.description="Reconnect attempt is not authorized.",this.explanation="",this.name="ReconnectAttemptError",this.solutions=[],Object.setPrototypeOf(this,e.ReconnectAttemptError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.ReconnectAttemptError=d;class h extends bt{constructor(g,x){super(g,x),this.causes=["The Call Message Event Type is invalid and is not understood by Twilio Voice."],this.code=31210,this.description="Call Message Event Type is invalid.",this.explanation="The Call Message Event Type is invalid and is not understood by Twilio Voice.",this.name="CallMessageEventTypeInvalidError",this.solutions=["Ensure the Call Message Event Type is Valid and understood by Twilio Voice and try again."],Object.setPrototypeOf(this,e.CallMessageEventTypeInvalidError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.CallMessageEventTypeInvalidError=h;class f extends bt{constructor(g,x){super(g,x),this.causes=["The payload size of Call Message Event exceeds the authorized limit."],this.code=31212,this.description="Call Message Event Payload size exceeded authorized limit.",this.explanation="The request performed to send a Call Message Event exceeds the payload size authorized limit",this.name="PayloadSizeExceededError",this.solutions=["Reduce payload size of Call Message Event to be within the authorized limit and try again."],Object.setPrototypeOf(this,e.PayloadSizeExceededError.prototype);const b=typeof g=="string"?g:this.explanation,j=typeof g=="object"?g:x;this.message=`${this.name} (${this.code}): ${b}`,this.originalError=j}}e.PayloadSizeExceededError=f})(Vr||(Vr={}));var kc;(function(e){class t extends bt{constructor(a,l){super(a,l),this.causes=["The user denied the getUserMedia request.","The browser denied the getUserMedia request."],this.code=31401,this.description="UserMedia Permission Denied Error",this.explanation="The browser or end-user denied permissions to user media. Therefore we were unable to acquire input audio.",this.name="PermissionDeniedError",this.solutions=["The user should accept the request next time prompted. If the browser saved the deny, the user should change that permission in their browser.","The user should to verify that the browser has permission to access the microphone at this address."],Object.setPrototypeOf(this,e.PermissionDeniedError.prototype);const c=typeof a=="string"?a:this.explanation,d=typeof a=="object"?a:l;this.message=`${this.name} (${this.code}): ${c}`,this.originalError=d}}e.PermissionDeniedError=t;class r extends bt{constructor(a,l){super(a,l),this.causes=["NotFoundError - The deviceID specified was not found.","The getUserMedia constraints were overconstrained and no devices matched."],this.code=31402,this.description="UserMedia Acquisition Failed Error",this.explanation="The browser and end-user allowed permissions, however getting the media failed. Usually this is due to bad constraints, but can sometimes fail due to browser, OS or hardware issues.",this.name="AcquisitionFailedError",this.solutions=["Ensure the deviceID being specified exists.","Try acquiring media with fewer constraints."],Object.setPrototypeOf(this,e.AcquisitionFailedError.prototype);const c=typeof a=="string"?a:this.explanation,d=typeof a=="object"?a:l;this.message=`${this.name} (${this.code}): ${c}`,this.originalError=d}}e.AcquisitionFailedError=r})(kc||(kc={}));var Ls;(function(e){class t extends bt{constructor(a,l){super(a,l),this.causes=[],this.code=53e3,this.description="Signaling connection error",this.explanation="Raised whenever a signaling connection error occurs that is not covered by a more specific error code.",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,e.ConnectionError.prototype);const c=typeof a=="string"?a:this.explanation,d=typeof a=="object"?a:l;this.message=`${this.name} (${this.code}): ${c}`,this.originalError=d}}e.ConnectionError=t;class r extends bt{constructor(a,l){super(a,l),this.causes=["The device running your application lost its Internet connection."],this.code=53001,this.description="Signaling connection disconnected",this.explanation="Raised whenever the signaling connection is unexpectedly disconnected.",this.name="ConnectionDisconnected",this.solutions=["Ensure the device running your application has access to a stable Internet connection."],Object.setPrototypeOf(this,e.ConnectionDisconnected.prototype);const c=typeof a=="string"?a:this.explanation,d=typeof a=="object"?a:l;this.message=`${this.name} (${this.code}): ${c}`,this.originalError=d}}e.ConnectionDisconnected=r})(Ls||(Ls={}));var ya;(function(e){class t extends bt{constructor(l,c){super(l,c),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may not have the necessary resources to create or apply a new media description."],this.code=53400,this.description="Client is unable to create or apply a local media description",this.explanation="Raised whenever a Client is unable to create or apply a local media description.",this.name="ClientLocalDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,e.ClientLocalDescFailed.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ClientLocalDescFailed=t;class r extends bt{constructor(l,c){super(l,c),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may be connecting peer-to-peer with another Participant that is not using a supported WebRTC implementation.","The Client may not have the necessary resources to apply a new media description."],this.code=53402,this.description="Client is unable to apply a remote media description",this.explanation="Raised whenever the Client receives a remote media description but is unable to apply it.",this.name="ClientRemoteDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,e.ClientRemoteDescFailed.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ClientRemoteDescFailed=r;class n extends bt{constructor(l,c){super(l,c),this.causes=["The Client was unable to establish a media connection.","A media connection which was active failed liveliness checks."],this.code=53405,this.description="Media connection failed",this.explanation="Raised by the Client or Server whenever a media connection fails.",this.name="ConnectionError",this.solutions=["If the problem persists, try connecting to another region.","Check your Client's network connectivity.","If you've provided custom ICE Servers then ensure that the URLs and credentials are valid."],Object.setPrototypeOf(this,e.ConnectionError.prototype);const d=typeof l=="string"?l:this.explanation,h=typeof l=="object"?l:c;this.message=`${this.name} (${this.code}): ${d}`,this.originalError=h}}e.ConnectionError=n})(ya||(ya={}));const Ow=new Map([[20101,Vr.AccessTokenInvalid],[20104,Vr.AccessTokenExpired],[20151,Vr.AuthenticationFailed],[31202,Gv.AccessTokenSignatureValidationFailed],[31400,Fl.BadRequest],[31404,Fl.NotFound],[31480,Fl.TemporarilyUnavailable],[31486,Fl.BusyHere],[31603,Kv.Decline],[31e3,An.UnknownError],[31001,An.ApplicationNotFoundError],[31002,An.ConnectionDeclinedError],[31003,An.ConnectionTimeoutError],[31005,An.ConnectionError],[31008,An.CallCancelledError],[31009,An.TransportError],[31100,Ya.MalformedRequestError],[31101,Ya.MissingParameterArrayError],[31102,Ya.AuthorizationTokenMissingError],[31103,Ya.MaxParameterLengthExceededError],[31104,Ya.InvalidBridgeTokenError],[31105,Ya.InvalidClientNameError],[31107,Ya.ReconnectParameterInvalidError],[31201,Vr.AuthorizationError],[31203,Vr.NoValidAccountError],[31204,Vr.InvalidJWTTokenError],[31205,Vr.JWTTokenExpiredError],[31206,Vr.RateExceededError],[31207,Vr.JWTTokenExpirationTooLongError],[31209,Vr.ReconnectAttemptError],[31210,Vr.CallMessageEventTypeInvalidError],[31212,Vr.PayloadSizeExceededError],[31401,kc.PermissionDeniedError],[31402,kc.AcquisitionFailedError],[53e3,Ls.ConnectionError],[53001,Ls.ConnectionDisconnected],[53400,ya.ClientLocalDescFailed],[53402,ya.ClientRemoteDescFailed],[53405,ya.ConnectionError]]);Object.freeze(Ow);const nU=new Set([31001,31002,31003,31101,31102,31103,31104,31105,31107,31201,31202,31203,31204,31205,31207,31404,31480,31486,31603]);function Yv(e,t){if(!(typeof t!="number"||!aU(t)||!(e||!nU.has(t))))return sU(t)}class Bt extends Error{constructor(t){super(t),this.name="InvalidArgumentError"}}class Xs extends Error{constructor(t){super(t),this.name="InvalidStateError"}}class an extends Error{constructor(t){super(t),this.name="NotSupportedError"}}function sU(e){const t=Ow.get(e);if(!t)throw new Bt(`Error code ${e} not found`);return t}function aU(e){return Ow.has(e)}const XA="@twilio/voice-sdk",gc="2.17.0",Pw="https://sdk.twilio.com/js/client/sounds/releases/1.0.0",iU=`${Pw}/cowbell.mp3?cache=${gc}`,lU=2e4;class Gr{static getLogLevelInstance(t){if(!Gr.loglevelInstance)try{Gr.loglevelInstance=(t&&t.LogLevelModule?t.LogLevelModule:rU).getLogger(XA)}catch{console.warn("Cannot create custom logger"),Gr.loglevelInstance=console}return Gr.loglevelInstance}constructor(t,r){this._log=Gr.getLogLevelInstance(r),this._prefix=`[TwilioVoice][${t}]`}debug(...t){this._log.debug(this._prefix,...t)}error(...t){this._log.error(this._prefix,...t)}info(...t){this._log.info(this._prefix,...t)}setDefaultLevel(t){this._log.setDefaultLevel?this._log.setDefaultLevel(t):console.warn("Logger cannot setDefaultLevel")}warn(...t){this._log.warn(this._prefix,...t)}}Gr.levels=pu.levels;Gr.getLogLevelInstance();const oU=`${Pw}/outgoing.mp3`;class rS{constructor(t,r,n,a){this._name=t,this._availableDevices=r,this._beforeChange=n,this._isSupported=a,this._activeDevices=new Set,this._log=new Gr("OutputDeviceCollection")}delete(t){this._log.debug(".delete",t);const r=!!this._activeDevices.delete(t),n=this._availableDevices.get("default")||Array.from(this._availableDevices.values())[0];!this._activeDevices.size&&n&&this._activeDevices.add(n);const a=Array.from(this._activeDevices.values()).map(l=>l.deviceId);return this._beforeChange(this._name,a),!!r}get(){return this._activeDevices}set(t){if(this._log.debug(".set",t),!this._isSupported)return Promise.reject(new an("This browser does not support audio output selection"));const r=Array.isArray(t)?t:[t];if(!r.length)return Promise.reject(new Bt("Must specify at least one device to set"));const n=[],a=r.map(l=>{const c=this._availableDevices.get(l);return c||n.push(l),c});return n.length?Promise.reject(new Bt(`Devices not found: ${n.join(", ")}`)):new Promise(l=>{l(this._beforeChange(this._name,r))}).then(()=>{this._activeDevices.clear(),a.forEach(this._activeDevices.add,this._activeDevices)})}test(t=oU){return this._isSupported?this._activeDevices.size?Promise.all(Array.from(this._activeDevices).map(r=>{let n;return new Promise(a=>{n=new Audio(t),n.oncanplay=a}).then(()=>n.setSinkId(r.deviceId).then(()=>n.play()))})):Promise.reject(new Xs("No active output devices to test")):Promise.reject(new an("This browser does not support audio output selection"))}}class cU{constructor(t){Object.defineProperties(this,{deviceId:{get(){return t.deviceId}},groupId:{get(){return t.groupId}},kind:{get(){return t.kind}},label:{get(){return t.label}}})}}function C0(e){if(!(this instanceof C0))return new C0(e);this.message=e}C0.prototype.toString=function(){return`Twilio.Exception: ${this.message}`};function iu(e){return e&&e.length?e.reduce((t,r)=>t+r)/e.length:0}function Dw(e,t,r){r=r||(a=>a);const n=new Set(t.map(r));return e.filter(a=>!n.has(r(a)))}function JA(e){return!!e.userAgent.match("Electron")}function Mw(e,t){const r=!!t.userAgent.match("CriOS"),n=!!t.userAgent.match("HeadlessChrome"),a=typeof e.chrome<"u"&&t.vendor==="Google Inc."&&t.userAgent.indexOf("OPR")===-1&&t.userAgent.indexOf("Edge")===-1;return r||JA(t)||a||n}function dU(e){return e=e||(typeof window>"u"?global.navigator:window.navigator),!!e&&typeof e.userAgent=="string"&&/firefox|fxios/i.test(e.userAgent)}function Em(e){return e=e||(typeof window>"u"?global.navigator:window.navigator),!!e&&typeof e.userAgent=="string"&&/edge\/\d+/i.test(e.userAgent)}function uU(e){return!!e.vendor&&e.vendor.indexOf("Apple")!==-1&&e.userAgent&&e.userAgent.indexOf("CriOS")===-1&&e.userAgent.indexOf("FxiOS")===-1}function QA(e){return e?e.split("&").reduce((t,r)=>{const n=r.split("="),a=n[0],l=decodeURIComponent((n[1]||"").replace(/\+/g,"%20"));return a&&(t[a]=l),t},{}):""}function Xv(e,t){const r=e instanceof Map||e instanceof Set?Array.from(e.values()):e;return t=t||(n=>n),r.reduce((n,a)=>{const l=t(a);return n.concat(l)},[])}function Jv(e,t,r){return new Promise((n,a)=>{function l(){e.removeListener(r,c),n()}function c(){e.removeListener(t,l),a()}e.once(t,l),e.once(r,c)})}function ZA(e,t){const r=t.map(n=>"audio/"+n.toLowerCase());return e.sort((n,a)=>{const l=r.indexOf(n.mimeType.toLowerCase()),c=r.indexOf(a.mimeType.toLowerCase()),d=l>=0?l:Number.MAX_VALUE,h=c>=0?c:Number.MAX_VALUE;return d-h})}const hU=C0,eT=Object.freeze(Object.defineProperty({__proto__:null,Exception:hU,average:iu,difference:Dw,flatMap:Xv,isChrome:Mw,isElectron:JA,isFirefox:dU,isLegacyEdge:Em,isSafari:uU,promisifyEvents:Jv,queryToJson:QA,sortByMimeTypes:ZA},Symbol.toStringTag,{value:"Module"})),fU={audioinput:"Audio Input",audiooutput:"Audio Output"};class Qv extends zs.EventEmitter{get audioConstraints(){return this._audioConstraints}get inputDevice(){return this._inputDevice}get inputStream(){return this._localProcessedStream||this._selectedInputDeviceStream}get processedStream(){return this._log.warn("AudioHelper#processedStream is deprecated. Please use AudioHelper#localProcessedStream instead."),this._localProcessedStream}get localProcessedStream(){return this._localProcessedStream}get remoteProcessedStream(){return this._remoteProcessedStream}constructor(t,r,n){super(),this.availableInputDevices=new Map,this.availableOutputDevices=new Map,this._audioConstraints=null,this._defaultInputDeviceStream=null,this._enabledSounds={[Ie.SoundName.Disconnect]:!0,[Ie.SoundName.Incoming]:!0,[Ie.SoundName.Outgoing]:!0},this._inputDevice=null,this._inputDevicePromise=null,this._isPollingInputVolume=!1,this._log=new Gr("AudioHelper"),this._localProcessedStream=null,this._remoteProcessedStream=null,this._selectedInputDeviceStream=null,this._unknownDeviceIndexes={audioinput:{},audiooutput:{}},this._updateAvailableDevices=()=>!this._mediaDevices||!this._enumerateDevices?Promise.reject("Enumeration not supported"):this._enumerateDevices().then(d=>{this._updateDevices(d.filter(f=>f.kind==="audiooutput"),this.availableOutputDevices,this._removeLostOutput),this._updateDevices(d.filter(f=>f.kind==="audioinput"),this.availableInputDevices,this._removeLostInput);const h=this.availableOutputDevices.get("default")||Array.from(this.availableOutputDevices.values())[0];[this.speakerDevices,this.ringtoneDevices].forEach(f=>{!f.get().size&&this.availableOutputDevices.size&&this.isOutputSelectionSupported&&f.set(h.deviceId).catch(m=>{this._log.warn(`Unable to set audio output devices. ${m}`)})})}),this._removeLostInput=d=>{if(!this.inputDevice||this.inputDevice.deviceId!==d.deviceId)return!1;this._destroyLocalProcessedStream(),this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume();const h=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return h&&this.setInputDevice(h.deviceId),!0},this._removeLostOutput=d=>{const h=this.speakerDevices.delete(d),f=this.ringtoneDevices.delete(d);return h||f},n=Object.assign({AudioContext:typeof AudioContext<"u"&&AudioContext,setSinkId:typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId},n),this._beforeSetInputDevice=n.beforeSetInputDevice||(()=>Promise.resolve()),this._updateUserOptions(n),this._audioProcessorEventObserver=n.audioProcessorEventObserver,this._mediaDevices=n.mediaDevices||navigator.mediaDevices,this._onActiveInputChanged=r,this._enumerateDevices=typeof n.enumerateDevices=="function"?n.enumerateDevices:this._mediaDevices&&this._mediaDevices.enumerateDevices.bind(this._mediaDevices);const a=!!(n.AudioContext||n.audioContext),l=!!this._enumerateDevices;n.enabledSounds&&(this._enabledSounds=n.enabledSounds);const c=typeof n.setSinkId=="function";this.isOutputSelectionSupported=l&&c,this.isVolumeSupported=a,this.isVolumeSupported&&(this._audioContext=n.audioContext||n.AudioContext&&new n.AudioContext,this._audioContext&&(this._inputVolumeAnalyser=this._audioContext.createAnalyser(),this._inputVolumeAnalyser.fftSize=32,this._inputVolumeAnalyser.smoothingTimeConstant=.3)),this.ringtoneDevices=new rS("ringtone",this.availableOutputDevices,t,this.isOutputSelectionSupported),this.speakerDevices=new rS("speaker",this.availableOutputDevices,t,this.isOutputSelectionSupported),this.addListener("newListener",d=>{d==="inputVolume"&&this._maybeStartPollingVolume()}),this.addListener("removeListener",d=>{d==="inputVolume"&&this._maybeStopPollingVolume()}),this.once("newListener",()=>{this.isOutputSelectionSupported||this._log.warn("Warning: This browser does not support audio output selection."),this.isVolumeSupported||this._log.warn("Warning: This browser does not support Twilio's volume indicator feature.")}),l&&this._initializeEnumeration(),navigator&&navigator.permissions&&typeof navigator.permissions.query=="function"?navigator.permissions.query({name:"microphone"}).then(d=>{if(d.state!=="granted"){const h=()=>{this._updateAvailableDevices(),this._stopMicrophonePermissionListener()};d.addEventListener("change",h),this._microphonePermissionStatus=d,this._onMicrophonePermissionStatusChanged=h}}).catch(d=>this._log.warn(`Warning: unable to listen for microphone permission changes. ${d}`)):this._log.warn("Warning: current browser does not support permissions API.")}_destroy(){this._stopDefaultInputDeviceStream(),this._stopSelectedInputDeviceStream(),this._destroyLocalProcessedStream(),this._destroyRemoteProcessedStream(),this._maybeStopPollingVolume(),this.removeAllListeners(),this._stopMicrophonePermissionListener(),this._unbind()}_destroyRemoteProcessedStream(){if(this._remoteProcessor&&this._remoteProcessedStream){this._log.info("destroying remote processed stream");const t=this._remoteProcessedStream;this._remoteProcessedStream.getTracks().forEach(r=>r.stop()),this._remoteProcessedStream=null,this._remoteProcessor.destroyProcessedStream(t),this._audioProcessorEventObserver.emit("destroy",!0)}}_getInputDevicePromise(){return this._inputDevicePromise}_getAudioProcessorEventObserver(){return this._audioProcessorEventObserver}_maybeCreateRemoteProcessedStream(t){return this._remoteProcessor?(this._log.info("Creating remote processed stream"),this._remoteProcessor.createProcessedStream(t).then(r=>(this._remoteProcessedStream=r,this._audioProcessorEventObserver.emit("create",!0),this._remoteProcessedStream))):Promise.resolve(t)}_maybeStartPollingVolume(){if(!this.isVolumeSupported||!this.inputStream||(this._updateVolumeSource(),this._isPollingInputVolume||!this._inputVolumeAnalyser))return;const t=this._inputVolumeAnalyser.frequencyBinCount,r=new Uint8Array(t);this._isPollingInputVolume=!0;const n=()=>{if(this._isPollingInputVolume){if(this._inputVolumeAnalyser){this._inputVolumeAnalyser.getByteFrequencyData(r);const a=iu(r);this.emit("inputVolume",a/255)}requestAnimationFrame(n)}};requestAnimationFrame(n)}_maybeStopPollingVolume(){this.isVolumeSupported&&(!this._isPollingInputVolume||this.inputStream&&this.listenerCount("inputVolume")||(this._inputVolumeSource&&(this._inputVolumeSource.disconnect(),delete this._inputVolumeSource),this._isPollingInputVolume=!1))}_openDefaultDeviceWithConstraints(t){return this._log.info("Opening default device with constraints",t),this._getUserMedia(t).then(r=>(this._log.info("Opened default device. Updating available devices."),this._updateAvailableDevices().catch(n=>{this._log.warn("Unable to updateAvailableDevices after gUM call",n)}),this._defaultInputDeviceStream=r,this._maybeCreateLocalProcessedStream(r)))}_stopDefaultInputDeviceStream(){this._defaultInputDeviceStream&&(this._log.info("stopping default device stream"),this._defaultInputDeviceStream.getTracks().forEach(t=>t.stop()),this._defaultInputDeviceStream=null,this._destroyLocalProcessedStream())}_unbind(){var t;!((t=this._mediaDevices)===null||t===void 0)&&t.removeEventListener&&this._mediaDevices.removeEventListener("devicechange",this._updateAvailableDevices)}_updateUserOptions(t){typeof t.enumerateDevices=="function"&&(this._enumerateDevices=t.enumerateDevices),typeof t.getUserMedia=="function"&&(this._getUserMedia=t.getUserMedia)}addProcessor(t,r=!1){if(this._log.debug(".addProcessor"),this._localProcessor&&!r)throw new an("Can only have one Local AudioProcessor at a time.");if(this._remoteProcessor&&r)throw new an("Can only have one Remote AudioProcessor at a time.");if(typeof t!="object"||t===null)throw new Bt("Missing AudioProcessor argument.");if(typeof t.createProcessedStream!="function")throw new Bt("Missing createProcessedStream() method.");if(typeof t.destroyProcessedStream!="function")throw new Bt("Missing destroyProcessedStream() method.");return r?(this._remoteProcessor=t,this._audioProcessorEventObserver.emit("add",!0),Promise.resolve()):(this._localProcessor=t,this._audioProcessorEventObserver.emit("add",!1),this._restartInputStreams())}disconnect(t){return this._log.debug(".disconnect",t),this._maybeEnableSound(Ie.SoundName.Disconnect,t)}incoming(t){return this._log.debug(".incoming",t),this._maybeEnableSound(Ie.SoundName.Incoming,t)}outgoing(t){return this._log.debug(".outgoing",t),this._maybeEnableSound(Ie.SoundName.Outgoing,t)}removeProcessor(t,r=!1){if(this._log.debug(".removeProcessor"),typeof t!="object"||t===null)throw new Bt("Missing AudioProcessor argument.");if(this._localProcessor!==t&&!r)throw new Bt("Cannot remove a Local AudioProcessor that has not been previously added.");if(this._remoteProcessor!==t&&r)throw new Bt("Cannot remove a Remote AudioProcessor that has not been previously added.");return r?(this._destroyRemoteProcessedStream(),this._remoteProcessor=null,this._audioProcessorEventObserver.emit("remove",!0),Promise.resolve()):(this._destroyLocalProcessedStream(),this._localProcessor=null,this._audioProcessorEventObserver.emit("remove",!1),this._restartInputStreams())}setAudioConstraints(t){return this._log.debug(".setAudioConstraints",t),this._audioConstraints=Object.assign({},t),delete this._audioConstraints.deviceId,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}setInputDevice(t){return this._log.debug(".setInputDevice",t),this._setInputDevice(t,!1)}unsetAudioConstraints(){return this._log.debug(".unsetAudioConstraints"),this._audioConstraints=null,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}unsetInputDevice(){return this._log.debug(".unsetInputDevice",this.inputDevice),this.inputDevice?(this._destroyLocalProcessedStream(),this._onActiveInputChanged(null).then(()=>{this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume()})):Promise.resolve()}_destroyLocalProcessedStream(){if(this._localProcessor&&this._localProcessedStream){this._log.info("destroying local processed stream");const t=this._localProcessedStream;this._localProcessedStream.getTracks().forEach(r=>r.stop()),this._localProcessedStream=null,this._localProcessor.destroyProcessedStream(t),this._audioProcessorEventObserver.emit("destroy",!1)}}_getUnknownDeviceIndex(t){const r=t.deviceId,n=t.kind;let a=this._unknownDeviceIndexes[n][r];return a||(a=Object.keys(this._unknownDeviceIndexes[n]).length+1,this._unknownDeviceIndexes[n][r]=a),a}_initializeEnumeration(){if(!this._mediaDevices||!this._enumerateDevices)throw new an("Enumeration is not supported");this._mediaDevices.addEventListener&&this._mediaDevices.addEventListener("devicechange",this._updateAvailableDevices),this._updateAvailableDevices().then(()=>{this.isOutputSelectionSupported&&Promise.all([this.speakerDevices.set("default"),this.ringtoneDevices.set("default")]).catch(t=>{this._log.warn(`Warning: Unable to set audio output devices. ${t}`)})})}_maybeCreateLocalProcessedStream(t){return this._localProcessor?(this._log.info("Creating local processed stream"),this._localProcessor.createProcessedStream(t).then(r=>(this._localProcessedStream=r,this._audioProcessorEventObserver.emit("create",!1),this._localProcessedStream))):Promise.resolve(t)}_maybeEnableSound(t,r){return typeof r<"u"&&(this._enabledSounds[t]=r),this._enabledSounds[t]}_replaceStream(t){this._log.info("Replacing with new stream."),this._selectedInputDeviceStream&&(this._log.info("Old stream detected. Stopping tracks."),this._stopSelectedInputDeviceStream()),this._selectedInputDeviceStream=t}_restartInputStreams(){if(this.inputDevice&&this._selectedInputDeviceStream)return this._log.info("Restarting selected input device"),this._setInputDevice(this.inputDevice.deviceId,!0);if(this._defaultInputDeviceStream){const t=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return this._log.info("Restarting default input device, now becoming selected."),this._setInputDevice(t.deviceId,!0)}return Promise.resolve()}_setInputDevice(t,r){return Ce(this,void 0,void 0,function*(){const n=()=>Ce(this,void 0,void 0,function*(){if(yield this._beforeSetInputDevice(),typeof t!="string")return Promise.reject(new Bt("Must specify the device to set"));const a=this.availableInputDevices.get(t);if(!a)return Promise.reject(new Bt(`Device not found: ${t}`));if(this._log.info("Setting input device. ID: "+t),this._inputDevice&&this._inputDevice.deviceId===t&&this._selectedInputDeviceStream){if(!r)return Promise.resolve();this._log.info("Same track detected on setInputDevice, stopping old tracks."),this._stopSelectedInputDeviceStream()}this._stopDefaultInputDeviceStream();const l={audio:Object.assign({deviceId:{exact:t}},this.audioConstraints)};return this._log.info("setInputDevice: getting new tracks."),this._getUserMedia(l).then(c=>(this._destroyLocalProcessedStream(),this._maybeCreateLocalProcessedStream(c).then(d=>(this._log.info("setInputDevice: invoking _onActiveInputChanged."),this._onActiveInputChanged(d).then(()=>{this._replaceStream(c),this._inputDevice=a,this._maybeStartPollingVolume()})))))});return this._inputDevicePromise=n().finally(()=>{this._inputDevicePromise=null})})}_stopMicrophonePermissionListener(){var t;!((t=this._microphonePermissionStatus)===null||t===void 0)&&t.removeEventListener&&this._microphonePermissionStatus.removeEventListener("change",this._onMicrophonePermissionStatusChanged)}_stopSelectedInputDeviceStream(){this._selectedInputDeviceStream&&(this._log.info("Stopping selected device stream"),this._selectedInputDeviceStream.getTracks().forEach(t=>t.stop()))}_updateDevices(t,r,n){const a=t.map(f=>f.deviceId),l=Array.from(r.values()).map(f=>f.deviceId),c=[],d=Dw(l,a);d.forEach(f=>{const m=r.get(f);m&&(r.delete(f),n(m)&&c.push(m))});let h=!1;if(t.forEach(f=>{const m=r.get(f.deviceId),g=this._wrapMediaDeviceInfo(f);(!m||m.label!==g.label)&&(r.set(f.deviceId,g),h=!0)}),h||d.length){const f="default",m=this.inputDevice&&this.inputDevice.deviceId===f,g=this._defaultInputDeviceStream&&this.availableInputDevices.get(f);(m||g)&&(this._log.warn("Calling getUserMedia after device change to ensure that the           tracks of the active device (default) have not gone stale."),setTimeout(()=>{this._setInputDevice(f,!0)},0)),this._log.debug("#deviceChange",c),this.emit("deviceChange",c)}}_updateVolumeSource(){if(!(!this.inputStream||!this._audioContext||!this._inputVolumeAnalyser)){this._inputVolumeSource&&this._inputVolumeSource.disconnect();try{this._inputVolumeSource=this._audioContext.createMediaStreamSource(this.inputStream),this._inputVolumeSource.connect(this._inputVolumeAnalyser)}catch(t){this._log.warn("Unable to update volume source",t),delete this._inputVolumeSource}}}_wrapMediaDeviceInfo(t){const r={deviceId:t.deviceId,groupId:t.groupId,kind:t.kind,label:t.label};if(!r.label)if(r.deviceId==="default")r.label="Default";else{const n=this._getUnknownDeviceIndex(t);r.label=`Unknown ${fU[r.kind]} Device ${n}`}return new cU(r)}}Qv||(Qv={});var mU=Qv;class pU extends zs.EventEmitter{constructor(){super(),this._log=new Gr("AudioProcessorEventObserver"),this._log.info("Creating AudioProcessorEventObserver instance"),this.on("enabled",t=>this._reEmitEvent("enabled",t)),this.on("add",t=>this._reEmitEvent("add",t)),this.on("remove",t=>this._reEmitEvent("remove",t)),this.on("create",t=>this._reEmitEvent("create-processed-stream",t)),this.on("destroy",t=>this._reEmitEvent("destroy-processed-stream",t))}destroy(){this.removeAllListeners()}_reEmitEvent(t,r){this._log.info(`${r?"Remote":"Local"} AudioProcessor:${t}`),this.emit("event",{name:t,group:"audio-processor",isRemote:r})}}const gU={dtmf0:[1360,960],dtmf1:[1230,720],dtmf2:[1360,720],dtmf3:[1480,720],dtmf4:[1230,790],dtmf5:[1360,790],dtmf6:[1480,790],dtmf7:[1230,870],dtmf8:[1360,870],dtmf9:[1480,870],dtmfh:[1480,960],dtmfs:[1230,960]};class xU{constructor(t){this._context=t,this._gainNodes=[],this._gainNodes=[this._context.createGain(),this._context.createGain()],this._gainNodes.forEach(r=>{r.connect(this._context.destination),r.gain.value=.1,this._gainNodes.push(r)})}cleanup(){this._gainNodes.forEach(t=>{t.disconnect()})}play(t){const r=gU[t];if(!r)throw new Bt("Invalid DTMF sound name");[this._context.createOscillator(),this._context.createOscillator()].forEach((a,l)=>{a.type="sine",a.frequency.value=r[l],a.connect(this._gainNodes[l]),a.start(),a.stop(this._context.currentTime+.1),a.addEventListener("ended",()=>a.disconnect())})}}function bU(e,t,r){const n=JSON.stringify(t.body||{}),a=new Headers;t.headers=t.headers||[],Object.entries(t.headers).forEach(([l,c])=>a.append(l,c)),fetch(t.url,{body:n,headers:a,method:e}).then(l=>l.text(),r).then(l=>r(null,l),r)}const Rw=bU;Rw.get=function(t,r){return new this("GET",t,r)};Rw.post=function(t,r){return new this("POST",t,r)};class In extends zs.EventEmitter{constructor(t,r,n){if(super(),!(this instanceof In))return new In(t,r,n);n=Object.assign({defaultPayload(){return{}}},n);let a=n.defaultPayload;typeof a!="function"&&(a=()=>Object.assign({},n.defaultPayload));let l=!0;const c=Object.assign({app_name:void 0,app_version:void 0},n.metadata);Object.defineProperties(this,{_defaultPayload:{value:a},_host:{value:n.host,writable:!0},_isEnabled:{get(){return l},set(d){l=d}},_log:{value:new Gr("EventPublisher")},_request:{value:n.request||Rw,writable:!0},_token:{value:r,writable:!0},isEnabled:{enumerable:!0,get(){return l}},metadata:{enumerable:!0,get(){return c}},productName:{enumerable:!0,value:t},token:{enumerable:!0,get(){return this._token}}})}}In.prototype._post=function(t,r,n,a,l,c,d){if(!this.isEnabled&&!d||!this._host)return this._log.debug("Publishing cancelled",JSON.stringify({isEnabled:this.isEnabled,force:d,host:this._host})),Promise.resolve();if(!c||(!c.parameters||!c.parameters.CallSid)&&!c.outboundConnectionId)return c?this._log.debug("Publishing cancelled. Missing connection info",JSON.stringify({outboundConnectionId:c.outboundConnectionId,parameters:c.parameters})):this._log.debug("Publishing cancelled. Missing connection object"),Promise.resolve();const h={group:n,level:r.toUpperCase(),name:a,payload:l&&l.forEach?l.slice(0):Object.assign(this._defaultPayload(c),l),payload_type:"application/json",private:!1,publisher:this.productName,timestamp:new Date().toISOString()};this.metadata&&(h.publisher_metadata=this.metadata),t==="EndpointEvents"&&this._log.debug("Publishing insights",JSON.stringify({endpointName:t,event:h,force:d,host:this._host}));const f={body:h,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token},url:`https://${this._host}/v4/${t}`};return new Promise((m,g)=>{this._request.post(f,x=>{x?(this.emit("error",x),g(x)):m()})}).catch(m=>{this._log.error(`Unable to post ${n} ${a} event to Insights. Received error: ${m}`)})};In.prototype.post=function(t,r,n,a,l,c){return this._post("EndpointEvents",t,r,n,a,l,c)};In.prototype.debug=function(t,r,n,a){return this.post("debug",t,r,n,a)};In.prototype.info=function(t,r,n,a){return this.post("info",t,r,n,a)};In.prototype.warn=function(t,r,n,a){return this.post("warning",t,r,n,a)};In.prototype.error=function(t,r,n,a){return this.post("error",t,r,n,a)};In.prototype.postMetrics=function(t,r,n,a,l){return new Promise(c=>{const d=n.map(vU).map(h=>Object.assign(h,a));c(this._post("EndpointMetrics","info",t,r,d,l))})};In.prototype.setHost=function(t){this._host=t};In.prototype.setToken=function(t){this._token=t};In.prototype.enable=function(){this._isEnabled=!0};In.prototype.disable=function(){this._isEnabled=!1};function vU(e){return{audio_codec:e.codecName,audio_level_in:e.audioInputLevel,audio_level_out:e.audioOutputLevel,bytes_received:e.bytesReceived,bytes_sent:e.bytesSent,call_volume_input:e.inputVolume,call_volume_output:e.outputVolume,jitter:e.jitter,mos:e.mos&&Math.round(e.mos*100)/100,packets_lost:e.packetsLost,packets_lost_fraction:e.packetsLostFraction&&Math.round(e.packetsLostFraction*100)/100,packets_received:e.packetsReceived,rtt:e.rtt,timestamp:new Date(e.timestamp).toISOString(),total_bytes_received:e.totals.bytesReceived,total_bytes_sent:e.totals.bytesSent,total_packets_lost:e.totals.packetsLost,total_packets_received:e.totals.packetsReceived,total_packets_sent:e.totals.packetsSent}}const nS=32767,sS=typeof window<"u"?window.RTCStatsReport:void 0;function ta(e){if(!(this instanceof ta))return new ta(e);const t=this;Object.defineProperties(this,{_map:{value:e},size:{enumerable:!0,get(){return t._map.size}}}),this[Symbol.iterator]=e[Symbol.iterator]}sS&&(ta.prototype=Object.create(sS.prototype),ta.prototype.constructor=ta);["entries","forEach","get","has","keys","values"].forEach(e=>{ta.prototype[e]=function(...t){return this._map[e](...t)}});ta.fromArray=function(t){return new ta(t.reduce((r,n)=>(r.set(n.id,n),r),new Map))};ta.fromRTCStatsResponse=function(t){let r;const n=new Map,a=t.result().reduce((l,c)=>{const d=c.id;switch(c.type){case"googCertificate":l.set(d,NU(c));break;case"datachannel":l.set(d,SU(c));break;case"googCandidatePair":rT(c,"googActiveConnection")&&(r=d),l.set(d,kU(c));break;case"localcandidate":l.set(d,iS(c,!1));break;case"remotecandidate":l.set(d,iS(c,!0));break;case"ssrc":Yl(c,"packetsReceived")?l.set(`rtp-${d}`,jU(c)):l.set(`rtp-${d}`,_U(c)),l.set(`track-${d}`,wU(c)),l.set(`codec-${d}`,yU(c));break;case"googComponent":const h=aS(c);n.set(h.selectedCandidatePairId,d),l.set(d,aS(c));break}return l},new Map);if(r){const l=n.get(r);l&&(a.get(l).dtlsState="connected")}return new ta(a)};function aS(e){return{bytesReceived:void 0,bytesSent:void 0,dtlsState:void 0,id:e.id,localCertificateId:e.stat("localCertificateId"),remoteCertificateId:e.stat("remoteCertificateId"),rtcpTransportStatsId:void 0,selectedCandidatePairId:e.stat("selectedCandidatePairId"),timestamp:Date.parse(e.timestamp),type:"transport"}}function yU(e){return{channels:void 0,clockRate:void 0,id:e.id,implementation:void 0,mimeType:`${e.stat("mediaType")}/${e.stat("googCodecName")}`,payloadType:void 0,sdpFmtpLine:void 0,timestamp:Date.parse(e.timestamp),type:"codec"}}function wU(e){return{audioLevel:Yl(e,"audioOutputLevel")?Vt(e,"audioOutputLevel")/nS:(Vt(e,"audioInputLevel")||0)/nS,detached:void 0,echoReturnLoss:ey(e,"googEchoCancellationReturnLoss"),echoReturnLossEnhancement:ey(e,"googEchoCancellationReturnLossEnhancement"),ended:void 0,frameHeight:Yl(e,"googFrameHeightReceived")?Vt(e,"googFrameHeightReceived"):Vt(e,"googFrameHeightSent"),frameWidth:Yl(e,"googFrameWidthReceived")?Vt(e,"googFrameWidthReceived"):Vt(e,"googFrameWidthSent"),framesCorrupted:void 0,framesDecoded:Vt(e,"framesDecoded"),framesDropped:void 0,framesPerSecond:void 0,framesReceived:void 0,framesSent:Vt(e,"framesEncoded"),fullFramesLost:void 0,id:e.id,kind:e.stat("mediaType"),partialFramesLost:void 0,remoteSource:void 0,ssrcIds:void 0,timestamp:Date.parse(e.timestamp),trackIdentifier:e.stat("googTrackId"),type:"track"}}function tT(e,t){return{associateStatsId:void 0,codecId:`codec-${e.id}`,firCount:t?Vt(e,"googFirsSent"):void 0,id:e.id,isRemote:void 0,mediaType:e.stat("mediaType"),nackCount:t?Vt(e,"googNacksSent"):Vt(e,"googNacksReceived"),pliCount:t?Vt(e,"googPlisSent"):Vt(e,"googPlisReceived"),qpSum:Vt(e,"qpSum"),sliCount:void 0,ssrc:e.stat("ssrc"),timestamp:Date.parse(e.timestamp),trackId:`track-${e.id}`,transportId:e.stat("transportId")}}function jU(e){const t=tT(e,!0);return Object.assign(t,{burstDiscardCount:void 0,burstDiscardRate:void 0,burstLossCount:void 0,burstLossRate:void 0,burstPacketsDiscarded:void 0,burstPacketsLost:void 0,bytesReceived:Vt(e,"bytesReceived"),fractionLost:void 0,framesDecoded:Vt(e,"framesDecoded"),gapDiscardRate:void 0,gapLossRate:void 0,jitter:Zv(e.stat("googJitterReceived")),packetsDiscarded:void 0,packetsLost:Vt(e,"packetsLost"),packetsReceived:Vt(e,"packetsReceived"),packetsRepaired:void 0,roundTripTime:Zv(e.stat("googRtt")),type:"inbound-rtp"}),t}function _U(e){const t=tT(e,!1);return Object.assign(t,{bytesSent:Vt(e,"bytesSent"),framesEncoded:Vt(e,"framesEncoded"),packetsSent:Vt(e,"packetsSent"),remoteTimestamp:void 0,targetBitrate:void 0,type:"outbound-rtp"}),t}function iS(e,t){return{candidateType:CU(e.stat("candidateType")),deleted:void 0,id:e.id,ip:e.stat("ipAddress"),isRemote:t,port:Vt(e,"portNumber"),priority:ey(e,"priority"),protocol:e.stat("transport"),relayProtocol:void 0,timestamp:Date.parse(e.timestamp),transportId:void 0,type:t?"remote-candidate":"local-candidate",url:void 0}}function kU(e){return{availableIncomingBitrate:void 0,availableOutgoingBitrate:void 0,bytesReceived:Vt(e,"bytesReceived"),bytesSent:Vt(e,"bytesSent"),consentRequestsSent:Vt(e,"consentRequestsSent"),currentRoundTripTime:Zv(e.stat("googRtt")),id:e.id,lastPacketReceivedTimestamp:void 0,lastPacketSentTimestamp:void 0,localCandidateId:e.stat("localCandidateId"),nominated:void 0,priority:void 0,readable:void 0,remoteCandidateId:e.stat("remoteCandidateId"),requestsReceived:Vt(e,"requestsReceived"),requestsSent:Vt(e,"requestsSent"),responsesReceived:Vt(e,"responsesReceived"),responsesSent:Vt(e,"responsesSent"),retransmissionsReceived:void 0,retransmissionsSent:void 0,state:void 0,timestamp:Date.parse(e.timestamp),totalRoundTripTime:void 0,transportId:e.stat("googChannelId"),type:"candidate-pair",writable:rT(e,"googWritable")}}function NU(e){return{base64Certificate:e.stat("googDerBase64"),fingerprint:e.stat("googFingerprint"),fingerprintAlgorithm:e.stat("googFingerprintAlgorithm"),id:e.id,issuerCertificateId:e.stat("googIssuerId"),timestamp:Date.parse(e.timestamp),type:"certificate"}}function SU(e){return{bytesReceived:void 0,bytesSent:void 0,datachannelid:e.stat("datachannelid"),id:e.id,label:e.stat("label"),messagesReceived:void 0,messagesSent:void 0,protocol:e.stat("protocol"),state:e.stat("state"),timestamp:Date.parse(e.timestamp),transportId:e.stat("transportId"),type:"data-channel"}}function Zv(e){return isNaN(e)||e===""?void 0:parseInt(e,10)/1e3}function CU(e){switch(e){case"peerreflexive":return"prflx";case"serverreflexive":return"srflx";case"host":case"relay":default:return e}}function Vt(e,t){const r=e.stat(t);return Yl(e,t)?parseInt(r,10):void 0}function ey(e,t){const r=e.stat(t);return Yl(e,t)?parseFloat(r):void 0}function rT(e,t){const r=e.stat(t);return Yl(e,t)?r==="true"||r===!0:void 0}function Yl(e,t){const r=e.stat(t);return typeof r<"u"&&r!==""}const EU="PeerConnection is null",AU="WebRTC statistics are unsupported";function Qo(e,t){return typeof e.get=="function"?e.get(t):e.find(r=>r.id===t)}function nT(e){if(!e)return Promise.reject(new Bt(EU));if(typeof e.getStats!="function")return Promise.reject(new an(AU));let t;try{t=e.getStats()}catch{t=new Promise(n=>e.getStats(n)).then(ta.fromRTCStatsResponse)}return t}function TU(e,t){return t=Object.assign({createRTCSample:DU},t),nT(e).then(t.createRTCSample)}function OU(e){return nT(e).then(t=>{const{candidatePairs:r,localCandidates:n,remoteCandidates:a,transport:l}=Array.from(t.values()).reduce((h,f)=>{switch(["candidatePairs","localCandidates","remoteCandidates"].forEach(m=>{h[m]||(h[m]=[])}),f.type){case"candidate-pair":h.candidatePairs.push(f);break;case"local-candidate":h.localCandidates.push(f);break;case"remote-candidate":h.remoteCandidates.push(f);break;case"transport":f.selectedCandidatePairId&&(h.transport=f);break}return h},{}),c=r.find(h=>h.selected||l&&h.id===l.selectedCandidatePairId);let d;return c&&(d={localCandidate:n.find(h=>h.id===c.localCandidateId),remoteCandidate:a.find(h=>h.id===c.remoteCandidateId)}),{iceCandidateStats:[...n,...a],selectedIceCandidatePairStats:d}})}function PU(){}function DU(e){let t=null;const r=new PU;let n;Array.from(e.values()).forEach(h=>{if(h.isRemote)return;const f=h.type.replace("-","");if(n=n||h.timestamp,h.remoteId){const m=Qo(e,h.remoteId);m&&m.roundTripTime&&(r.rtt=m.roundTripTime*1e3)}switch(f){case"inboundrtp":r.timestamp=r.timestamp||h.timestamp,r.jitter=h.jitter*1e3,r.packetsLost=h.packetsLost,r.packetsReceived=h.packetsReceived,r.bytesReceived=h.bytesReceived;break;case"outboundrtp":if(r.timestamp=h.timestamp,r.packetsSent=h.packetsSent,r.bytesSent=h.bytesSent,h.codecId){const m=Qo(e,h.codecId);r.codecName=m?m.mimeType&&m.mimeType.match(/(.*\/)?(.*)/)[2]:h.codecId}break;case"transport":t=h.id;break}}),r.timestamp||(r.timestamp=n);const a=Qo(e,t);if(!a)return r;const l=Qo(e,a.selectedCandidatePairId);if(!l)return r;const c=Qo(e,l.localCandidateId),d=Qo(e,l.remoteCandidateId);return r.rtt||(r.rtt=l&&l.currentRoundTripTime*1e3),Object.assign(r,{localAddress:c&&(c.address||c.ip),remoteAddress:d&&(d.address||d.ip)}),r}class mr extends zs.EventEmitter{constructor(t,r){super(),this._hasInsightsErrored=!1,this._log=new Gr("PreflightTest"),this._networkTiming={},this._options={codecPreferences:[Re.Codec.PCMU,Re.Codec.Opus],edge:"roaming",fakeMicInput:!1,logLevel:"error",signalingTimeoutMs:1e4},this._status=mr.Status.Connecting,Object.assign(this._options,r),this._samples=[],this._warnings=[],this._startTime=Date.now(),this._initDevice(t,Object.assign(Object.assign({},this._options),{fileInputStream:this._options.fakeMicInput?this._getStreamFromFile():void 0}));const n=["codecPreferences","edge","fakeMicInput","logLevel","signalingTimeoutMs"],a=["audioContext","deviceFactory","fileInputStream","getRTCIceCandidateStatsReport","iceServers","rtcConfiguration"];if(typeof r=="object"){const l=Object.assign({},r);Object.keys(l).forEach(c=>{!n.includes(c)&&!a.includes(c)&&delete l[c],a.includes(c)&&(l[c]=!0)}),this._log.debug(".constructor",JSON.stringify(l))}}stop(){this._log.debug(".stop");const t=new An.CallCancelledError;this._device?(this._device.once(Ie.EventName.Unregistered,()=>this._onFailed(t)),this._device.destroy()):this._onFailed(t)}_emitWarning(t,r,n){const a={name:t,description:r};n&&(a.rtcWarning=n),this._warnings.push(a),this._log.debug(`#${mr.Events.Warning}`,JSON.stringify(a)),this.emit(mr.Events.Warning,a)}_getCallQuality(t){return t>4.2?mr.CallQuality.Excellent:t>=4.1&&t<=4.2?mr.CallQuality.Great:t>=3.7&&t<=4?mr.CallQuality.Good:t>=3.1&&t<=3.6?mr.CallQuality.Fair:mr.CallQuality.Degraded}_getReport(){var t,r,n;const a=this._getRTCStats(),l={start:this._startTime};this._endTime&&(l.end=this._endTime,l.duration=this._endTime-this._startTime);const c={callSid:this._callSid,edge:this._edge,iceCandidateStats:(r=(t=this._rtcIceCandidateStatsReport)===null||t===void 0?void 0:t.iceCandidateStats)!==null&&r!==void 0?r:[],networkTiming:this._networkTiming,samples:this._samples,selectedEdge:this._options.edge,stats:a,testTiming:l,totals:this._getRTCSampleTotals(),warnings:this._warnings},d=(n=this._rtcIceCandidateStatsReport)===null||n===void 0?void 0:n.selectedIceCandidatePairStats;return d&&(c.selectedIceCandidatePairStats=d,c.isTurnRequired=d.localCandidate.candidateType==="relay"||d.remoteCandidate.candidateType==="relay"),a&&(c.callQuality=this._getCallQuality(a.mos.average)),c}_getRTCSampleTotals(){if(this._latestSample)return Object.assign({},this._latestSample.totals)}_getRTCStats(){const t=this._samples.findIndex(n=>typeof n.mos=="number"&&n.mos>0),r=t>=0?this._samples.slice(t):[];if(!(!r||!r.length))return["jitter","mos","rtt"].reduce((n,a)=>{const l=r.map(c=>c[a]);return Object.assign(Object.assign({},n),{[a]:{average:Number((l.reduce((c,d)=>c+d)/l.length).toPrecision(5)),max:Math.max(...l),min:Math.min(...l)}})},{})}_getStreamFromFile(){const t=this._options.audioContext;if(!t)throw new an("Cannot fake input audio stream: AudioContext is not supported by this browser.");const r=new Audio(iU);r.addEventListener("canplaythrough",()=>r.play()),typeof r.setAttribute=="function"&&r.setAttribute("crossorigin","anonymous");const n=t.createMediaElementSource(r),a=t.createMediaStreamDestination();return n.connect(a),a.stream}_initDevice(t,r){try{this._device=new(r.deviceFactory||Ie)(t,{chunderw:r.chunderw,codecPreferences:r.codecPreferences,edge:r.edge,eventgw:r.eventgw,fileInputStream:r.fileInputStream,logLevel:r.logLevel,preflight:!0}),this._device.once(Ie.EventName.Registered,()=>{this._onDeviceRegistered()}),this._device.once(Ie.EventName.Error,n=>{this._onDeviceError(n)}),this._device.register()}catch(n){setTimeout(()=>{this._onFailed(n)});return}this._signalingTimeoutTimer=setTimeout(()=>{this._onDeviceError(new Ls.ConnectionError("WebSocket Connection Timeout"))},r.signalingTimeoutMs)}_onDeviceError(t){this._device.destroy(),this._onFailed(t)}_onDeviceRegistered(){return Ce(this,void 0,void 0,function*(){if(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._call=yield this._device.connect({rtcConfiguration:this._options.rtcConfiguration}),this._networkTiming.signaling={start:Date.now()},this._setupCallHandlers(this._call),this._edge=this._device.edge||void 0,this._options.fakeMicInput){this._echoTimer=setTimeout(()=>this._device.disconnectAll(),lU);const r=this._device.audio;r&&(r.disconnect(!1),r.outgoing(!1))}this._call.once("disconnect",()=>{this._device.once(Ie.EventName.Unregistered,()=>this._onUnregistered()),this._device.destroy()}),this._call._publisher.on("error",()=>{this._hasInsightsErrored||this._emitWarning("insights-connection-error","Received an error when attempting to connect to Insights gateway"),this._hasInsightsErrored=!0})})}_onFailed(t){clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=mr.Status.Failed,this._log.debug(`#${mr.Events.Failed}`,t),this.emit(mr.Events.Failed,t)}_onUnregistered(){setTimeout(()=>{this._status!==mr.Status.Failed&&(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=mr.Status.Completed,this._report=this._getReport(),this._log.debug(`#${mr.Events.Completed}`,JSON.stringify(this._report)),this.emit(mr.Events.Completed,this._report))},10)}_releaseHandlers(){[this._device,this._call].forEach(t=>{t&&t.eventNames().forEach(r=>t.removeAllListeners(r))})}_setupCallHandlers(t){this._options.fakeMicInput&&t.once("volume",()=>{t._mediaHandler.outputs.forEach(r=>r.audio.muted=!0)}),t.on("warning",(r,n)=>{this._emitWarning(r,"Received an RTCWarning. See .rtcWarning for the RTCWarning",n)}),t.once("accept",()=>{this._callSid=t._mediaHandler.callSid,this._status=mr.Status.Connected,this._log.debug(`#${mr.Events.Connected}`),this.emit(mr.Events.Connected)}),t.on("sample",r=>Ce(this,void 0,void 0,function*(){this._latestSample||(this._rtcIceCandidateStatsReport=yield(this._options.getRTCIceCandidateStatsReport||OU)(t._mediaHandler.version.pc)),this._latestSample=r,this._samples.push(r),this._log.debug(`#${mr.Events.Sample}`,JSON.stringify(r)),this.emit(mr.Events.Sample,r)})),[{reportLabel:"peerConnection",type:"pcconnection"},{reportLabel:"ice",type:"iceconnection"},{reportLabel:"dtls",type:"dtlstransport"},{reportLabel:"signaling",type:"signaling"}].forEach(({type:r,reportLabel:n})=>{const a=`on${r}statechange`,l=t._mediaHandler[a];t._mediaHandler[a]=c=>{const d=this._networkTiming[n]=this._networkTiming[n]||{start:0};c==="connecting"||c==="checking"?d.start=Date.now():(c==="connected"||c==="stable")&&!d.duration&&(d.end=Date.now(),d.duration=d.end-d.start),l(c)}})}get callSid(){return this._callSid}get endTime(){return this._endTime}get latestSample(){return this._latestSample}get report(){return this._report}get startTime(){return this._startTime}get status(){return this._status}}(function(e){(function(t){t.Excellent="excellent",t.Great="great",t.Good="good",t.Fair="fair",t.Degraded="degraded"})(e.CallQuality||(e.CallQuality={})),(function(t){t.Completed="completed",t.Connected="connected",t.Failed="failed",t.Sample="sample",t.Warning="warning"})(e.Events||(e.Events={})),(function(t){t.Connecting="connecting",t.Connected="connected",t.Completed="completed",t.Failed="failed"})(e.Status||(e.Status={}))})(mr||(mr={}));const ac=globalThis.WebSocket,MU=1e4,RU=5e3,lS=15e3,IU=15e3,$U=1/0,LU=1e3,zU=2e4;var os;(function(e){e.Connecting="connecting",e.Closed="closed",e.Open="open"})(os||(os={}));class Am extends zs.EventEmitter{constructor(t,r={}){super(),this.state=os.Closed,this._backoffStartTime={preferred:null,primary:null},this._connectedUri=null,this._log=new Gr("WSTransport"),this._shouldFallback=!1,this._uriIndex=0,this._moveUriIndex=()=>{this._uriIndex++,this._uriIndex>=this._uris.length&&(this._uriIndex=0)},this._onSocketClose=n=>{if(this._log.error(`Received websocket close event code: ${n.code}. Reason: ${n.reason}`),n.code===1006||n.code===1015){this.emit("error",{code:31005,message:n.reason||"Websocket connection to Twilio's signaling servers were unexpectedly ended. If this is happening consistently, there may be an issue resolving the hostname provided. If a region or an edge is being specified in Device setup, ensure it is valid.",twilioError:new Ls.ConnectionError});const a=this.state===os.Open||this._previousState===os.Open;(this._shouldFallback||!a)&&this._moveUriIndex(),this._shouldFallback=!0}this._closeSocket()},this._onSocketError=n=>{this._log.error(`WebSocket received error: ${n.message}`),this.emit("error",{code:31e3,message:n.message||"WSTransport socket error",twilioError:new Ls.ConnectionDisconnected})},this._onSocketMessage=n=>{if(this._setHeartbeatTimeout(),this._socket&&n.data===`
`){this._socket.send(`
`),this._log.debug("heartbeat");return}n&&typeof n.data=="string"&&this._log.debug(`Received: ${n.data}`),this.emit("message",n)},this._onSocketOpen=()=>{this._log.info("WebSocket opened successfully."),this._timeOpened=Date.now(),this._shouldFallback=!1,this._setState(os.Open),clearTimeout(this._connectTimeout),this._resetBackoffs(),this._setHeartbeatTimeout(),this.emit("open")},this._options=Object.assign(Object.assign({},Am.defaultConstructorOptions),r),this._uris=t,this._backoff=this._setupBackoffs()}close(){this._log.info("WSTransport.close() called..."),this._close()}open(){if(this._log.info("WSTransport.open() called..."),this._socket&&(this._socket.readyState===ac.CONNECTING||this._socket.readyState===ac.OPEN)){this._log.info("WebSocket already open.");return}this._preferredUri?this._connect(this._preferredUri):this._connect(this._uris[this._uriIndex])}send(t){if(this._log.debug(`Sending: ${t}`),!this._socket||this._socket.readyState!==ac.OPEN)return this._log.debug("Cannot send message. WebSocket is not open."),!1;try{this._socket.send(t)}catch(r){return this._log.error("Error while sending message:",r.message),this._closeSocket(),!1}return!0}updatePreferredURI(t){this._preferredUri=t}updateURIs(t){typeof t=="string"&&(t=[t]),this._uris=t,this._uriIndex=0}_close(){this._setState(os.Closed),this._closeSocket()}_closeSocket(){if(clearTimeout(this._connectTimeout),clearTimeout(this._heartbeatTimeout),this._log.info("Closing and cleaning up WebSocket..."),!this._socket){this._log.info("No WebSocket to clean up.");return}this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("error",this._onSocketError),this._socket.removeEventListener("message",this._onSocketMessage),this._socket.removeEventListener("open",this._onSocketOpen),(this._socket.readyState===ac.CONNECTING||this._socket.readyState===ac.OPEN)&&this._socket.close(),this._timeOpened&&Date.now()-this._timeOpened>MU&&this._resetBackoffs(),this.state!==os.Closed&&this._performBackoff(),delete this._socket,this.emit("close")}_connect(t,r){this._log.info(typeof r=="number"?`Attempting to reconnect (retry #${r})...`:"Attempting to connect..."),this._closeSocket(),this._setState(os.Connecting),this._connectedUri=t;try{this._socket=new this._options.WebSocket(this._connectedUri)}catch(n){this._log.error("Could not connect to endpoint:",n.message),this._close(),this.emit("error",{code:31e3,message:n.message||`Could not connect to ${this._connectedUri}`,twilioError:new Ls.ConnectionDisconnected});return}this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("error",this._onSocketError),this._socket.addEventListener("message",this._onSocketMessage),this._socket.addEventListener("open",this._onSocketOpen),delete this._timeOpened,this._connectTimeout=setTimeout(()=>{this._log.info("WebSocket connection attempt timed out."),this._moveUriIndex(),this._closeSocket()},this._options.connectTimeoutMs)}_performBackoff(){this._preferredUri?(this._log.info("Preferred URI set; backing off."),this._backoff.preferred.backoff()):(this._log.info("Preferred URI not set; backing off."),this._backoff.primary.backoff())}_resetBackoffs(){this._backoff.preferred.reset(),this._backoff.primary.reset(),this._backoffStartTime.preferred=null,this._backoffStartTime.primary=null}_setHeartbeatTimeout(){clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=setTimeout(()=>{this._log.info(`No messages received in ${lS/1e3} seconds. Reconnecting...`),this._shouldFallback=!0,this._closeSocket()},lS)}_setState(t){this._previousState=this.state,this.state=t}_setupBackoffs(){const t={factor:2,jitter:.4,max:this._options.maxPreferredDelayMs,min:100};this._log.info("Initializing preferred transport backoff using config: ",t);const r=new Wv(t);r.on("backoff",(l,c)=>{if(this.state===os.Closed){this._log.info("Preferred backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect Websocket to preferred URI in ${c}ms`),l===0&&(this._backoffStartTime.preferred=Date.now(),this._log.info(`Preferred backoff start; ${this._backoffStartTime.preferred}`))}),r.on("ready",(l,c)=>{if(this.state===os.Closed){this._log.info("Preferred backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.preferred===null){this._log.info("Preferred backoff start time invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.preferred>this._options.maxPreferredDurationMs){this._log.info("Max preferred backoff attempt time exceeded; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}if(typeof this._preferredUri!="string"){this._log.info("Preferred URI cleared; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}this._connect(this._preferredUri,l+1)});const n={factor:2,jitter:.4,max:this._options.maxPrimaryDelayMs,min:this._uris&&this._uris.length>1?Math.floor(Math.random()*4001)+1e3:100};this._log.info("Initializing primary transport backoff using config: ",n);const a=new Wv(n);return a.on("backoff",(l,c)=>{if(this.state===os.Closed){this._log.info("Primary backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect WebSocket in ${c}ms`),l===0&&(this._backoffStartTime.primary=Date.now(),this._log.info(`Primary backoff start; ${this._backoffStartTime.primary}`))}),a.on("ready",(l,c)=>{if(this.state===os.Closed){this._log.info("Primary backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.primary===null){this._log.info("Primary backoff start time invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.primary>this._options.maxPrimaryDurationMs){this._log.info("Max primary backoff attempt time exceeded; not attempting a connection.");return}this._connect(this._uris[this._uriIndex],l+1)}),{preferred:r,primary:a}}get uri(){return this._connectedUri}}Am.defaultConstructorOptions={WebSocket:ac,connectTimeoutMs:RU,maxPreferredDelayMs:LU,maxPreferredDurationMs:IU,maxPrimaryDelayMs:zU,maxPrimaryDurationMs:$U};const BU="1.6",UU=30;class ar extends zs.EventEmitter{constructor(t,r,n){if(super(),!(this instanceof ar))return new ar(t,r,n);const a={TransportFactory:Am};n=n||{};for(const c in a)c in n||(n[c]=a[c]);this.options=n,this.token=t||"",this.status="disconnected",this.gateway=null,this.region=null,this._messageQueue=[],this._preferredUri=null,this._uris=r,this._handleTransportClose=this._handleTransportClose.bind(this),this._handleTransportError=this._handleTransportError.bind(this),this._handleTransportMessage=this._handleTransportMessage.bind(this),this._handleTransportOpen=this._handleTransportOpen.bind(this),this._log=new Gr("PStream"),this.on("error",()=>{this._log.warn("Unexpected error handled in pstream")});const l=this;return this.addListener("ready",()=>{l.status="ready"}),this.addListener("offline",()=>{l.status="offline"}),this.addListener("close",()=>{l._log.info('Received "close" from server. Destroying PStream...'),l._destroy()}),this.transport=new this.options.TransportFactory(this._uris,{backoffMaxMs:this.options.backoffMaxMs,maxPreferredDurationMs:this.options.maxPreferredDurationMs}),Object.defineProperties(this,{uri:{enumerable:!0,get(){return this.transport.uri}}}),this.transport.on("close",this._handleTransportClose),this.transport.on("error",this._handleTransportError),this.transport.on("message",this._handleTransportMessage),this.transport.on("open",this._handleTransportOpen),this.transport.open(),this}}ar.prototype._handleTransportClose=function(){this.emit("transportClose"),this.status!=="disconnected"&&(this.status!=="offline"&&this.emit("offline",this),this.status="disconnected")};ar.prototype._handleTransportError=function(e){if(!e){this.emit("error",{error:{code:31e3,message:"Websocket closed without a provided reason",twilioError:new Ls.ConnectionDisconnected}});return}this.emit("error",typeof e.code<"u"?{error:e}:e)};ar.prototype._handleTransportMessage=function(e){if(!e||!e.data||typeof e.data!="string")return;const{type:t,payload:r={}}=JSON.parse(e.data);this.gateway=r.gateway||this.gateway,this.region=r.region||this.region,t==="error"&&r.error&&(r.error.twilioError=new Ls.ConnectionError),this.emit(t,r)};ar.prototype._handleTransportOpen=function(){this.status="connected",this.setToken(this.token),this.emit("transportOpen"),this._messageQueue.splice(0,this._messageQueue.length).forEach(t=>this._publish(...t))};ar.toString=()=>"[Twilio.PStream class]";ar.prototype.toString=()=>"[Twilio.PStream instance]";ar.prototype.setToken=function(e){this._log.info("Setting token and publishing listen"),this.token=e;let t=0;const r=this.options.maxPreferredDurationMs;this._log.info(`maxPreferredDurationMs:${r}`),typeof r=="number"&&r>=0&&(t=Math.min(Math.ceil(r/1e3),UU)),this._log.info(`reconnectTimeout:${t}`);const n={browserinfo:qU(),reconnectTimeout:t,token:e};this._publish("listen",n)};ar.prototype.sendMessage=function(e,t,r="application/json",n,a){const l={callsid:e,content:t,contenttype:r,messagetype:n,voiceeventsid:a};this._publish("message",l,!0)};ar.prototype.register=function(e){const t={media:e};this._publish("register",t,!0)};ar.prototype.invite=function(e,t,r){const n={callsid:t,sdp:e,twilio:r?{params:r}:{}};this._publish("invite",n,!0)};ar.prototype.reconnect=function(e,t,r){const n={callsid:t,reconnect:r,sdp:e,twilio:{}};this._publish("invite",n,!0)};ar.prototype.answer=function(e,t){this._publish("answer",{sdp:e,callsid:t},!0)};ar.prototype.dtmf=function(e,t){this._publish("dtmf",{callsid:e,dtmf:t},!0)};ar.prototype.hangup=function(e,t){const r=t?{callsid:e,message:t}:{callsid:e};this._publish("hangup",r,!0)};ar.prototype.reject=function(e){this._publish("reject",{callsid:e},!0)};ar.prototype.reinvite=function(e,t){this._publish("reinvite",{sdp:e,callsid:t},!1)};ar.prototype._destroy=function(){this.transport.removeListener("close",this._handleTransportClose),this.transport.removeListener("error",this._handleTransportError),this.transport.removeListener("message",this._handleTransportMessage),this.transport.removeListener("open",this._handleTransportOpen),this.transport.close(),this.emit("offline",this)};ar.prototype.destroy=function(){return this._log.info("PStream.destroy() called..."),this._destroy(),this};ar.prototype.updatePreferredURI=function(e){this._preferredUri=e,this.transport.updatePreferredURI(e)};ar.prototype.updateURIs=function(e){this._uris=e,this.transport.updateURIs(this._uris)};ar.prototype.publish=function(e,t){return this._publish(e,t,!0)};ar.prototype._publish=function(e,t,r){const n=JSON.stringify({payload:t,type:e,version:BU});!!this.transport.send(n)||(this.emit("error",{error:{code:31009,message:"No transport available to send or receive messages",twilioError:new An.TransportError}}),r&&this._messageQueue.push([e,t,!0]))};function qU(){const e=typeof navigator<"u"?navigator:{};return{browser:{platform:e.platform||"unknown",userAgent:e.userAgent||"unknown"},p:"browser",plugin:"rtc",v:gc}}var xr;(function(e){e.Sydney="sydney",e.SaoPaulo="sao-paulo",e.Dublin="dublin",e.Frankfurt="frankfurt",e.Tokyo="tokyo",e.Singapore="singapore",e.Ashburn="ashburn",e.Umatilla="umatilla",e.Roaming="roaming",e.AshburnIx="ashburn-ix",e.SanJoseIx="san-jose-ix",e.LondonIx="london-ix",e.FrankfurtIx="frankfurt-ix",e.SingaporeIx="singapore-ix",e.SydneyIx="sydney-ix",e.TokyoIx="tokyo-ix"})(xr||(xr={}));var zt;(function(e){e.Au1="au1",e.Au1Ix="au1-ix",e.Br1="br1",e.De1="de1",e.De1Ix="de1-ix",e.Gll="gll",e.Ie1="ie1",e.Ie1Ix="ie1-ix",e.Ie1Tnx="ie1-tnx",e.Jp1="jp1",e.Jp1Ix="jp1-ix",e.Sg1="sg1",e.Sg1Ix="sg1-ix",e.Sg1Tnx="sg1-tnx",e.Us1="us1",e.Us1Ix="us1-ix",e.Us1Tnx="us1-tnx",e.Us2="us2",e.Us2Ix="us2-ix",e.Us2Tnx="us2-tnx"})(zt||(zt={}));const FU={ASIAPAC_SINGAPORE:zt.Sg1,ASIAPAC_SYDNEY:zt.Au1,ASIAPAC_TOKYO:zt.Jp1,EU_FRANKFURT:zt.De1,EU_IRELAND:zt.Ie1,SOUTH_AMERICA_SAO_PAULO:zt.Br1,US_EAST_VIRGINIA:zt.Us1,US_WEST_OREGON:zt.Us2},HU={[zt.Au1]:xr.Sydney,[zt.Br1]:xr.SaoPaulo,[zt.Ie1]:xr.Dublin,[zt.De1]:xr.Frankfurt,[zt.Jp1]:xr.Tokyo,[zt.Sg1]:xr.Singapore,[zt.Us1]:xr.Ashburn,[zt.Us2]:xr.Umatilla,[zt.Gll]:xr.Roaming,[zt.Us1Ix]:xr.AshburnIx,[zt.Us2Ix]:xr.SanJoseIx,[zt.Ie1Ix]:xr.LondonIx,[zt.De1Ix]:xr.FrankfurtIx,[zt.Sg1Ix]:xr.SingaporeIx,[zt.Au1Ix]:xr.SydneyIx,[zt.Jp1Ix]:xr.TokyoIx,[zt.Us1Tnx]:xr.AshburnIx,[zt.Us2Tnx]:xr.AshburnIx,[zt.Ie1Tnx]:xr.LondonIx,[zt.Sg1Tnx]:xr.SingaporeIx},VU=xr.Roaming,WU="eventgw.twilio.com";function oS(e){return`voice-js.${e}.twilio.com`}function cS(e){return e?`eventgw.${e}.twilio.com`:WU}function dS(e){return`wss://${e}/signal`}function uS(e){if(e&&typeof e!="string"&&!Array.isArray(e))throw new Bt("If `edge` is provided, it must be of type `string` or an array of strings.");let t;return e?t=(Array.isArray(e)?e:[e]).map(n=>oS(n)):t=[oS(VU)],t}function GU(e){return FU[e]||null}const hS={0:"PCMU",8:"PCMA"},KU=111,YU=51e4,XU=6e3;function JU(e){const[,t,r]=/a=rtpmap:(\d+) (\S+)/m.exec(e)||[null,"",""],n=new RegExp(`a=fmtp:${t} (\\S+)`,"m"),[,a]=n.exec(e)||[null,""];return{codecName:r,codecParams:a}}function QU(e){return Mw(window,window.navigator)?e.split(`
`).filter(t=>t.indexOf("a=ice-lite")===-1).join(`
`):e}function sT(e,t){if(typeof t!="number"||t<XU||t>YU)return e;const r=/a=rtpmap:(\d+) opus/m.exec(e),n=r&&r.length?r[1]:KU,a=new RegExp(`a=fmtp:${n}`);return e.split(`
`).map(c=>a.test(c)?c+`;maxaveragebitrate=${t}`:c).join(`
`)}function aT(e,t){const r=ZU(e);return[e.split(`\r
m=`)[0]].concat(r.map(a=>{if(!/^m=(audio|video)/.test(a))return a;const l=a.match(/^m=(audio|video)/)[1],c=eq(a),d=tq(c,t),h=rq(d,a),f=c.get("pcma")||[],m=c.get("pcmu")||[];return(l==="audio"?new Set(f.concat(m)):new Set).has(d[0])?h.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):h})).join(`\r
`)}function ZU(e,t,r){return e.replace(/\r\n\r\n$/,`\r
`).split(`\r
m=`).slice(1).map(n=>`m=${n}`).filter(n=>{const a=new RegExp("m=.*","gm"),l=new RegExp("a=.*","gm");return a.test(n)&&l.test(n)})}function eq(e){return Array.from(nq(e)).reduce((t,r)=>{const n=r[0],a=r[1],l=t.get(a)||[];return t.set(a,l.concat(n))},new Map)}function tq(e,t){t=t.map(l=>l.toLowerCase());const r=Xv(t,l=>e.get(l)||[]),n=Dw(Array.from(e.keys()),t),a=Xv(n,l=>e.get(l));return r.concat(a)}function rq(e,t){const r=t.split(`\r
`);let n=r[0];const a=r.slice(1);return n=n.replace(/([0-9]+\s?)+$/,e.join(" ")),[n].concat(a).join(`\r
`)}function nq(e){return sq(e).reduce((t,r)=>{const n=new RegExp(`a=rtpmap:${r} ([^/]+)`),a=e.match(n),l=a?a[1].toLowerCase():hS[r]?hS[r].toLowerCase():"";return t.set(r,l)},new Map)}function sq(e){const r=e.split(`\r
`)[0].match(/([0-9]+)/g);return r?r.slice(1).map(n=>parseInt(n,10)):[]}function xs(e){if(this.log=new Gr("RTCPC"),typeof window>"u"){this.log.info("No RTCPeerConnection implementation available. The window object was not found.");return}e&&e.RTCPeerConnection?this.RTCPeerConnection=e.RTCPeerConnection:typeof window.RTCPeerConnection=="function"?this.RTCPeerConnection=window.RTCPeerConnection:typeof window.webkitRTCPeerConnection=="function"?this.RTCPeerConnection=webkitRTCPeerConnection:typeof window.mozRTCPeerConnection=="function"?(this.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate):this.log.info("No RTCPeerConnection implementation available")}xs.prototype.create=function(e){this.pc=new this.RTCPeerConnection(e)};xs.prototype.createModernConstraints=e=>{if(typeof e>"u")return null;const t=Object.assign({},e);return typeof webkitRTCPeerConnection<"u"&&!Em()?(t.mandatory={},typeof e.audio<"u"&&(t.mandatory.OfferToReceiveAudio=e.audio),typeof e.video<"u"&&(t.mandatory.OfferToReceiveVideo=e.video)):(typeof e.audio<"u"&&(t.offerToReceiveAudio=e.audio),typeof e.video<"u"&&(t.offerToReceiveVideo=e.video)),delete t.audio,delete t.video,t};xs.prototype.createOffer=function(e,t,r,n){return t=this.createModernConstraints(t),lT(this.pc.createOffer,this.pc)(t).then(a=>{if(!this.pc)return Promise.resolve();const l=sT(a.sdp,e);return Tm(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:l,type:"offer"}))}).then(r,n)};xs.prototype.createAnswer=function(e,t,r,n){return t=this.createModernConstraints(t),lT(this.pc.createAnswer,this.pc)(t).then(a=>{if(!this.pc)return Promise.resolve();const l=sT(a.sdp,e);return Tm(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:l,type:"answer"}))}).then(r,n)};xs.prototype.processSDP=function(e,t,r,n,a,l){r=aT(r,t);const c=new RTCSessionDescription({sdp:r,type:"offer"});return Tm(this.pc.setRemoteDescription,this.pc)(c).then(()=>{this.createAnswer(e,n,a,l)})};xs.prototype.getSDP=function(){return this.pc.localDescription.sdp};xs.prototype.processAnswer=function(e,t,r,n){return this.pc?(t=aT(t,e),Tm(this.pc.setRemoteDescription,this.pc)(new RTCSessionDescription({sdp:t,type:"answer"})).then(r,n)):Promise.resolve()};xs.test=()=>{if(typeof navigator=="object"){const e=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.getUserMedia;if(Em(navigator))return!1;if(e&&typeof window.RTCPeerConnection=="function")return!0;if(e&&typeof window.webkitRTCPeerConnection=="function")return!0;if(e&&typeof window.mozRTCPeerConnection=="function"){try{if(typeof new window.mozRTCPeerConnection().getLocalStreams!="function")return!1}catch{return!1}return!0}else if(typeof RTCIceGatherer<"u")return!0}return!1};function iT(e,t,r,n){return function(){const a=Array.prototype.slice.call(arguments);return new Promise(l=>{const c=e.apply(t,a);if(!n){l(c);return}if(typeof c=="object"&&typeof c.then=="function")l(c);else throw new Error}).catch(()=>new Promise((l,c)=>{e.apply(t,r?[l,c].concat(a):a.concat([l,c]))}))}}function lT(e,t){return iT(e,t,!0,!0)}function Tm(e,t){return iT(e,t,!1,!1)}const aq=15e3,iq="none",lq="timeout",oq="new",fS=50;function Qe(e,t,r){if(!e||!t)throw new Bt("Audiohelper, and pstream are required arguments");if(!(this instanceof Qe))return new Qe(e,t,r);this._log=new Gr("PeerConnection");function n(){this._log.warn("Unexpected noop call in peerconnection")}this.onaudio=n,this.onopen=n,this.onerror=n,this.onclose=n,this.ondisconnected=n,this.onfailed=n,this.onconnected=n,this.onreconnected=n,this.onsignalingstatechange=n,this.ondtlstransportstatechange=n,this.onicegatheringfailure=n,this.onicegatheringstatechange=n,this.oniceconnectionstatechange=n,this.onpcconnectionstatechange=n,this.onicecandidate=n,this.onselectedcandidatepairchange=n,this.onvolume=n,this.version=null,this.pstream=t,this.stream=null,this.sinkIds=new Set(["default"]),this.outputs=new Map,this.status="connecting",this.callSid=null,this.isMuted=!1;const a=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);return this._isSinkSupported=!!a&&typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId,this._audioContext=a&&e._audioContext,this._audioHelper=e,this._audioProcessorEventObserver=e._getAudioProcessorEventObserver(),this._hasIceCandidates=!1,this._hasIceGatheringFailures=!1,this._iceGatheringTimeoutId=null,this._masterAudio=null,this._masterAudioDeviceId=null,this._mediaStreamSource=null,this._dtmfSender=null,this._dtmfSenderUnsupported=!1,this._callEvents=[],this._nextTimeToPublish=Date.now(),this._onAnswerOrRinging=n,this._onHangup=n,this._remoteStream=null,this._shouldManageStream=!0,this._iceState=oq,this.options=r=r||{},this.navigator=r.navigator||(typeof navigator<"u"?navigator:null),this.util=r.util||eT,this.codecPreferences=r.codecPreferences,this._onAudioProcessorAdded=l=>{this._handleAudioProcessorEvent(l,!0)},this._onAudioProcessorRemoved=l=>{this._handleAudioProcessorEvent(l,!1)},this._audioProcessorEventObserver.on("add",this._onAudioProcessorAdded),this._audioProcessorEventObserver.on("remove",this._onAudioProcessorRemoved),this}Qe.prototype.uri=function(){return this._uri};Qe.prototype.openDefaultDeviceWithConstraints=function(e){return this._audioHelper._openDefaultDeviceWithConstraints(e).then(this._setInputTracksFromStream.bind(this,!1))};Qe.prototype.setInputTracksFromStream=function(e){const t=this;return this._setInputTracksFromStream(!0,e).then(()=>{t._shouldManageStream=!1})};Qe.prototype._createAnalyser=(e,t)=>{t=Object.assign({fftSize:32,smoothingTimeConstant:.3},t);const r=e.createAnalyser();for(const n in t)r[n]=t[n];return r};Qe.prototype._setVolumeHandler=function(e){this.onvolume=e};Qe.prototype._startPollingVolume=function(){if(!this._audioContext||!this.stream||!this._remoteStream)return;const e=this._audioContext,r=(this._inputAnalyser=this._createAnalyser(e)).frequencyBinCount,n=new Uint8Array(r);this._inputAnalyser2=this._createAnalyser(e,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0});const l=(this._outputAnalyser=this._createAnalyser(e)).frequencyBinCount,c=new Uint8Array(l);this._outputAnalyser2=this._createAnalyser(e,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0}),this._updateInputStreamSource(this.stream),this._updateOutputStreamSource(this._remoteStream);const d=this;setTimeout(function h(){if(d._audioContext){if(d.status==="closed"){d._inputAnalyser.disconnect(),d._outputAnalyser.disconnect(),d._inputAnalyser2.disconnect(),d._outputAnalyser2.disconnect();return}}else return;d._inputAnalyser.getByteFrequencyData(n);const f=d.util.average(n);d._inputAnalyser2.getByteFrequencyData(n);const m=d.util.average(n);d._outputAnalyser.getByteFrequencyData(c);const g=d.util.average(c);d._outputAnalyser2.getByteFrequencyData(c);const x=d.util.average(c);d.onvolume(f/255,g/255,m,x),setTimeout(h,fS)},fS)};Qe.prototype._stopStream=function(){this._shouldManageStream&&this._audioHelper._stopDefaultInputDeviceStream()};Qe.prototype._updateInputStreamSource=function(e){this._inputStreamSource&&this._inputStreamSource.disconnect();try{this._inputStreamSource=this._audioContext.createMediaStreamSource(e),this._inputStreamSource.connect(this._inputAnalyser),this._inputStreamSource.connect(this._inputAnalyser2)}catch(t){this._log.warn("Unable to update input MediaStreamSource",t),this._inputStreamSource=null}};Qe.prototype._updateOutputStreamSource=function(e){this._outputStreamSource&&this._outputStreamSource.disconnect();try{this._outputStreamSource=this._audioContext.createMediaStreamSource(e),this._outputStreamSource.connect(this._outputAnalyser),this._outputStreamSource.connect(this._outputAnalyser2)}catch(t){this._log.warn("Unable to update output MediaStreamSource",t),this._outputStreamSource=null}};Qe.prototype._setInputTracksFromStream=function(e,t){if(!t)return Promise.reject(new Bt("Can not set input stream to null while in a call"));if(!t.getAudioTracks().length)return Promise.reject(new Bt("Supplied input stream has no audio tracks"));const r=this.stream,n=()=>(this.mute(this.isMuted),Promise.resolve(this.stream));if(!r)this.stream=e?mS(t,this.options.MediaStream):t;else return this._shouldManageStream&&this._stopStream(),this._sender||(this._sender=this.version.pc.getSenders()[0]),this._sender.replaceTrack(t.getAudioTracks()[0]).then(()=>(this._updateInputStreamSource(t),this.stream=e?mS(t,this.options.MediaStream):t,n()));return n()};Qe.prototype._onInputDevicesChanged=function(){if(!this.stream)return;this.stream.getAudioTracks().every(t=>t.readyState==="ended")&&this._shouldManageStream&&this.openDefaultDeviceWithConstraints({audio:!0})};Qe.prototype._onIceGatheringFailure=function(e){this._hasIceGatheringFailures=!0,this.onicegatheringfailure(e)};Qe.prototype._onMediaConnectionStateChange=function(e){const t=this._iceState;if(t===e||e!=="connected"&&e!=="disconnected"&&e!=="failed")return;this._iceState=e;let r;switch(e){case"connected":t==="disconnected"||t==="failed"?(r="ICE liveliness check succeeded. Connection with Twilio restored",this._log.info(r),this.onreconnected(r)):(r="Media connection established.",this._log.info(r),this.onconnected(r)),this._stopIceGatheringTimeout(),this._hasIceGatheringFailures=!1;break;case"disconnected":r="ICE liveliness check failed. May be having trouble connecting to Twilio",this._log.warn(r),this.ondisconnected(r);break;case"failed":r="Connection with Twilio was interrupted.",this._log.warn(r),this.onfailed(r);break}};Qe.prototype._setSinkIds=function(e){return this._isSinkSupported?(this.sinkIds=new Set(e.forEach?e:[e]),this.version?this._updateAudioOutputs():Promise.resolve()):Promise.reject(new an("Audio output selection is not supported by this browser"))};Qe.prototype._startIceGatheringTimeout=function(){this._stopIceGatheringTimeout(),this._iceGatheringTimeoutId=setTimeout(()=>{this._onIceGatheringFailure(lq)},aq)};Qe.prototype._stopIceGatheringTimeout=function(){clearInterval(this._iceGatheringTimeoutId)};Qe.prototype._updateAudioOutputs=function(){const t=Array.from(this.sinkIds).filter(function(l){return!this.outputs.has(l)},this),r=Array.from(this.outputs.keys()).filter(function(l){return!this.sinkIds.has(l)},this),n=this,a=t.map(this._createAudioOutput,this);return Promise.all(a).then(()=>Promise.all(r.map(n._removeAudioOutput,n)))};Qe.prototype._createAudio=function(t){const r=new Audio(t);return this.onaudio(r),r};Qe.prototype._createAudioOutput=function(t){let r=null;this._mediaStreamSource&&(r=this._audioContext.createMediaStreamDestination(),this._mediaStreamSource.connect(r));const n=this._createAudio();Om(n,r&&r.stream?r.stream:this.pcStream,this._audioHelper).catch(()=>this._log.error("Error attaching stream to element (_createAudioOutput)."));const a=this;return n.setSinkId(t).then(()=>n.play()).then(()=>{a.outputs.set(t,{audio:n,dest:r})})};Qe.prototype._removeAudioOutputs=function(){return this._masterAudio&&typeof this._masterAudioDeviceId<"u"&&(this._disableOutput(this,this._masterAudioDeviceId),this.outputs.delete(this._masterAudioDeviceId),this._masterAudioDeviceId=null,this._masterAudio.paused||this._masterAudio.pause(),typeof this._masterAudio.srcObject<"u"?this._masterAudio.srcObject=null:this._masterAudio.src="",this._masterAudio=null),Array.from(this.outputs.keys()).map(this._removeAudioOutput,this)};Qe.prototype._disableOutput=function(t,r){const n=t.outputs.get(r);n&&(n.audio&&(n.audio.pause(),n.audio.src=""),n.dest&&n.dest.disconnect())};Qe.prototype._reassignMasterOutput=function(t,r){const n=t.outputs.get(r);t.outputs.delete(r);const a=this,l=Array.from(t.outputs.keys())[0],c=typeof l=="string"?l:"default";return n.audio.setSinkId(c).then(()=>{a._disableOutput(t,c),t.outputs.set(c,n),t._masterAudioDeviceId=c}).catch(function(){t.outputs.set(r,n),a._log.info("Could not reassign master output. Attempted to roll back.")})};Qe.prototype._removeAudioOutput=function(t){return this._masterAudioDeviceId===t?this._reassignMasterOutput(this,t):(this._disableOutput(this,t),this.outputs.delete(t),Promise.resolve())};Qe.prototype._onAddTrack=function(t,r){const n=t._masterAudio=this._createAudio();Om(n,r,this._audioHelper).then(()=>n.play()).catch(()=>t._log.error("Error attaching stream to element (_onAddTrack)."));const a=Array.from(t.outputs.keys())[0],l=typeof a=="string"?a:"default";t._masterAudioDeviceId=l,t.outputs.set(l,{audio:n});try{t._mediaStreamSource=t._audioContext.createMediaStreamSource(r)}catch(c){this._log.warn("Unable to create a MediaStreamSource from onAddTrack",c),this._mediaStreamSource=null}t.pcStream=r,t._updateAudioOutputs()};Qe.prototype._fallbackOnAddTrack=function(t,r){const n=document&&document.createElement("audio");Om(n,r,this._audioHelper).then(()=>n.play()).catch(()=>t._log.error("Error attaching stream to element (_fallbackOnAddTrack).")),t.outputs.set("default",{audio:n})};Qe.prototype._setEncodingParameters=function(e){if(!e||!this._sender||typeof this._sender.getParameters!="function"||typeof this._sender.setParameters!="function")return;const t=this._sender.getParameters();!t.priority&&!(t.encodings&&t.encodings.length)||(t.priority="high",t.encodings&&t.encodings.length&&t.encodings.forEach(r=>{r.priority="high",r.networkPriority="high"}),this._sender.setParameters(t))};Qe.prototype._setupPeerConnection=function(e){const t=this,r=new(this.options.rtcpcFactory||xs)({RTCPeerConnection:this.options.RTCPeerConnection});r.create(e),cq(r.pc,this.stream);const n=RTCRtpReceiver.getCapabilities("audio").codecs;this._log.debug("sorting codecs",n,this.codecPreferences);const a=ZA(n,this.codecPreferences),[l]=r.pc.getTransceivers();this._log.debug("setting sorted codecs",a),l.setCodecPreferences(a);const c="ontrack"in r.pc?"ontrack":"onaddstream";return r.pc[c]=d=>{const h=t._remoteStream=d.stream||d.streams[0];typeof r.pc.getSenders=="function"&&(this._sender=r.pc.getSenders()[0]),t._isSinkSupported?t._onAddTrack(t,h):t._fallbackOnAddTrack(t,h),t._startPollingVolume()},r};Qe.prototype._maybeSetIceAggressiveNomination=function(e){return this.options.forceAggressiveIceNomination?QU(e):e};Qe.prototype._setupChannel=function(){const e=this.version.pc;this.version.pc.onopen=()=>{this.status="open",this.onopen()},this.version.pc.onstatechange=()=>{this.version.pc&&this.version.pc.readyState==="stable"&&(this.status="open",this.onopen())},this.version.pc.onsignalingstatechange=()=>{const t=e.signalingState;this._log.info(`signalingState is "${t}"`),this.version.pc&&this.version.pc.signalingState==="stable"&&(this.status="open",this.onopen()),this.onsignalingstatechange(e.signalingState)},e.onconnectionstatechange=t=>{let r=e.connectionState;if(!r&&t&&t.target){const n=t.target;r=n.connectionState||n.connectionState_,this._log.info(`pc.connectionState not detected. Using target PC. State=${r}`)}r?this._log.info(`pc.connectionState is "${r}"`):this._log.warn(`onconnectionstatechange detected but state is "${r}"`),this.onpcconnectionstatechange(r),this._onMediaConnectionStateChange(r)},e.onicecandidate=t=>{const{candidate:r}=t;r&&(this._hasIceCandidates=!0,this.onicecandidate(r),this._setupRTCIceTransportListener()),this._log.info(`ICE Candidate: ${JSON.stringify(r)}`)},e.onicegatheringstatechange=()=>{const t=e.iceGatheringState;t==="gathering"?this._startIceGatheringTimeout():t==="complete"&&(this._stopIceGatheringTimeout(),this._hasIceCandidates||this._onIceGatheringFailure(iq),this._hasIceCandidates&&this._hasIceGatheringFailures&&this._startIceGatheringTimeout()),this._log.info(`pc.iceGatheringState is "${e.iceGatheringState}"`),this.onicegatheringstatechange(t)},e.oniceconnectionstatechange=()=>{this._log.info(`pc.iceConnectionState is "${e.iceConnectionState}"`),this.oniceconnectionstatechange(e.iceConnectionState),this._onMediaConnectionStateChange(e.iceConnectionState)}};Qe.prototype._initializeMediaStream=function(e){return this.status==="open"?!1:this.pstream.status==="disconnected"?(this.onerror({info:{code:31e3,message:"Cannot establish connection. Client is disconnected",twilioError:new Ls.ConnectionDisconnected}}),this.close(),!1):(this.version=this._setupPeerConnection(e),this._setupChannel(),!0)};Qe.prototype._removeReconnectionListeners=function(){this.pstream&&(this.pstream.removeListener("answer",this._onAnswerOrRinging),this.pstream.removeListener("hangup",this._onHangup))};Qe.prototype._setupRTCDtlsTransportListener=function(){const e=this.getRTCDtlsTransport();if(!e||e.onstatechange)return;const t=()=>{this._log.info(`dtlsTransportState is "${e.state}"`),this.ondtlstransportstatechange(e.state)};t(),e.onstatechange=t};Qe.prototype._setupRTCIceTransportListener=function(){const e=this._getRTCIceTransport();!e||e.onselectedcandidatepairchange||(e.onselectedcandidatepairchange=()=>this.onselectedcandidatepairchange(e.getSelectedCandidatePair()))};Qe.prototype.iceRestart=function(){this._log.info("Attempting to restart ICE..."),this._hasIceCandidates=!1,this.version.createOffer(this.options.maxAverageBitrate,{iceRestart:!0}).then(()=>{this._removeReconnectionListeners(),this._onAnswerOrRinging=e=>{if(this._removeReconnectionListeners(),!e.sdp||this.version.pc.signalingState!=="have-local-offer"){const r=`Invalid state or param during ICE Restart:hasSdp:${!!e.sdp}, signalingState:${this.version.pc.signalingState}`;this._log.warn(r);return}const t=this._maybeSetIceAggressiveNomination(e.sdp);this._answerSdp=t,this.status!=="closed"&&this.version.processAnswer(this.codecPreferences,t,null,r=>{const n=r&&r.message?r.message:r;this._log.error(`Failed to process answer during ICE Restart. Error: ${n}`)})},this._onHangup=()=>{this._log.info("Received hangup during ICE Restart"),this._removeReconnectionListeners()},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("hangup",this._onHangup),this.pstream.reinvite(this.version.getSDP(),this.callSid)}).catch(e=>{const t=e&&e.message?e.message:e;this._log.error(`Failed to createOffer during ICE Restart. Error: ${t}`),this.onfailed(t)})};Qe.prototype.makeOutgoingCall=function(e,t,r,n,a){if(!this._initializeMediaStream(n))return;const l=this;this.callSid=r;function c(){l.options&&l._setEncodingParameters(l.options.dscp),a(l.version.pc)}function d(m){const g=m.message||m;l.onerror({info:{code:31e3,message:`Error processing answer: ${g}`,twilioError:new ya.ClientRemoteDescFailed}})}this._onAnswerOrRinging=m=>{if(!m.sdp)return;const g=this._maybeSetIceAggressiveNomination(m.sdp);l._answerSdp=g,l.status!=="closed"&&l.version.processAnswer(this.codecPreferences,g,c,d),l.pstream.removeListener("answer",l._onAnswerOrRinging),l.pstream.removeListener("ringing",l._onAnswerOrRinging)},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("ringing",this._onAnswerOrRinging);function h(){l.status!=="closed"&&(t?l.pstream.reconnect(l.version.getSDP(),l.callSid,t):l.pstream.invite(l.version.getSDP(),l.callSid,e),l._setupRTCDtlsTransportListener())}function f(m){const g=m.message||m;l.onerror({info:{code:31e3,message:`Error creating the offer: ${g}`,twilioError:new ya.ClientLocalDescFailed}})}this.version.createOffer(this.options.maxAverageBitrate,{audio:!0},h,f)};Qe.prototype.answerIncomingCall=function(e,t,r,n){if(!this._initializeMediaStream(r))return;t=this._maybeSetIceAggressiveNomination(t),this._answerSdp=t.replace(/^a=setup:actpass$/gm,"a=setup:passive"),this.callSid=e;const a=this;function l(){a.status!=="closed"&&(a.pstream.answer(a.version.getSDP(),e),a.options&&a._setEncodingParameters(a.options.dscp),n(a.version.pc),a._setupRTCDtlsTransportListener())}function c(d){const h=d.message||d;a.onerror({info:{code:31e3,message:`Error creating the answer: ${h}`,twilioError:new ya.ClientRemoteDescFailed}})}this.version.processSDP(this.options.maxAverageBitrate,this.codecPreferences,t,{audio:!0},l,c)};Qe.prototype.close=function(){this.version&&this.version.pc&&(this.version.pc.signalingState!=="closed"&&this.version.pc.close(),this.version.pc=null),this.stream&&(this.mute(!1),this._stopStream()),this.stream=null,this._removeReconnectionListeners(),this._stopIceGatheringTimeout(),this._audioHelper._destroyRemoteProcessedStream(),this._audioProcessorEventObserver.removeListener("add",this._onAudioProcessorAdded),this._audioProcessorEventObserver.removeListener("remove",this._onAudioProcessorRemoved),Promise.all(this._removeAudioOutputs()).catch(()=>{}),this._mediaStreamSource&&this._mediaStreamSource.disconnect(),this._inputAnalyser&&this._inputAnalyser.disconnect(),this._outputAnalyser&&this._outputAnalyser.disconnect(),this._inputAnalyser2&&this._inputAnalyser2.disconnect(),this._outputAnalyser2&&this._outputAnalyser2.disconnect(),this.status="closed",this.onclose()};Qe.prototype.reject=function(e){this.callSid=e};Qe.prototype.ignore=function(e){this.callSid=e};Qe.prototype.mute=function(e){this.isMuted=e,this.stream&&(this._sender&&this._sender.track?this._sender.track.enabled=!e:(typeof this.stream.getAudioTracks=="function"?this.stream.getAudioTracks():this.stream.audioTracks).forEach(r=>{r.enabled=!e}))};Qe.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender||this._dtmfSenderUnsupported)return this._dtmfSender||null;const t=this,r=this.version.pc;if(!r)return this._log.warn("No RTCPeerConnection available to call createDTMFSender on"),null;if(typeof r.getSenders=="function"&&(typeof RTCDTMFSender=="function"||typeof RTCDtmfSender=="function")){const n=r.getSenders().find(a=>a.dtmf);if(n)return this._log.info("Using RTCRtpSender#dtmf"),this._dtmfSender=n.dtmf,this._dtmfSender}if(typeof r.createDTMFSender=="function"&&typeof r.getLocalStreams=="function"){const n=r.getLocalStreams().map(a=>{const l=t._getAudioTracks(a);return l&&l[0]})[0];return n?(this._log.info("Creating RTCDTMFSender"),this._dtmfSender=r.createDTMFSender(n),this._dtmfSender):(this._log.warn("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null)}return this._log.info("RTCPeerConnection does not support RTCDTMFSender"),this._dtmfSenderUnsupported=!0,null};Qe.prototype.getRTCDtlsTransport=function(){const t=this.version&&this.version.pc&&typeof this.version.pc.getSenders=="function"&&this.version.pc.getSenders()[0];return t&&t.transport||null};Qe.prototype._canStopMediaStreamTrack=()=>typeof MediaStreamTrack.prototype.stop=="function";Qe.prototype._getAudioTracks=e=>typeof e.getAudioTracks=="function"?e.getAudioTracks():e.audioTracks;Qe.prototype._getRTCIceTransport=function(){const t=this.getRTCDtlsTransport();return t&&t.iceTransport||null};Qe.protocol=xs.test()?new xs:null;Qe.prototype._handleAudioProcessorEvent=function(e,t){if(!e||!this._remoteStream)return;let r=null;this._masterAudio?(this._log.info("Setting audio source for master audio."),r=this._masterAudio):(this._log.info("No master audio. Setting audio source for default audio output."),r=this.outputs.get("default").audio),Om(r,this._remoteStream,this._audioHelper).then(()=>{const n=t?"Successfully updated audio source with processed stream":"Successfully reverted audio source to original stream";this._log.info(n),r.paused&&(this._log.info("Resuming audio playback"),r.play())}).catch(()=>{const n=t?"Failed to update audio source":"Failed to revert audio source";this._log.error(n)})};function cq(e,t){typeof e.addTrack=="function"?t.getAudioTracks().forEach(r=>{e.addTrack(r,t)}):e.addStream(t)}function mS(e,t){let r;return t?r=new t:typeof MediaStream<"u"?r=new MediaStream:r=new webkitMediaStream,e.getAudioTracks().forEach(r.addTrack,r),r}function Om(e,t,r){return r._maybeCreateRemoteProcessedStream(t).then(n=>{if(typeof e.srcObject<"u")e.srcObject=n;else if(typeof e.mozSrcObject<"u")e.mozSrcObject=n;else if(typeof e.src<"u"){const a=e.options.window||window;e.src=(a.URL||a.webkitURL).createObjectURL(n)}else return Promise.reject();return Promise.resolve()})}Qe.enabled=xs.test();function dq(){return xs.test()}function uq(){return typeof RTCIceGatherer<"u"?"ORTC":"WebRTC"}function hq(e,t){return t=t||{},t.util=t.util||eT,t.navigator=t.navigator||(typeof navigator<"u"?navigator:null),new Promise((r,n)=>{if(!t.navigator)throw new an("getUserMedia is not supported");switch("function"){case typeof(t.navigator.mediaDevices&&t.navigator.mediaDevices.getUserMedia):return r(t.navigator.mediaDevices.getUserMedia(e));case typeof t.navigator.webkitGetUserMedia:return t.navigator.webkitGetUserMedia(e,r,n);case typeof t.navigator.mozGetUserMedia:return t.navigator.mozGetUserMedia(e,r,n);case typeof t.navigator.getUserMedia:return t.navigator.getUserMedia(e,r,n);default:throw new an("getUserMedia is not supported")}}).catch(r=>{throw t.util.isFirefox()&&r.name==="NotReadableError"?new an(`Firefox does not currently support opening multiple audio input trackssimultaneously, even across different tabs.
Related Bugzilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324`):r})}function fq(){if(typeof window!="object")throw new an("This platform is not supported.");const{crypto:e}=window;if(typeof e!="object")throw new an("The `crypto` module is not available on this platform.");if(typeof e.getRandomValues!="function")throw new an("The function `crypto.getRandomValues` is not available on this platform.");if(typeof window.Uint8Array!="function")throw new an("The `Uint8Array` module is not available on this platform.");return e.getRandomValues(new window.Uint8Array(16)).reduce((t,r)=>`${t}${r.toString(16).padStart(2,"0")}`,"")}function ty(){return`KX${fq()}`}let mq=class{constructor(){this._promise=new Promise((t,r)=>{this._resolve=t,this._reject=r})}get promise(){return this._promise}reject(t){this._reject(t)}resolve(t){this._resolve(t)}};class pq{constructor(){this._operations=[]}enqueue(t){const r=!!this._operations.length,n=new mq;return this._operations.push({deferred:n,callback:t}),r||this._processQueue(),n.promise}_processQueue(){return Ce(this,void 0,void 0,function*(){for(;this._operations.length;){const{deferred:t,callback:r}=this._operations[0];let n,a,l;try{n=yield r(),l=!0}catch(c){a=c}this._operations.shift(),l?t.resolve(n):t.reject(a)}})}}class gq{get reject(){return this._reject}get resolve(){return this._resolve}constructor(){this.promise=new Promise((t,r)=>{this._resolve=t,this._reject=r})}}class xq{constructor(){this._eventEmitter=new zs.EventEmitter}addEventListener(t,r){return this._eventEmitter.addListener(t,r)}dispatchEvent(t,...r){return this._eventEmitter.emit(t,...r)}removeEventListener(t,r){return this._eventEmitter.removeListener(t,r)}}class pS extends xq{get destination(){return this._destination}get loop(){return this._loop}set loop(t){const r=this;function n(){r._audioNode.removeEventListener("ended",n),r.pause()}!t&&this.loop&&!this.paused&&this._audioNode.addEventListener("ended",n),this._loop=t}get muted(){return this._gainNode.gain.value===0}set muted(t){this._gainNode.gain.value=t?0:1}get paused(){return this._audioNode===null}get src(){return this._src}set src(t){this._load(t)}get srcObject(){return this._audioElement.srcObject}set srcObject(t){this._audioElement.srcObject=t}get sinkId(){return this._sinkId}constructor(t,r={},n={}){super(),this._audioNode=null,this._loop=!1,this._pendingPlayDeferreds=[],this._sinkId="default",this._src="",typeof r!="string"&&(n=r),this._audioContext=t,this._audioElement=new(n.AudioFactory||Audio),this._bufferPromise=this._createPlayDeferred().promise,this._destination=this._audioContext.destination,this._gainNode=this._audioContext.createGain(),this._gainNode.connect(this._destination),this._XMLHttpRequest=n.XMLHttpRequestFactory||XMLHttpRequest,this.addEventListener("canplaythrough",()=>{this._resolvePlayDeferreds()}),typeof r=="string"&&(this.src=r)}load(){this._load(this._src)}pause(){this.paused||(this._audioElement.pause(),this._audioNode.stop(),this._audioNode.disconnect(this._gainNode),this._audioNode=null,this._rejectPlayDeferreds(new Error("The play() request was interrupted by a call to pause().")))}play(){return Ce(this,void 0,void 0,function*(){if(!this.paused){if(yield this._bufferPromise,!this.paused)return;throw new Error("The play() request was interrupted by a call to pause().")}this._audioNode=this._audioContext.createBufferSource(),this._audioNode.loop=this.loop,this._audioNode.addEventListener("ended",()=>{this._audioNode&&this._audioNode.loop||this.dispatchEvent("ended")});const t=yield this._bufferPromise;if(this.paused)throw new Error("The play() request was interrupted by a call to pause().");if(this._audioNode.buffer=t,this._audioNode.connect(this._gainNode),this._audioNode.start(),this._audioElement.srcObject)return this._audioElement.play()})}setSinkId(t){return Ce(this,void 0,void 0,function*(){if(typeof this._audioElement.setSinkId!="function")throw new Error("This browser does not support setSinkId.");if(t!==this.sinkId){if(t==="default"){this.paused||this._gainNode.disconnect(this._destination),this._audioElement.srcObject=null,this._destination=this._audioContext.destination,this._gainNode.connect(this._destination),this._sinkId=t;return}yield this._audioElement.setSinkId(t),!this._audioElement.srcObject&&(this._gainNode.disconnect(this._audioContext.destination),this._destination=this._audioContext.createMediaStreamDestination(),this._audioElement.srcObject=this._destination.stream,this._sinkId=t,this._gainNode.connect(this._destination))}})}_createPlayDeferred(){const t=new gq;return this._pendingPlayDeferreds.push(t),t}_load(t){this._src&&this._src!==t&&this.pause(),this._src=t,this._bufferPromise=new Promise((r,n)=>Ce(this,void 0,void 0,function*(){if(!t)return this._createPlayDeferred().promise;const a=yield bq(this._audioContext,this._XMLHttpRequest,t);this.dispatchEvent("canplaythrough"),r(a)}))}_rejectPlayDeferreds(t){const r=this._pendingPlayDeferreds;r.splice(0,r.length).forEach(({reject:n})=>n(t))}_resolvePlayDeferreds(t){const r=this._pendingPlayDeferreds;r.splice(0,r.length).forEach(({resolve:n})=>n(t))}}function bq(e,t,r){return Ce(this,void 0,void 0,function*(){const n=new t;n.open("GET",r,!0),n.responseType="arraybuffer";const a=yield new Promise(l=>{n.addEventListener("load",l),n.send()});try{return e.decodeAudioData(a.target.response)}catch{return new Promise(c=>{e.decodeAudioData(a.target.response,c)})}})}function ii(e,t,r){if(!(this instanceof ii))return new ii(e,t,r);if(!e||!t)throw new Bt("name and url are required arguments");r=Object.assign({AudioFactory:typeof Audio<"u"?Audio:null,maxDuration:0,shouldLoop:!1},r),r.AudioPlayer=r.audioContext?pS.bind(pS,r.audioContext):r.AudioFactory,Object.defineProperties(this,{_Audio:{value:r.AudioPlayer},_activeEls:{value:new Map},_isSinkSupported:{value:r.AudioFactory!==null&&typeof r.AudioFactory.prototype.setSinkId=="function"},_maxDuration:{value:r.maxDuration},_maxDurationTimeout:{value:null,writable:!0},_operations:{value:new pq},_playPromise:{value:null,writable:!0},_shouldLoop:{value:r.shouldLoop},_sinkIds:{value:["default"]},isPlaying:{enumerable:!0,get(){return!!this._playPromise}},name:{enumerable:!0,value:e},url:{enumerable:!0,value:t}}),this._Audio&&this._play(!0,!1)}function oT(e){e&&(e.pause(),e.src="",e.srcObject=null,e.load())}ii.prototype._playAudioElement=function(t,r,n){const a=this._activeEls.get(t);if(!a)throw new Bt(`sinkId: "${t}" doesn't have an audio element`);return a.muted=!!r,a.loop=!!n,a.play().then(()=>a).catch(l=>{throw oT(a),this._activeEls.delete(t),l})};ii.prototype._play=function(t,r){this.isPlaying&&this._stop(),this._maxDuration>0&&(this._maxDurationTimeout=setTimeout(this._stop.bind(this),this._maxDuration)),r=typeof r=="boolean"?r:this._shouldLoop;const n=this;return this._playPromise=Promise.all(this._sinkIds.map(function(c){if(!n._Audio)return Promise.resolve();let d=n._activeEls.get(c);return d?n._playAudioElement(c,t,r):(d=new n._Audio(n.url),typeof d.setAttribute=="function"&&d.setAttribute("crossorigin","anonymous"),new Promise(h=>{d.addEventListener("canplaythrough",h)}).then(()=>(n._isSinkSupported?d.setSinkId(c):Promise.resolve()).then(function(){return n._activeEls.set(c,d),n._playPromise?n._playAudioElement(c,t,r):Promise.resolve()})))}))};ii.prototype._stop=function(){this._activeEls.forEach((t,r)=>{this._sinkIds.includes(r)?(t.pause(),t.currentTime=0):(oT(t),this._activeEls.delete(r))}),clearTimeout(this._maxDurationTimeout),this._playPromise=null,this._maxDurationTimeout=null};ii.prototype.setSinkIds=function(t){this._isSinkSupported&&(t=t.forEach?t:[t],[].splice.apply(this._sinkIds,[0,this._sinkIds.length].concat(t)))};ii.prototype.stop=function(){this._operations.enqueue(()=>(this._stop(),Promise.resolve()))};ii.prototype.play=function(){return this._operations.enqueue(()=>this._play())};const vq=3e4,yq=2e3,wq="twilio-js-sdk",jq='Parameter "token" must be of type "string".';class Ie extends zs.EventEmitter{static get audioContext(){return Ie._audioContext}static get extension(){const t=typeof document<"u"?document.createElement("audio"):{canPlayType:!1};let r;try{r=t.canPlayType&&!!t.canPlayType("audio/mpeg").replace(/no/,"")}catch{r=!1}let n;try{n=t.canPlayType&&!!t.canPlayType("audio/ogg;codecs='vorbis'").replace(/no/,"")}catch{n=!1}return n&&!r?"ogg":"mp3"}static get isSupported(){return dq()}static get packageName(){return XA}static runPreflight(t,r){return new mr(t,Object.assign({audioContext:Ie._getOrCreateAudioContext()},r))}static toString(){return"[Twilio.Device class]"}static get version(){return gc}static _getOrCreateAudioContext(){return Ie._audioContext||(typeof AudioContext<"u"?Ie._audioContext=new AudioContext:typeof webkitAudioContext<"u"&&(Ie._audioContext=new webkitAudioContext)),Ie._audioContext}constructor(t,r={}){if(super(),this._activeCall=null,this._audio=null,this._audioProcessorEventObserver=null,this._callInputStream=null,this._calls=[],this._callSinkIds=["default"],this._chunderURIs=[],this._defaultOptions={allowIncomingWhileBusy:!1,closeProtection:!1,codecPreferences:[Re.Codec.PCMU,Re.Codec.Opus],dscp:!0,enableImprovedSignalingErrorPrecision:!1,forceAggressiveIceNomination:!1,logLevel:pu.levels.ERROR,maxCallSignalingTimeoutMs:0,preflight:!1,sounds:{},tokenRefreshMs:1e4,voiceEventSidGenerator:ty},this._edge=null,this._home=null,this._identity=null,this._log=new Gr("Device"),this._makeCallPromise=null,this._options={},this._preferredURI=null,this._publisher=null,this._region=null,this._regTimer=null,this._shouldReRegister=!1,this._soundcache=new Map,this._state=Ie.State.Unregistered,this._stateEventMapping={[Ie.State.Destroyed]:Ie.EventName.Destroyed,[Ie.State.Unregistered]:Ie.EventName.Unregistered,[Ie.State.Registering]:Ie.EventName.Registering,[Ie.State.Registered]:Ie.EventName.Registered},this._stream=null,this._streamConnectedPromise=null,this._tokenWillExpireTimeout=null,this._createDefaultPayload=l=>{const c={aggressive_nomination:this._options.forceAggressiveIceNomination,browser_extension:this._isBrowserExtension,dscp:!!this._options.dscp,ice_restart_enabled:!0,platform:uq(),sdk_version:gc};function d(h,f){f&&(c[h]=f)}if(l){const h=l.parameters.CallSid;d("call_sid",/^TJ/.test(h)?void 0:h),d("temp_call_sid",l.outboundConnectionId),d("audio_codec",l.codec),c.direction=l.direction}return d("gateway",this._stream&&this._stream.gateway),d("region",this._stream&&this._stream.region),c},this._onSignalingClose=()=>{this._stream=null,this._streamConnectedPromise=null},this._onSignalingConnected=l=>{var c;const d=GU(l.region);if(this._edge=l.edge||HU[d]||l.region,this._region=d||l.region,this._home=l.home,(c=this._publisher)===null||c===void 0||c.setHost(cS(l.home)),l.token&&(this._identity=l.token.identity,typeof l.token.ttl=="number"&&typeof this._options.tokenRefreshMs=="number")){const f=l.token.ttl*1e3,m=Math.max(0,f-this._options.tokenRefreshMs);this._tokenWillExpireTimeout=setTimeout(()=>{this._log.debug("#tokenWillExpire"),this.emit("tokenWillExpire",this),this._tokenWillExpireTimeout&&(clearTimeout(this._tokenWillExpireTimeout),this._tokenWillExpireTimeout=null)},m)}const h=this._getChunderws()||uS(this._edge);if(h.length>0){const[f]=h;this._preferredURI=dS(f)}else this._log.warn("Could not parse a preferred URI from the stream#connected event.");this._shouldReRegister&&this.register()},this._onSignalingError=l=>{if(typeof l!="object"){this._log.warn("Invalid signaling error payload",l);return}const{error:c,callsid:d,voiceeventsid:h}=l;if(typeof c!="object"||h){this._log.warn("Ignoring signaling error payload",{originalError:c,voiceeventsid:h});return}const f=typeof d=="string"&&this._findCall(d)||void 0,{code:m,message:g}=c;let{twilioError:x}=c;if(typeof m=="number")if(m===31201)x=new Vr.AuthenticationFailed(c);else if(m===31204)x=new Vr.AccessTokenInvalid(c);else if(m===31205)this._stopRegistrationTimer(),x=new Vr.AccessTokenExpired(c);else{const b=Yv(!!this._options.enableImprovedSignalingErrorPrecision,m);typeof b<"u"&&(x=new b(c))}x||(this._log.error("Unknown signaling error: ",c),x=new An.UnknownError(g,c)),this._log.error("Received error: ",x),this._log.debug("#error",c),this.emit(Ie.EventName.Error,x,f)},this._onSignalingInvite=l=>Ce(this,void 0,void 0,function*(){var c;const d=!!this._activeCall;if(d&&!this._options.allowIncomingWhileBusy){this._log.info("Device busy; ignoring incoming invite");return}if(!l.callsid||!l.sdp){this._log.debug("#error",l),this.emit(Ie.EventName.Error,new Fl.BadRequest("Malformed invite from gateway"));return}const h=l.parameters||{};h.CallSid=h.CallSid||l.callsid;const f=Object.assign({},QA(h.Params));this._makeCallPromise=this._makeCall(f,{callParameters:h,enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,offerSdp:l.sdp,reconnectToken:l.reconnect,voiceEventSidGenerator:this._options.voiceEventSidGenerator});let m;try{m=yield this._makeCallPromise}finally{this._makeCallPromise=null}this._calls.push(m),m.once("accept",()=>{this._soundcache.get(Ie.SoundName.Incoming).stop(),this._publishNetworkChange()});const g=!((c=this._audio)===null||c===void 0)&&c.incoming()&&!d?()=>this._soundcache.get(Ie.SoundName.Incoming).play():()=>Promise.resolve();this._showIncomingCall(m,g)}),this._onSignalingOffline=()=>{this._log.info("Stream is offline"),this._edge=null,this._region=null,this._shouldReRegister=this.state!==Ie.State.Unregistered,this._setState(Ie.State.Unregistered)},this._onSignalingReady=()=>{this._log.info("Stream is ready"),this._setState(Ie.State.Registered)},this._publishNetworkChange=()=>{this._activeCall&&this._networkInformation&&this._publisher.info("network-information","network-change",{connection_type:this._networkInformation.type,downlink:this._networkInformation.downlink,downlinkMax:this._networkInformation.downlinkMax,effective_type:this._networkInformation.effectiveType,rtt:this._networkInformation.rtt},this._activeCall)},this._updateInputStream=l=>{const c=this._activeCall;return c&&!l?Promise.reject(new Xs("Cannot unset input device while a call is in progress.")):(this._callInputStream=l,c?c._setInputTracksFromStream(l):Promise.resolve())},this._updateSinkIds=(l,c)=>(l==="ringtone"?this._updateRingtoneSinkIds(c):this._updateSpeakerSinkIds(c)).then(()=>{this._publisher.info("audio",`${l}-devices-set`,{audio_device_ids:c},this._activeCall)},h=>{throw this._publisher.error("audio",`${l}-devices-set-failed`,{audio_device_ids:c,message:h.message},this._activeCall),h}),this._setupLoglevel(r.logLevel),this._logOptions("constructor",r),this.updateToken(t),Em())throw new an("Microsoft Edge Legacy (https://support.microsoft.com/en-us/help/4533505/what-is-microsoft-edge-legacy) is deprecated and will not be able to connect to Twilio to make or receive calls after September 1st, 2020. Please see this documentation for a list of supported browsers https://www.twilio.com/docs/voice/client/javascript#supported-browsers");if(!Ie.isSupported&&r.ignoreBrowserSupport)throw window&&window.location&&window.location.protocol==="http:"?new an("twilio.js wasn't able to find WebRTC browser support.           This is most likely because this page is served over http rather than https,           which does not support WebRTC in many browsers. Please load this page over https and           try again."):new an("twilio.js 1.3+ SDKs require WebRTC browser support.         For more information, see <https://www.twilio.com/docs/api/client/twilio-js>.         If you have any questions about this announcement, please contact         Twilio Support at <help@twilio.com>.");const n=globalThis,a=n.msBrowser||n.browser||n.chrome;if(this._isBrowserExtension=!!a&&!!a.runtime&&!!a.runtime.id||!!n.safari&&!!n.safari.extension,this._isBrowserExtension&&this._log.info("Running as browser extension."),navigator){const l=navigator;this._networkInformation=l.connection||l.mozConnection||l.webkitConnection}this._networkInformation&&typeof this._networkInformation.addEventListener=="function"&&this._networkInformation.addEventListener("change",this._publishNetworkChange),Ie._getOrCreateAudioContext(),Ie._audioContext&&(Ie._dialtonePlayer||(Ie._dialtonePlayer=new xU(Ie._audioContext))),this._boundDestroy=this.destroy.bind(this),this._boundConfirmClose=this._confirmClose.bind(this),typeof window<"u"&&window.addEventListener&&(window.addEventListener("unload",this._boundDestroy),window.addEventListener("pagehide",this._boundDestroy)),this.updateOptions(r)}get audio(){return this._audio}connect(){return Ce(this,arguments,void 0,function*(t={}){if(this._log.debug(".connect",JSON.stringify(t)),this._throwIfDestroyed(),this._activeCall)throw new Xs("A Call is already active");let r,n,a;if(t.connectToken){try{const f=JSON.parse(decodeURIComponent(atob(t.connectToken)));r=f.customParameters,n=f.parameters,a=f.signalingReconnectToken}catch{throw new Bt("Cannot parse connectToken")}if(!n||!n.CallSid||!a)throw new Bt("Invalid connectToken")}let l=!1,c={};const d={enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,rtcConfiguration:t.rtcConfiguration,voiceEventSidGenerator:this._options.voiceEventSidGenerator};a&&n?(l=!0,d.callParameters=n,d.reconnectCallSid=n.CallSid,d.reconnectToken=a,c=r||c):c=t.params||c;let h;this._makeCallPromise=this._makeCall(c,d,l);try{h=this._activeCall=yield this._makeCallPromise}finally{this._makeCallPromise=null}return this._calls.splice(0).forEach(f=>f.ignore()),this._soundcache.get(Ie.SoundName.Incoming).stop(),h.accept({rtcConstraints:t.rtcConstraints}),this._publishNetworkChange(),h})}get calls(){return this._calls}destroy(){var t;this._log.debug(".destroy"),this._log.debug("Rejecting any incoming calls"),this._calls.slice(0).forEach(n=>n.reject()),this.disconnectAll(),this._stopRegistrationTimer(),this._destroyStream(),this._destroyAudioHelper(),(t=this._audioProcessorEventObserver)===null||t===void 0||t.destroy(),this._destroyPublisher(),this._networkInformation&&typeof this._networkInformation.removeEventListener=="function"&&this._networkInformation.removeEventListener("change",this._publishNetworkChange),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.removeEventListener("unload",this._boundDestroy),window.removeEventListener("pagehide",this._boundDestroy)),this._setState(Ie.State.Destroyed),zs.EventEmitter.prototype.removeAllListeners.call(this)}disconnectAll(){this._log.debug(".disconnectAll"),this._calls.splice(0).forEach(r=>r.disconnect()),this._activeCall&&this._activeCall.disconnect()}get edge(){return this._edge}get home(){return this._home}get identity(){return this._identity}get isBusy(){return!!this._activeCall}register(){return Ce(this,void 0,void 0,function*(){if(this._log.debug(".register"),this.state!==Ie.State.Unregistered)throw new Xs(`Attempt to register when device is in state "${this.state}". Must be "${Ie.State.Unregistered}".`);this._shouldReRegister=!1,this._setState(Ie.State.Registering),yield this._streamConnectedPromise||this._setupStream(),yield this._sendPresence(!0),yield Jv(this,Ie.State.Registered,Ie.State.Unregistered)})}get state(){return this._state}get token(){return this._token}toString(){return"[Twilio.Device instance]"}unregister(){return Ce(this,void 0,void 0,function*(){if(this._log.debug(".unregister"),this.state!==Ie.State.Registered)throw new Xs(`Attempt to unregister when device is in state "${this.state}". Must be "${Ie.State.Registered}".`);this._shouldReRegister=!1;const t=yield this._streamConnectedPromise,r=new Promise(n=>{t.on("offline",n)});yield this._sendPresence(!1),yield r})}updateOptions(t={}){if(this._logOptions("updateOptions",t),this.state===Ie.State.Destroyed)throw new Xs(`Attempt to "updateOptions" when device is in state "${this.state}".`);this._options=Object.assign(Object.assign(Object.assign({},this._defaultOptions),this._options),t);const r=new Set(this._chunderURIs),n=this._chunderURIs=(this._getChunderws()||uS(this._options.edge)).map(dS);let a=r.size!==n.length;if(!a){for(const l of n)if(!r.has(l)){a=!0;break}}if(this.isBusy&&a)throw new Xs("Cannot change Edge while on an active Call");this._setupLoglevel(this._options.logLevel);for(const l of Object.keys(Ie._defaultSounds)){const c=Ie._defaultSounds[l],d=`${Pw}/${c.filename}.${Ie.extension}?cache=${gc}`,h=this._options.sounds&&this._options.sounds[l]||d,f=new(this._options.Sound||ii)(l,h,{audioContext:this._options.disableAudioContextSounds?null:Ie.audioContext,maxDuration:c.maxDuration,shouldLoop:c.shouldLoop});this._soundcache.set(l,f)}this._setupAudioHelper(),this._setupPublisher(),a&&this._streamConnectedPromise&&this._setupStream(),typeof window<"u"&&typeof window.addEventListener=="function"&&this._options.closeProtection&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.addEventListener("beforeunload",this._boundConfirmClose))}updateToken(t){if(this._log.debug(".updateToken"),this.state===Ie.State.Destroyed)throw new Xs(`Attempt to "updateToken" when device is in state "${this.state}".`);if(typeof t!="string")throw new Bt(jq);this._token=t,this._stream&&this._stream.setToken(this._token),this._publisher&&this._publisher.setToken(this._token)}_confirmClose(t){if(!this._activeCall)return"";const r=this._options.closeProtection||!1,n=typeof r!="string"?"A call is currently in-progress. Leaving or reloading this page will end the call.":r;return(t||window.event).returnValue=n,n}_destroyAudioHelper(){this._audio&&(this._audio._destroy(),this._audio=null)}_destroyPublisher(){this._publisher&&(this._publisher=null)}_destroyStream(){this._stream&&(this._stream.removeListener("close",this._onSignalingClose),this._stream.removeListener("connected",this._onSignalingConnected),this._stream.removeListener("error",this._onSignalingError),this._stream.removeListener("invite",this._onSignalingInvite),this._stream.removeListener("offline",this._onSignalingOffline),this._stream.removeListener("ready",this._onSignalingReady),this._stream.destroy(),this._stream=null),this._onSignalingOffline(),this._streamConnectedPromise=null}_findCall(t){return this._calls.find(r=>r.parameters.CallSid===t||r.outboundConnectionId===t)||null}_getChunderws(){return typeof this._options.chunderw=="string"?[this._options.chunderw]:Array.isArray(this._options.chunderw)?this._options.chunderw:null}_logOptions(t,r={}){const n=["allowIncomingWhileBusy","appName","appVersion","closeProtection","codecPreferences","disableAudioContextSounds","dscp","edge","enableImprovedSignalingErrorPrecision","forceAggressiveIceNomination","logLevel","maxAverageBitrate","maxCallSignalingTimeoutMs","sounds","tokenRefreshMs"],a=["RTCPeerConnection","enumerateDevices","getUserMedia","MediaStream"];if(typeof r=="object"){const l=Object.assign({},r);Object.keys(l).forEach(c=>{!n.includes(c)&&!a.includes(c)&&delete l[c],a.includes(c)&&(l[c]=!0)}),this._log.debug(`.${t}`,JSON.stringify(l))}}_makeCall(t,r){return Ce(this,arguments,void 0,function*(n,a,l=!1){var c;const d=(c=this._audio)===null||c===void 0?void 0:c._getInputDevicePromise();d&&(this._log.debug("inputDevicePromise detected, waiting..."),yield d,this._log.debug("inputDevicePromise resolved"));const h={audioHelper:this._audio,onIgnore:()=>{this._soundcache.get(Ie.SoundName.Incoming).stop()},pstream:yield this._streamConnectedPromise||this._setupStream(),publisher:this._publisher,soundcache:this._soundcache};a=Object.assign({MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,beforeAccept:g=>{!this._activeCall||this._activeCall===g||(this._activeCall.disconnect(),this._removeCall(this._activeCall))},codecPreferences:this._options.codecPreferences,customSounds:this._options.sounds,dialtonePlayer:Ie._dialtonePlayer,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,getInputStream:()=>this._options.fileInputStream||this._callInputStream,getSinkIds:()=>this._callSinkIds,maxAverageBitrate:this._options.maxAverageBitrate,preflight:this._options.preflight,rtcConstraints:this._options.rtcConstraints,shouldPlayDisconnect:()=>{var g;return(g=this._audio)===null||g===void 0?void 0:g.disconnect()},twimlParams:n,voiceEventSidGenerator:this._options.voiceEventSidGenerator},a);const f=()=>{if(!this._stream){this._log.warn("UnsetPreferredUri called without a stream");return}this._activeCall===null&&this._calls.length===0&&this._stream.updatePreferredURI(null)},m=new(this._options.Call||Re)(h,a);return this._publisher.info("settings","init",{MediaStream:!!this._options.MediaStream,RTCPeerConnection:!!this._options.RTCPeerConnection,enumerateDevices:!!this._options.enumerateDevices,getUserMedia:!!this._options.getUserMedia},m),m.once("accept",()=>{var g,x,b,j,w;this._stream.updatePreferredURI(this._preferredURI),this._removeCall(m),this._activeCall=m,this._audio&&this._audio._maybeStartPollingVolume(),m.direction===Re.CallDirection.Outgoing&&(!((g=this._audio)===null||g===void 0)&&g.outgoing())&&!l&&this._soundcache.get(Ie.SoundName.Outgoing).play();const _={edge:this._edge||this._region};this._options.edge&&(_.selected_edge=Array.isArray(this._options.edge)?this._options.edge:[this._options.edge]),this._publisher.info("settings","edge",_,m),!((x=this._audio)===null||x===void 0)&&x.localProcessedStream&&((b=this._audioProcessorEventObserver)===null||b===void 0||b.emit("enabled",!1)),!((j=this._audio)===null||j===void 0)&&j.remoteProcessedStream&&((w=this._audioProcessorEventObserver)===null||w===void 0||w.emit("enabled",!0))}),m.addListener("error",g=>{m.status()==="closed"&&(this._removeCall(m),f()),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),m.once("cancel",()=>{this._log.info(`Canceled: ${m.parameters.CallSid}`),this._removeCall(m),f(),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),m.once("disconnect",()=>{this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(m),f(),this._maybeStopIncomingSound()}),m.once("reject",()=>{this._log.info(`Rejected: ${m.parameters.CallSid}`),this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(m),f(),this._maybeStopIncomingSound()}),m.on("transportClose",()=>{m.status()===Re.State.Pending&&(this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(m),this._maybeStopIncomingSound())}),m})}_maybeStopIncomingSound(){this._calls.length||this._soundcache.get(Ie.SoundName.Incoming).stop()}_removeCall(t){this._activeCall===t&&(this._activeCall=null,this._makeCallPromise=null);for(let r=this._calls.length-1;r>=0;r--)t===this._calls[r]&&this._calls.splice(r,1)}_sendPresence(t){return Ce(this,void 0,void 0,function*(){const r=yield this._streamConnectedPromise;r&&(r.register({audio:t}),t?this._startRegistrationTimer():this._stopRegistrationTimer())})}_setState(t){if(t===this.state)return;this._state=t;const r=this._stateEventMapping[t];this._log.debug(`#${r}`),this.emit(r)}_setupAudioHelper(){this._audioProcessorEventObserver||(this._audioProcessorEventObserver=new pU,this._audioProcessorEventObserver.on("event",({name:r,group:n,isRemote:a})=>{this._publisher.info(n,r,{is_remote:a},this._activeCall)}));const t={audioContext:Ie.audioContext,audioProcessorEventObserver:this._audioProcessorEventObserver,beforeSetInputDevice:()=>this._makeCallPromise?(this._log.debug("beforeSetInputDevice pause detected"),this._makeCallPromise):(this._log.debug("beforeSetInputDevice pause not detected, setting default"),Promise.resolve()),enumerateDevices:this._options.enumerateDevices,getUserMedia:this._options.getUserMedia||hq};if(this._audio){this._log.info("Found existing audio helper; updating options..."),this._audio._updateUserOptions(t);return}this._audio=new(this._options.AudioHelper||mU)(this._updateSinkIds,this._updateInputStream,t),this._audio.on("deviceChange",r=>{const n=this._activeCall,a=r.map(l=>l.deviceId);this._publisher.info("audio","device-change",{lost_active_device_ids:a},n),n&&n._mediaHandler._onInputDevicesChanged()})}_setupLoglevel(t){const r=typeof t=="number"||typeof t=="string"?t:pu.levels.ERROR;this._log.setDefaultLevel(r),this._log.info("Set logger default level to",r)}_setupPublisher(){this._publisher&&(this._log.info("Found existing publisher; destroying..."),this._destroyPublisher());const t={defaultPayload:this._createDefaultPayload,metadata:{app_name:this._options.appName,app_version:this._options.appVersion}};return this._options.eventgw&&(t.host=this._options.eventgw),this._home&&(t.host=cS(this._home)),this._publisher=new(this._options.Publisher||In)(wq,this.token,t),this._options.publishEvents===!1?this._publisher.disable():this._publisher.on("error",r=>{this._log.warn("Cannot connect to insights.",r)}),this._publisher}_setupStream(){return this._stream&&(this._log.info("Found existing stream; destroying..."),this._destroyStream()),this._log.info("Setting up VSP"),this._stream=new(this._options.PStream||ar)(this.token,this._chunderURIs,{backoffMaxMs:this._options.backoffMaxMs,maxPreferredDurationMs:this._options.maxCallSignalingTimeoutMs}),this._stream.addListener("close",this._onSignalingClose),this._stream.addListener("connected",this._onSignalingConnected),this._stream.addListener("error",this._onSignalingError),this._stream.addListener("invite",this._onSignalingInvite),this._stream.addListener("offline",this._onSignalingOffline),this._stream.addListener("ready",this._onSignalingReady),this._streamConnectedPromise=Jv(this._stream,"connected","close").then(()=>this._stream)}_showIncomingCall(t,r){let n;return Promise.race([r(),new Promise((a,l)=>{n=setTimeout(()=>{const c="Playing incoming ringtone took too long; it might not play. Continuing execution...";l(new Error(c))},yq)})]).catch(a=>{this._log.warn(a.message)}).then(()=>{clearTimeout(n),this._log.debug("#incoming",JSON.stringify({customParameters:t.customParameters,parameters:t.parameters})),this.emit(Ie.EventName.Incoming,t)})}_startRegistrationTimer(){this._stopRegistrationTimer(),this._regTimer=setTimeout(()=>{this._sendPresence(!0)},vq)}_stopRegistrationTimer(){this._regTimer&&clearTimeout(this._regTimer)}_throwIfDestroyed(){if(this.state===Ie.State.Destroyed)throw new Xs("Device has been destroyed.")}_updateRingtoneSinkIds(t){return Promise.resolve(this._soundcache.get(Ie.SoundName.Incoming).setSinkIds(t))}_updateSpeakerSinkIds(t){Array.from(this._soundcache.entries()).filter(n=>n[0]!==Ie.SoundName.Incoming).forEach(n=>n[1].setSinkIds(t)),this._callSinkIds=t;const r=this._activeCall;return r?r._setSinkIds(t):Promise.resolve()}}Ie._defaultSounds={disconnect:{filename:"disconnect",maxDuration:3e3},dtmf0:{filename:"dtmf-0",maxDuration:1e3},dtmf1:{filename:"dtmf-1",maxDuration:1e3},dtmf2:{filename:"dtmf-2",maxDuration:1e3},dtmf3:{filename:"dtmf-3",maxDuration:1e3},dtmf4:{filename:"dtmf-4",maxDuration:1e3},dtmf5:{filename:"dtmf-5",maxDuration:1e3},dtmf6:{filename:"dtmf-6",maxDuration:1e3},dtmf7:{filename:"dtmf-7",maxDuration:1e3},dtmf8:{filename:"dtmf-8",maxDuration:1e3},dtmf9:{filename:"dtmf-9",maxDuration:1e3},dtmfh:{filename:"dtmf-hash",maxDuration:1e3},dtmfs:{filename:"dtmf-star",maxDuration:1e3},incoming:{filename:"incoming",shouldLoop:!0},outgoing:{filename:"outgoing",maxDuration:3e3}};(function(e){(function(t){t.Error="error",t.Incoming="incoming",t.Destroyed="destroyed",t.Unregistered="unregistered",t.Registering="registering",t.Registered="registered",t.TokenWillExpire="tokenWillExpire"})(e.EventName||(e.EventName={})),(function(t){t.Destroyed="destroyed",t.Unregistered="unregistered",t.Registering="registering",t.Registered="registered"})(e.State||(e.State={})),(function(t){t.Incoming="incoming",t.Outgoing="outgoing",t.Disconnect="disconnect",t.Dtmf0="dtmf0",t.Dtmf1="dtmf1",t.Dtmf2="dtmf2",t.Dtmf3="dtmf3",t.Dtmf4="dtmf4",t.Dtmf5="dtmf5",t.Dtmf6="dtmf6",t.Dtmf7="dtmf7",t.Dtmf8="dtmf8",t.Dtmf9="dtmf9",t.DtmfS="dtmfs",t.DtmfH="dtmfh"})(e.SoundName||(e.SoundName={}))})(Ie||(Ie={}));class Hx{constructor(t,r=!1){this.deleted=!1;let n;const a=t.candidate.split("network-cost ");a[1]&&(n=parseInt(a[1],10)),this.candidateType=t.type,this.ip=t.ip||t.address,this.isRemote=r,this.networkCost=n,this.port=t.port,this.priority=t.priority,this.protocol=t.protocol,this.relatedAddress=t.relatedAddress,this.relatedPort=t.relatedPort,this.tcpType=t.tcpType,this.transportId=t.sdpMid}toPayload(){return{candidate_type:this.candidateType,deleted:this.deleted,ip:this.ip,is_remote:this.isRemote,"network-cost":this.networkCost,port:this.port,priority:this.priority,protocol:this.protocol,related_address:this.relatedAddress,related_port:this.relatedPort,tcp_type:this.tcpType,transport_id:this.transportId}}}const gS=94.768;function _q(e,t,r){if(typeof e!="number"||typeof t!="number"||typeof r!="number"||!s0(e)||!s0(t)||!s0(r))return null;const n=e+t*2+10;let a=0;switch(!0){case n<160:a=gS-n/40;break;case n<1e3:a=gS-(n-120)/10;break}switch(!0){case r<=a/2.5:a=Math.max(a-r*2.5,6.52);break;default:a=0;break}return 1+.035*a+7e-6*a*(a-60)*(100-a)}function s0(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)&&e>=0}var kq={calculate:_q,isNonNegativeNumber:s0};const Nq=5,Sq=0,Cq=3,Eq=1e3,Aq=5*1e3,Tq={audioInputLevel:{minStandardDeviation:327.67,sampleCount:10},audioOutputLevel:{minStandardDeviation:327.67,sampleCount:10},bytesReceived:{clearCount:2,min:1,raiseCount:3,sampleCount:3},bytesSent:{clearCount:2,min:1,raiseCount:3,sampleCount:3},jitter:{max:30},mos:{min:3},packetsLostFraction:[{max:1},{clearValue:1,maxAverage:3,sampleCount:7}],rtt:{max:400}};function Oq(e,t){return t.reduce((r,n)=>r+=n>e?1:0,0)}function Pq(e,t){return t.reduce((r,n)=>r+=n<e?1:0,0)}function Dq(e){if(e.length<=0)return null;const t=e.reduce((a,l)=>a+l,0)/e.length,r=e.map(a=>Math.pow(a-t,2));return Math.sqrt(r.reduce((a,l)=>a+l,0)/r.length)}function Mq(e){return e.reduce((t,r)=>[...t,...r],[])}class Rq extends zs.EventEmitter{constructor(t){super(),this._activeWarnings=new Map,this._currentStreaks=new Map,this._inputVolumes=[],this._outputVolumes=[],this._sampleBuffer=[],this._supplementalSampleBuffers={audioInputLevel:[],audioOutputLevel:[]},this._warningsEnabled=!0,t=t||{},this._getRTCStats=t.getRTCStats||TU,this._mos=t.Mos||kq,this._peerConnection=t.peerConnection,this._thresholds=Object.assign(Object.assign({},Tq),t.thresholds);const r=Object.values(this._thresholds).map(n=>n.sampleCount).filter(n=>!!n);this._maxSampleCount=Math.max(Nq,...r),this._peerConnection&&this.enable(this._peerConnection)}addVolumes(t,r){this._inputVolumes.push(t),this._outputVolumes.push(r)}disable(){return this._sampleInterval&&(clearInterval(this._sampleInterval),delete this._sampleInterval),this}disableWarnings(){return this._warningsEnabled&&this._activeWarnings.clear(),this._warningsEnabled=!1,this}enable(t){if(t){if(this._peerConnection&&t!==this._peerConnection)throw new Bt("Attempted to replace an existing PeerConnection in StatsMonitor.enable");this._peerConnection=t}if(!this._peerConnection)throw new Bt("Can not enable StatsMonitor without a PeerConnection");return this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),Eq),this}enableWarnings(){return this._warningsEnabled=!0,this}hasActiveWarning(t,r){const n=`${t}:${r}`;return!!this._activeWarnings.get(n)}_addSample(t){const r=this._sampleBuffer;r.push(t),r.length>this._maxSampleCount&&r.splice(0,r.length-this._maxSampleCount)}_clearWarning(t,r,n){const a=`${t}:${r}`,l=this._activeWarnings.get(a);!l||Date.now()-l.timeRaised<Aq||(this._activeWarnings.delete(a),this.emit("warning-cleared",Object.assign(Object.assign({},n),{name:t,threshold:{name:r,value:this._thresholds[t][r]}})))}_createSample(t,r){const n=r&&r.totals.bytesSent||0,a=r&&r.totals.bytesReceived||0,l=r&&r.totals.packetsSent||0,c=r&&r.totals.packetsReceived||0,d=r&&r.totals.packetsLost||0,h=t.bytesSent-n,f=t.bytesReceived-a,m=t.packetsSent-l,g=t.packetsReceived-c,x=t.packetsLost-d,b=g+x,j=b>0?x/b*100:0,w=t.packetsReceived+t.packetsLost,_=w>0?t.packetsLost/w*100:100,N=typeof t.rtt=="number"||!r?t.rtt:r.rtt,C=this._inputVolumes.splice(0);this._supplementalSampleBuffers.audioInputLevel.push(C);const A=this._outputVolumes.splice(0);return this._supplementalSampleBuffers.audioOutputLevel.push(A),{audioInputLevel:Math.round(iu(C)),audioOutputLevel:Math.round(iu(A)),bytesReceived:f,bytesSent:h,codecName:t.codecName,jitter:t.jitter,mos:this._mos.calculate(N,t.jitter,r&&j),packetsLost:x,packetsLostFraction:j,packetsReceived:g,packetsSent:m,rtt:N,timestamp:t.timestamp,totals:{bytesReceived:t.bytesReceived,bytesSent:t.bytesSent,packetsLost:t.packetsLost,packetsLostFraction:_,packetsReceived:t.packetsReceived,packetsSent:t.packetsSent}}}_fetchSample(){this._getSample().then(t=>{this._addSample(t),this._raiseWarnings(),this.emit("sample",t)}).catch(t=>{this.disable(),this.emit("error",t)})}_getSample(){return this._getRTCStats(this._peerConnection).then(t=>{let r=null;return this._sampleBuffer.length&&(r=this._sampleBuffer[this._sampleBuffer.length-1]),this._createSample(t,r)})}_raiseWarning(t,r,n){const a=`${t}:${r}`;if(this._activeWarnings.has(a))return;this._activeWarnings.set(a,{timeRaised:Date.now()});const l=this._thresholds[t];let c;if(Array.isArray(l)){const d=l.find(h=>r in h);d&&(c=d[r])}else c=this._thresholds[t][r];this.emit("warning",Object.assign(Object.assign({},n),{name:t,threshold:{name:r,value:c}}))}_raiseWarnings(){this._warningsEnabled&&Object.keys(this._thresholds).forEach(t=>this._raiseWarningsForStat(t))}_raiseWarningsForStat(t){(Array.isArray(this._thresholds[t])?this._thresholds[t]:[this._thresholds[t]]).forEach(n=>{const a=this._sampleBuffer,l=n.clearCount||Sq,c=n.raiseCount||Cq,d=n.sampleCount||this._maxSampleCount;let h=a.slice(-d);const f=h.map(x=>x[t]);if(f.some(x=>typeof x>"u"||x===null))return;let g;if(typeof n.max=="number"&&(g=Oq(n.max,f),g>=c?this._raiseWarning(t,"max",{values:f,samples:h}):g<=l&&this._clearWarning(t,"max",{values:f,samples:h})),typeof n.min=="number"&&(g=Pq(n.min,f),g>=c?this._raiseWarning(t,"min",{values:f,samples:h}):g<=l&&this._clearWarning(t,"min",{values:f,samples:h})),typeof n.maxDuration=="number"&&a.length>1){h=a.slice(-2);const x=h[0][t],b=h[1][t],j=this._currentStreaks.get(t)||0,w=x===b?j+1:0;this._currentStreaks.set(t,w),w>=n.maxDuration?this._raiseWarning(t,"maxDuration",{value:w}):w===0&&this._clearWarning(t,"maxDuration",{value:j})}if(typeof n.minStandardDeviation=="number"){const x=this._supplementalSampleBuffers[t];if(!x||x.length<n.sampleCount)return;x.length>n.sampleCount&&x.splice(0,x.length-n.sampleCount);const b=Mq(x.slice(-d)),j=Dq(b);if(typeof j!="number")return;j<n.minStandardDeviation?this._raiseWarning(t,"minStandardDeviation",{value:j}):this._clearWarning(t,"minStandardDeviation",{value:j})}[["maxAverage",(x,b)=>x>b],["minAverage",(x,b)=>x<b]].forEach(([x,b])=>{if(typeof n[x]=="number"&&f.length>=d){const j=iu(f);b(j,n[x])?this._raiseWarning(t,x,{values:f,samples:h}):b(j,n.clearValue||n[x])||this._clearWarning(t,x,{values:f,samples:h})}})})}}const xS={factor:1.1,jitter:.5,max:3e4,min:1},Iq=70,$q=500,Lq=160,zq=10,Bq=5e3,bS={disconnect:!0,info:{code:31003,message:"Connection with Twilio was interrupted.",twilioError:new ya.ConnectionError}},vS={packetsLostFraction:{max:"packet-loss",maxAverage:"packets-lost-fraction"}},yS={audioInputLevel:"audio-input-level",audioOutputLevel:"audio-output-level",bytesReceived:"bytes-received",bytesSent:"bytes-sent",jitter:"jitter",mos:"mos",rtt:"rtt"},Uq={max:"high-",maxAverage:"high-",maxDuration:"constant-",min:"low-",minStandardDeviation:"constant-"};class Re extends zs.EventEmitter{get direction(){return this._direction}get codec(){return this._codec}get connectToken(){const t=this._signalingReconnectToken,r=this.parameters&&this.parameters.CallSid?this.parameters.CallSid:void 0;if(!t||!r)return;const n=this.customParameters&&typeof this.customParameters.keys=="function"?Array.from(this.customParameters.keys()).reduce((l,c)=>(l[c]=this.customParameters.get(c),l),{}):{},a=this.parameters||{};return btoa(encodeURIComponent(JSON.stringify({customParameters:n,parameters:a,signalingReconnectToken:t})))}constructor(t,r){super(),this.parameters={},this._inputVolumeStreak=0,this._isAnswered=!1,this._isCancelled=!1,this._isRejected=!1,this._latestInputVolume=0,this._latestOutputVolume=0,this._log=new Gr("Call"),this._mediaStatus=Re.State.Pending,this._messages=new Map,this._metricsSamples=[],this._options={MediaHandler:Qe,MediaStream:null,enableImprovedSignalingErrorPrecision:!1,offerSdp:null,shouldPlayDisconnect:()=>!0,voiceEventSidGenerator:ty},this._outputVolumeStreak=0,this._shouldSendHangup=!0,this._signalingStatus=Re.State.Pending,this._soundcache=new Map,this._status=Re.State.Pending,this._wasConnected=!1,this.toString=()=>"[Twilio.Call instance]",this._emitWarning=(c,d,h,f,m,g)=>{const b=`${c}warning${m?"-cleared":"-raised"}`;if(d==="constant-audio-input-level"&&this.isMuted())return;let j=m?"info":"warning";d==="constant-audio-output-level"&&(j="info");const w={threshold:h};if(f&&(f instanceof Array?w.values=f.map(_=>typeof _=="number"?Math.round(_*100)/100:f):w.value=f),this._publisher.post(j,b,d,{data:w},this),d!=="constant-audio-output-level"){const _=m?"warning-cleared":"warning";this._log.debug(`#${_}`,d),this.emit(_,d,g&&!m?g:null)}},this._onAck=c=>{const{acktype:d,callsid:h,voiceeventsid:f}=c;if(this.parameters.CallSid!==h){this._log.warn(`Received ack from a different callsid: ${h}`);return}d==="message"&&this._onMessageSent(f)},this._onAnswer=c=>{typeof c.reconnect=="string"&&(this._signalingReconnectToken=c.reconnect),!(this._isAnswered&&this._status!==Re.State.Reconnecting)&&(this._setCallSid(c),this._isAnswered=!0,this._maybeTransitionToOpen())},this._onCancel=c=>{const d=c.callsid;this.parameters.CallSid===d&&(this._isCancelled=!0,this._publisher.info("connection","cancel",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=Re.State.Closed,this._log.debug("#cancel"),this.emit("cancel"),this._pstream.removeListener("cancel",this._onCancel))},this._onConnected=()=>{this._log.info("Received connected from pstream"),this._signalingReconnectToken&&this._mediaHandler.version&&this._pstream.reconnect(this._mediaHandler.version.getSDP(),this.parameters.CallSid,this._signalingReconnectToken)},this._onHangup=c=>{if(this.status()!==Re.State.Closed){if(c.callsid&&(this.parameters.CallSid||this.outboundConnectionId)){if(c.callsid!==this.parameters.CallSid&&c.callsid!==this.outboundConnectionId)return}else if(c.callsid)return;if(this._log.info("Received HANGUP from gateway"),c.error){const d=c.error.code,h=Yv(this._options.enableImprovedSignalingErrorPrecision,d),f=typeof h<"u"?new h(c.error.message):new An.ConnectionError("Error sent from gateway in HANGUP",c.error);this._log.error("Received an error from the gateway:",f),this._log.debug("#error",f),this.emit("error",f)}this._shouldSendHangup=!1,this._publisher.info("connection","disconnected-by-remote",null,this),this._disconnect(null,!0),this._cleanupEventListeners()}},this._onMediaFailure=c=>{const{ConnectionDisconnected:d,ConnectionFailed:h,IceGatheringFailed:f,LowBytes:m}=Re.MediaFailure,g=c===h||c===f;if(!Mw(window,window.navigator)&&c===h)return this._mediaHandler.onerror(bS);if(this._mediaStatus===Re.State.Reconnecting){if(g){if(Date.now()-this._mediaReconnectStartTime>xS.max)return this._log.warn("Exceeded max ICE retries"),this._mediaHandler.onerror(bS);try{this._mediaReconnectBackoff.backoff()}catch(w){if(!(w.message&&w.message==="Backoff in progress."))throw w}}return}const x=this._mediaHandler.version.pc,b=x&&x.iceConnectionState==="disconnected",j=this._monitor.hasActiveWarning("bytesSent","min")||this._monitor.hasActiveWarning("bytesReceived","min");if(c===m&&b||c===d&&j||g){const w=new ya.ConnectionError("Media connection failed.");this._log.warn("ICE Connection disconnected."),this._publisher.warn("connection","error",w,this),this._publisher.info("connection","reconnecting",null,this),this._mediaReconnectStartTime=Date.now(),this._status=Re.State.Reconnecting,this._mediaStatus=Re.State.Reconnecting,this._mediaReconnectBackoff.reset(),this._mediaReconnectBackoff.backoff(),this._log.debug("#reconnecting"),this.emit("reconnecting",w)}},this._onMediaReconnected=()=>{this._mediaStatus===Re.State.Reconnecting&&(this._log.info("ICE Connection reestablished."),this._mediaStatus=Re.State.Open,this._signalingStatus===Re.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=Re.State.Open))},this._onMessageReceived=c=>{const{callsid:d,content:h,contenttype:f,messagetype:m,voiceeventsid:g}=c;if(this.parameters.CallSid!==d){this._log.warn(`Received a message from a different callsid: ${d}`);return}const x={content:h,contentType:f,messageType:m,voiceEventSid:g};this._publisher.info("call-message",m,{content_type:f,event_type:"received",voice_event_sid:g},this),this._log.debug("#messageReceived",JSON.stringify(x)),this.emit("messageReceived",x)},this._onMessageSent=c=>{if(!this._messages.has(c)){this._log.warn(`Received a messageSent with a voiceEventSid that doesn't exists: ${c}`);return}const d=this._messages.get(c);this._messages.delete(c),this._publisher.info("call-message",d==null?void 0:d.messageType,{content_type:d==null?void 0:d.contentType,event_type:"sent",voice_event_sid:c},this),this._log.debug("#messageSent",JSON.stringify(d)),this.emit("messageSent",d)},this._onRinging=c=>{if(this._setCallSid(c),this._status!==Re.State.Connecting&&this._status!==Re.State.Ringing)return;const d=!!c.sdp;this._status=Re.State.Ringing,this._publisher.info("connection","outgoing-ringing",{hasEarlyMedia:d},this),this._log.debug("#ringing"),this.emit("ringing",d)},this._onRTCSample=c=>{const d=Object.assign(Object.assign({},c),{inputVolume:this._latestInputVolume,outputVolume:this._latestOutputVolume});this._codec=d.codecName,this._metricsSamples.push(d),this._metricsSamples.length>=zq&&this._publishMetrics(),this.emit("sample",c)},this._onSignalingError=c=>{const{callsid:d,voiceeventsid:h,error:f}=c;if(this.parameters.CallSid!==d){this._log.warn(`Received an error from a different callsid: ${d}`);return}if(h&&this._messages.has(h)){this._messages.delete(h),this._log.warn("Received an error while sending a message.",c),this._publisher.error("call-message","error",{code:f.code,message:f.message,voice_event_sid:h},this);let m;const g=Yv(!!this._options.enableImprovedSignalingErrorPrecision,f.code);typeof g<"u"&&(m=new g(f)),m||(this._log.error("Unknown Call Message Error: ",f),m=new An.UnknownError(f.message,f)),this._log.debug("#error",f,m),this.emit("error",m)}},this._onSignalingReconnected=()=>{this._signalingStatus===Re.State.Reconnecting&&(this._log.info("Signaling Connection reestablished."),this._signalingStatus=Re.State.Open,this._mediaStatus===Re.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=Re.State.Open))},this._onTransportClose=()=>{this._log.error("Received transportClose from pstream"),this._log.debug("#transportClose"),this.emit("transportClose"),this._signalingReconnectToken?(this._status=Re.State.Reconnecting,this._signalingStatus=Re.State.Reconnecting,this._publisher.info("connection","reconnecting",null,this),this._log.debug("#reconnecting"),this.emit("reconnecting",new Ls.ConnectionDisconnected)):(this._status=Re.State.Closed,this._signalingStatus=Re.State.Closed)},this._reemitWarning=(c,d)=>{const h=/^audio/.test(c.name)?"audio-level-":"network-quality-",f=Uq[c.threshold.name];let m;c.name in vS?m=vS[c.name][c.threshold.name]:c.name in yS&&(m=yS[c.name]);const g=f+m;this._emitWarning(h,g,c.threshold.value,c.values||c.value,d,c)},this._reemitWarningCleared=c=>{this._reemitWarning(c,!0)},this._soundcache=t.soundcache,typeof t.onIgnore=="function"&&(this._onIgnore=t.onIgnore);const n=r&&r.twimlParams||{};this.customParameters=new Map(Object.entries(n).map(([c,d])=>[c,String(d)])),Object.assign(this._options,r),this._options.callParameters&&(this.parameters=this._options.callParameters),this._options.reconnectToken&&(this._signalingReconnectToken=this._options.reconnectToken),this._voiceEventSidGenerator=this._options.voiceEventSidGenerator||ty,this._direction=this.parameters.CallSid&&!this._options.reconnectCallSid?Re.CallDirection.Incoming:Re.CallDirection.Outgoing,this.parameters?this.callerInfo=this.parameters.StirStatus?{isVerified:this.parameters.StirStatus==="TN-Validation-Passed-A"}:null:this.callerInfo=null,this._mediaReconnectBackoff=new Wv(xS),this._mediaReconnectBackoff.on("ready",()=>this._mediaHandler.iceRestart()),this.outboundConnectionId=qq();const a=this._publisher=t.publisher;this._direction===Re.CallDirection.Incoming?a.info("connection","incoming",null,this):a.info("connection","outgoing",{preflight:this._options.preflight,reconnect:!!this._options.reconnectCallSid},this);const l=this._monitor=new(this._options.StatsMonitor||Rq);l.on("sample",this._onRTCSample),l.disableWarnings(),setTimeout(()=>l.enableWarnings(),Bq),l.on("warning",(c,d)=>{(c.name==="bytesSent"||c.name==="bytesReceived")&&this._onMediaFailure(Re.MediaFailure.LowBytes),this._reemitWarning(c,d)}),l.on("warning-cleared",c=>{this._reemitWarningCleared(c)}),this._mediaHandler=new this._options.MediaHandler(t.audioHelper,t.pstream,{MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,codecPreferences:this._options.codecPreferences,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,maxAverageBitrate:this._options.maxAverageBitrate}),this.on("volume",(c,d)=>{this._inputVolumeStreak=this._checkVolume(c,this._inputVolumeStreak,this._latestInputVolume,"input"),this._outputVolumeStreak=this._checkVolume(d,this._outputVolumeStreak,this._latestOutputVolume,"output"),this._latestInputVolume=c,this._latestOutputVolume=d}),this._mediaHandler.onaudio=c=>{this._log.debug("#audio"),this.emit("audio",c)},this._mediaHandler.onvolume=(c,d,h,f)=>{l.addVolumes(h/255*32767,f/255*32767),this.emit("volume",c,d)},this._mediaHandler.ondtlstransportstatechange=c=>{const d=c==="failed"?"error":"debug";this._publisher.post(d,"dtls-transport-state",c,null,this)},this._mediaHandler.onpcconnectionstatechange=c=>{let d="debug";const h=this._mediaHandler.getRTCDtlsTransport();c==="failed"&&(d=h&&h.state==="failed"?"error":"warning"),this._publisher.post(d,"pc-connection-state",c,null,this)},this._mediaHandler.onicecandidate=c=>{const d=new Hx(c).toPayload();this._publisher.debug("ice-candidate","ice-candidate",d,this)},this._mediaHandler.onselectedcandidatepairchange=c=>{const d=new Hx(c.local).toPayload(),h=new Hx(c.remote,!0).toPayload();this._publisher.debug("ice-candidate","selected-ice-candidate-pair",{local_candidate:d,remote_candidate:h},this)},this._mediaHandler.oniceconnectionstatechange=c=>{const d=c==="failed"?"error":"debug";this._publisher.post(d,"ice-connection-state",c,null,this)},this._mediaHandler.onicegatheringfailure=c=>{this._publisher.warn("ice-gathering-state",c,null,this),this._onMediaFailure(Re.MediaFailure.IceGatheringFailed)},this._mediaHandler.onicegatheringstatechange=c=>{this._publisher.debug("ice-gathering-state",c,null,this)},this._mediaHandler.onsignalingstatechange=c=>{this._publisher.debug("signaling-state",c,null,this)},this._mediaHandler.ondisconnected=c=>{this._log.warn(c),this._publisher.warn("network-quality-warning-raised","ice-connectivity-lost",{message:c},this),this._log.debug("#warning","ice-connectivity-lost"),this.emit("warning","ice-connectivity-lost"),this._onMediaFailure(Re.MediaFailure.ConnectionDisconnected)},this._mediaHandler.onfailed=c=>{this._onMediaFailure(Re.MediaFailure.ConnectionFailed)},this._mediaHandler.onconnected=()=>{this._status===Re.State.Reconnecting&&this._onMediaReconnected()},this._mediaHandler.onreconnected=c=>{this._log.info(c),this._publisher.info("network-quality-warning-cleared","ice-connectivity-lost",{message:c},this),this._log.debug("#warning-cleared","ice-connectivity-lost"),this.emit("warning-cleared","ice-connectivity-lost"),this._onMediaReconnected()},this._mediaHandler.onerror=c=>{c.disconnect===!0&&this._disconnect(c.info&&c.info.message);const d=c.info.twilioError||new An.UnknownError(c.info.message);this._log.error("Received an error from MediaStream:",c),this._log.debug("#error",d),this.emit("error",d)},this._mediaHandler.onopen=()=>{this._status===Re.State.Open||this._status===Re.State.Reconnecting||(this._status===Re.State.Ringing||this._status===Re.State.Connecting?(this.mute(this._mediaHandler.isMuted),this._mediaStatus=Re.State.Open,this._maybeTransitionToOpen()):this._mediaHandler.close())},this._mediaHandler.onclose=()=>{this._status=Re.State.Closed,this._options.shouldPlayDisconnect&&this._options.shouldPlayDisconnect()&&!this._isCancelled&&!this._isRejected&&this._soundcache.get(Ie.SoundName.Disconnect).play(),l.disable(),this._publishMetrics(),!this._isCancelled&&!this._isRejected&&(this._log.debug("#disconnect"),this.emit("disconnect",this))},this._pstream=t.pstream,this._pstream.on("ack",this._onAck),this._pstream.on("cancel",this._onCancel),this._pstream.on("error",this._onSignalingError),this._pstream.on("ringing",this._onRinging),this._pstream.on("transportClose",this._onTransportClose),this._pstream.on("connected",this._onConnected),this._pstream.on("message",this._onMessageReceived),this.on("error",c=>{this._publisher.error("connection","error",{code:c.code,message:c.message},this),this._pstream&&this._pstream.status==="disconnected"&&this._cleanupEventListeners()}),this.on("disconnect",()=>{this._cleanupEventListeners()})}_setInputTracksFromStream(t){return this._mediaHandler.setInputTracksFromStream(t)}_setSinkIds(t){return this._mediaHandler._setSinkIds(t)}accept(t){if(this._log.debug(".accept",t),this._status!==Re.State.Pending){this._log.debug(`.accept noop. status is '${this._status}'`);return}t=t||{};const r=t.rtcConfiguration||this._options.rtcConfiguration,n=t.rtcConstraints||this._options.rtcConstraints||{},a={audio:typeof n.audio<"u"?n.audio:!0};this._status=Re.State.Connecting;const l=()=>{if(this._status!==Re.State.Connecting){this._cleanupEventListeners(),this._mediaHandler.close();return}const h=m=>{const g=this._direction===Re.CallDirection.Incoming?"accepted-by-local":"accepted-by-remote";this._publisher.info("connection",g,null,this);const{codecName:x,codecParams:b}=JU(this._mediaHandler.version.getSDP());this._publisher.info("settings","codec",{codec_params:b,selected_codec:x},this),this._monitor.enable(m)},f=typeof this._options.getSinkIds=="function"&&this._options.getSinkIds();if(Array.isArray(f)&&this._mediaHandler._setSinkIds(f).catch(()=>{}),this._pstream.addListener("hangup",this._onHangup),this._direction===Re.CallDirection.Incoming)this._isAnswered=!0,this._pstream.on("answer",this._onAnswer),this._mediaHandler.answerIncomingCall(this.parameters.CallSid,this._options.offerSdp,r,h);else{const m=Array.from(this.customParameters.entries()).map(g=>`${encodeURIComponent(g[0])}=${encodeURIComponent(g[1])}`).join("&");this._pstream.on("answer",this._onAnswer),this._mediaHandler.makeOutgoingCall(m,this._signalingReconnectToken,this._options.reconnectCallSid||this.outboundConnectionId,r,h)}};this._options.beforeAccept&&this._options.beforeAccept(this);const c=typeof this._options.getInputStream=="function"&&this._options.getInputStream();(c?this._mediaHandler.setInputTracksFromStream(c):this._mediaHandler.openDefaultDeviceWithConstraints(a)).then(()=>{this._publisher.info("get-user-media","succeeded",{data:{audioConstraints:a}},this),l()},h=>{let f;h.code===31208||["PermissionDeniedError","NotAllowedError"].indexOf(h.name)!==-1?(f=new kc.PermissionDeniedError,this._publisher.error("get-user-media","denied",{data:{audioConstraints:a,error:h}},this)):(f=new kc.AcquisitionFailedError,this._publisher.error("get-user-media","failed",{data:{audioConstraints:a,error:h}},this)),this._disconnect(),this._log.debug("#error",h),this.emit("error",f)})}disconnect(){this._log.debug(".disconnect"),this._disconnect()}getLocalStream(){return this._mediaHandler&&this._mediaHandler.stream}getRemoteStream(){return this._mediaHandler&&this._mediaHandler._remoteStream}ignore(){if(this._log.debug(".ignore"),this._status!==Re.State.Pending){this._log.debug(`.ignore noop. status is '${this._status}'`);return}this._status=Re.State.Closed,this._mediaHandler.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local",null,this),this._onIgnore&&this._onIgnore()}isMuted(){return this._mediaHandler.isMuted}mute(t=!0){this._log.debug(".mute",t);const r=this._mediaHandler.isMuted;this._mediaHandler.mute(t);const n=this._mediaHandler.isMuted;r!==n&&(this._publisher.info("connection",n?"muted":"unmuted",null,this),this._log.debug("#mute",n),this.emit("mute",n,this))}postFeedback(t,r){if(typeof t>"u"||t===null)return this._postFeedbackDeclined();if(!Object.values(Re.FeedbackScore).includes(t))throw new Bt(`Feedback score must be one of: ${Object.values(Re.FeedbackScore)}`);if(typeof r<"u"&&r!==null&&!Object.values(Re.FeedbackIssue).includes(r))throw new Bt(`Feedback issue must be one of: ${Object.values(Re.FeedbackIssue)}`);return this._publisher.info("feedback","received",{issue_name:r,quality_score:t},this,!0)}reject(){if(this._log.debug(".reject"),this._status!==Re.State.Pending){this._log.debug(`.reject noop. status is '${this._status}'`);return}this._isRejected=!0,this._pstream.reject(this.parameters.CallSid),this._mediaHandler.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=Re.State.Closed,this._log.debug("#reject"),this.emit("reject")}sendDigits(t){if(this._log.debug(".sendDigits",t),t.match(/[^0-9*#w]/))throw new Bt("Illegal character passed into sendDigits");const r=this._options.customSounds||{},n=[];t.split("").forEach(d=>{let h=d!=="w"?`dtmf${d}`:"";h==="dtmf*"&&(h="dtmfs"),h==="dtmf#"&&(h="dtmfh"),n.push(h)});const a=()=>{const d=n.shift();d&&(this._options.dialtonePlayer&&!r[d]?this._options.dialtonePlayer.play(d):this._soundcache.get(d).play()),n.length&&setTimeout(()=>a(),200)};a();const l=this._mediaHandler.getOrCreateDTMFSender();function c(d){if(!d.length)return;const h=d.shift();h&&h.length&&l.insertDTMF(h,Lq,Iq),setTimeout(c.bind(null,d),$q)}if(l){if(!("canInsertDTMF"in l)||l.canInsertDTMF){this._log.info("Sending digits using RTCDTMFSender"),c(t.split("w"));return}this._log.info("RTCDTMFSender cannot insert DTMF")}if(this._log.info("Sending digits over PStream"),this._pstream!==null&&this._pstream.status!=="disconnected")this._pstream.dtmf(this.parameters.CallSid,t);else{const d=new An.ConnectionError("Could not send DTMF: Signaling channel is disconnected");this._log.debug("#error",d),this.emit("error",d)}}sendMessage(t){this._log.debug(".sendMessage",JSON.stringify(t));const{content:r,contentType:n,messageType:a}=t;if(typeof r>"u"||r===null)throw new Bt("`content` is empty");if(typeof a!="string")throw new Bt("`messageType` must be a string.");if(a.length===0)throw new Bt("`messageType` must be a non-empty string.");if(this._pstream===null)throw new Xs("Could not send CallMessage; Signaling channel is disconnected");const l=this.parameters.CallSid;if(typeof this.parameters.CallSid>"u")throw new Xs("Could not send CallMessage; Call has no CallSid");const c=this._voiceEventSidGenerator();return this._messages.set(c,{content:r,contentType:n,messageType:a,voiceEventSid:c}),this._pstream.sendMessage(l,r,n,a,c),c}status(){return this._status}_checkVolume(t,r,n,a){const l=r>=10;let c=0;return n===t&&(c=r),c>=10?this._emitWarning("audio-level-",`constant-audio-${a}-level`,10,c,!1):l&&this._emitWarning("audio-level-",`constant-audio-${a}-level`,10,c,!0),c}_cleanupEventListeners(){const t=()=>{this._pstream&&(this._pstream.removeListener("ack",this._onAck),this._pstream.removeListener("answer",this._onAnswer),this._pstream.removeListener("cancel",this._onCancel),this._pstream.removeListener("error",this._onSignalingError),this._pstream.removeListener("hangup",this._onHangup),this._pstream.removeListener("ringing",this._onRinging),this._pstream.removeListener("transportClose",this._onTransportClose),this._pstream.removeListener("connected",this._onConnected),this._pstream.removeListener("message",this._onMessageReceived))};t(),setTimeout(t,0)}_createMetricPayload(){const t={call_sid:this.parameters.CallSid,dscp:!!this._options.dscp,sdk_version:gc};return this._options.gateway&&(t.gateway=this._options.gateway),t.direction=this._direction,t}_disconnect(t,r){if(t=typeof t=="string"?t:null,!(this._status!==Re.State.Open&&this._status!==Re.State.Connecting&&this._status!==Re.State.Reconnecting&&this._status!==Re.State.Ringing)){if(this._log.info("Disconnecting..."),this._pstream!==null&&this._pstream.status!=="disconnected"&&this._shouldSendHangup){const n=this.parameters.CallSid||this.outboundConnectionId;n&&this._pstream.hangup(n,t)}this._cleanupEventListeners(),this._mediaHandler.close(),r||this._publisher.info("connection","disconnected-by-local",null,this)}}_maybeTransitionToOpen(){this._wasConnected,this._isAnswered&&(this._onSignalingReconnected(),this._signalingStatus=Re.State.Open,this._mediaHandler&&this._mediaHandler.status==="open"&&(this._status=Re.State.Open,this._wasConnected||(this._wasConnected=!0,this._log.debug("#accept"),this.emit("accept",this))))}_postFeedbackDeclined(){return this._publisher.info("feedback","received-none",null,this,!0)}_publishMetrics(){this._metricsSamples.length!==0&&this._publisher.postMetrics("quality-metrics-samples","metrics-sample",this._metricsSamples.splice(0),this._createMetricPayload(),this).catch(t=>{this._log.warn("Unable to post metrics to Insights. Received error:",t)})}_setCallSid(t){const r=t.callsid;r&&(this.parameters.CallSid=r,this._mediaHandler.callSid=r)}}Re.toString=()=>"[Twilio.Call class]";(function(e){(function(t){t.Closed="closed",t.Connecting="connecting",t.Open="open",t.Pending="pending",t.Reconnecting="reconnecting",t.Ringing="ringing"})(e.State||(e.State={})),(function(t){t.AudioLatency="audio-latency",t.ChoppyAudio="choppy-audio",t.DroppedCall="dropped-call",t.Echo="echo",t.NoisyCall="noisy-call",t.OneWayAudio="one-way-audio"})(e.FeedbackIssue||(e.FeedbackIssue={})),(function(t){t[t.One=1]="One",t[t.Two=2]="Two",t[t.Three=3]="Three",t[t.Four=4]="Four",t[t.Five=5]="Five"})(e.FeedbackScore||(e.FeedbackScore={})),(function(t){t.Incoming="INCOMING",t.Outgoing="OUTGOING"})(e.CallDirection||(e.CallDirection={})),(function(t){t.Opus="opus",t.PCMU="pcmu"})(e.Codec||(e.Codec={})),(function(t){t.None="none",t.Timeout="timeout"})(e.IceGatheringFailureReason||(e.IceGatheringFailureReason={})),(function(t){t.ConnectionDisconnected="ConnectionDisconnected",t.ConnectionFailed="ConnectionFailed",t.IceGatheringFailed="IceGatheringFailed",t.LowBytes="LowBytes"})(e.MediaFailure||(e.MediaFailure={}))})(Re||(Re={}));function qq(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const cT=v.createContext(null),Pm=()=>{const e=v.useContext(cT);if(!e)throw new Error("useCall must be used within a CallProvider");return e},Fq=({children:e})=>{const[t,r]=v.useState(null),[n,a]=v.useState(null),[l,c]=v.useState("disconnected"),[d,h]=v.useState(()=>typeof window<"u"?localStorage.getItem("activeLeadId"):null),f=Ae=>{console.log("[CallContext] setActiveLeadId:",Ae),h(Ae),Ae?localStorage.setItem("activeLeadId",Ae):localStorage.removeItem("activeLeadId")},[m,g]=v.useState("idle"),[x,b]=v.useState(!1),[j,w]=v.useState(!1),[_,N]=v.useState(!1),[C,A]=v.useState(0),[E,S]=v.useState(!1),[T,D]=v.useState("pending"),[P,I]=v.useState(null),[$,M]=v.useState(null),[R,F]=v.useState({isActive:!1,isPaused:!1,queue:[],currentIndex:0,previewCountdown:0,isInPreview:!1}),[V,H]=v.useState([]),L=v.useRef(R),U=v.useRef(null);v.useEffect(()=>{L.current=R},[R]);const[W,le]=v.useState([]),[ve,B]=v.useState({}),G=v.useRef({});v.useEffect(()=>{G.current=ve},[ve]);const ie=(Ae,tt)=>{let pt=Ae==="agent"?"agent":"customer";return typeof window<"u"&&localStorage.getItem("forceSwapRoles")==="1"&&(pt=pt==="agent"?"customer":"agent",console.log(`[UI-RoleNorm] FORCE_SWAP active: ${Ae} -> ${pt}`)),pt};v.useEffect(()=>{const Ae=tt=>{if(tt.ctrlKey&&tt.shiftKey&&tt.key==="R"){tt.preventDefault();const pt=localStorage.getItem("forceSwapRoles")||"0",te=pt==="1"?"0":"1";localStorage.setItem("forceSwapRoles",te),console.log(`[UI-RoleSwap] Toggled forceSwapRoles: ${pt} -> ${te}`),alert(`Role Swap: ${te==="1"?"ENABLED":"DISABLED"}

Refresh the page to see changes in new calls.`)}};return window.addEventListener("keydown",Ae),()=>window.removeEventListener("keydown",Ae)},[]);const[he,_e]=v.useState({score:50,stage:"",insight:"  ..."}),[Ee,we]=v.useState([]),[ye,ee]=v.useState(null),ke=v.useRef(null),Te=v.useRef(null),J=v.useRef(null),[Le,$e]=v.useState(0),[ut,yt]=v.useState(!1),Dt=v.useRef(Date.now()),Zt=async()=>{try{if(l==="ready")return;c("connecting"),console.log("[Twilio] Fetching token...");const Ae=await fetch("/api/token");if(!Ae.ok){const te=await Ae.text();throw console.error("[Twilio] Token fetch failed:",Ae.status,te),new Error(`Token fetch failed: ${Ae.status}`)}const tt=await Ae.json();console.log("[Twilio] Token received, initializing device...");const pt=new Ie(tt.token,{codecPreferences:["opus","pcmu"]});pt.on("registered",()=>{console.log("[Twilio] Device Registered successfully"),b(!0),c("ready")}),pt.on("error",te=>{var Pe;const ze=te.callSid||((Pe=n==null?void 0:n.parameters)==null?void 0:Pe.CallSid);console.error("[Twilio] Device Error:",{code:te.code,message:te.message,twilioError:te.twilioError,originalError:te.originalError,callSid:ze}),ze&&(console.info(` Twilio Debugger Link: https://console.twilio.com/us1/monitor/logs/call/${ze}`),console.info(" General Debugger: https://console.twilio.com/us1/monitor/logs/debugger")),te.code===31401?console.error("[Twilio] Permission Denied - Check microphone access"):te.code===31005||te.code===31009?console.error("[Twilio] WebSocket/Transport Error (31005/31009) - Check network / firewall / region"):te.code===31e3&&console.error("[Twilio] Unknown Error - See details above"),c("error"),b(!1)}),pt.on("unregistered",()=>{console.log("[Twilio] Device Unregistered"),c("disconnected"),b(!1)}),await pt.register(),r(pt),console.log("[Twilio] Device registered and ready")}catch(Ae){console.error("[Twilio] Device Init Error:",Ae),c("error"),b(!1)}};v.useEffect(()=>(m==="connected"?Te.current=setInterval(()=>{A(Ae=>Ae+1)},1e3):Te.current&&clearInterval(Te.current),()=>{Te.current&&clearInterval(Te.current)}),[m]);const[dr,Y]=v.useState([]),[Z,fe]=v.useState([]),Ve=v.useRef({});v.useEffect(()=>{(async()=>{var tt,pt;if(!d){Y([]);return}Ve.current[d]?(console.log("[CallContext] Cache hit for lead:",d),Y(Ve.current[d])):Y([]),console.log("[CallContext] Fetching history for lead:",d);try{const{data:{session:te}}=await ge.auth.getSession(),ze=te==null?void 0:te.access_token,Pe=await fetch(`/api/calls/lead/${d}`,{headers:{Authorization:`Bearer ${ze}`}}),gt=await Pe.json();if(!Pe.ok||!gt.success){console.error("[CallContext] History fetch error:",gt.error),Pe.status===403&&(console.warn("[CallContext] Access Forbidden. Clearing active lead."),f(null),localStorage.removeItem("activeLeadId"));return}const et=[];(tt=gt.calls)==null||tt.forEach(Et=>{Et.transcript&&Object.entries(Et.transcript).forEach(([Ot,er])=>{Array.isArray(er)&&er.forEach((un,ur)=>{et.push({id:`${Et.id}-${Ot}-${ur}`,speaker:Ot,text:un.text,timestamp:new Date(un.timestamp||Et.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isFinal:!0})})})}),et.sort((Et,Ot)=>Et.timestamp.localeCompare(Ot.timestamp)),console.log("[CallContext] Loaded history:",et.length,"messages from",(pt=gt.calls)==null?void 0:pt.length,"calls"),Ve.current[d]=et,Y(et),fe(gt.calls||[])}catch(te){console.error("[CallContext] History fetch error:",te)}})()},[d]);const rt=Ae=>{var ze;if(((ze=ke.current)==null?void 0:ze.readyState)===WebSocket.OPEN){console.log("[WS] Already connected");return}const pt=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/coach?callSid=${Ae}`;console.log(`[WS] Connecting to: ${pt} (attempt ${Le+1})`);const te=new WebSocket(pt);ke.current=te,te.onopen=()=>{console.log("[WS]  Connected successfully"),yt(!1),$e(0),Le>0&&te.send(JSON.stringify({type:"sync_request",since:Dt.current}))},te.onmessage=Pe=>{var gt;try{const et=JSON.parse(Pe.data);if(Dt.current=Date.now(),et.type==="transcript"){const Et=et.isFinal===!0,Ot=ie(et.role,et.track),er=et.segmentId||`${Ot}-${Math.floor(Date.now()/3e3)}`,ur=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(console.log(`[WS-msg] role=${et.role} normalized=${Ot} isFinal=${Et} text="${et.text.substring(0,20)}..." track=${et.track} segmentId=${er}`),!Et)B(Sr=>{const Ut=Sr[Ot];let Ye=et.text;if(Ut&&Ut.text){const Gt=Ut.text;Ye.startsWith(Gt)||(Gt.startsWith(Ye)&&Gt.length>Ye.length?Ye=Gt:Ye=Ye)}return{...Sr,[Ot]:{id:`draft-${Ot}`,speaker:Ot,text:Ye,timestamp:ur,isFinal:!1}}});else{const Sr=G.current[Ot];let Ut=et.text;Sr&&Sr.text&&Sr.text.length>Ut.length&&Sr.text.startsWith(Ut)&&(console.log(`[UI-Debug] Monotonic Rescue: Final "${Ut}" rejected. Kept "${Sr.text}"`),Ut=Sr.text),Ut=(Gt=>{const hr=Gt.split(/\s+/),X=[];let Se=0;for(;Se<hr.length;){let be=!1;for(let Oe=Math.min(10,Math.floor((hr.length-Se)/2));Oe>=3;Oe--){const lt=hr.slice(Se,Se+Oe).join(" "),Tt=hr.slice(Se+Oe,Se+Oe*2).join(" ");if(lt===Tt&&lt.length>=10){X.push(...hr.slice(Se,Se+Oe)),Se+=Oe*2,be=!0,console.log(`[UI-Dedup] Removed duplicate phrase: "${lt}"`);break}}be||(X.push(hr[Se]),Se++)}return X.join(" ")})(Ut),console.log(`[UI-Debug] role=${Ot} isFinal=true newLen=${et.text.length} draftLen=${(gt=Sr==null?void 0:Sr.text)==null?void 0:gt.length} commitLen=${Ut.length} text="${Ut.substring(0,10)}..."`),le(Gt=>{const hr=Gt[Gt.length-1],X=[...Gt],Se=(be,Oe)=>{const lt=Math.min(be.length,Oe.length,50);for(let Tt=lt;Tt>3;Tt--)if(be.endsWith(Oe.substring(0,Tt)))return Tt;return 0};if(hr&&hr.speaker===Ot){const be=hr.text||"";if(be.includes(Ut))return Gt;if(Ut.includes(be))return X[Gt.length-1]={...hr,text:Ut,timestamp:ur},X;const Oe=Se(be,Ut);if(Oe>0){const lt=be+Ut.substring(Oe);return console.log(`[UI-Overlap] Found ${Oe} char overlap, merging`),X[Gt.length-1]={...hr,text:lt,timestamp:ur},X}return X[Gt.length-1]={...hr,text:`${hr.text} ${Ut}`,timestamp:ur},X}else return[...Gt,{id:Date.now().toString(),speaker:Ot,text:Ut,timestamp:ur,isFinal:!0}]}),B(Gt=>({...Gt,[Ot]:null}))}}et.type==="coaching"&&(_e(Et=>({...Et,score:et.score??Et.score,stage:et.stage??Et.stage,insight:et.message??Et.insight,suggestion:et.suggested_reply,signals:et.signals||Et.signals||[]})),we(Et=>Et.some(er=>er.message===et.message&&Math.abs(er.timestamp-Date.now())<5e3)?Et:[...Et,{type:"coaching",message:et.message,severity:et.severity||"info",timestamp:Date.now()}])),et.type==="call_summary"&&(console.log("[Summary] Received via WS, summaryStatus=ready",et.data),ee(et.data),D("ready"))}catch(et){console.error("WS Parse Error",et)}},te.onerror=Pe=>{console.error("[WS]  Error:",Pe)},te.onclose=Pe=>{if(console.log(`[WS]  Closed (${Pe.code}: ${Pe.reason||"No reason"})`),!Pe.wasClean&&Le<10&&j){const gt=Math.min(1e3*Math.pow(2,Le),3e4);console.log(`[WS]  Reconnecting in ${gt}ms (attempt ${Le+1})`),yt(!0),J.current=setTimeout(()=>{$e(et=>et+1),rt(Ae)},gt)}else Le>=10&&(console.error("[WS]  Max reconnection attempts reached"),alert("  .    ."),yt(!1))}};v.useEffect(()=>()=>{J.current&&clearTimeout(J.current)},[]);const pe=async(Ae,tt,pt)=>{if(t)try{g("dialing"),w(!0),A(0),le([]),we([]),ee(null),_e({score:50,stage:"",insight:" ..."});let te=Ae.replace(/\D/g,"");if(te.startsWith("0")?te="+972"+te.substring(1):te.startsWith("+")||te.startsWith("972")&&(te="+"+te),Ae.startsWith("+")&&!te.startsWith("+")&&(te="+"+te),console.log("[CallContext] Starting call trigger:",{formattedPhone:te,deviceStatus:!!t,readyState:t==null?void 0:t.state}),!t){console.error("[CallContext] Start Call Failed: Device not initialized"),alert("   .    .");return}console.log("[CallContext] Starting call to:",te);try{await navigator.mediaDevices.getUserMedia({audio:!0})}catch(Pe){console.error("[CallContext] Mic Permission Denied",Pe),alert(" .     ."),g("idle"),w(!1);return}const ze=await t.connect({params:{target_number:te,agent_id:tt||"unknown",lead_id:pt||"unknown"}});ze.on("accept",()=>{console.log("Call Accepted"),g("connected"),a(ze);const Pe=ze.parameters.CallSid;I(Pe),console.log("[Summary] callSessionId stored:",Pe),rt(Pe)}),ze.on("disconnect",async()=>{var et,Et,Ot;console.log("Call Disconnected"),w(!1),g("idle"),a(null);const Pe=C,gt=d;if(gt&&Pe<15){console.log("[AutoRetry] Short call detected, scheduling retry:",{leadId:gt,duration:Pe});try{const{data:{session:er}}=await ge.auth.getSession();let un=(Et=(et=er==null?void 0:er.user)==null?void 0:et.user_metadata)==null?void 0:Et.organization_id;if(!un&&((Ot=er==null?void 0:er.user)!=null&&Ot.id)){const{data:ur}=await ge.from("profiles").select("organization_id").eq("id",er.user.id).single();un=ur==null?void 0:ur.organization_id}un&&(await fetch(`/api/leads/${gt}/record-attempt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({disposition:"no_answer",organizationId:un})}),console.log("[AutoRetry]  Retry scheduled for lead:",gt))}catch(er){console.warn("[AutoRetry] Failed to schedule retry:",er)}}console.log("[Summary] modalOpened, summaryStatus=generating"),D("generating"),S(!0),setTimeout(()=>{D(er=>er==="generating"?(console.log("[Summary] Timeout - marking as ready with available data"),"ready"):er)},15e3)}),ze.on("error",Pe=>{console.error("Call Error:",{name:Pe.name,message:Pe.message,code:Pe.code,originalError:Pe.originalError,info:Pe.toString()}),g("idle"),w(!1)})}catch(te){console.error("Start Call Error",te),g("idle"),w(!1)}},qe=()=>{n?n.disconnect():t&&t.disconnectAll(),g("idle")},nt=()=>ee(null),ae=()=>{if(n){const Ae=!_;n.mute(Ae),N(Ae),console.log(`[CallContext] Mute toggled: ${Ae?"MUTED":"UNMUTED"}`)}else console.warn("[CallContext] Cannot toggle mute - no active call")},Ne=()=>{(ye||W.length>0)&&M({leadId:d,summary:ye,transcripts:[...W],coachingTips:Ee,duration:C}),S(!1),D("pending"),I(null),console.log("[Summary] Modal dismissed, states reset")},Ge=async()=>{if(V.length===0){console.log("[CallContext] Queue empty, cannot dial next.");return}const Ae=V[0],tt=V.slice(1);console.log(" Dialing Next Lead:",Ae.name),H(tt),f(Ae.id),S(!1),Ae.phone?setTimeout(()=>{pe(Ae.phone,void 0,Ae.id)},500):(console.warn("Next lead has no phone:",Ae),alert("     "))},vt=()=>{$&&(ee($.summary),S(!0),D($.summary?"ready":"pending"),console.log("[Summary] Re-showing last call summary"))},st=$!==null,mt=Ae=>{if(console.log("[PowerDialer] Starting with",Ae.length,"leads"),Ae.length===0){console.warn("[PowerDialer] No leads provided");return}F({isActive:!0,isPaused:!1,queue:Ae,currentIndex:0,previewCountdown:0,isInPreview:!1})},wt=()=>{console.log("[PowerDialer] Stopped"),U.current&&(clearInterval(U.current),U.current=null),F({isActive:!1,isPaused:!1,queue:[],currentIndex:0,previewCountdown:0,isInPreview:!1})},ct=()=>{console.log("[PowerDialer] Paused"),U.current&&(clearInterval(U.current),U.current=null),F(Ae=>({...Ae,isPaused:!0,isInPreview:!1,previewCountdown:0}))},dt=()=>{console.log("[PowerDialer] Resumed"),F(Ae=>({...Ae,isPaused:!1})),ws()},Zr=()=>{console.log("[PowerDialer] Skipping to next lead"),U.current&&(clearInterval(U.current),U.current=null),F(Ae=>{const tt=Ae.currentIndex+1;return tt>=Ae.queue.length?(console.log("[PowerDialer] No more leads, stopping"),{...Ae,isActive:!1,isInPreview:!1}):{...Ae,currentIndex:tt,isInPreview:!1,previewCountdown:0}}),setTimeout(()=>ws(),100)},ws=()=>{const Ae=L.current;if(!(!Ae.isActive||Ae.isPaused)){if(Ae.currentIndex>=Ae.queue.length){console.log("[PowerDialer] Queue complete"),wt();return}console.log("[PowerDialer] Starting 5 second preview"),F(tt=>({...tt,isInPreview:!0,previewCountdown:5})),U.current=setInterval(()=>{F(tt=>{if(!tt.isActive||tt.isPaused)return U.current&&clearInterval(U.current),tt;if(tt.previewCountdown<=1){U.current&&clearInterval(U.current);const pt=tt.queue[tt.currentIndex];return pt&&(console.log("[PowerDialer] Auto-calling lead:",pt.name),pe(pt.phone,void 0,pt.id)),{...tt,isInPreview:!1,previewCountdown:0}}return{...tt,previewCountdown:tt.previewCountdown-1}})},1e3)}};v.useEffect(()=>{!E&&L.current.isActive&&!L.current.isPaused&&m==="idle"&&(F(Ae=>{const tt=Ae.currentIndex+1;return tt>=Ae.queue.length?(console.log("[PowerDialer] All leads called, stopping"),{...Ae,isActive:!1}):{...Ae,currentIndex:tt}}),setTimeout(()=>ws(),500))},[E,m]);const dn=[...W,...Object.values(ve).filter(Boolean)];return s.jsx(cT.Provider,{value:{device:t,activeCall:n,connectionStatus:l,callStatus:m,isReady:x,isOnCall:j,isMuted:_,callDuration:C,transcripts:dn,coachingData:he,activeLeadId:d,setActiveLeadId:f,callSummary:ye,historyCalls:Z||[],showSummaryModal:E,summaryStatus:T,callSessionId:P,dismissSummaryModal:Ne,hasLastCall:st,showLastSummary:vt,initDevice:Zt,startCall:pe,hangup:qe,clearSummary:nt,toggleMute:ae,powerDialer:R,startPowerDialer:mt,stopPowerDialer:wt,pausePowerDialer:ct,resumePowerDialer:dt,skipToNextLead:Zr,smartQueue:V,setSmartQueue:H,dialNextLead:Ge},children:e})},Hq=e=>{const t=e.toLowerCase();return t.includes("")||t.includes("intro")?["  ( + )",'  ("   ?")','  ("  ...")',"   (Hook)"]:t.includes("")||t.includes("discovery")||t.includes("")?["   ?","   ?","    ?","      ?","   ?"]:t.includes("")||t.includes("demo")||t.includes("")?["   "," ROI /  ","    (Social Proof)",'  ("     ?")']:t.includes("")||t.includes("objection")?["  ( )",' (" ...")','  (" ...")'," ",'  ("   ?")']:t.includes("")||t.includes("closing")?[" ","  ",'  (" ?")',"   (Next Steps)"]:[" ","  ","","  "]},Vq=({stages:e,currentStageIdx:t,setStageIdx:r,suggestions:n})=>{const[a,l]=v.useState(null),c=e.length>0?e:[" "," "," "," ",""],d=Math.min(t,c.length-1),h=Hq(c[d]),f=[{id:"price",label:" ",response:"  ,  .    -ROI      ."},{id:"send_info",label:" ",response:".      ,      ?"},{id:"competitor",label:"  ",response:"!      ?    ..."},{id:"busy",label:"  ",response:" .   30     ,    . ?"}];return s.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-900 overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-950/50",children:[s.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-3",children:" "}),s.jsxs("div",{className:"relative flex justify-between items-center z-0",children:[s.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-slate-200 dark:bg-slate-800 -z-10"}),c.map((m,g)=>{const x=g===d,b=g<d;return s.jsxs("button",{onClick:()=>r(g),className:`relative group flex flex-col items-center focus:outline-none transition-all duration-300 ${x?"scale-110":""}`,title:m,children:[s.jsx("div",{className:`
                  w-6 h-6 rounded-full flex items-center justify-center border-2 transition-colors duration-300 bg-white dark:bg-slate-900
                  ${x?"border-brand-500 text-brand-500 shadow-[0_0_10px_rgba(168,85,247,0.3)]":b?"border-emerald-500 text-emerald-500":"border-slate-300 dark:border-slate-600 text-slate-300"}
                `,children:b?s.jsx(Ct,{className:"w-3.5 h-3.5"}):s.jsx("div",{className:`w-2 h-2 rounded-full ${x?"bg-brand-500":"bg-transparent"}`})}),x&&s.jsx("span",{className:"absolute top-8 text-[10px] font-bold text-brand-600 dark:text-brand-400 whitespace-nowrap bg-brand-50 dark:bg-brand-900/30 px-2 py-0.5 rounded-full animate-in fade-in slide-in-from-top-1",children:m})]},g)})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-white transition-all duration-300",children:c[d]})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[s.jsx("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-4 duration-500",children:s.jsx("div",{className:"space-y-3",children:h.map((m,g)=>s.jsxs("div",{className:"flex items-start gap-3 group cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 p-2 rounded-lg transition-colors",children:[s.jsx("div",{className:"mt-0.5 w-5 h-5 rounded border border-slate-300 dark:border-slate-600 flex items-center justify-center group-hover:border-brand-400 transition-colors",children:s.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-transparent group-hover:bg-brand-100 dark:group-hover:bg-brand-900/50"})}),s.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white transition-colors",children:m})]},g))})}),s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Nr,{className:"w-4 h-4 text-purple-500"}),s.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"  "})]}),s.jsx("div",{className:"space-y-3",children:n.length===0?s.jsx("div",{className:"text-center py-6 text-slate-400 text-xs italic bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-dashed border-slate-200 dark:border-slate-800",children:"  ..."}):n.map(m=>s.jsxs("div",{className:"flex gap-3 items-start animate-in slide-in-from-bottom-2 duration-300 bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/30 p-3 rounded-xl shadow-sm",children:[s.jsx("div",{className:`
                                w-5 h-5 rounded-md flex items-center justify-center flex-shrink-0 mt-0.5
                                ${m.type==="warning"?"text-amber-600 dark:text-amber-400":m.type==="tip"?"text-brand-600 dark:text-brand-400":"text-slate-500 dark:text-slate-400"}
                            `,children:s.jsx(Nr,{className:"w-3.5 h-3.5"})}),s.jsx("div",{className:"flex flex-col gap-1",children:s.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 leading-snug",children:m.text})})]},m.id))})]})]}),s.jsxs("div",{className:"mt-auto bg-slate-50 dark:bg-slate-950 border-t border-slate-200 dark:border-slate-800",children:[s.jsx("div",{className:"p-2 border-b border-slate-200 dark:border-slate-800 px-4 py-2",children:s.jsxs("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1",children:[s.jsx(jm,{className:"w-3 h-3"}),"  "]})}),s.jsx("div",{className:"max-h-48 overflow-y-auto",children:f.map(m=>{const g=a===m.id;return s.jsxs("div",{className:"border-b border-slate-100 dark:border-slate-800 last:border-0",children:[s.jsxs("button",{onClick:()=>l(g?null:m.id),className:`w-full text-right px-4 py-3 flex items-center justify-between text-sm transition-colors
                                ${g?"bg-amber-50 dark:bg-amber-900/10 text-amber-900 dark:text-amber-100 font-medium":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-900"}
                            `,children:[s.jsx("span",{children:m.label}),g?s.jsx(eo,{className:"w-3.5 h-3.5 opacity-50"}):s.jsx(Pt,{className:"w-3.5 h-3.5 opacity-50"})]}),g&&s.jsx("div",{className:"px-4 py-3 bg-amber-50/50 dark:bg-amber-900/5 text-sm text-slate-700 dark:text-slate-200 leading-relaxed animate-in slide-in-from-top-1",children:m.response})]},m.id)})})]})]})},Iw=e=>{const[t,r]=v.useState(null),[n,a]=v.useState(!0),[l,c]=v.useState(null),d=[{id:"New",label:" ",color:"#3B82F6"},{id:"Discovery",label:" ",color:"#8B5CF6"},{id:"Proposal",label:" ",color:"#10B981"},{id:"Negotiation",label:" ",color:"#EC4899"},{id:"Follow Up",label:"",color:"#F59E0B"},{id:"Closed",label:" - ",color:"#059669"},{id:"Lost",label:" - ",color:"#EF4444"}];return v.useEffect(()=>{if(!e){a(!1);return}(async()=>{try{a(!0);const{data:m,error:g}=await ge.from("organization_settings").select("*").eq("organization_id",e).single();if(g)console.warn("Fetching org settings info (using defaults):",g.message),r({id:"default_fallback",organization_id:e,pipeline_statuses:d});else{const x=m.pipeline_statuses||d;r({...m,pipeline_statuses:x})}}catch(m){console.error("Unexpected error in useOrganizationSettings:",m),c("Failed to load settings"),r({id:"error_fallback",organization_id:e,pipeline_statuses:d})}finally{a(!1)}})()},[e]),{settings:t,loading:n,error:l,updateSettings:async f=>{if(!e)return{success:!1,error:"Missing Organization ID"};try{const{count:m}=await ge.from("organization_settings").select("id",{count:"exact",head:!0}).eq("organization_id",e);let g;if(m===0?g=await ge.from("organization_settings").insert({organization_id:e,...f,calls_config:{},stages_config:[]}):g=await ge.from("organization_settings").update(f).eq("organization_id",e),g.error)throw g.error;return r(x=>x?{...x,...f}:null),{success:!0}}catch(m){return console.error("Error updating settings details:",m),{success:!1,error:m.message||"Update failed"}}}}},Wq=({transcript:e,coachSuggestions:t,onEndCall:r,orgId:n})=>{const{isMuted:a,toggleMute:l,callDuration:c,activeCall:d}=Pm(),{settings:h}=Iw(n),f=v.useRef(null),[m,g]=v.useState(!0),[x,b]=v.useState(!1),[j,w]=v.useState(0),_=$=>{const M=Math.floor($/60),R=$%60;return`${M.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`},N=()=>{b(!x),d&&d.mute(!x),console.log(`[ActiveCallPanel] Hold toggled: ${x?"RESUMED":"ON HOLD"}`)},[C,A]=v.useState(!1),[E,S]=v.useState(""),[T,D]=v.useState([{id:"welcome",sender:"ai",text:"     ."}]),P=v.useRef(null);v.useEffect(()=>{m&&f.current&&(f.current.scrollTop=f.current.scrollHeight)},[e,m]),v.useEffect(()=>{C&&P.current&&(P.current.scrollTop=P.current.scrollHeight)},[T,C]);const I=()=>{if(!E.trim())return;const $={id:Date.now().toString(),sender:"user",text:E};D(M=>[...M,$]),S(""),C||A(!0),setTimeout(()=>{D(M=>[...M,{id:(Date.now()+1).toString(),sender:"ai",text:".     ..."}])},1e3)};return s.jsxs("div",{className:"flex flex-col flex-1 bg-white dark:bg-slate-950 min-w-0 relative overflow-hidden h-full",children:[s.jsxs("div",{className:"h-16 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between px-6 bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm z-20 flex-shrink-0 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:`flex items-center justify-center gap-2 px-3 py-1 rounded-full ${x?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700"} transition-colors`,children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${x?"bg-amber-500":"bg-rose-500"} animate-pulse`}),s.jsx("span",{className:"font-mono font-medium text-sm",children:_(c)})]}),s.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:x?" ":" "})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(je,{onClick:N,variant:"ghost",size:"icon",className:`${x?"text-amber-500 bg-amber-50 dark:bg-amber-900/20":"text-slate-400 hover:text-slate-600"}`,title:x?" ":" ",children:x?s.jsx(EE,{className:"w-5 h-5"}):s.jsx(hw,{className:"w-5 h-5"})}),s.jsx(je,{onClick:l,variant:"ghost",size:"icon",className:`${a?"text-rose-500 bg-rose-50 dark:bg-rose-900/20":"text-slate-400 hover:text-slate-600"}`,title:a?" ":" ",children:a?s.jsx(R$,{className:"w-5 h-5"}):s.jsx($$,{className:"w-5 h-5"})}),s.jsxs(je,{onClick:()=>r&&r(),variant:"danger",size:"sm",className:"bg-rose-600 hover:bg-rose-700 text-white border-0 shadow-md hover:shadow-lg transition-all",children:[s.jsx(BE,{className:"w-4 h-4 ml-2"})," "]})]})]}),s.jsxs("div",{className:"flex-1 flex min-h-0 relative",children:[s.jsx("div",{className:"w-96 border-e border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex flex-col z-10 shadow-lg",children:s.jsx(Vq,{stages:(h==null?void 0:h.stages_config)||[],currentStageIdx:j,setStageIdx:w,suggestions:t})}),s.jsxs("div",{className:"flex-1 bg-slate-50/50 dark:bg-slate-950/50 relative flex flex-col min-w-0",children:[s.jsxs("div",{ref:f,onScroll:$=>{const M=$.target,R=Math.abs(M.scrollHeight-M.scrollTop-M.clientHeight)<50;g(!!R)},className:"flex-1 overflow-y-auto p-8 space-y-6 scroll-smooth",children:[e.map($=>s.jsxs("div",{className:`flex flex-col ${$.speaker==="agent"?"items-end":"items-start"} max-w-3xl mx-auto w-full group`,children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1.5 px-1 opacity-70 group-hover:opacity-100 transition-opacity",children:[s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${$.speaker==="agent"?"text-brand-600 dark:text-brand-400":"text-slate-500"}`,children:$.speaker==="agent"?" ()":""}),s.jsx("span",{className:"text-[10px] text-slate-300 dark:text-slate-600 font-mono",children:$.timestamp})]}),s.jsx("div",{className:`
                  relative max-w-[90%] md:max-w-[85%] px-6 py-4 rounded-2xl text-base leading-relaxed shadow-sm transition-all duration-200
                  ${$.speaker==="agent"?"bg-white border border-brand-100 dark:bg-slate-900 dark:border-brand-900/30 text-slate-800 dark:text-slate-200 rounded-tl-none hover:border-brand-300":"bg-white border border-slate-200 dark:bg-slate-800 dark:border-slate-700 text-slate-700 dark:text-slate-300 rounded-tr-none hover:border-slate-300"}
                  ${$.highlight?"ring-2 ring-amber-100 dark:ring-amber-900/30 bg-amber-50/50 dark:bg-amber-900/10":""}
                  ${$.isFinal===!1?"opacity-70 animate-pulse":""}
                `,children:$.text})]},$.id)),s.jsx("div",{className:"h-12"})]}),!m&&s.jsx("button",{onClick:()=>g(!0),className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs px-4 py-2 rounded-full shadow-lg hover:bg-slate-700 transition-all z-20 animate-in fade-in slide-in-from-bottom-2",children:"  "})]})]}),!C&&s.jsxs("button",{onClick:()=>A(!0),className:"absolute bottom-4 left-6 z-30 p-3 bg-purple-600 text-white rounded-full shadow-lg hover:bg-purple-700 hover:scale-105 transition-all flex items-center gap-2",title:" ",children:[s.jsx(N2,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-bold pr-1",children:"' "})]}),s.jsxs("div",{className:`absolute bottom-0 left-6 w-80 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-2xl rounded-t-xl transition-all duration-300 ease-in-out z-40 flex flex-col
        ${C?"h-[400px] opacity-100 translate-y-0":"h-0 opacity-0 translate-y-10 pointer-events-none"}
        `,children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-100 dark:border-slate-800 bg-purple-50/50 dark:bg-purple-900/10 rounded-t-xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(N2,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-bold text-purple-900 dark:text-purple-100",children:"' "})]}),s.jsx("button",{onClick:()=>A(!1),className:"text-slate-400 hover:text-slate-600",children:s.jsx(Pt,{className:"w-4 h-4"})})]}),s.jsx("div",{ref:P,className:"flex-1 overflow-y-auto p-4 space-y-3 bg-white dark:bg-slate-900",children:T.map($=>s.jsx("div",{className:`flex ${$.sender==="user"?"justify-start":"justify-end"}`,children:s.jsx("div",{className:`max-w-[85%] p-2.5 rounded-xl text-xs leading-relaxed ${$.sender==="user"?"bg-purple-100 text-purple-900 rounded-br-none":"bg-slate-100 text-slate-700 rounded-bl-none"}`,children:$.text})},$.id))}),s.jsx("div",{className:"p-3 border-t border-slate-100 dark:border-slate-800",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border-none rounded-lg text-sm focus:ring-2 focus:ring-purple-500 outline-none",placeholder:" ...",value:E,onChange:$=>S($.target.value),onKeyDown:$=>$.key==="Enter"&&I()}),s.jsx("button",{onClick:I,className:"absolute left-1 top-1/2 -translate-y-1/2 p-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:s.jsx(yc,{className:"w-3 h-3"})})]})})]})]})},Gq=({transcripts:e,coachingData:t,callDuration:r,currentLead:n,onEndCall:a,formatTime:l})=>{var f,m,g,x;const[c,d]=v.useState(!1),h=v.useRef(null);return v.useEffect(()=>{e.length&&h.current&&(h.current.scrollTop=h.current.scrollHeight)},[e]),s.jsxs("div",{className:"flex flex-col h-full p-3 md:p-4 lg:p-6 gap-4 overflow-y-auto lg:overflow-hidden bg-[#F7F8FC]",children:[s.jsxs("div",{className:"w-full bg-white rounded-2xl border border-[#E7EAF2] shadow-sm p-4 flex flex-col md:flex-row justify-between items-center gap-3 shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-rose-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-xs font-bold text-rose-600",children:""})]}),s.jsx("span",{className:"font-mono text-xl font-bold text-[#0B1220]",children:l(r)}),n&&s.jsxs("span",{className:"text-sm text-slate-500",children:[" ",n.name]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>d(!c),className:`p-2 rounded-lg border transition-colors ${c?"bg-brand-50 border-brand-200 text-brand-600":"bg-slate-50 border-slate-200 text-slate-600 hover:bg-slate-100"}`,title:" ",children:s.jsx(ps,{className:"w-5 h-5"})}),s.jsx("button",{className:"p-2 rounded-lg bg-slate-50 border border-slate-200 text-slate-600 hover:bg-slate-100 transition-colors",children:s.jsx(hw,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:a,className:"px-4 py-2 rounded-lg bg-[#FFF1F2] border border-[#FECDD3] text-[#E11D48] font-bold hover:bg-[#FFE4E6] transition-colors text-sm flex items-center justify-center gap-2",children:[s.jsx(BE,{className:"w-4 h-4"}),s.jsx("span",{children:" "})]})]})]}),s.jsx(YA,{leadPhone:n==null?void 0:n.phone,leadName:n==null?void 0:n.name,leadEmail:n==null?void 0:n.email,className:"bg-white rounded-xl border border-slate-200 p-3",callTranscript:e.map(b=>`${b.speaker}: ${b.text}`).join(`
`),callSummary:t}),s.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0",children:[s.jsxs("div",{className:"flex-1 bg-white rounded-2xl border border-[#E7EAF2] shadow-sm flex flex-col overflow-hidden min-h-[400px]",children:[s.jsx("div",{className:"p-4 border-b border-[#E7EAF2]",children:s.jsx("h3",{className:"font-bold text-slate-800",children:"Transcript"})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-white space-y-4",ref:h,children:[e.length===0&&s.jsx("div",{className:"text-center text-slate-400 mt-10",children:"Waiting for call to start..."}),e.map((b,j)=>s.jsxs("div",{className:`flex flex-col ${b.speaker==="agent"?"items-end":"items-start"} max-w-[85%] w-full ${b.speaker==="agent"?"mr-auto":"ml-auto"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1.5 px-1",children:[s.jsx("span",{className:"text-[10px] text-[#98A2B3] font-medium font-mono",children:"Now"}),s.jsx("span",{className:"text-xs font-bold text-[#667085]",children:b.speaker==="agent"?"":""})]}),s.jsx("div",{className:`
                        relative px-4 py-3 text-sm leading-relaxed shadow-sm
                        ${b.speaker==="agent"?"bg-[#EFF4FF] text-[#1E3A8A] rounded-2xl rounded-tl-none border border-blue-100/50":"bg-white text-[#344054] rounded-2xl rounded-tr-none border border-[#E7EAF2]"}
                        ${b.isFinal===!1?"opacity-70 animate-pulse":""}
                     `,children:b.text})]},j))]})]}),s.jsxs("div",{className:"w-full lg:w-96 bg-white rounded-2xl border border-[#E7EAF2] shadow-sm flex flex-col overflow-hidden shrink-0 max-h-[calc(100vh-200px)]",children:[s.jsxs("div",{className:"p-4 border-b border-[#E7EAF2] bg-gradient-to-r from-[#6366f1]/5 to-white flex items-center justify-between",children:[s.jsxs("h3",{className:"text-sm font-bold text-[#0B1220] flex items-center gap-2",children:[s.jsx(Nr,{className:"w-4 h-4 text-purple-600 fill-purple-600"})," AI  Sales Coach"]}),s.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-emerald-50 rounded-full",children:[s.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-[10px] font-bold text-emerald-700",children:"Live"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#6366f1] to-[#4f46e5] rounded-xl p-4 text-white relative overflow-hidden shadow-lg",children:[s.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl -mr-8 -mt-8"}),s.jsxs("h4",{className:"text-xs font-bold uppercase tracking-wider mb-2 flex items-center gap-1.5 opacity-90",children:[s.jsx(al,{className:"w-3.5 h-3.5"})," "]}),s.jsx("p",{className:"text-sm leading-relaxed font-medium",children:(t==null?void 0:t.insight)||" ..."}),(t==null?void 0:t.suggestion)&&s.jsxs("div",{className:"mt-3 p-3 bg-white/15 backdrop-blur rounded-lg border border-white/20",children:[s.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide opacity-80",children:" :"}),s.jsxs("p",{className:"text-sm mt-1 leading-relaxed",children:['"',t.suggestion,'"']})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-rose-50 border border-rose-100 rounded-xl p-3",children:[s.jsxs("h5",{className:"text-[10px] font-bold text-rose-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:[s.jsx(_n,{className:"w-3 h-3"}),""]}),(f=t==null?void 0:t.signals)!=null&&f.pains&&t.signals.pains.length>0?s.jsx("ul",{className:"space-y-1.5",children:t.signals.pains.slice(0,3).map((b,j)=>s.jsxs("li",{className:"text-xs text-rose-800 flex items-start gap-1.5",children:[s.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${b.severity==="high"?"bg-rose-600":b.severity==="medium"?"bg-rose-400":"bg-rose-300"}`}),b.text]},j))}):s.jsx("p",{className:"text-[10px] text-rose-400 italic",children:"  "})]}),s.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-3",children:[s.jsxs("h5",{className:"text-[10px] font-bold text-amber-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:[s.jsx(jm,{className:"w-3 h-3"}),""]}),(m=t==null?void 0:t.signals)!=null&&m.objections&&t.signals.objections.length>0?s.jsx("ul",{className:"space-y-1.5",children:t.signals.objections.slice(0,3).map((b,j)=>s.jsxs("li",{className:`text-xs flex items-start gap-1.5 ${b.status==="handled"?"text-emerald-700 line-through opacity-60":"text-amber-800"}`,children:[s.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${b.status==="handled"?"bg-emerald-500":"bg-amber-500"}`}),b.text]},j))}):s.jsx("p",{className:"text-[10px] text-amber-400 italic",children:"  "})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-3",children:[s.jsxs("h5",{className:"text-[10px] font-bold text-blue-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:[s.jsx(n$,{className:"w-3 h-3"}),""]}),(g=t==null?void 0:t.signals)!=null&&g.gaps&&t.signals.gaps.length>0?s.jsx("ul",{className:"space-y-1.5",children:t.signals.gaps.slice(0,3).map((b,j)=>s.jsxs("li",{className:"text-xs text-blue-800 flex items-start gap-1.5",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 bg-blue-500"}),b.text]},j))}):s.jsx("p",{className:"text-[10px] text-blue-400 italic",children:"  "})]}),s.jsxs("div",{className:"bg-purple-50 border border-purple-100 rounded-xl p-3",children:[s.jsxs("h5",{className:"text-[10px] font-bold text-purple-700 uppercase tracking-wide mb-2 flex items-center gap-1",children:[s.jsx(vr,{className:"w-3 h-3"})," "]}),(x=t==null?void 0:t.signals)!=null&&x.vision&&t.signals.vision.length>0?s.jsx("ul",{className:"space-y-1.5",children:t.signals.vision.slice(0,3).map((b,j)=>s.jsxs("li",{className:"text-xs text-purple-800 flex items-start gap-1.5",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 bg-purple-500"}),b.text]},j))}):s.jsx("p",{className:"text-[10px] text-purple-400 italic",children:"  "})]})]}),(t==null?void 0:t.stage)&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[s.jsx("span",{className:"text-xs text-slate-500",children:" :"}),s.jsx("span",{className:"text-xs font-bold text-slate-800 px-2 py-1 bg-white rounded-lg border border-slate-200",children:t.stage})]})]})]})]})]})},Kq=({onStartCall:e,onEndCall:t,currentUserId:r,orgId:n})=>{var hr;const[a,l]=v.useState("leads"),[c,d]=v.useState("followup"),[h,f]=v.useState(""),m=v.useRef(null),[g,x]=v.useState(!1),[b,j]=v.useState(!1),[w,_]=v.useState(!1),[N,C]=v.useState([]),[A,E]=v.useState([]),[S,T]=v.useState(!0),[D,P]=v.useState(!0),[I,$]=v.useState(""),[M,R]=v.useState([]),[F,V]=v.useState(null),[H,L]=v.useState(null),[U,W]=v.useState(!0),[le,ve]=v.useState([]),[B,G]=v.useState(!0),[ie,he]=v.useState(null),[_e,Ee]=v.useState(null),[we,ye]=v.useState(null),[ee,ke]=v.useState(""),[Te,J]=v.useState("10:00"),[Le,$e]=v.useState(""),[ut,yt]=v.useState(!1),[Dt,Zt]=v.useState(()=>{try{return localStorage.getItem("sales_coach_view_mode")||"copilot"}catch{return"copilot"}});v.useEffect(()=>{try{localStorage.setItem("sales_coach_view_mode",Dt)}catch{console.warn("Failed to save view mode preference")}},[Dt]);const{callStatus:dr,callDuration:Y,transcripts:Z,coachingData:fe,startCall:Ve,connectionStatus:rt,isReady:pe,initDevice:qe,activeLeadId:nt,setActiveLeadId:ae,runDiagnostics:Ne,hasLastCall:Ge,showLastSummary:vt,historyCalls:st,powerDialer:mt,startPowerDialer:wt,stopPowerDialer:ct,pausePowerDialer:dt,resumePowerDialer:Zr,skipToNextLead:ws,smartQueue:dn,setSmartQueue:Ae,dialNextLead:tt}=Pm(),[pt,te]=v.useState(!1),ze=async()=>{if(n){te(!0);try{const{data:{session:X}}=await ge.auth.getSession(),be=await(await fetch("/api/leads/smart-queue",{headers:{Authorization:`Bearer ${X==null?void 0:X.access_token}`}})).json();be.success&&Ae(be.queue)}catch(X){console.error("Failed to fetch smart queue",X)}finally{te(!1)}}},Pe=async()=>{dn.length>0?(x(!0),console.log("[PowerSession] Starting with queue size:",dn.length),await tt(),e(),x(!1)):(console.warn("[PowerSession] Cannot start: Queue is empty"),V("    "))},gt=dr==="connected"||dr==="dialing",et=X=>{if(!X)return null;switch(X){case"Website":return"";case"LinkedIn":return"";case"Facebook Ads":return"";case"Instagram":return"";case"Referral":return"";case"Webinar":return"";case"Social Media":return"";case"Manual":return"";default:return X}},Et=X=>{if(!X)return null;switch(X){case"New":return" ";case"Discovery":return" ";case"Negotiation":return" ";case"Proposal":return" ";case"Contacted":return" ";case"In Progress":return"";case"Qualified":return" ";case"Lost":return"";case"Deal":return"";case"Closed":return"";default:return X}},Ot=X=>{switch(X){case"completed":return"";case"missed":return" ";case"rejected":return"";case"busy":return"";case"no-answer":return" ";case"failed":return"";default:return X}},er=X=>{const Se=Math.floor(X/60),be=X%60;return`${Se.toString().padStart(2,"0")}:${be.toString().padStart(2,"0")}`};v.useEffect(()=>{const X=async()=>{if(n){T(!0);try{const{data:be,error:Oe}=await ge.from("leads").select("id, name, phone, company, status, priority, source, created_at").eq("organization_id",n).order("created_at",{ascending:!1}).limit(100);if(Oe)throw Oe;C(be||[])}catch(be){console.error("[Leads] Fetch error:",be),V("  : "+be.message)}finally{T(!1)}}};X();const Se=ge.channel("leads-changes").on("postgres_changes",{event:"*",schema:"public",table:"leads",filter:`organization_id=eq.${n}`},()=>{console.log("[Leads] Realtime update detected, refreshing..."),X()}).subscribe();return()=>{ge.removeChannel(Se)}},[n]),v.useEffect(()=>{ze()},[n]),v.useEffect(()=>{(async()=>{if(n)try{const Se=new Date;Se.setHours(23,59,59,999);const{data:be,error:Oe}=await ge.from("leads").select("id, name, phone, follow_up_at, follow_up_notes").eq("organization_id",n).not("follow_up_at","is",null).lte("follow_up_at",Se.toISOString()).order("follow_up_at",{ascending:!0}).limit(20);if(Oe)throw Oe;R((be||[]).map(lt=>({id:lt.id,lead_id:lt.id,lead_name:lt.name,lead_phone:lt.phone,follow_up_at:lt.follow_up_at,notes:lt.follow_up_notes})))}catch(Se){console.error("[FollowUp] Fetch error:",Se)}})()},[n]),v.useEffect(()=>{(async()=>{if(n){P(!0);try{const{data:Se,error:be}=await ge.from("calls").select("id, agent_id, lead_id, status, duration, created_at, recording_url, transcript, leads(name, phone, company)").eq("organization_id",n).order("created_at",{ascending:!1}).limit(20);if(be)throw be;E(Se||[])}catch(Se){console.error("[Calls] Fetch error:",Se)}finally{P(!1)}}})()},[n]),v.useEffect(()=>{(async()=>{W(!0);try{const be=await(await fetch("/api/stats/daily")).json();be.success&&L(be.stats)}catch(Se){console.error("[Stats] Fetch error:",Se)}finally{W(!1)}})()},[]),v.useEffect(()=>{(async()=>{var Se;G(!0);try{const{data:{session:be}}=await ge.auth.getSession();if(!((Se=be==null?void 0:be.user)!=null&&Se.id))return;const{data:Oe}=await ge.from("profiles").select("organization_id").eq("id",be.user.id).single();if(!(Oe!=null&&Oe.organization_id))return;const Tt=await(await fetch(`/api/campaigns?organizationId=${Oe.organization_id}`,{headers:{Authorization:`Bearer ${be.access_token}`}})).json();Tt.success&&ve(Tt.campaigns||[])}catch(be){console.error("[Campaigns] Fetch error:",be)}finally{G(!1)}})()},[]),v.useEffect(()=>{Z.length&&m.current&&(gt?m.current.scrollTop=m.current.scrollHeight:m.current.scrollTop=0)},[Z,gt]),v.useEffect(()=>{!pe&&rt==="disconnected"&&(console.log("[Dialer] Initializing Twilio Device..."),qe())},[pe,rt]),v.useEffect(()=>{if(F){const X=setTimeout(()=>V(null),5e3);return()=>clearTimeout(X)}},[F]);const un=async X=>{console.log("[Dialer] Lead clicked:",{id:X.id,name:X.name,phone:X.phone}),ae(X.id)},ur=async X=>{var Se;if(console.log("[Dialer] Starting call to lead:",{id:X.id,phone:X.phone}),!X.phone){V("    ");return}if(!pe){console.warn("[Dialer] Device not ready, attempting init..."),V(" ...    "),await qe();return}if(rt==="error"){V("   .   .");return}try{const{data:{session:be}}=await ge.auth.getSession(),Oe=((Se=be==null?void 0:be.user)==null?void 0:Se.id)||r||"unknown";console.log("[Dialer] Calling via Twilio:",{phone:X.phone,agentId:Oe,leadId:X.id}),await Ve(X.phone,Oe,X.id)}catch(be){console.error("[Dialer] Call error:",be),be.code===31401?V(" :   "):be.code===31005||be.code===31009?V(" :   "):V("  : "+(be.message||"Unknown error"))}},Sr=async()=>{var Si,Aa,Cr;if(console.log("[SmartDialer] Starting smart campaign dialer:",{campaign:h,campaignsCount:le.length}),!h){V("    ");return}const X=le.find(at=>at.id===h);if(!X){V("   ");return}const{data:{session:Se}}=await ge.auth.getSession();let Oe=(Aa=(Si=Se==null?void 0:Se.user)==null?void 0:Si.user_metadata)==null?void 0:Aa.organization_id;if(!Oe&&((Cr=Se==null?void 0:Se.user)!=null&&Cr.id)){const{data:at}=await ge.from("profiles").select("organization_id").eq("id",Se.user.id).single();Oe=at==null?void 0:at.organization_id}console.log("[SmartDialer] Organization ID:",Oe),console.log("[SmartDialer] Selected campaign:",{name:X.name,source:X.source_filter});let lt=[],Tt=[];if(Oe)try{const[at,mo]=await Promise.all([fetch(`/api/follow-ups/due?organizationId=${Oe}`),fetch(`/api/leads/ready-for-retry?organizationId=${Oe}&campaignId=${h}`)]),Zn=await at.json(),Ta=await mo.json();Zn.success&&(lt=Zn.followUps||[],console.log("[SmartDialer]  Follow-ups due:",lt.length)),Ta.success&&(Tt=Ta.leads||[],console.log("[SmartDialer]  Retry leads:",Tt.length))}catch(at){console.warn("[SmartDialer] Failed to fetch priority leads, continuing with regular leads:",at)}const hl=N.filter(at=>{const mo=(at.source||"").toLowerCase().trim(),Zn=(X.source_filter||"").toLowerCase().trim();return Zn===""||mo===Zn}).filter(at=>at.status!=="Won"&&at.status!=="Lost");console.log("[SmartDialer]  Regular campaign leads:",hl.length);const js=new Set,zn=[];for(const at of lt)js.has(at.id)||(zn.push({...at,_priority:"follow_up",_priorityLabel:" "}),js.add(at.id));for(const at of Tt)js.has(at.id)||(zn.push({...at,_priority:"retry",_priorityLabel:"  "}),js.add(at.id));for(const at of hl)js.has(at.id)||(zn.push({...at,_priority:"regular",_priorityLabel:" "}),js.add(at.id));if(zn.length===0){V(`    "${X.name}"`);return}console.log("[SmartDialer]  Smart Queue built:",{total:zn.length,followUps:zn.filter(at=>at._priority==="follow_up").length,retries:zn.filter(at=>at._priority==="retry").length,regular:zn.filter(at=>at._priority==="regular").length});const Ni=zn.map(at=>({id:at.id,name:at.name||at.full_name,phone:at.phone||"",source:at.source,status:at.status,company:at.company,priority:at._priority,priorityLabel:at._priorityLabel}));wt(Ni);const ua=zn[0];console.log("[SmartDialer]  Starting first call:",{name:ua.name,priority:ua._priorityLabel}),await ur(ua)},Ut=async()=>{if(!(!Ye||!ee))try{const X=new Date(`${ee}T${Te}:00`).toISOString();if(!(await fetch(`/api/leads/${Ye.id}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"follow_up",followUpAt:X,notes:Le||null})})).ok)throw new Error("Failed to schedule follow-up");console.log("[History] Follow-up scheduled successfully"),ye(null),ke(""),J("10:00"),$e("")}catch(X){console.error("[History] Follow-up failed:",X),V("  ")}},Ye=nt?N.find(X=>X.id===nt):null,Gt=I?N.filter(X=>{var Se,be,Oe;return((Se=X.name)==null?void 0:Se.toLowerCase().includes(I.toLowerCase()))||((be=X.phone)==null?void 0:be.includes(I))||((Oe=X.company)==null?void 0:Oe.toLowerCase().includes(I.toLowerCase()))}):N;return s.jsxs("div",{className:"flex w-full h-full bg-[#F7F8FC] font-sans overflow-hidden text-[#0B1220] relative",children:[F&&s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-top-2",children:s.jsxs("div",{className:"bg-rose-600 text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-3",children:[s.jsx(cu,{className:"w-5 h-5 shrink-0"}),s.jsx("span",{className:"text-sm font-medium",children:F}),s.jsx("button",{onClick:()=>V(null),className:"p-1 hover:bg-white/20 rounded",children:s.jsx(Lt,{className:"w-4 h-4"})})]})}),mt.isActive&&s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[99] animate-in fade-in slide-in-from-top-2",children:s.jsxs("div",{className:"bg-gradient-to-r from-brand-600 to-brand-700 text-white px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-6 min-w-[400px]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pL,{className:"w-5 h-5 animate-spin-slow"}),s.jsx("span",{className:"font-bold",children:"Power Dialer"})]}),s.jsx("div",{className:"flex items-center gap-2 bg-white/20 px-3 py-1 rounded-lg",children:s.jsxs("span",{className:"text-sm font-medium",children:[" ",mt.currentIndex+1,"/",mt.queue.length]})}),mt.isInPreview&&mt.queue[mt.currentIndex]&&s.jsxs("div",{className:"flex items-center gap-3 bg-white/10 px-3 py-1 rounded-lg",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs opacity-75",children:" :"}),s.jsx("p",{className:"font-medium text-sm",children:mt.queue[mt.currentIndex].name})]}),s.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center font-bold text-lg",children:mt.previewCountdown})]}),s.jsxs("div",{className:"flex items-center gap-2 mr-auto",children:[mt.isPaused?s.jsx("button",{onClick:Zr,className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:"",children:s.jsx(EE,{className:"w-5 h-5"})}):s.jsx("button",{onClick:dt,className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:" ",children:s.jsx(hw,{className:"w-5 h-5"})}),s.jsx("button",{onClick:ws,className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:" ",children:s.jsx(NL,{className:"w-5 h-5"})}),s.jsx("button",{onClick:ct,className:"p-2 bg-rose-500/80 hover:bg-rose-500 rounded-lg transition-colors",title:"",children:s.jsx(ML,{className:"w-5 h-5 fill-current"})})]})]})}),s.jsx(XB,{isVisible:ut&&gt,onClose:()=>yt(!1),campaignName:(hr=le.find(X=>X.id===h))==null?void 0:hr.name,leadName:Ye==null?void 0:Ye.name}),(b||w)&&s.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-40 xl:hidden backdrop-blur-sm transition-opacity",onClick:()=>{j(!1),_(!1)}}),s.jsxs("div",{className:`
        fixed inset-y-0 right-0 z-50 w-80 bg-white border-l border-[#E7EAF2] h-full flex flex-col shadow-2xl transition-transform duration-300 ease-in-out
        xl:relative xl:translate-x-0 xl:shadow-[4px_0_24px_rgba(0,0,0,0.01)] xl:z-auto xl:flex-shrink-0
        ${b?"translate-x-0":"translate-x-full xl:translate-x-0"}
      `,children:[s.jsx("button",{onClick:()=>j(!1),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 xl:hidden z-10",children:s.jsx(Lt,{className:"w-5 h-5"})}),s.jsxs("div",{className:"p-4 border-b border-[#E7EAF2] flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"font-bold text-[#0B1220] text-base",children:" "}),s.jsxs("span",{className:"text-[11px] font-medium text-[#667085] bg-slate-50 border border-[#E7EAF2] px-2 py-0.5 rounded-full",children:[Gt.length," "]})]}),s.jsxs("div",{className:"flex bg-[#F0F2F5] p-1 rounded-xl mb-3",children:[s.jsxs("button",{onClick:()=>l("leads"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all border border-transparent
                        ${a==="leads"?"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.05)] text-[#0B1220]":"text-[#667085] hover:text-[#0B1220]"}`,children:[" (",N.length,")"]}),s.jsxs("button",{onClick:()=>l("history"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all
                        ${a==="history"?"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.05)] text-[#0B1220]":"text-[#667085] hover:text-[#0B1220]"}`,children:[" (",A.length,")"]})]}),s.jsxs("div",{className:"relative group",children:[s.jsx(na,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#98A2B3] group-focus-within:text-brand-500 transition-colors"}),s.jsx("input",{type:"text",value:I,onChange:X=>$(X.target.value),placeholder:"...",className:"w-full pl-3 pr-9 py-2 bg-white border border-[#E7EAF2] rounded-xl text-sm outline-none focus:border-brand-500 focus:ring-2 focus:ring-brand-500/10 transition-all placeholder-[#98A2B3]"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:a==="leads"?S?s.jsx("div",{className:"space-y-3",children:[1,2,3].map(X=>s.jsx("div",{className:"h-20 bg-slate-50 rounded-2xl animate-pulse"},X))}):Gt.length===0?s.jsx("div",{className:"text-center py-10 text-slate-400 text-sm",children:"  "}):Gt.map(X=>s.jsxs("div",{onClick:()=>un(X),onDoubleClick:()=>ur(X),className:`
                              p-4 rounded-2xl border cursor-pointer transition-all relative group
                              ${nt===X.id?"bg-gradient-to-l from-brand-50 to-white border-brand-200 shadow-md shadow-brand-500/10":"bg-white border-slate-100 hover:bg-slate-50/80 hover:border-slate-200 hover:shadow-sm"}
                           `,children:[nt===X.id&&s.jsx("div",{className:"absolute right-0 top-3 bottom-3 w-1.5 bg-gradient-to-b from-brand-500 to-indigo-600 rounded-l-full"}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:`font-bold text-[14px] block ${nt===X.id?"text-brand-900":"text-[#0B1220]"}`,children:X.name}),s.jsx("span",{className:"text-[11px] text-slate-400",children:X.company||""})]}),X.priority==="Hot"&&s.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-rose-50 rounded-md border border-rose-200",children:[s.jsx(uu,{className:"w-3 h-3 text-rose-500"}),s.jsx("span",{className:"text-[10px] font-bold text-rose-600",children:""})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:`text-[10px] px-2.5 py-1 rounded-lg font-bold border ${X.status==="New"?"bg-indigo-50 text-indigo-600 border-indigo-200":X.status==="Discovery"?"bg-purple-50 text-purple-600 border-purple-200":X.status==="Proposal"?"bg-pink-50 text-pink-600 border-pink-200":X.status==="Negotiation"?"bg-amber-50 text-amber-600 border-amber-200":X.status==="Closed"?"bg-emerald-50 text-emerald-600 border-emerald-200":"bg-slate-50 text-slate-500 border-slate-200"}`,children:Et(X.status)||" "}),X.source&&s.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-md bg-slate-100 text-slate-500",children:et(X.source)})]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-slate-400",children:[s.jsx(ft,{className:"w-3 h-3"}),s.jsx("span",{dir:"ltr",className:"font-medium",children:X.phone})]}),s.jsx("button",{onClick:Se=>{Se.stopPropagation(),ur(X)},className:"absolute left-3 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-all bg-gradient-to-r from-brand-600 to-indigo-600 hover:from-brand-700 hover:to-indigo-700 text-white p-2.5 rounded-xl shadow-lg shadow-brand-500/30 hover:shadow-xl hover:scale-105",title:"",children:s.jsx(ft,{className:"w-4 h-4"})})]},X.id)):D?s.jsx("div",{className:"flex items-center justify-center py-10",children:s.jsx(it,{className:"w-6 h-6 animate-spin text-brand-500"})}):A.length===0?s.jsx("div",{className:"text-center py-10 text-slate-400 text-sm",children:"  "}):A.map(X=>{var Se;return s.jsxs("div",{className:"rounded-2xl border bg-white border-slate-100 overflow-hidden transition-all",children:[s.jsxs("div",{onClick:()=>he(ie===X.id?null:X.id),className:"p-3.5 cursor-pointer hover:bg-slate-50 transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-semibold text-sm truncate text-[#0B1220]",children:((Se=X.leads)==null?void 0:Se.name)||"( )"}),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-md font-medium ${X.status==="completed"?"bg-emerald-50 text-emerald-600":"bg-slate-50 text-slate-500"}`,children:Ot(X.status)})]}),s.jsxs("div",{className:"flex items-center gap-3 text-[11px] text-[#98A2B3]",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Pr,{className:"w-3 h-3"}),X.duration?`${Math.floor(X.duration/60)}:${(X.duration%60).toString().padStart(2,"0")}`:"--:--"]}),s.jsx("span",{children:""}),s.jsxs("span",{children:[new Date(X.created_at).toLocaleDateString("he-IL"),"  ",new Date(X.created_at).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})]})]})]}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 transition-transform ${ie===X.id?"rotate-180":""}`})]}),ie===X.id&&s.jsxs("div",{className:"border-t border-slate-100 p-3.5 bg-slate-50/50 space-y-3 animate-in slide-in-from-top-2",children:[X.recording_url&&!X.recording_url.startsWith("sid:")&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"text-xs font-bold text-slate-500 flex items-center gap-1.5",children:[s.jsx(Kl,{className:"w-3 h-3"})," "]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("audio",{controls:!0,className:"flex-1 h-8",src:X.recording_url,children:"     "}),s.jsx("a",{href:X.recording_url,download:!0,className:"p-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-100 transition-colors",title:" ",children:s.jsx(Du,{className:"w-4 h-4 text-slate-500"})})]})]}),X.transcript?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"text-xs font-bold text-slate-500 flex items-center gap-1.5",children:[s.jsx(ps,{className:"w-3 h-3"})," "]}),s.jsx("div",{className:"text-xs text-slate-600 max-h-40 overflow-y-auto p-2 bg-white rounded-lg border border-slate-100 whitespace-pre-wrap",children:X.transcript})]}):s.jsx("p",{className:"text-xs text-slate-400 italic",children:"    "}),X.summary&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"text-xs font-bold text-slate-500 flex items-center gap-1.5",children:[s.jsx(Nr,{className:"w-3 h-3"})," AI"]}),s.jsx("div",{className:"text-xs text-slate-600 p-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-100",children:X.summary})]})]})]},X.id)})}),Ye&&!gt&&s.jsx("div",{className:"p-3 border-t border-[#E7EAF2]",children:s.jsxs("button",{onClick:()=>ur(Ye),disabled:!pe||rt==="error",className:`w-full py-3 rounded-xl font-bold text-sm flex items-center justify-center gap-2 transition-all
                        ${pe?"bg-brand-600 text-white hover:bg-brand-700 shadow-lg shadow-brand-500/25":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[s.jsx(ft,{className:"w-4 h-4"}),pe?` ${Ye.name}`:"..."]})})]}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-[#F7F8FC] relative h-full overflow-hidden",children:[s.jsxs("div",{className:"h-12 px-4 flex items-center justify-between xl:hidden border-b border-[#E7EAF2] bg-white shrink-0 shadow-sm z-20",children:[s.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 text-xs font-bold text-slate-600 hover:text-brand-600 transition-colors",children:[s.jsx(K$,{className:"w-4 h-4"})," "]}),s.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 text-xs font-bold text-slate-600 hover:text-brand-600 transition-colors",children:["",s.jsx(W$,{className:"w-4 h-4"})]})]}),rt==="connecting"&&s.jsxs("div",{className:"bg-amber-100 border-b border-amber-200 px-4 py-2 flex items-center justify-center gap-2",children:[s.jsx(it,{className:"w-4 h-4 animate-spin text-amber-600"}),s.jsx("span",{className:"text-sm font-medium text-amber-700",children:"  ..."})]}),rt==="error"&&s.jsxs("div",{className:"bg-rose-100 border-b border-rose-200 px-4 py-2 flex items-center justify-center gap-2",children:[s.jsx(cu,{className:"w-4 h-4 text-rose-600"}),s.jsx("span",{className:"text-sm font-medium text-rose-700",children:"  -   "}),s.jsx("button",{onClick:qe,className:"text-xs bg-rose-600 text-white px-2 py-1 rounded hover:bg-rose-700",children:" "})]}),Ge&&!gt&&s.jsxs("div",{className:"bg-gradient-to-l from-brand-50 to-purple-50 border-b border-brand-200 px-4 py-2 flex items-center justify-center gap-3",children:[s.jsx(ps,{className:"w-4 h-4 text-brand-600"}),s.jsx("span",{className:"text-sm font-medium text-brand-700",children:"      "}),s.jsx("button",{onClick:vt,className:"text-xs bg-brand-600 text-white px-3 py-1.5 rounded-lg hover:bg-brand-700 font-medium shadow-sm transition-all hover:shadow",children:" "})]}),gt?(()=>{var Se,be,Oe;const X=[];return fe!=null&&fe.insight&&X.push({id:"insight-"+Date.now(),type:"tip",text:fe.insight}),fe!=null&&fe.suggestion&&X.push({id:"sugg-"+Date.now(),type:"tip",text:` : ${fe.suggestion}`}),(Se=fe==null?void 0:fe.signals)!=null&&Se.pains&&fe.signals.pains.forEach((lt,Tt)=>{X.push({id:`pain-${Tt}`,type:"warning",text:`  : ${lt.text}`})}),(be=fe==null?void 0:fe.signals)!=null&&be.objections&&fe.signals.objections.forEach((lt,Tt)=>{X.push({id:`obj-${Tt}`,type:"warning",text:` : ${lt.text}`})}),(Oe=fe==null?void 0:fe.signals)!=null&&Oe.vision&&fe.signals.vision.forEach((lt,Tt)=>{X.push({id:`vis-${Tt}`,type:"tip",text:` : ${lt.text}`})}),s.jsxs("div",{className:"relative h-full flex flex-col min-h-0 bg-white",children:[s.jsx("div",{className:"absolute top-24 left-4 z-[50]",children:s.jsx("button",{onClick:()=>Zt(lt=>lt==="copilot"?"legacy":"copilot"),className:"bg-slate-800 text-white p-2 rounded-full shadow-xl hover:bg-slate-700 transition-colors border border-slate-600",title:Dt==="copilot"?"Switch to Legacy View":"Switch to New View",children:s.jsx(X$,{className:"w-5 h-5"})})}),Dt==="copilot"?s.jsx(Wq,{transcript:Z.map((lt,Tt)=>({id:lt.id||`msg-${Tt}`,speaker:lt.speaker||"unknown",text:lt.text||"",timestamp:lt.timestamp||new Date().toISOString(),isFinal:lt.isFinal})),coachSuggestions:X,onEndCall:t,orgId:n}):s.jsx(Gq,{transcripts:Z,coachingData:fe,callDuration:Y,currentLead:Ye,onEndCall:t,formatTime:er})]})})():S?s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsx(it,{className:"w-8 h-8 animate-spin text-brand-500"})}):s.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:Ye?s.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[s.jsxs("div",{className:"bg-gradient-to-l from-white via-white to-brand-50/30 border-b border-[#E7EAF2] p-5 flex items-center justify-between shadow-sm z-10",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-brand-500 to-indigo-600 rounded-full flex items-center justify-center text-xl font-bold text-white shadow-lg shadow-brand-500/20",children:Ye.name.charAt(0)}),Ye.priority==="Hot"&&s.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-rose-500 rounded-full flex items-center justify-center border-2 border-white shadow-sm",children:s.jsx(uu,{className:"w-3 h-3 text-white"})})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{className:"text-xl font-bold text-[#0B1220]",children:Ye.name}),s.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold border ${Ye.status==="New"?"bg-indigo-50 text-indigo-600 border-indigo-200":Ye.status==="Discovery"?"bg-purple-50 text-purple-600 border-purple-200":Ye.status==="Proposal"?"bg-pink-50 text-pink-600 border-pink-200":Ye.status==="Negotiation"?"bg-amber-50 text-amber-600 border-amber-200":Ye.status==="Contacted"?"bg-sky-50 text-sky-600 border-sky-200":Ye.status==="Qualified"?"bg-teal-50 text-teal-600 border-teal-200":Ye.status==="Deal"||Ye.status==="Closed"?"bg-emerald-50 text-emerald-600 border-emerald-200":Ye.status==="Lost"?"bg-slate-100 text-slate-500 border-slate-200":"bg-slate-100 text-slate-600 border-slate-200"}`,children:Et(Ye.status)||" "})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-[#667085]",children:[s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx(Na,{className:"w-3.5 h-3.5 text-slate-400"}),Ye.company||""]}),s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx(ft,{className:"w-3.5 h-3.5 text-slate-400"}),s.jsx("span",{dir:"ltr",children:Ye.phone})]}),Ye.source&&s.jsx("span",{className:"px-2 py-0.5 rounded-md bg-slate-100 text-slate-500 text-xs font-medium",children:et(Ye.source)})]})]})]}),s.jsxs("button",{onClick:()=>ur(Ye),disabled:!pe,className:`h-11 px-7 rounded-xl font-bold text-sm flex items-center gap-2.5 transition-all shadow-xl hover:-translate-y-0.5 hover:shadow-2xl
                                 ${pe?"bg-gradient-to-r from-brand-600 to-indigo-600 text-white hover:from-brand-700 hover:to-indigo-700 shadow-brand-500/30":"bg-slate-100 text-slate-400 cursor-not-allowed shadow-none"}`,children:[s.jsx(ft,{className:"w-4 h-4"})," "]}),s.jsx(YA,{leadPhone:Ye==null?void 0:Ye.phone,leadName:Ye==null?void 0:Ye.name,leadEmail:Ye==null?void 0:Ye.email,className:"hidden md:flex"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-[#F7F8FC] space-y-6",ref:m,children:st.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center opacity-60",children:[s.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(Nr,{className:"w-8 h-8 text-slate-300"})}),s.jsx("p",{className:"text-slate-500 text-sm",children:"    "}),s.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"    "})]}):st.map((X,Se)=>{var be,Oe;return s.jsxs("div",{className:"bg-white rounded-2xl border border-[#E7EAF2] overflow-hidden shadow-sm",children:[s.jsxs("div",{onClick:()=>Ee(_e===X.id?null:X.id),className:"bg-slate-50/50 p-3 border-b border-[#E7EAF2] flex justify-between items-center cursor-pointer hover:bg-slate-100/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${X.status==="completed"?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-500"}`,children:s.jsx(ft,{className:"w-3.5 h-3.5"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs font-bold text-[#0B1220]",children:[new Date(X.created_at).toLocaleDateString("he-IL"),"  ",new Date(X.created_at).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("div",{className:"text-[10px] text-slate-500 font-medium flex gap-2",children:[s.jsxs("span",{children:[": ",X.duration?`${Math.floor(X.duration/60)}:${(X.duration%60).toString().padStart(2,"0")}`:"00:00"]}),s.jsx("span",{children:""}),s.jsx("span",{children:Ot(X.status)})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[((be=X.summary)==null?void 0:be.score)&&s.jsxs(qr,{variant:X.summary.score>=80?"success":"warning",size:"sm",children:[" AI: ",X.summary.score]}),s.jsx(Pt,{className:`w-5 h-5 text-slate-400 transition-transform ${_e===X.id?"rotate-180":""}`})]})]}),_e===X.id&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-4 space-y-3 bg-white max-h-80 overflow-y-auto",children:!X.transcript||Object.keys(X.transcript).length===0?s.jsx("div",{className:"text-center text-xs text-slate-400 py-2",children:"    "}):(()=>{const lt=[];return X.transcript&&Object.entries(X.transcript).forEach(([Tt,Ea])=>{Array.isArray(Ea)&&Ea.forEach(hl=>lt.push({...hl,role:Tt}))}),lt.sort((Tt,Ea)=>new Date(Tt.timestamp).getTime()-new Date(Ea.timestamp).getTime()).map((Tt,Ea)=>s.jsxs("div",{className:`flex flex-col ${Tt.role==="agent"?"items-end":"items-start"} max-w-[90%] w-full ${Tt.role==="agent"?"mr-auto":"ml-auto"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 px-1",children:[s.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:new Date(Tt.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),s.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:Tt.role==="agent"?"":""})]}),s.jsx("div",{className:`
                                                                relative px-3 py-2 text-sm leading-relaxed rounded-xl
                                                                ${Tt.role==="agent"?"bg-[#EFF4FF] text-[#1E3A8A] rounded-tl-none":"bg-[#F9FAFB] text-[#344054] rounded-tr-none border border-slate-100"}
                                                             `,children:Tt.text})]},Ea))})()}),((Oe=X.summary)==null?void 0:Oe.summary)&&s.jsxs("div",{className:"p-3 bg-slate-50 border-t border-[#E7EAF2] text-xs text-slate-600 leading-relaxed",children:[s.jsx("span",{className:"font-bold block mb-1",children:" :"}),X.summary.summary]}),s.jsxs("div",{className:"p-3 bg-white border-t border-[#E7EAF2] flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:lt=>{lt.stopPropagation(),ye(X.id)},className:"flex items-center gap-1.5 px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs font-medium rounded-lg hover:from-blue-600 hover:to-indigo-600 transition-all shadow-sm",children:[s.jsx(wn,{className:"w-3.5 h-3.5"}),"  "]}),s.jsxs("button",{onClick:lt=>{lt.stopPropagation(),Ee(null)},className:"flex items-center gap-1.5 px-3 py-2 bg-slate-100 text-slate-600 text-xs font-medium rounded-lg hover:bg-slate-200 transition-all",children:[s.jsx(Lt,{className:"w-3.5 h-3.5"}),""]})]})]})]},X.id||Se)})})]}):s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 md:p-8 overflow-y-auto",children:[s.jsxs("div",{className:"bg-white rounded-3xl shadow-[0_8px_30px_rgba(0,0,0,0.04)] border border-[#E7EAF2] p-6 md:p-10 max-w-lg w-full text-center relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-brand-400 to-purple-500"}),s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-brand-50/50 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none"}),s.jsx("div",{className:"w-20 h-20 bg-brand-50 rounded-2xl flex items-center justify-center mx-auto mb-6 relative z-10 shadow-sm border border-brand-100",children:s.jsx(ft,{className:"w-9 h-9 text-brand-600"})}),s.jsx("h2",{className:"text-xl md:text-2xl font-bold text-[#0B1220] mb-2 relative z-10",children:"  "}),s.jsx("p",{className:"text-[#667085] text-sm mb-8 max-w-xs mx-auto leading-relaxed relative z-10",children:"           ."}),s.jsxs("div",{className:"space-y-3 relative z-10",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:h,onChange:X=>f(X.target.value),className:"w-full h-12 pl-4 pr-10 bg-[#FAFAFC] border border-[#E7EAF2] rounded-xl text-sm font-medium text-[#0B1220] outline-none focus:border-brand-500 focus:ring-2 focus:ring-brand-500/10 appearance-none cursor-pointer transition-all",disabled:B,children:[s.jsx("option",{value:"",disabled:!0,children:B?" ...":le.length===0?"  -   ":" ..."}),le.map(X=>s.jsx("option",{value:X.id,children:X.name},X.id))]}),s.jsx(Pt,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#98A2B3] pointer-events-none"})]}),s.jsxs("button",{onClick:Sr,disabled:!h||!pe,className:`w-full h-12 rounded-xl font-bold text-sm flex items-center justify-center gap-2 transition-all shadow-lg hover:-translate-y-0.5
                                   ${h&&pe?"bg-brand-600 text-white hover:bg-brand-700 shadow-brand-500/25":"bg-slate-100 text-slate-400 cursor-not-allowed shadow-none border border-slate-200"}`,children:[s.jsx(Kl,{className:"w-4 h-4 fill-current"})," "]})]})]}),s.jsxs("div",{className:"mt-8 flex flex-col items-center gap-2",children:[s.jsxs("p",{className:"text-xs text-[#98A2B3] font-medium flex items-center gap-2",children:[s.jsx(Nr,{className:"w-3 h-3 text-purple-500"}),"AI Coach    ",pe&&s.jsx("span",{className:"text-emerald-500",children:" "})]}),s.jsx("button",{onClick:Ne,className:"text-[10px] text-slate-400 hover:text-brand-500 underline",children:"  (Preflight)"})]})]})})]}),s.jsxs("div",{className:`
        fixed inset-y-0 left-0 z-50 w-72 bg-[#F7F8FC] border-r border-[#E7EAF2] h-full flex flex-col shadow-2xl transition-transform duration-300 ease-in-out
        xl:relative xl:translate-x-0 xl:shadow-[inset_4px_0_24px_rgba(0,0,0,0.01)] xl:z-auto xl:flex-shrink-0
        ${w?"translate-x-0":"-translate-x-full xl:translate-x-0"}
      `,children:[s.jsx("div",{className:"p-4 border-b border-[#E7EAF2]",children:s.jsx("h2",{className:"font-bold text-[#0B1220]",children:" "})}),s.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-800 px-4",children:[s.jsx("button",{onClick:()=>d("followup"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${c==="followup"?"border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:" "}),s.jsx("button",{onClick:()=>d("queue"),className:`flex-1 py-3 text-sm font-medium border-b-2 transition-colors ${c==="queue"?"border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(Nr,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:" "})]})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[c==="queue"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-brand-50 dark:bg-brand-900/20 p-4 rounded-xl border border-brand-100 dark:border-brand-800/50",children:[s.jsx("h3",{className:"font-bold text-brand-900 dark:text-brand-100 mb-1",children:"Power Dialer "}),s.jsxs("p",{className:"text-xs text-brand-700 dark:text-brand-300 mb-3",children:["   ",dn.length,"  .     ."]}),s.jsxs("button",{onClick:Pe,disabled:g,className:`w-full py-2 bg-brand-600 hover:bg-brand-700 text-white rounded-lg text-sm font-medium shadow-sm shadow-brand-200 dark:shadow-none transition-all active:scale-[0.98] flex items-center justify-center gap-2 ${g?"opacity-70 cursor-not-allowed":""}`,children:[g?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(Kl,{className:"w-4 h-4 fill-current"}),g?" ...":"  "]})]}),pt?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(it,{className:"w-6 h-6 animate-spin text-slate-400"})}):dn.length===0?s.jsx("div",{className:"text-center py-8 text-slate-500 text-sm",children:" !   "}):s.jsx("div",{className:"space-y-2",children:dn.map((X,Se)=>s.jsxs("div",{className:"group bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 p-3 rounded-lg hover:border-brand-300 dark:hover:border-brand-700 transition-colors cursor-pointer relative",children:[s.jsxs("div",{className:"absolute top-2 left-2 text-[10px] font-bold text-slate-300",children:["#",Se+1]}),s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("div",{className:"font-medium text-slate-900 dark:text-white truncate max-w-[140px]",children:X.name}),s.jsx(qr,{variant:X.priorityReason==="High AI Score"?"success":"neutral",className:"text-[10px] px-1.5 py-0",children:X.priorityReason})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 dark:text-slate-400",children:[s.jsx("span",{children:X.phone}),s.jsx("span",{children:X.status})]})]},X.id))})]}),c==="followup"&&s.jsx("div",{className:"space-y-3",children:M.length===0?s.jsxs("div",{className:"text-center py-10 text-slate-400",children:[s.jsx(Pr,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"   "}),s.jsx("p",{className:"text-xs mt-1",children:"     "})]}):M.map(X=>s.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-3 hover:border-brand-300 transition-colors cursor-pointer",onClick:()=>{ae(X.lead_id)},children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("span",{className:"font-medium text-slate-900 truncate",children:X.lead_name}),s.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${new Date(X.follow_up_at)<new Date?"bg-rose-100 text-rose-700":"bg-blue-100 text-blue-700"}`,children:new Date(X.follow_up_at)<new Date?"":""})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[s.jsx(Pr,{className:"w-3 h-3"}),s.jsx("span",{children:new Date(X.follow_up_at).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})}),X.notes&&s.jsxs("span",{className:"truncate",children:[" ",X.notes]})]})]},X.id))})]}),s.jsx("div",{className:"p-4 border-b border-slate-200",children:s.jsx(JB,{userId:r,orgId:n,compact:!0})}),s.jsx("div",{className:"p-4 space-y-3",children:U?s.jsx("div",{className:"text-center text-slate-400 py-8",children:" ..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-orange-50",children:[s.jsx(Ct,{className:"w-5 h-5 text-orange-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:""}),s.jsxs("p",{className:"font-bold text-slate-800",children:[(H==null?void 0:H.calls.answered)||0," / ",(H==null?void 0:H.calls.total)||0]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-emerald-50",children:[s.jsx(AE,{className:"w-5 h-5 text-emerald-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:""}),s.jsx("p",{className:"font-bold text-slate-800",children:(H==null?void 0:H.deals)||0})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-purple-50",children:[s.jsx(hu,{className:"w-5 h-5 text-purple-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:" "}),s.jsx("p",{className:"font-bold text-slate-800",children:(H==null?void 0:H.newLeads)||0})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-slate-100",children:[s.jsx(qL,{className:"w-5 h-5 text-slate-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"  "}),s.jsx("p",{className:"font-bold text-slate-800",children:er((H==null?void 0:H.avgCallTime)||0)})]})]})]})})]}),we&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999]",onClick:()=>ye(null),children:s.jsxs("div",{onClick:X=>X.stopPropagation(),className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200",children:[s.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[s.jsx(wn,{className:"w-5 h-5 text-brand-500"}),"  "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:""}),s.jsx("input",{type:"date",value:ee,min:new Date().toISOString().split("T")[0],onChange:X=>ke(X.target.value),className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50 text-slate-900 outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:""}),s.jsx("input",{type:"time",value:Te,min:ee===new Date().toISOString().split("T")[0]?new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):void 0,onChange:X=>J(X.target.value),className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50 text-slate-900 outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:" ()"}),s.jsx("textarea",{value:Le,onChange:X=>$e(X.target.value),placeholder:"    ?",className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50 text-slate-900 outline-none focus:ring-2 focus:ring-brand-500 resize-none h-20"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>ye(null),className:"flex-1 px-4 py-2.5 bg-slate-100 text-slate-600 font-medium rounded-xl hover:bg-slate-200 transition-all",children:""}),s.jsx("button",{onClick:Ut,disabled:!ee,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-brand-600 to-indigo-600 text-white font-medium rounded-xl hover:from-brand-700 hover:to-indigo-700 transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:" "})]})]})})]})};function E0(e,t){const r=t.split(".");let n=e;for(const a of r){if(typeof n=="boolean"||typeof n=="string")return n;if(n==null||typeof n!="object")return;n=n[a]}return n}function Yq(e){const{theme:t,clearTheme:r,applyTheme:n,...a}=e;return a}function dT(e,t){let r=Yq(e);return t&&(r={...t,...e}),r}const cl={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")};cl.defaultMerge;function Xq(e,t){return t}function Jq(e,t){return e.filter(r=>r!==void 0)}var wS;(function(e){e[e.NOT=0]="NOT",e[e.RECORD=1]="RECORD",e[e.ARRAY=2]="ARRAY",e[e.SET=3]="SET",e[e.MAP=4]="MAP",e[e.OTHER=5]="OTHER"})(wS||(wS={}));function jS(e){return typeof e!="object"||e===null?0:Array.isArray(e)?2:eF(e)?1:e instanceof Set?3:e instanceof Map?4:5}function Qq(e){const t=new Set;for(const r of e)for(const n of[...Object.keys(r),...Object.getOwnPropertySymbols(r)])t.add(n);return t}function Zq(e,t){return typeof e=="object"&&Object.prototype.propertyIsEnumerable.call(e,t)}function uT(e){var n;let t=0,r=(n=e[0])==null?void 0:n[Symbol.iterator]();return{[Symbol.iterator](){return{next(){var a;do{if(r===void 0)return{done:!0,value:void 0};const l=r.next();if(l.done===!0){t+=1,r=(a=e[t])==null?void 0:a[Symbol.iterator]();continue}return{done:!1,value:l.value}}while(!0)}}}}}const _S=["[object Object]","[object Module]"];function eF(e){if(!_S.includes(Object.prototype.toString.call(e)))return!1;const{constructor:t}=e;if(t===void 0)return!0;const r=t.prototype;return!(r===null||typeof r!="object"||!_S.includes(Object.prototype.toString.call(r))||!r.hasOwnProperty("isPrototypeOf"))}function tF(e,t,r){const n={};for(const a of Qq(e)){const l=[];for(const h of e)Zq(h,a)&&l.push(h[a]);if(l.length===0)continue;const c=t.metaDataUpdater(r,{key:a,parents:e}),d=fT(l,t,c);d!==cl.skip&&(a==="__proto__"?Object.defineProperty(n,a,{value:d,configurable:!0,enumerable:!0,writable:!0}):n[a]=d)}return n}function rF(e){return e.flat()}function nF(e){return new Set(uT(e))}function sF(e){return new Map(uT(e))}function aF(e){return e.at(-1)}const Tf={mergeRecords:tF,mergeArrays:rF,mergeSets:nF,mergeMaps:sF,mergeOthers:aF};function iF(...e){return hT({})(...e)}function hT(e,t){const r=lF(e,n);function n(...a){return fT(a,r,t)}return n}function lF(e,t){return{defaultMergeFunctions:Tf,mergeFunctions:{...Tf,...Object.fromEntries(Object.entries(e).filter(([r,n])=>Object.hasOwn(Tf,r)).map(([r,n])=>n===!1?[r,Tf.mergeOthers]:[r,n]))},metaDataUpdater:e.metaDataUpdater??Xq,deepmerge:t,useImplicitDefaultMerging:e.enableImplicitDefaultMerging??!1,filterValues:e.filterValues===!1?void 0:e.filterValues??Jq,actions:cl}}function fT(e,t,r){var l;const n=((l=t.filterValues)==null?void 0:l.call(t,e,r))??e;if(n.length===0)return;if(n.length===1)return Vx(n,t,r);const a=jS(n[0]);if(a!==0&&a!==5){for(let c=1;c<n.length;c++)if(jS(n[c])!==a)return Vx(n,t,r)}switch(a){case 1:return oF(n,t,r);case 2:return cF(n,t,r);case 3:return dF(n,t,r);case 4:return uF(n,t,r);default:return Vx(n,t,r)}}function oF(e,t,r){const n=t.mergeFunctions.mergeRecords(e,t,r);return n===cl.defaultMerge||t.useImplicitDefaultMerging&&n===void 0&&t.mergeFunctions.mergeRecords!==t.defaultMergeFunctions.mergeRecords?t.defaultMergeFunctions.mergeRecords(e,t,r):n}function cF(e,t,r){const n=t.mergeFunctions.mergeArrays(e,t,r);return n===cl.defaultMerge||t.useImplicitDefaultMerging&&n===void 0&&t.mergeFunctions.mergeArrays!==t.defaultMergeFunctions.mergeArrays?t.defaultMergeFunctions.mergeArrays(e):n}function dF(e,t,r){const n=t.mergeFunctions.mergeSets(e,t,r);return n===cl.defaultMerge||t.useImplicitDefaultMerging&&n===void 0&&t.mergeFunctions.mergeSets!==t.defaultMergeFunctions.mergeSets?t.defaultMergeFunctions.mergeSets(e):n}function uF(e,t,r){const n=t.mergeFunctions.mergeMaps(e,t,r);return n===cl.defaultMerge||t.useImplicitDefaultMerging&&n===void 0&&t.mergeFunctions.mergeMaps!==t.defaultMergeFunctions.mergeMaps?t.defaultMergeFunctions.mergeMaps(e):n}function Vx(e,t,r){const n=t.mergeFunctions.mergeOthers(e,t,r);return n===cl.defaultMerge||t.useImplicitDefaultMerging&&n===void 0&&t.mergeFunctions.mergeOthers!==t.defaultMergeFunctions.mergeOthers?t.defaultMergeFunctions.mergeOthers(e):n}function a0(e){var t,r,n;if(Array.isArray(e)){for(r=Array(t=e.length);t--;)r[t]=(n=e[t])&&typeof n=="object"?a0(n):n;return r}if(Object.prototype.toString.call(e)==="[object Object]"){r={};for(t in e)t==="__proto__"?Object.defineProperty(r,t,{value:a0(e[t]),configurable:!0,enumerable:!0,writable:!0}):r[t]=(n=e[t])&&typeof n=="object"?a0(n):n;return r}return e}const $w={dark:void 0,prefix:void 0,version:void 0};function hF(){return $w.dark}function mT(){return $w.prefix}function pT(){return $w.version}function fF(e){return hT({mergeOthers:(t,r)=>{if(t.some(n=>typeof n=="string")){const n=t.filter(c=>typeof c=="string"),a=new Set,l=[];for(const c of n){const d=[...new Set(c.split(/\s+/))];l.push(d.filter(h=>!a.has(h)).join(" "));for(const h of d)a.add(h)}return e(l)}return r.actions.defaultMerge}})}function ry(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e))return e.length!==t.length?!1:e.every((n,a)=>ry(n,t[a]));if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e);return r.length!==Object.keys(t).length?!1:r.every(n=>Object.prototype.hasOwnProperty.call(t,n)&&ry(e[n],t[n]))}return e!==e&&t!==t}const Lw="-",mF=e=>{const t=gF(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:c=>{const d=c.split(Lw);return d[0]===""&&d.length!==1&&d.shift(),gT(d,t)||pF(c)},getConflictingClassGroupIds:(c,d)=>{const h=r[c]||[];return d&&n[c]?[...h,...n[c]]:h}}},gT=(e,t)=>{var c;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?gT(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(Lw);return(c=t.validators.find(({validator:d})=>d(l)))==null?void 0:c.classGroupId},kS=/^\[(.+)\]$/,pF=e=>{if(kS.test(e)){const t=kS.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},gF=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)ny(r[a],n,a,t);return n},ny=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:NS(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(xF(a)){ny(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,c])=>{ny(c,NS(t,l),r,n)})})},NS=(e,t)=>{let r=e;return t.split(Lw).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},xF=e=>e.isThemeGetter,bF=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,c)=>{r.set(l,c),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let c=r.get(l);if(c!==void 0)return c;if((c=n.get(l))!==void 0)return a(l,c),c},set(l,c){r.has(l)?r.set(l,c):a(l,c)}}},sy="!",ay=":",vF=ay.length,yF=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const l=[];let c=0,d=0,h=0,f;for(let j=0;j<a.length;j++){let w=a[j];if(c===0&&d===0){if(w===ay){l.push(a.slice(h,j)),h=j+vF;continue}if(w==="/"){f=j;continue}}w==="["?c++:w==="]"?c--:w==="("?d++:w===")"&&d--}const m=l.length===0?a:a.substring(h),g=wF(m),x=g!==m,b=f&&f>h?f-h:void 0;return{modifiers:l,hasImportantModifier:x,baseClassName:g,maybePostfixModifierPosition:b}};if(t){const a=t+ay,l=n;n=c=>c.startsWith(a)?l(c.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:c,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=l=>r({className:l,parseClassName:a})}return n},wF=e=>e.endsWith(sy)?e.substring(0,e.length-1):e.startsWith(sy)?e.substring(1):e,jF=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let l=[];return n.forEach(c=>{c[0]==="["||t[c]?(a.push(...l.sort(),c),l=[]):l.push(c)}),a.push(...l.sort()),a}},_F=e=>({cache:bF(e.cacheSize),parseClassName:yF(e),sortModifiers:jF(e),...mF(e)}),kF=/\s+/,NF=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:l}=t,c=[],d=e.trim().split(kF);let h="";for(let f=d.length-1;f>=0;f-=1){const m=d[f],{isExternal:g,modifiers:x,hasImportantModifier:b,baseClassName:j,maybePostfixModifierPosition:w}=r(m);if(g){h=m+(h.length>0?" "+h:h);continue}let _=!!w,N=n(_?j.substring(0,w):j);if(!N){if(!_){h=m+(h.length>0?" "+h:h);continue}if(N=n(j),!N){h=m+(h.length>0?" "+h:h);continue}_=!1}const C=l(x).join(":"),A=b?C+sy:C,E=A+N;if(c.includes(E))continue;c.push(E);const S=a(N,_);for(let T=0;T<S.length;++T){const D=S[T];c.push(A+D)}h=m+(h.length>0?" "+h:h)}return h};function SF(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=xT(t))&&(n&&(n+=" "),n+=r);return n}const xT=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=xT(e[n]))&&(r&&(r+=" "),r+=t);return r};function SS(e,...t){let r,n,a,l=c;function c(h){const f=t.reduce((m,g)=>g(m),e());return r=_F(f),n=r.cache.get,a=r.cache.set,l=d,d(h)}function d(h){const f=n(h);if(f)return f;const m=NF(h,r);return a(h,m),m}return function(){return l(SF.apply(null,arguments))}}const tn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},bT=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,vT=/^\((?:(\w[\w-]*):)?(.+)\)$/i,CF=/^\d+\/\d+$/,EF=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,AF=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TF=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,OF=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,PF=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zo=e=>CF.test(e),St=e=>!!e&&!Number.isNaN(Number(e)),Ol=e=>!!e&&Number.isInteger(Number(e)),CS=e=>e.endsWith("%")&&St(e.slice(0,-1)),Xi=e=>EF.test(e),DF=()=>!0,MF=e=>AF.test(e)&&!TF.test(e),zw=()=>!1,RF=e=>OF.test(e),IF=e=>PF.test(e),$F=e=>!De(e)&&!Me(e),LF=e=>Uc(e,jT,zw),De=e=>bT.test(e),Pl=e=>Uc(e,_T,MF),Wx=e=>Uc(e,YF,St),zF=e=>Uc(e,yT,zw),BF=e=>Uc(e,wT,IF),UF=e=>Uc(e,zw,RF),Me=e=>vT.test(e),Of=e=>qc(e,_T),qF=e=>qc(e,XF),FF=e=>qc(e,yT),HF=e=>qc(e,jT),VF=e=>qc(e,wT),WF=e=>qc(e,JF,!0),Uc=(e,t,r)=>{const n=bT.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},qc=(e,t,r=!1)=>{const n=vT.exec(e);return n?n[1]?t(n[1]):r:!1},yT=e=>e==="position",GF=new Set(["image","url"]),wT=e=>GF.has(e),KF=new Set(["length","size","percentage"]),jT=e=>KF.has(e),_T=e=>e==="length",YF=e=>e==="number",XF=e=>e==="family-name",JF=e=>e==="shadow",ES=()=>{const e=tn("color"),t=tn("font"),r=tn("text"),n=tn("font-weight"),a=tn("tracking"),l=tn("leading"),c=tn("breakpoint"),d=tn("container"),h=tn("spacing"),f=tn("radius"),m=tn("shadow"),g=tn("inset-shadow"),x=tn("drop-shadow"),b=tn("blur"),j=tn("perspective"),w=tn("aspect"),_=tn("ease"),N=tn("animate"),C=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],E=()=>["auto","hidden","clip","visible","scroll"],S=()=>["auto","contain","none"],T=()=>[Zo,"px","full","auto",Me,De,h],D=()=>[Ol,"none","subgrid",Me,De],P=()=>["auto",{span:["full",Ol,Me,De]},Me,De],I=()=>[Ol,"auto",Me,De],$=()=>["auto","min","max","fr",Me,De],M=()=>[Me,De,h],R=()=>["start","end","center","between","around","evenly","stretch","baseline"],F=()=>["start","end","center","stretch"],V=()=>[Me,De,h],H=()=>["px",...V()],L=()=>["px","auto",...V()],U=()=>[Zo,"auto","px","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",Me,De,h],W=()=>[e,Me,De],le=()=>[CS,Pl],ve=()=>["","none","full",f,Me,De],B=()=>["",St,Of,Pl],G=()=>["solid","dashed","dotted","double"],ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>["","none",b,Me,De],_e=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Me,De],Ee=()=>["none",St,Me,De],we=()=>["none",St,Me,De],ye=()=>[St,Me,De],ee=()=>[Zo,"full","px",Me,De,h];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Xi],breakpoint:[Xi],color:[DF],container:[Xi],"drop-shadow":[Xi],ease:["in","out","in-out"],font:[$F],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Xi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Xi],shadow:[Xi],spacing:[St],text:[Xi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Zo,De,Me,w]}],container:["container"],columns:[{columns:[St,De,Me,d]}],"break-after":[{"break-after":C()}],"break-before":[{"break-before":C()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...A(),De,Me]}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:T()}],"inset-x":[{"inset-x":T()}],"inset-y":[{"inset-y":T()}],start:[{start:T()}],end:[{end:T()}],top:[{top:T()}],right:[{right:T()}],bottom:[{bottom:T()}],left:[{left:T()}],visibility:["visible","invisible","collapse"],z:[{z:[Ol,"auto",Me,De]}],basis:[{basis:[Zo,"full","auto",Me,De,d,h]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[St,Zo,"auto","initial","none",De]}],grow:[{grow:["",St,Me,De]}],shrink:[{shrink:["",St,Me,De]}],order:[{order:[Ol,"first","last","none",Me,De]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:P()}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:P()}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":$()}],"auto-rows":[{"auto-rows":$()}],gap:[{gap:M()}],"gap-x":[{"gap-x":M()}],"gap-y":[{"gap-y":M()}],"justify-content":[{justify:[...R(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...R()]}],"align-items":[{items:[...F(),"baseline"]}],"align-self":[{self:["auto",...F(),"baseline"]}],"place-content":[{"place-content":R()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:H()}],px:[{px:H()}],py:[{py:H()}],ps:[{ps:H()}],pe:[{pe:H()}],pt:[{pt:H()}],pr:[{pr:H()}],pb:[{pb:H()}],pl:[{pl:H()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":V()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":V()}],"space-y-reverse":["space-y-reverse"],size:[{size:U()}],w:[{w:[d,"screen",...U()]}],"min-w":[{"min-w":[d,"screen","none",...U()]}],"max-w":[{"max-w":[d,"screen","none","prose",{screen:[c]},...U()]}],h:[{h:["screen",...U()]}],"min-h":[{"min-h":["screen","none",...U()]}],"max-h":[{"max-h":["screen",...U()]}],"font-size":[{text:["base",r,Of,Pl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Me,Wx]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",CS,De]}],"font-family":[{font:[qF,De,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Me,De]}],"line-clamp":[{"line-clamp":[St,"none",Me,Wx]}],leading:[{leading:[Me,De,l,h]}],"list-image":[{"list-image":["none",Me,De]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Me,De]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:W()}],"text-color":[{text:W()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:[St,"from-font","auto",Me,Pl]}],"text-decoration-color":[{decoration:W()}],"underline-offset":[{"underline-offset":[St,"auto",Me,De]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:["px",...V()]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Me,De]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Me,De]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...A(),FF,zF]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",HF,LF]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ol,Me,De],radial:["",Me,De],conic:[Ol,Me,De]},VF,BF]}],"bg-color":[{bg:W()}],"gradient-from-pos":[{from:le()}],"gradient-via-pos":[{via:le()}],"gradient-to-pos":[{to:le()}],"gradient-from":[{from:W()}],"gradient-via":[{via:W()}],"gradient-to":[{to:W()}],rounded:[{rounded:ve()}],"rounded-s":[{"rounded-s":ve()}],"rounded-e":[{"rounded-e":ve()}],"rounded-t":[{"rounded-t":ve()}],"rounded-r":[{"rounded-r":ve()}],"rounded-b":[{"rounded-b":ve()}],"rounded-l":[{"rounded-l":ve()}],"rounded-ss":[{"rounded-ss":ve()}],"rounded-se":[{"rounded-se":ve()}],"rounded-ee":[{"rounded-ee":ve()}],"rounded-es":[{"rounded-es":ve()}],"rounded-tl":[{"rounded-tl":ve()}],"rounded-tr":[{"rounded-tr":ve()}],"rounded-br":[{"rounded-br":ve()}],"rounded-bl":[{"rounded-bl":ve()}],"border-w":[{border:B()}],"border-w-x":[{"border-x":B()}],"border-w-y":[{"border-y":B()}],"border-w-s":[{"border-s":B()}],"border-w-e":[{"border-e":B()}],"border-w-t":[{"border-t":B()}],"border-w-r":[{"border-r":B()}],"border-w-b":[{"border-b":B()}],"border-w-l":[{"border-l":B()}],"divide-x":[{"divide-x":B()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":B()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...G(),"hidden","none"]}],"divide-style":[{divide:[...G(),"hidden","none"]}],"border-color":[{border:W()}],"border-color-x":[{"border-x":W()}],"border-color-y":[{"border-y":W()}],"border-color-s":[{"border-s":W()}],"border-color-e":[{"border-e":W()}],"border-color-t":[{"border-t":W()}],"border-color-r":[{"border-r":W()}],"border-color-b":[{"border-b":W()}],"border-color-l":[{"border-l":W()}],"divide-color":[{divide:W()}],"outline-style":[{outline:[...G(),"none","hidden"]}],"outline-offset":[{"outline-offset":[St,Me,De]}],"outline-w":[{outline:["",St,Of,Pl]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",m,WF,UF]}],"shadow-color":[{shadow:W()}],"inset-shadow":[{"inset-shadow":["none",Me,De,g]}],"inset-shadow-color":[{"inset-shadow":W()}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:W()}],"ring-offset-w":[{"ring-offset":[St,Pl]}],"ring-offset-color":[{"ring-offset":W()}],"inset-ring-w":[{"inset-ring":B()}],"inset-ring-color":[{"inset-ring":W()}],opacity:[{opacity:[St,Me,De]}],"mix-blend":[{"mix-blend":[...ie(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ie()}],filter:[{filter:["","none",Me,De]}],blur:[{blur:he()}],brightness:[{brightness:[St,Me,De]}],contrast:[{contrast:[St,Me,De]}],"drop-shadow":[{"drop-shadow":["","none",x,Me,De]}],grayscale:[{grayscale:["",St,Me,De]}],"hue-rotate":[{"hue-rotate":[St,Me,De]}],invert:[{invert:["",St,Me,De]}],saturate:[{saturate:[St,Me,De]}],sepia:[{sepia:["",St,Me,De]}],"backdrop-filter":[{"backdrop-filter":["","none",Me,De]}],"backdrop-blur":[{"backdrop-blur":he()}],"backdrop-brightness":[{"backdrop-brightness":[St,Me,De]}],"backdrop-contrast":[{"backdrop-contrast":[St,Me,De]}],"backdrop-grayscale":[{"backdrop-grayscale":["",St,Me,De]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[St,Me,De]}],"backdrop-invert":[{"backdrop-invert":["",St,Me,De]}],"backdrop-opacity":[{"backdrop-opacity":[St,Me,De]}],"backdrop-saturate":[{"backdrop-saturate":[St,Me,De]}],"backdrop-sepia":[{"backdrop-sepia":["",St,Me,De]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":V()}],"border-spacing-x":[{"border-spacing-x":V()}],"border-spacing-y":[{"border-spacing-y":V()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Me,De]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[St,"initial",Me,De]}],ease:[{ease:["linear","initial",_,Me,De]}],delay:[{delay:[St,Me,De]}],animate:[{animate:["none",N,Me,De]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[j,Me,De]}],"perspective-origin":[{"perspective-origin":_e()}],rotate:[{rotate:Ee()}],"rotate-x":[{"rotate-x":Ee()}],"rotate-y":[{"rotate-y":Ee()}],"rotate-z":[{"rotate-z":Ee()}],scale:[{scale:we()}],"scale-x":[{"scale-x":we()}],"scale-y":[{"scale-y":we()}],"scale-z":[{"scale-z":we()}],"scale-3d":["scale-3d"],skew:[{skew:ye()}],"skew-x":[{"skew-x":ye()}],"skew-y":[{"skew-y":ye()}],transform:[{transform:[Me,De,"","none","gpu","cpu"]}],"transform-origin":[{origin:_e()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ee()}],"translate-x":[{"translate-x":ee()}],"translate-y":[{"translate-y":ee()}],"translate-z":[{"translate-z":ee()}],"translate-none":["translate-none"],accent:[{accent:W()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:W()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Me,De]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Me,De]}],fill:[{fill:["none",...W()]}],"stroke-w":[{stroke:[St,Of,Pl,Wx]}],stroke:[{stroke:["none",...W()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},QF=(e,{cacheSize:t,prefix:r,experimentalParseClassName:n,extend:a={},override:l={}})=>(tu(e,"cacheSize",t),tu(e,"prefix",r),tu(e,"experimentalParseClassName",n),Pf(e.theme,l.theme),Pf(e.classGroups,l.classGroups),Pf(e.conflictingClassGroups,l.conflictingClassGroups),Pf(e.conflictingClassGroupModifiers,l.conflictingClassGroupModifiers),tu(e,"orderSensitiveModifiers",l.orderSensitiveModifiers),Df(e.theme,a.theme),Df(e.classGroups,a.classGroups),Df(e.conflictingClassGroups,a.conflictingClassGroups),Df(e.conflictingClassGroupModifiers,a.conflictingClassGroupModifiers),kT(e,a,"orderSensitiveModifiers"),e),tu=(e,t,r)=>{r!==void 0&&(e[t]=r)},Pf=(e,t)=>{if(t)for(const r in t)tu(e,r,t[r])},Df=(e,t)=>{if(t)for(const r in t)kT(e,t,r)},kT=(e,t,r)=>{const n=t[r];n!==void 0&&(e[r]=e[r]?e[r].concat(n):n)},ZF=(e,...t)=>typeof e=="function"?SS(ES,e,...t):SS(()=>QF(ES(),e),...t),AS=new Map;function Gn(...e){const t=mT(),r=pT(),n=`${t}.${r}`,a=AS.get(n);if(a)return a(...e);const l=ZF({extend:{classGroups:{"bg-image":["bg-arrow-down-icon","bg-check-icon","bg-dash-icon","bg-dot-icon"],shadow:["shadow-sm-light"]}},prefix:t});return AS.set(n,l),l(...e)}function NT(...e){return eH(()=>tH(...e),e)}function eH(e,t){const r=v.useRef(),n=v.useRef();return(!r.current||!ry(r.current,t))&&(r.current=t,n.current=e()),n.current}function tH([e,...t],r,n){const a=hF(),l=mT(),c=pT(),d=t!=null&&t.length?t==null?void 0:t.filter(x=>x!==void 0):void 0,h=r!=null&&r.length?r==null?void 0:r.filter(x=>x!==void 0):void 0,f=n!=null&&n.length?n==null?void 0:n.filter(x=>x!==void 0):void 0,m=h!=null&&h.length||a===!1||c===4||l?a0(e):e;if(h!=null&&h.length){const x=iy(m,!1);let b=!1;for(const j of h)j&&(b=!0),rH(x,j);b&&sH(m,x)}let g=m;if(d!=null&&d.length&&(g=fF(Gn)(m,...d)),f!=null&&f.length&&(d!=null&&d.length)){const x=iy(m,"merge");let b=!1;for(const j of f)j!=="merge"&&(b=!0),nH(x,j);b&&aH(g,iF(m,...t),x)}return g}function rH(e,t){function r(n,a){if(typeof a=="boolean")if(typeof n=="object"&&n!==null)for(const l in n)n[l]=r(n[l],a);else return a;if(typeof a=="object"&&a!==null)for(const l in a)n[l]=r(n[l],a[l]);return n}r(e,t)}function nH(e,t){function r(n,a){if(typeof a=="string")if(typeof n=="object"&&n!==null)for(const l in n)n[l]=r(n[l],a);else return a;if(typeof a=="object"&&a!==null)for(const l in a)n[l]=r(n[l],a[l]);return n}r(e,t)}function sH(e,t){function r(n,a){if(a===!0)if(typeof n=="object"&&n!==null)for(const l in n)n[l]=r(n[l],a);else return"";if(typeof a=="object"&&a!==null)for(const l in a)n[l]=r(n[l],a[l]);return n}r(e,t)}function aH(e,t,r){function n(a,l,c){if(c==="replace")if(typeof a=="object"&&a!==null)for(const d in a)a[d]=n(a[d],l[d],c);else return l;if(typeof c=="object"&&c!==null)for(const d in c)a[d]=n(a[d],l[d],c[d]);return a}n(e,t,r)}function iy(e,t){if(e===null||typeof e!="object")return t;const r={};for(const n in e)r[n]=iy(e[n],t);return r}const iH=v.createContext(void 0);function ST(){return v.useContext(iH)??{}}var Dm=_E();const CT=vs(Dm),ET=v.forwardRef((e,t)=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",stroke:"currentColor",strokeWidth:0,viewBox:"0 0 20 20",ref:t,...e,children:s.jsx("path",{fillRule:"evenodd",stroke:"none",d:"M9.707 16.707a1 1 0 0 1-1.414 0l-6-6a1 1 0 0 1 0-1.414l6-6a1 1 0 0 1 1.414 1.414L5.414 9H17a1 1 0 1 1 0 2H5.414l4.293 4.293a1 1 0 0 1 0 1.414z",clipRule:"evenodd"})}));ET.displayName="ArrowLeftIcon";const AT=v.forwardRef((e,t)=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",stroke:"currentColor",strokeWidth:0,viewBox:"0 0 20 20",ref:t,...e,children:s.jsx("path",{fillRule:"evenodd",stroke:"none",d:"M10.293 3.293a1 1 0 0 1 1.414 0l6 6a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414-1.414L14.586 11H3a1 1 0 1 1 0-2h11.586l-4.293-4.293a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})}));AT.displayName="ArrowRightIcon";const TT=v.forwardRef((e,t)=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",stroke:"currentColor",strokeWidth:0,viewBox:"0 0 20 20",ref:t,...e,children:s.jsx("path",{fillRule:"evenodd",stroke:"none",d:"M6 2a1 1 0 0 0-1 1v1H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1V3a1 1 0 1 0-2 0v1H7V3a1 1 0 0 0-1-1zm0 5a1 1 0 0 0 0 2h8a1 1 0 1 0 0-2H6z",clipRule:"evenodd"})}));TT.displayName="CalendarIcon";const lH={base:"flex",addon:"inline-flex items-center rounded-l-md border border-r-0 border-gray-300 bg-gray-200 px-3 text-sm text-gray-900 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400",field:{base:"relative w-full",icon:{base:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",svg:"h-5 w-5 text-gray-500 dark:text-gray-400"},rightIcon:{base:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",svg:"h-5 w-5 text-gray-500 dark:text-gray-400"},input:{base:"block w-full border focus:outline-none focus:ring-1 disabled:cursor-not-allowed disabled:opacity-50",sizes:{sm:"p-2 sm:text-xs",md:"p-2.5 text-sm",lg:"p-4 sm:text-base"},colors:{gray:"border-gray-300 bg-gray-50 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-primary-500 dark:focus:ring-primary-500",info:"border-cyan-500 bg-cyan-50 text-cyan-900 placeholder-cyan-700 focus:border-cyan-500 focus:ring-cyan-500 dark:border-cyan-400 dark:bg-cyan-100 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",failure:"border-red-500 bg-red-50 text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:bg-red-100 dark:focus:border-red-500 dark:focus:ring-red-500",warning:"border-yellow-500 bg-yellow-50 text-yellow-900 placeholder-yellow-700 focus:border-yellow-500 focus:ring-yellow-500 dark:border-yellow-400 dark:bg-yellow-100 dark:focus:border-yellow-500 dark:focus:ring-yellow-500",success:"border-green-500 bg-green-50 text-green-900 placeholder-green-700 focus:border-green-500 focus:ring-green-500 dark:border-green-400 dark:bg-green-100 dark:focus:border-green-500 dark:focus:ring-green-500"},withRightIcon:{on:"pr-10",off:""},withIcon:{on:"pl-10",off:""},withAddon:{on:"rounded-r-lg",off:"rounded-lg"},withShadow:{on:"shadow-sm dark:shadow-sm-light",off:""}}}},OT=v.forwardRef((e,t)=>{var b,j;const r=ST(),n=NT([lH,(b=r.theme)==null?void 0:b.textInput,e.theme],[E0(r.clearTheme,"textInput"),e.clearTheme],[E0(r.applyTheme,"textInput"),e.applyTheme]),{addon:a,className:l,color:c="gray",icon:d,rightIcon:h,shadow:f,sizing:m="md",type:g="text",...x}=dT(e,(j=r.props)==null?void 0:j.textInput);return s.jsxs("div",{className:Gn(n.base,l),children:[a&&s.jsx("span",{className:n.addon,children:a}),s.jsxs("div",{className:n.field.base,children:[d&&s.jsx("div",{className:n.field.icon.base,children:s.jsx(d,{className:n.field.icon.svg})}),h&&s.jsx("div",{"data-testid":"right-icon",className:n.field.rightIcon.base,children:s.jsx(h,{className:n.field.rightIcon.svg})}),s.jsx("input",{className:Gn(n.field.input.base,n.field.input.colors[c],n.field.input.sizes[m],n.field.input.withIcon[d?"on":"off"],n.field.input.withRightIcon[h?"on":"off"],n.field.input.withAddon[a?"on":"off"],n.field.input.withShadow[f?"on":"off"]),type:g,...x,ref:t})]})]})});OT.displayName="TextInput";const PT=v.createContext(void 0);function Mm(){const e=v.useContext(PT);if(!e)throw new Error("useDatePickerContext should be used within the DatePickerContext provider!");return e}var Qt=(e=>(e[e.Days=0]="Days",e[e.Months=1]="Months",e[e.Years=2]="Years",e[e.Decades=3]="Decades",e))(Qt||{}),DT=(e=>(e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday",e))(DT||{});function Nc(e,t,r){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime();if(t&&r){const a=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),l=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return n>=a&&n<=l}if(t){const a=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();return n>=a}if(r){const a=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return n<=a}return!0}function Sc(e,t){return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e.getTime()===t.getTime()}function oH(e){return Sc(e,new Date)}function Mf(e,t,r){return Nc(e,t,r)||(t&&e<t?e=t:r&&e>r&&(e=r)),e}function cH(e,t){const r=new Date(e.getFullYear(),e.getMonth(),1);let a=r.getDay()-t;return a<0&&(a+=7),Bw(r,-a)}function dH(e,t){const r=[],n=new Date(0);n.setDate(n.getDate()-n.getDay()+t);const a=new Intl.DateTimeFormat(e,{weekday:"short"});for(let l=0;l<7;l++)r.push(a.format(Bw(n,l)));return r}function Bw(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r}function uH(e,t){const r=new Date(e);return r.setMonth(r.getMonth()+t),r}function lc(e,t){const r=new Date(e);return r.setFullYear(r.getFullYear()+t),r}function oc(e,t,r){let n={day:"numeric",month:"long",year:"numeric"};return r&&(n=r),new Intl.DateTimeFormat(e,n).format(t)}function cc(e,t){const r=e.getFullYear();return Math.floor(r/t)*t}function hH(e,t){const r=e.getFullYear(),n=t+9;return r>=t&&r<=n}const fH={root:{base:"relative"},popup:{root:{base:"absolute top-10 z-50 block pt-2",inline:"relative top-0 z-auto",inner:"inline-block rounded-lg bg-white p-4 shadow-lg dark:bg-gray-700"},header:{base:"",title:"px-2 py-3 text-center font-semibold text-gray-900 dark:text-white",selectors:{base:"mb-2 flex justify-between",button:{base:"rounded-lg bg-white px-5 py-2.5 text-sm font-semibold text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",prev:"",next:"",view:""}}},view:{base:"p-1"},footer:{base:"mt-2 flex space-x-2",button:{base:"w-full rounded-lg px-5 py-2 text-center text-sm font-medium focus:ring-4 focus:ring-primary-300",today:"bg-primary-700 text-white hover:bg-primary-800 dark:bg-primary-600 dark:hover:bg-primary-700",clear:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600"}}},views:{days:{header:{base:"mb-1 grid grid-cols-7",title:"h-6 text-center text-sm font-medium leading-6 text-gray-500 dark:text-gray-400"},items:{base:"grid w-64 grid-cols-7",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-primary-700 text-white hover:bg-primary-600",disabled:"text-gray-500",today:""}}},months:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-primary-700 text-white hover:bg-primary-600",disabled:"text-gray-500"}}},years:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-primary-700 text-white hover:bg-primary-600",disabled:"text-gray-500"}}},decades:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-primary-700 text-white hover:bg-primary-600",disabled:"text-gray-500"}}}}};function MT(){const{theme:e,weekStart:t,minDate:r,maxDate:n,filterDate:a,viewDate:l,selectedDate:c,changeSelectedDate:d,language:h}=Mm(),f=e.views.days,m=dH(h,t),g=cH(l,t);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:f.header.base,children:m.map((x,b)=>s.jsx("span",{className:f.header.title,children:x},b))}),s.jsx("div",{className:f.items.base,children:[...Array(42)].map((x,b)=>{const j=Bw(g,b),w=oc(h,j,{day:"numeric"}),_=c&&Sc(c,j),N=!Nc(j,r,n)||a&&!a(j,Qt.Days),C=oH(j);return s.jsx("button",{disabled:N,type:"button",className:Gn(f.items.item.base,C&&f.items.item.today,_&&f.items.item.selected,N&&f.items.item.disabled),onClick:()=>{N||d(j,!0)},children:w},b)})})]})}MT.displayName="DatepickerViewsDays";function RT(){const{theme:e,viewDate:t,selectedDate:r,minDate:n,maxDate:a,filterDate:l,setViewDate:c,setView:d}=Mm(),h=e.views.decades,f=cc(t,100);return s.jsx("div",{className:h.items.base,children:[...Array(12)].map((m,g)=>{const x=f-10+g*10,b=new Date(t.getTime());b.setFullYear(x+t.getFullYear()%10);const j=new Date(x,0,1),w=lc(j,9),_=r&&hH(r,x),N=!Nc(j,n,a)&&!Nc(w,n,a)||l&&!l(b,Qt.Decades);return s.jsx("button",{disabled:N,type:"button",className:Gn(h.items.item.base,_&&h.items.item.selected,N&&h.items.item.disabled),onClick:()=>{N||(r&&c(lc(t,x-r.getFullYear())),d(Qt.Years))},children:x},g)})})}RT.displayName="DatepickerViewsDecades";function IT(){const{theme:e,minDate:t,maxDate:r,filterDate:n,selectedDate:a,viewDate:l,language:c,setViewDate:d,setView:h}=Mm(),f=e.views.months;return s.jsx("div",{className:f.items.base,children:[...Array(12)].map((m,g)=>{const x=new Date;x.setMonth(g,1),x.setFullYear(l.getFullYear());const b=oc(c,x,{month:"short"}),j=a&&Sc(a,x),w=!Nc(x,t,r)||n&&!n(x,Qt.Months);return s.jsx("button",{disabled:w,type:"button",className:Gn(f.items.item.base,j&&f.items.item.selected,w&&f.items.item.disabled),onClick:()=>{w||(d(x),h(Qt.Days))},children:b},g)})})}IT.displayName="DatepickerViewsMonth";function $T(){const{theme:e,selectedDate:t,minDate:r,maxDate:n,filterDate:a,viewDate:l,setViewDate:c,setView:d}=Mm(),h=e.views.years;return s.jsx("div",{className:h.items.base,children:[...Array(12)].map((f,m)=>{const x=cc(l,10)+m,b=new Date(l.getTime());b.setFullYear(x);const j=t&&Sc(t,b),w=!Nc(b,r,n)||a&&!a(b,Qt.Years);return s.jsx("button",{disabled:w,type:"button",className:Gn(h.items.item.base,j&&h.items.item.selected,w&&h.items.item.disabled),onClick:()=>{w||(c(b),d(Qt.Months))},children:x},m)})})}$T.displayName="DatepickerViewsYears";const LT=v.forwardRef((e,t)=>{var Ee,we;const r=ST(),n=NT([fH,(Ee=r.theme)==null?void 0:Ee.datepicker,e.theme],[E0(r.clearTheme,"datepicker"),e.clearTheme],[E0(r.applyTheme,"datepicker"),e.applyTheme]),{title:a,open:l,inline:c=!1,autoHide:d=!0,showClearButton:h=!0,labelClearButton:f="Clear",showTodayButton:m=!0,labelTodayButton:g="Today",defaultValue:x,minDate:b,maxDate:j,filterDate:w,language:_="en",weekStart:N=DT.Sunday,className:C,onChange:A,label:E,value:S,...T}=dT(e,(we=r.props)==null?void 0:we.datepicker),D=x?Mf(x,b,j):null,P=v.useMemo(()=>x?Mf(x,b,j):new Date,[]),[I,$]=v.useState(l),[M,R]=v.useState(Qt.Days),[F,V]=v.useState(S??D),[H,L]=v.useState(S??P),U=v.useRef(null),W=v.useRef(null);function le(ye,ee){V(ye),(ye===null||ye)&&A&&A(ye),d&&M===Qt.Days&&ee==!0&&!c&&$(!1)}function ve(){le(D,!0),x&&L(x)}v.useImperativeHandle(t,()=>({focus(){var ye;(ye=U.current)==null||ye.focus()},clear(){ve()}}));function B(ye){switch(ye){case Qt.Decades:return s.jsx(RT,{});case Qt.Years:return s.jsx($T,{});case Qt.Months:return s.jsx(IT,{});case Qt.Days:default:return s.jsx(MT,{})}}function G(){switch(M){case Qt.Days:return Qt.Months;case Qt.Months:return Qt.Years;case Qt.Years:return Qt.Decades}return M}function ie(){switch(M){case Qt.Decades:return`${cc(H,100)-10} - ${cc(H,100)+100}`;case Qt.Years:return`${cc(H,10)} - ${cc(H,10)+11}`;case Qt.Months:return oc(_,H,{year:"numeric"});case Qt.Days:default:return oc(_,H,{month:"long",year:"numeric"})}}function he(ye,ee,ke){switch(ye){case Qt.Days:return new Date(uH(ee,ke));case Qt.Months:return new Date(lc(ee,ke));case Qt.Years:return new Date(lc(ee,ke*10));case Qt.Decades:return new Date(lc(ee,ke*100));default:return new Date(lc(ee,ke*10))}}v.useEffect(()=>{const ye=ee=>{var J,Le;const ke=(J=W==null?void 0:W.current)==null?void 0:J.contains(ee.target),Te=(Le=U==null?void 0:U.current)==null?void 0:Le.contains(ee.target);!ke&&!Te&&$(!1)};return document.addEventListener("mousedown",ye),()=>{document.removeEventListener("mousedown",ye)}},[U,W,$]),v.useEffect(()=>{const ye=S&&Mf(new Date(S),b,j),ee=F&&Mf(new Date(F),b,j);ee&&ye&&!Sc(ye,ee)&&V(ye),F==null&&V(D)},[S,V,L,F]);const _e=S===null?E:oc(_,F||new Date);return s.jsx(PT.Provider,{value:{theme:n,language:_,minDate:b,maxDate:j,filterDate:w,weekStart:N,isOpen:I,setIsOpen:$,view:M,setView:R,viewDate:H,setViewDate:L,selectedDate:F,setSelectedDate:V,changeSelectedDate:le},children:s.jsxs("div",{className:Gn(n.root.base,C),children:[!c&&s.jsx(OT,{theme:n.root.input,icon:TT,ref:U,onFocus:()=>{F&&!Sc(H,F)&&L(F),$(!0)},value:_e,defaultValue:D?oc(_,D):E,readOnly:!0,...T}),(I||c)&&s.jsx("div",{ref:W,className:Gn(n.popup.root.base,c&&n.popup.root.inline),children:s.jsxs("div",{className:n.popup.root.inner,children:[s.jsxs("div",{className:n.popup.header.base,children:[a&&s.jsx("div",{className:n.popup.header.title,children:a}),s.jsxs("div",{className:n.popup.header.selectors.base,children:[s.jsx("button",{type:"button",className:Gn(n.popup.header.selectors.button.base,n.popup.header.selectors.button.prev),onClick:()=>L(he(M,H,-1)),children:s.jsx(ET,{})}),s.jsx("button",{type:"button",className:Gn(n.popup.header.selectors.button.base,n.popup.header.selectors.button.view),onClick:()=>R(G()),children:ie()}),s.jsx("button",{type:"button",className:Gn(n.popup.header.selectors.button.base,n.popup.header.selectors.button.next),onClick:()=>L(he(M,H,1)),children:s.jsx(AT,{})})]})]}),s.jsx("div",{className:n.popup.view.base,children:B(M)}),(h||m)&&s.jsxs("div",{className:n.popup.footer.base,children:[m&&s.jsx("button",{type:"button",className:Gn(n.popup.footer.button.base,n.popup.footer.button.today),onClick:()=>{const ye=new Date;le(ye,!0),L(ye)},children:g}),h&&s.jsx("button",{type:"button",className:Gn(n.popup.footer.button.base,n.popup.footer.button.clear),onClick:()=>{le(null,!0)},children:f})]})]})})]})})});LT.displayName="Datepicker";const zT=({value:e,onChange:t,minDate:r,maxDate:n,label:a,showTime:l=!1,className:c=""})=>{const[d,h]=Ur.useState("12:00"),[f,m]=Ur.useState(!1),[g,x]=Ur.useState(!1);Ur.useEffect(()=>{},[g,f]),Ur.useEffect(()=>{if(e){const C=e.getHours().toString().padStart(2,"0"),A=e.getMinutes().toString().padStart(2,"0");h(`${C}:${A}`)}},[e]);const b=C=>{if(C){if(l){const[A,E]=d.split(":").map(Number);C.setHours(A,E,0,0)}t(C),x(!1)}},j=Ur.useMemo(()=>{const C=[];let A=0;e&&r&&e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth()&&e.getDate()===r.getDate()&&(A=r.getHours()*60+r.getMinutes());for(let E=0;E<24;E++)for(let S=0;S<60;S+=30)E*60+S>=A&&C.push(`${E.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`);return C},[e,r]),w=C=>C?C.toLocaleDateString("he-IL",{day:"numeric",month:"long",year:"numeric"}):" ",_={root:{base:"relative w-full"},popup:{root:{base:"block",inline:"relative top-0 z-auto",inner:"inline-block rounded-xl bg-white p-4 shadow-xl dark:bg-slate-800 w-full max-w-[320px] mx-auto"},header:{base:"",title:"px-2 py-2 text-center font-bold text-lg text-slate-900 dark:text-white mb-2",selectors:{base:"mb-4 flex justify-between items-center rtl:flex-row-reverse",button:{base:"rounded-lg bg-white dark:bg-slate-700 px-3 py-1.5 text-sm font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors border border-slate-200 dark:border-slate-600 shadow-sm",prev:"rotate-0",next:"rotate-0",view:""}}},view:{base:"p-1"},footer:{base:"mt-4 flex gap-2 rtl:flex-row-reverse",button:{base:"flex-1 rounded-lg px-4 py-2 text-center text-sm font-semibold transition-colors shadow-sm",today:"bg-brand-600 text-white hover:bg-brand-700",clear:"border border-slate-300 bg-white text-slate-700 hover:bg-slate-100 dark:border-slate-600 dark:bg-slate-700 dark:text-white dark:hover:bg-slate-600"}}},views:{days:{header:{base:"mb-2 grid grid-cols-7 rtl:flex-row-reverse",title:"h-6 text-center text-xs font-bold text-slate-500 dark:text-slate-400 flex items-center justify-center"},items:{base:"grid grid-cols-7 gap-1",item:{base:"flex items-center justify-center w-full aspect-square rounded-full border-0 text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 transition-colors",selected:"bg-brand-600 text-white hover:bg-brand-600 shadow-md",disabled:"text-slate-300 dark:text-slate-600 cursor-not-allowed hover:bg-transparent"}}},months:{items:{base:"grid grid-cols-4 gap-2",item:{base:"flex items-center justify-center w-full h-12 cursor-pointer rounded-lg border-0 text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 transition-colors",selected:"bg-brand-600 text-white hover:bg-brand-600",disabled:"text-slate-300 dark:text-slate-600"}}},years:{items:{base:"grid grid-cols-4 gap-2",item:{base:"flex items-center justify-center w-full h-12 cursor-pointer rounded-lg border-0 text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 transition-colors",selected:"bg-brand-600 text-white hover:bg-brand-600",disabled:"text-slate-300 dark:text-slate-600"}}},decades:{items:{base:"grid grid-cols-4 gap-2",item:{base:"flex items-center justify-center w-full h-12 cursor-pointer rounded-lg border-0 text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 transition-colors",selected:"bg-brand-600 text-white hover:bg-brand-600",disabled:"text-slate-300 dark:text-slate-600"}}}}},N="w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-3 text-sm text-slate-900 dark:text-white flex items-center gap-3 hover:border-brand-300 dark:hover:border-brand-600 transition-colors cursor-pointer shadow-sm";return s.jsxs("div",{className:`flex flex-col gap-2 ${c}`,dir:"rtl",children:[a&&s.jsxs("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[s.jsx(wn,{className:"w-4 h-4 text-brand-500"}),a]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 relative",children:[l&&s.jsxs("div",{className:"relative w-full sm:w-[130px] shrink-0",children:[s.jsxs("button",{type:"button",onClick:()=>m(!f),className:N,children:[s.jsx(Pr,{className:"w-4 h-4 text-slate-400 shrink-0"}),s.jsx("span",{className:"font-medium flex-1 text-center",children:d}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 shrink-0 transition-transform ${f?"rotate-180":""}`})]}),f&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>m(!1)}),s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 z-50 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl max-h-52 overflow-y-auto w-full",children:j.map(C=>s.jsx("button",{type:"button",onClick:()=>{if(h(C),m(!1),e){const A=new Date(e),[E,S]=C.split(":").map(Number);A.setHours(E,S,0,0),t(A)}},className:`w-full px-4 py-2.5 text-sm text-center transition-colors ${C===d?"bg-brand-50 dark:bg-brand-900/30 text-brand-600 dark:text-brand-400 font-semibold":"text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:C},C))})]})]}),s.jsxs("div",{className:"relative flex-1 min-w-0 w-full",children:[s.jsxs("button",{type:"button",onClick:()=>x(!g),className:N,children:[s.jsx(wn,{className:"w-4 h-4 text-slate-400 shrink-0"}),s.jsx("span",{className:"font-medium flex-1 text-center",children:w(e)}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 shrink-0 transition-transform ${g?"rotate-180":""}`})]}),g&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40 bg-transparent",onClick:()=>x(!1),onScroll:C=>C.stopPropagation()}),s.jsx("div",{className:"absolute top-full right-0 left-0 sm:left-auto sm:right-auto sm:rtl:right-0 mt-2 z-50 flex justify-center sm:block",children:s.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl overflow-hidden w-full max-w-[320px]",onClick:C=>C.stopPropagation(),children:s.jsx(LT,{inline:!0,value:e,onChange:b,minDate:r,maxDate:n,language:"he-IL",labelTodayButton:"",labelClearButton:"",weekStart:0,theme:_})})})]})]})]})]})},mH=({leadName:e,leadId:t,callDuration:r,transcripts:n,coachingTips:a=[]})=>{var Te;const{showSummaryModal:l,dismissSummaryModal:c,summaryStatus:d,callSummary:h,callSessionId:f,smartQueue:m,dialNextLead:g}=Pm(),[x,b]=v.useState("summary"),[j,w]=v.useState(null),[_,N]=v.useState(()=>{const J=new Date;return J.setDate(J.getDate()+1),J.setHours(10,0,0,0),J}),[C,A]=v.useState(""),[E,S]=v.useState(""),[T,D]=v.useState(!1),[P,I]=v.useState(!1),[$,M]=v.useState(!1),[R,F]=v.useState(null),[V,H]=v.useState(!1),[L,U]=v.useState(!1),[W,le]=v.useState(null),[ve,B]=v.useState(!1),G=v.useRef(null),[ie,he]=v.useState(e);v.useEffect(()=>{if(l){w(null),A(""),S(""),D(!1),I(!1),F(null),H(!1),U(!1),he(e);const J=new Date;J.setDate(J.getDate()+1),J.setHours(10,0,0,0),N(J)}},[l]),v.useEffect(()=>{h!=null&&h.deal_amount&&typeof h.deal_amount=="number"&&F(h.deal_amount)},[h]),v.useEffect(()=>{(async()=>{if(t&&l){const{data:Le,error:$e}=await ge.from("leads").select("name").eq("id",t).single();Le!=null&&Le.name&&!$e&&he(Le.name)}})()},[t,l]),v.useEffect(()=>{(async()=>{if(f&&l){const{data:Le,error:$e}=await ge.from("calls").select("recording_url").eq("recording_url",`sid:${f}`).or("recording_url.ilike.https%").single();!$e&&(Le!=null&&Le.recording_url)&&Le.recording_url.startsWith("https")&&le(Le.recording_url)}})()},[f,l]);const _e=()=>{G.current&&(ve?G.current.pause():G.current.play(),B(!ve))};if(!l)return null;const Ee=J=>{const Le=Math.floor(J/60),$e=J%60;return`${Le.toString().padStart(2,"0")}:${$e.toString().padStart(2,"0")}`},we=[{id:"deal_closed",label:" ",icon:Ct,color:"bg-emerald-100 text-emerald-700 border-emerald-300 dark:bg-emerald-900/30 dark:text-emerald-400"},{id:"follow_up",label:" ",icon:Pr,color:"bg-blue-100 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-400"},{id:"not_relevant",label:" ",icon:A2,color:"bg-rose-100 text-rose-600 border-rose-300 dark:bg-rose-900/30 dark:text-rose-400"}],ye=J=>{w(J),D(J==="follow_up"),I(J==="not_relevant")},ee=async()=>{if(j){M(!0),console.log("[Summary] Saving outcome:",j,{followUpDate:_,followUpNotes:C,callSessionId:f,leadId:t,dealAmount:R});try{const J=await fetch(`/api/leads/${t}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:j,followUpAt:_?_.toISOString():null,notes:j==="not_relevant"?E:C||null,callSessionId:f,summaryJson:h,dealAmount:R})});J.ok?console.log("[Activity] inserted:",{type:j,leadId:t,dealAmount:R}):console.error("[Summary] Failed to save:",await J.text())}catch(J){console.error("[Summary] Save error:",J)}M(!1),c()}},ke=async()=>{if(j){M(!0),console.log("[Summary] Saving outcome and dialing next:",j,{dealAmount:R});try{const J=await fetch(`/api/leads/${t}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:j,followUpAt:_?_.toISOString():null,notes:j==="not_relevant"?E:C||null,callSessionId:f,summaryJson:h,dealAmount:R})});J.ok?console.log("[Activity] inserted:",{type:j,leadId:t,dealAmount:R}):console.error("[Summary] Failed to save:",await J.text())}catch(J){console.error("[Summary] Save error:",J)}M(!1),await g()}};return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity",onClick:c}),s.jsxs("div",{className:"relative w-full max-w-2xl bg-white dark:bg-slate-950 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-300 border border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-5 border-b border-slate-100 dark:border-slate-800 flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[s.jsx(Ct,{className:"w-6 h-6 text-emerald-500"})," "]}),s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:[" ",ie,"  ",Ee(r)," "]})]}),d==="ready"&&(h==null?void 0:h.score)&&s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:" AI"}),s.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 px-3 py-1 rounded-full shadow-sm",children:[s.jsx(Nr,{className:"w-3.5 h-3.5 text-brand-500 fill-brand-500"}),s.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:h.score}),s.jsx("span",{className:"text-xs text-slate-400",children:"/ 100"})]})]}),W&&s.jsxs("button",{onClick:_e,className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg hover:bg-emerald-100 dark:hover:bg-emerald-900/30 transition-colors",title:" ",children:[ve?s.jsx(Z$,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}):s.jsx(Kl,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),s.jsx(Av,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),s.jsx("span",{className:"text-xs font-medium text-emerald-700 dark:text-emerald-300",children:""})]}),s.jsx("audio",{ref:G,src:W||void 0,onEnded:()=>B(!1)}),s.jsx("button",{onClick:c,className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-800",children:[s.jsxs("button",{onClick:()=>b("summary"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${x==="summary"?"text-brand-600 border-b-2 border-brand-600 bg-brand-50/50 dark:bg-brand-900/10":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[s.jsx(Nr,{className:"w-4 h-4"}),""]}),((Te=h==null?void 0:h.key_moments)==null?void 0:Te.length)>0&&s.jsxs("button",{onClick:()=>b("moments"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${x==="moments"?"text-brand-600 border-b-2 border-brand-600 bg-brand-50/50 dark:bg-brand-900/10":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[s.jsx(vr,{className:"w-4 h-4"}),"  (",h.key_moments.length,")"]}),s.jsxs("button",{onClick:()=>b("transcript"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${x==="transcript"?"text-brand-600 border-b-2 border-brand-600 bg-brand-50/50 dark:bg-brand-900/10":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[s.jsx(Xn,{className:"w-4 h-4"})," (",n.length,")"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-5",children:[x==="summary"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-brand-500 to-purple-600 rounded-xl opacity-20 group-hover:opacity-30 transition duration-500 blur"}),s.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-xl p-4 border border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("label",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center gap-1.5 uppercase tracking-wide",children:[s.jsx(Nr,{className:"w-3 h-3"}),"  AI"]}),d==="generating"&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[s.jsx(it,{className:"w-3 h-3 animate-spin"})," ..."]})]}),d==="generating"?s.jsxs("div",{className:"space-y-2 animate-pulse",children:[s.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-full"}),s.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-5/6"}),s.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-4/6"})]}):d==="ready"&&(h!=null&&h.summary)?s.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed",children:h.summary}):s.jsx("p",{className:"text-sm text-slate-400 italic",children:"    "})]})]}),a.length>0&&s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-200 dark:border-slate-800",children:[s.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[s.jsx(al,{className:"w-4 h-4 text-amber-500"}),"  "]}),s.jsx("div",{className:"space-y-3",children:a.map((J,Le)=>s.jsxs("div",{k:Le,className:"flex gap-3 items-start relative animate-in slide-in-from-right-2 duration-300",style:{animationDelay:`${Le*100}ms`},children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${J.severity==="critical"?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400"}`,children:s.jsx(al,{className:"w-4 h-4"})}),s.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 text-sm shadow-sm flex-1",children:[s.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:J.message}),s.jsx("span",{className:"text-xs text-slate-400 mt-1 block",children:new Date(J.timestamp).toLocaleTimeString("he-IL",{minute:"2-digit",second:"2-digit"})})]})]}))})]}),d==="ready"&&(h==null?void 0:h.micro_lesson)&&s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-amber-400 to-orange-500 rounded-xl opacity-20 group-hover:opacity-30 transition duration-500 blur"}),s.jsxs("div",{className:"relative bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-xl p-4 border border-amber-200 dark:border-amber-800",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-amber-500 to-orange-500 rounded-lg flex items-center justify-center",children:s.jsx(Pu,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:h.micro_lesson.title}),s.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:[": ",h.micro_lesson.weak_area]})]})]}),s.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed mb-3",children:h.micro_lesson.tip}),h.micro_lesson.example_phrase&&s.jsxs("div",{className:"bg-white/70 dark:bg-slate-800/70 rounded-lg p-3 border border-amber-200/50 dark:border-amber-700/30",children:[s.jsx("span",{className:"text-xs font-bold text-amber-600 dark:text-amber-400 block mb-1",children:" :"}),s.jsxs("p",{className:"text-sm text-slate-800 dark:text-slate-200 italic",children:["",h.micro_lesson.example_phrase,""]})]}),V?s.jsxs("div",{className:"mt-3 w-full flex items-center justify-center gap-2 py-2.5 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 font-bold text-sm border border-emerald-200 dark:border-emerald-800",children:[s.jsx(Ct,{className:"w-4 h-4"}),"+10 XP!"]}):s.jsxs("button",{onClick:async()=>{U(!0);try{const{data:{session:J}}=await ge.auth.getSession(),Le=J==null?void 0:J.access_token,$e=await fetch(`/api/debrief/${f}/complete`,{method:"POST",headers:{"Content-Type":"application/json",...Le?{Authorization:`Bearer ${Le}`}:{}},body:"{}"}),ut=await $e.json();$e.ok&&ut.xpAwarded>0&&H(!0)}catch(J){console.error("[Debrief] XP error:",J)}U(!1)},disabled:L,className:"mt-3 w-full flex items-center justify-center gap-2 py-2.5 rounded-lg bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white font-bold text-sm transition-all shadow-md hover:shadow-lg",children:[L?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(sl,{className:"w-4 h-4"}),",  (+10 XP)"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-bold text-slate-900 dark:text-white mb-3 block",children:" ?"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:we.map(J=>s.jsxs("button",{onClick:()=>ye(J.id),className:`flex flex-col items-center gap-2 p-4 rounded-xl border-2 transition-all ${j===J.id?`${J.color} ring-2 ring-offset-2 ring-offset-white dark:ring-offset-slate-950 ring-brand-500`:"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300"}`,children:[s.jsx(J.icon,{className:"w-6 h-6"}),s.jsx("span",{className:"font-bold text-sm text-center",children:J.label})]},J.id))})]}),(R!==null||j==="deal_closed")&&s.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20 rounded-xl p-5 border border-emerald-200 dark:border-emerald-800 space-y-3 animate-in slide-in-from-top-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center",children:s.jsx(AE,{className:"w-4 h-4 text-white"})}),s.jsx("span",{className:"text-sm font-bold text-emerald-700 dark:text-emerald-300",children:" "}),(h==null?void 0:h.deal_amount)&&s.jsx("span",{className:"text-xs text-emerald-600 dark:text-emerald-400 bg-emerald-100 dark:bg-emerald-900/30 px-2 py-0.5 rounded-full",children:" "})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:R??"",onChange:J=>F(J.target.value?Number(J.target.value):null),placeholder:"  ...",className:"w-full rounded-xl border-2 border-emerald-200 dark:border-emerald-700 p-3 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition-all text-right placeholder:text-slate-400 text-lg font-semibold"}),s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:""})]}),s.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 flex items-start gap-1.5",children:[s.jsx(Nr,{className:"w-3.5 h-3.5 shrink-0 mt-0.5"}),s.jsx("span",{children:"         "})]})]}),T&&s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-5 border border-blue-200 dark:border-blue-800 space-y-4 animate-in slide-in-from-top-2 pb-64",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx(Pr,{className:"w-4 h-4 text-white"})}),s.jsx("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-300",children:"  "})]}),s.jsx(zT,{value:_,onChange:N,minDate:new Date,label:" ",showTime:!0}),s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 mb-2 block flex items-center gap-1.5",children:[s.jsx(ps,{className:"w-3.5 h-3.5"}),"  "]}),s.jsx("textarea",{value:C,onChange:J=>A(J.target.value),placeholder:" ?     ?  ...",rows:3,className:"w-full rounded-xl border-2 border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-right placeholder:text-slate-400 resize-none text-sm"})]})]}),P&&s.jsxs("div",{className:"bg-rose-50 dark:bg-rose-900/20 rounded-xl p-4 border border-rose-200 dark:border-rose-800 space-y-3 animate-in slide-in-from-top-2",children:[s.jsx("label",{className:"text-xs font-bold text-rose-600 dark:text-rose-400 mb-1.5 block",children:"  ?"}),s.jsxs("div",{className:"flex items-start gap-2 bg-white dark:bg-slate-800 border border-rose-200 dark:border-rose-700 rounded-lg px-3 py-2",children:[s.jsx(A2,{className:"w-4 h-4 text-rose-400 mt-0.5"}),s.jsx("textarea",{value:E,onChange:J=>S(J.target.value),placeholder:":   ,   ,  ...",rows:2,className:"bg-transparent border-none text-sm w-full outline-none text-slate-900 dark:text-white resize-none"})]})]})]}),x==="moments"&&(h==null?void 0:h.key_moments)&&s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"relative pr-4",children:[s.jsx("div",{className:"absolute right-1.5 top-0 bottom-0 w-0.5 bg-slate-200 dark:bg-slate-700"}),h.key_moments.map((J,Le)=>{const $e=J.impact==="positive",ut=$e?"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/40 dark:text-emerald-400 border-emerald-300 dark:border-emerald-700":"bg-rose-100 text-rose-600 dark:bg-rose-900/40 dark:text-rose-400 border-rose-300 dark:border-rose-700",yt=$e?"border-emerald-200 dark:border-emerald-800/50":"border-rose-200 dark:border-rose-800/50";return s.jsxs("div",{className:"relative flex gap-3 items-start mb-4 last:mb-0 animate-in slide-in-from-right-3 duration-300",style:{animationDelay:`${Le*120}ms`},children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 border ${ut} z-10`,children:$e?s.jsx(Lc,{className:"w-4 h-4"}):s.jsx(_n,{className:"w-4 h-4"})}),s.jsxs("div",{className:`flex-1 bg-white dark:bg-slate-900 rounded-xl p-3.5 border ${yt} shadow-sm`,children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${$e?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400"}`,children:J.type==="turning_point"?" ":J.type==="missed_opportunity"?" ":J.type==="objection_handled"?" ":J.type==="great_question"?" ":J.type})}),s.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed",children:J.description})]})]},Le)})]})}),x==="transcript"&&s.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:n.length===0?s.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"  "}):n.map(J=>s.jsxs("div",{className:`flex flex-col ${J.speaker==="agent"?"items-end":"items-start"}`,children:[s.jsx("span",{className:`text-xs font-bold uppercase tracking-wider mb-1 ${J.speaker==="agent"?"text-brand-600":"text-slate-500"}`,children:J.speaker==="agent"?"":""}),s.jsx("div",{className:`max-w-[85%] px-4 py-2 rounded-xl text-sm ${J.speaker==="agent"?"bg-brand-50 dark:bg-brand-900/20 text-slate-800 dark:text-slate-200":"bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300"}`,children:J.text})]},J.id))})]}),s.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 flex justify-between items-center gap-3",children:[s.jsx("button",{onClick:c,className:"text-sm text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 font-medium px-4",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(je,{onClick:ee,disabled:!j||$,variant:"secondary",className:"px-4",children:[$?s.jsx(it,{className:"w-4 h-4 ml-2 animate-spin"}):s.jsx(ol,{className:"w-4 h-4 ml-2"}),""]}),m.length>0&&s.jsxs(je,{onClick:ke,disabled:!j||$,className:"px-6 shadow-lg shadow-brand-500/20 bg-gradient-to-r from-brand-600 to-purple-600 hover:from-brand-700 hover:to-purple-700",children:[$?s.jsx(it,{className:"w-4 h-4 ml-2 animate-spin"}):s.jsx(al,{className:"w-4 h-4 ml-2 fill-current"}),"  "]})]})]})]})]})};/**
 * react-router v7.10.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var TS="popstate";function pH(e={}){function t(n,a){let{pathname:l,search:c,hash:d}=n.location;return ly("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:gu(a)}return xH(t,r,null,e)}function yr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function aa(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function gH(){return Math.random().toString(36).substring(2,10)}function OS(e,t){return{usr:e.state,key:e.key,idx:t}}function ly(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Fc(t):t,state:r,key:t&&t.key||n||gH()}}function gu({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function xH(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:l=!1}=n,c=a.history,d="POP",h=null,f=m();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function m(){return(c.state||{idx:null}).idx}function g(){d="POP";let _=m(),N=_==null?null:_-f;f=_,h&&h({action:d,location:w.location,delta:N})}function x(_,N){d="PUSH";let C=ly(w.location,_,N);f=m()+1;let A=OS(C,f),E=w.createHref(C);try{c.pushState(A,"",E)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(E)}l&&h&&h({action:d,location:w.location,delta:1})}function b(_,N){d="REPLACE";let C=ly(w.location,_,N);f=m();let A=OS(C,f),E=w.createHref(C);c.replaceState(A,"",E),l&&h&&h({action:d,location:w.location,delta:0})}function j(_){return bH(_)}let w={get action(){return d},get location(){return e(a,c)},listen(_){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(TS,g),h=_,()=>{a.removeEventListener(TS,g),h=null}},createHref(_){return t(a,_)},createURL:j,encodeLocation(_){let N=j(_);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:x,replace:b,go(_){return c.go(_)}};return w}function bH(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),yr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:gu(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function BT(e,t,r="/"){return vH(e,t,r,!1)}function vH(e,t,r,n){let a=typeof t=="string"?Fc(t):t,l=li(a.pathname||"/",r);if(l==null)return null;let c=UT(e);yH(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let f=OH(l);d=AH(c[h],f,n)}return d}function UT(e,t=[],r=[],n="",a=!1){let l=(c,d,h=a,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&h)return;yr(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let g=ti([n,m.relativePath]),x=r.concat(m);c.children&&c.children.length>0&&(yr(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),UT(c.children,t,x,g,h)),!(c.path==null&&!c.index)&&t.push({path:g,score:CH(g,c.index),routesMeta:x})};return e.forEach((c,d)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))l(c,d);else for(let f of qT(c.path))l(c,d,!0,f)}),t}function qT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let c=qT(n.join("/")),d=[];return d.push(...c.map(h=>h===""?l:[l,h].join("/"))),a&&d.push(...c),d.map(h=>e.startsWith("/")&&h===""?"/":h)}function yH(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:EH(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var wH=/^:[\w-]+$/,jH=3,_H=2,kH=1,NH=10,SH=-2,PS=e=>e==="*";function CH(e,t){let r=e.split("/"),n=r.length;return r.some(PS)&&(n+=SH),t&&(n+=_H),r.filter(a=>!PS(a)).reduce((a,l)=>a+(wH.test(l)?jH:l===""?kH:NH),n)}function EH(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function AH(e,t,r=!1){let{routesMeta:n}=e,a={},l="/",c=[];for(let d=0;d<n.length;++d){let h=n[d],f=d===n.length-1,m=l==="/"?t:t.slice(l.length)||"/",g=A0({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},m),x=h.route;if(!g&&f&&r&&!n[n.length-1].route.index&&(g=A0({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!g)return null;Object.assign(a,g.params),c.push({params:a,pathname:ti([l,g.pathname]),pathnameBase:IH(ti([l,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(l=ti([l,g.pathnameBase]))}return c}function A0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=TH(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:n.reduce((f,{paramName:m,isOptional:g},x)=>{if(m==="*"){let j=d[x]||"";c=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const b=d[x];return g&&!b?f[m]=void 0:f[m]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:e}}function TH(e,t=!1,r=!0){aa(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(n.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function OH(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return aa(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function li(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var PH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DH=e=>PH.test(e);function MH(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Fc(e):e,l;if(r)if(DH(r))l=r;else{if(r.includes("//")){let c=r;r=r.replace(/\/\/+/g,"/"),aa(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${r}`)}r.startsWith("/")?l=DS(r.substring(1),"/"):l=DS(r,t)}else l=t;return{pathname:l,search:$H(n),hash:LH(a)}}function DS(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Gx(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RH(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function FT(e){let t=RH(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function HT(e,t,r,n=!1){let a;typeof e=="string"?a=Fc(e):(a={...e},yr(!a.pathname||!a.pathname.includes("?"),Gx("?","pathname","search",a)),yr(!a.pathname||!a.pathname.includes("#"),Gx("#","pathname","hash",a)),yr(!a.search||!a.search.includes("#"),Gx("#","search","hash",a)));let l=e===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=r;else{let g=t.length-1;if(!n&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),g-=1;a.pathname=x.join("/")}d=g>=0?t[g]:"/"}let h=MH(a,d),f=c&&c!=="/"&&c.endsWith("/"),m=(l||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(f||m)&&(h.pathname+="/"),h}var ti=e=>e.join("/").replace(/\/\/+/g,"/"),IH=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$H=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,LH=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function zH(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function BH(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var VT=["POST","PUT","PATCH","DELETE"];new Set(VT);var UH=["GET",...VT];new Set(UH);var Hc=v.createContext(null);Hc.displayName="DataRouter";var Rm=v.createContext(null);Rm.displayName="DataRouterState";v.createContext(!1);var WT=v.createContext({isTransitioning:!1});WT.displayName="ViewTransition";var qH=v.createContext(new Map);qH.displayName="Fetchers";var FH=v.createContext(null);FH.displayName="Await";var ca=v.createContext(null);ca.displayName="Navigation";var Lu=v.createContext(null);Lu.displayName="Location";var Ca=v.createContext({outlet:null,matches:[],isDataRoute:!1});Ca.displayName="Route";var Uw=v.createContext(null);Uw.displayName="RouteError";function HH(e,{relative:t}={}){yr(zu(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=v.useContext(ca),{hash:a,pathname:l,search:c}=Bu(e,{relative:t}),d=l;return r!=="/"&&(d=l==="/"?r:ti([r,l])),n.createHref({pathname:d,search:c,hash:a})}function zu(){return v.useContext(Lu)!=null}function lo(){return yr(zu(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Lu).location}var GT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function KT(e){v.useContext(ca).static||v.useLayoutEffect(e)}function qw(){let{isDataRoute:e}=v.useContext(Ca);return e?sV():VH()}function VH(){yr(zu(),"useNavigate() may be used only in the context of a <Router> component.");let e=v.useContext(Hc),{basename:t,navigator:r}=v.useContext(ca),{matches:n}=v.useContext(Ca),{pathname:a}=lo(),l=JSON.stringify(FT(n)),c=v.useRef(!1);return KT(()=>{c.current=!0}),v.useCallback((h,f={})=>{if(aa(c.current,GT),!c.current)return;if(typeof h=="number"){r.go(h);return}let m=HT(h,JSON.parse(l),a,f.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:ti([t,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[t,r,l,a,e])}v.createContext(null);function WH(){let{matches:e}=v.useContext(Ca),t=e[e.length-1];return t?t.params:{}}function Bu(e,{relative:t}={}){let{matches:r}=v.useContext(Ca),{pathname:n}=lo(),a=JSON.stringify(FT(r));return v.useMemo(()=>HT(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function GH(e,t){return YT(e,t)}function YT(e,t,r,n,a){var C;yr(zu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=v.useContext(ca),{matches:c}=v.useContext(Ca),d=c[c.length-1],h=d?d.params:{},f=d?d.pathname:"/",m=d?d.pathnameBase:"/",g=d&&d.route;{let A=g&&g.path||"";XT(f,!g||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let x=lo(),b;if(t){let A=typeof t=="string"?Fc(t):t;yr(m==="/"||((C=A.pathname)==null?void 0:C.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${A.pathname}" was given in the \`location\` prop.`),b=A}else b=x;let j=b.pathname||"/",w=j;if(m!=="/"){let A=m.replace(/^\//,"").split("/");w="/"+j.replace(/^\//,"").split("/").slice(A.length).join("/")}let _=BT(e,{pathname:w});aa(g||_!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),aa(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=QH(_&&_.map(A=>Object.assign({},A,{params:Object.assign({},h,A.params),pathname:ti([m,l.encodeLocation?l.encodeLocation(A.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?m:ti([m,l.encodeLocation?l.encodeLocation(A.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathnameBase])})),c,r,n,a);return t&&N?v.createElement(Lu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},N):N}function KH(){let e=nV(),t=zH(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:l},"ErrorBoundary")," or"," ",v.createElement("code",{style:l},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),r?v.createElement("pre",{style:a},r):null,c)}var YH=v.createElement(KH,null),XH=class extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?v.createElement(Ca.Provider,{value:this.props.routeContext},v.createElement(Uw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function JH({routeContext:e,match:t,children:r}){let n=v.useContext(Hc);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),v.createElement(Ca.Provider,{value:e},r)}function QH(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,c=r==null?void 0:r.errors;if(c!=null){let m=l.findIndex(g=>g.route.id&&(c==null?void 0:c[g.route.id])!==void 0);yr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,m+1))}let d=!1,h=-1;if(r)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=m),g.route.id){let{loaderData:x,errors:b}=r,j=g.route.loader&&!x.hasOwnProperty(g.route.id)&&(!b||b[g.route.id]===void 0);if(g.route.lazy||j){d=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}let f=r&&n?(m,g)=>{var x,b;n(m,{location:r.location,params:((b=(x=r.matches)==null?void 0:x[0])==null?void 0:b.params)??{},unstable_pattern:BH(r.matches),errorInfo:g})}:void 0;return l.reduceRight((m,g,x)=>{let b,j=!1,w=null,_=null;r&&(b=c&&g.route.id?c[g.route.id]:void 0,w=g.route.errorElement||YH,d&&(h<0&&x===0?(XT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),j=!0,_=null):h===x&&(j=!0,_=g.route.hydrateFallbackElement||null)));let N=t.concat(l.slice(0,x+1)),C=()=>{let A;return b?A=w:j?A=_:g.route.Component?A=v.createElement(g.route.Component,null):g.route.element?A=g.route.element:A=m,v.createElement(JH,{match:g,routeContext:{outlet:m,matches:N,isDataRoute:r!=null},children:A})};return r&&(g.route.ErrorBoundary||g.route.errorElement||x===0)?v.createElement(XH,{location:r.location,revalidation:r.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:f}):C()},null)}function Fw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZH(e){let t=v.useContext(Hc);return yr(t,Fw(e)),t}function eV(e){let t=v.useContext(Rm);return yr(t,Fw(e)),t}function tV(e){let t=v.useContext(Ca);return yr(t,Fw(e)),t}function Hw(e){let t=tV(e),r=t.matches[t.matches.length-1];return yr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function rV(){return Hw("useRouteId")}function nV(){var n;let e=v.useContext(Uw),t=eV("useRouteError"),r=Hw("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function sV(){let{router:e}=ZH("useNavigate"),t=Hw("useNavigate"),r=v.useRef(!1);return KT(()=>{r.current=!0}),v.useCallback(async(a,l={})=>{aa(r.current,GT),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...l}))},[e,t])}var MS={};function XT(e,t,r){!t&&!MS[e]&&(MS[e]=!0,aa(!1,r))}v.memo(aV);function aV({routes:e,future:t,state:r,unstable_onError:n}){return YT(e,void 0,r,n,t)}function oy(e){yr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function iV({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){yr(!zu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=e.replace(/^\/*/,"/"),h=v.useMemo(()=>({basename:d,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[d,a,l,c]);typeof r=="string"&&(r=Fc(r));let{pathname:f="/",search:m="",hash:g="",state:x=null,key:b="default"}=r,j=v.useMemo(()=>{let w=li(f,d);return w==null?null:{location:{pathname:w,search:m,hash:g,state:x,key:b},navigationType:n}},[d,f,m,g,x,b,n]);return aa(j!=null,`<Router basename="${d}"> is not able to match the URL "${f}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),j==null?null:v.createElement(ca.Provider,{value:h},v.createElement(Lu.Provider,{children:t,value:j}))}function lV({children:e,location:t}){return GH(cy(e),t)}function cy(e,t=[]){let r=[];return v.Children.forEach(e,(n,a)=>{if(!v.isValidElement(n))return;let l=[...t,a];if(n.type===v.Fragment){r.push.apply(r,cy(n.props.children,l));return}yr(n.type===oy,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=cy(n.props.children,l)),r.push(c)}),r}var i0="get",l0="application/x-www-form-urlencoded";function Im(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function oV(e){return Im(e)&&e.tagName.toLowerCase()==="button"}function cV(e){return Im(e)&&e.tagName.toLowerCase()==="form"}function dV(e){return Im(e)&&e.tagName.toLowerCase()==="input"}function uV(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function hV(e,t){return e.button===0&&(!t||t==="_self")&&!uV(e)}var Rf=null;function fV(){if(Rf===null)try{new FormData(document.createElement("form"),0),Rf=!1}catch{Rf=!0}return Rf}var mV=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kx(e){return e!=null&&!mV.has(e)?(aa(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${l0}"`),null):e}function pV(e,t){let r,n,a,l,c;if(cV(e)){let d=e.getAttribute("action");n=d?li(d,t):null,r=e.getAttribute("method")||i0,a=Kx(e.getAttribute("enctype"))||l0,l=new FormData(e)}else if(oV(e)||dV(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=e.getAttribute("formaction")||d.getAttribute("action");if(n=h?li(h,t):null,r=e.getAttribute("formmethod")||d.getAttribute("method")||i0,a=Kx(e.getAttribute("formenctype"))||Kx(d.getAttribute("enctype"))||l0,l=new FormData(d,e),!fV()){let{name:f,type:m,value:g}=e;if(m==="image"){let x=f?`${f}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else f&&l.append(f,g)}}else{if(Im(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=i0,n=null,a=l0,c=e}return l&&a==="text/plain"&&(c=l,l=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Vw(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function gV(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&li(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function xV(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function bV(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function vV(e,t,r){let n=await Promise.all(e.map(async a=>{let l=t.routes[a.route.id];if(l){let c=await xV(l,r);return c.links?c.links():[]}return[]}));return _V(n.flat(1).filter(bV).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function RS(e,t,r,n,a,l){let c=(h,f)=>r[f]?h.route.id!==r[f].route.id:!0,d=(h,f)=>{var m;return r[f].pathname!==h.pathname||((m=r[f].route.path)==null?void 0:m.endsWith("*"))&&r[f].params["*"]!==h.params["*"]};return l==="assets"?t.filter((h,f)=>c(h,f)||d(h,f)):l==="data"?t.filter((h,f)=>{var g;let m=n.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(c(h,f)||d(h,f))return!0;if(h.route.shouldRevalidate){let x=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function yV(e,t,{includeHydrateFallback:r}={}){return wV(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function wV(e){return[...new Set(e)]}function jV(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function _V(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let l=JSON.stringify(jV(a));return r.has(l)||(r.add(l),n.push({key:l,link:a})),n},[])}function JT(){let e=v.useContext(Hc);return Vw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function kV(){let e=v.useContext(Rm);return Vw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ww=v.createContext(void 0);Ww.displayName="FrameworkContext";function QT(){let e=v.useContext(Ww);return Vw(e,"You must render this element inside a <HydratedRouter> element"),e}function NV(e,t){let r=v.useContext(Ww),[n,a]=v.useState(!1),[l,c]=v.useState(!1),{onFocus:d,onBlur:h,onMouseEnter:f,onMouseLeave:m,onTouchStart:g}=t,x=v.useRef(null);v.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let w=N=>{N.forEach(C=>{c(C.isIntersecting)})},_=new IntersectionObserver(w,{threshold:.5});return x.current&&_.observe(x.current),()=>{_.disconnect()}}},[e]),v.useEffect(()=>{if(n){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[n]);let b=()=>{a(!0)},j=()=>{a(!1),c(!1)};return r?e!=="intent"?[l,x,{}]:[l,x,{onFocus:qd(d,b),onBlur:qd(h,j),onMouseEnter:qd(f,b),onMouseLeave:qd(m,j),onTouchStart:qd(g,b)}]:[!1,x,{}]}function qd(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function SV({page:e,...t}){let{router:r}=JT(),n=v.useMemo(()=>BT(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?v.createElement(EV,{page:e,matches:n,...t}):null}function CV(e){let{manifest:t,routeModules:r}=QT(),[n,a]=v.useState([]);return v.useEffect(()=>{let l=!1;return vV(e,t,r).then(c=>{l||a(c)}),()=>{l=!0}},[e,t,r]),n}function EV({page:e,matches:t,...r}){let n=lo(),{manifest:a,routeModules:l}=QT(),{basename:c}=JT(),{loaderData:d,matches:h}=kV(),f=v.useMemo(()=>RS(e,t,h,a,n,"data"),[e,t,h,a,n]),m=v.useMemo(()=>RS(e,t,h,a,n,"assets"),[e,t,h,a,n]),g=v.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let j=new Set,w=!1;if(t.forEach(N=>{var A;let C=a.routes[N.route.id];!C||!C.hasLoader||(!f.some(E=>E.route.id===N.route.id)&&N.route.id in d&&((A=l[N.route.id])!=null&&A.shouldRevalidate)||C.hasClientLoader?w=!0:j.add(N.route.id))}),j.size===0)return[];let _=gV(e,c,"data");return w&&j.size>0&&_.searchParams.set("_routes",t.filter(N=>j.has(N.route.id)).map(N=>N.route.id).join(",")),[_.pathname+_.search]},[c,d,n,a,f,t,e,l]),x=v.useMemo(()=>yV(m,a),[m,a]),b=CV(m);return v.createElement(v.Fragment,null,g.map(j=>v.createElement("link",{key:j,rel:"prefetch",as:"fetch",href:j,...r})),x.map(j=>v.createElement("link",{key:j,rel:"modulepreload",href:j,...r})),b.map(({key:j,link:w})=>v.createElement("link",{key:j,nonce:r.nonce,...w})))}function AV(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var ZT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ZT&&(window.__reactRouterVersion="7.10.1")}catch{}function TV({basename:e,children:t,unstable_useTransitions:r,window:n}){let a=v.useRef();a.current==null&&(a.current=pH({window:n,v5Compat:!0}));let l=a.current,[c,d]=v.useState({action:l.action,location:l.location}),h=v.useCallback(f=>{r===!1?d(f):v.startTransition(()=>d(f))},[r]);return v.useLayoutEffect(()=>l.listen(h),[l,h]),v.createElement(iV,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:r===!0})}var eO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tO=v.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:l,replace:c,state:d,target:h,to:f,preventScrollReset:m,viewTransition:g,...x},b){let{basename:j,unstable_useTransitions:w}=v.useContext(ca),_=typeof f=="string"&&eO.test(f),N,C=!1;if(typeof f=="string"&&_&&(N=f,ZT))try{let $=new URL(window.location.href),M=f.startsWith("//")?new URL($.protocol+f):new URL(f),R=li(M.pathname,j);M.origin===$.origin&&R!=null?f=R+M.search+M.hash:C=!0}catch{aa(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=HH(f,{relative:a}),[E,S,T]=NV(n,x),D=MV(f,{replace:c,state:d,target:h,preventScrollReset:m,relative:a,viewTransition:g,unstable_useTransitions:w});function P($){t&&t($),$.defaultPrevented||D($)}let I=v.createElement("a",{...x,...T,href:N||A,onClick:C||l?t:P,ref:AV(b,S),target:h,"data-discover":!_&&r==="render"?"true":void 0});return E&&!_?v.createElement(v.Fragment,null,I,v.createElement(SV,{page:A})):I});tO.displayName="Link";var OV=v.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:l,to:c,viewTransition:d,children:h,...f},m){let g=Bu(c,{relative:f.relative}),x=lo(),b=v.useContext(Rm),{navigator:j,basename:w}=v.useContext(ca),_=b!=null&&zV(g)&&d===!0,N=j.encodeLocation?j.encodeLocation(g).pathname:g.pathname,C=x.pathname,A=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(C=C.toLowerCase(),A=A?A.toLowerCase():null,N=N.toLowerCase()),A&&w&&(A=li(A,w)||A);const E=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let S=C===N||!a&&C.startsWith(N)&&C.charAt(E)==="/",T=A!=null&&(A===N||!a&&A.startsWith(N)&&A.charAt(N.length)==="/"),D={isActive:S,isPending:T,isTransitioning:_},P=S?t:void 0,I;typeof n=="function"?I=n(D):I=[n,S?"active":null,T?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(D):l;return v.createElement(tO,{...f,"aria-current":P,className:I,ref:m,style:$,to:c,viewTransition:d},typeof h=="function"?h(D):h)});OV.displayName="NavLink";var PV=v.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:l,method:c=i0,action:d,onSubmit:h,relative:f,preventScrollReset:m,viewTransition:g,...x},b)=>{let{unstable_useTransitions:j}=v.useContext(ca),w=$V(),_=LV(d,{relative:f}),N=c.toLowerCase()==="get"?"get":"post",C=typeof d=="string"&&eO.test(d),A=E=>{if(h&&h(E),E.defaultPrevented)return;E.preventDefault();let S=E.nativeEvent.submitter,T=(S==null?void 0:S.getAttribute("formmethod"))||c,D=()=>w(S||E.currentTarget,{fetcherKey:t,method:T,navigate:r,replace:a,state:l,relative:f,preventScrollReset:m,viewTransition:g});j&&r!==!1?v.startTransition(()=>D()):D()};return v.createElement("form",{ref:b,method:N,action:_,onSubmit:n?h:A,...x,"data-discover":!C&&e==="render"?"true":void 0})});PV.displayName="Form";function DV(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rO(e){let t=v.useContext(Hc);return yr(t,DV(e)),t}function MV(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:l,viewTransition:c,unstable_useTransitions:d}={}){let h=qw(),f=lo(),m=Bu(e,{relative:l});return v.useCallback(g=>{if(hV(g,t)){g.preventDefault();let x=r!==void 0?r:gu(f)===gu(m),b=()=>h(e,{replace:x,state:n,preventScrollReset:a,relative:l,viewTransition:c});d?v.startTransition(()=>b()):b()}},[f,h,m,r,n,t,e,a,l,c,d])}var RV=0,IV=()=>`__${String(++RV)}__`;function $V(){let{router:e}=rO("useSubmit"),{basename:t}=v.useContext(ca),r=rV(),n=e.fetch,a=e.navigate;return v.useCallback(async(l,c={})=>{let{action:d,method:h,encType:f,formData:m,body:g}=pV(l,t);if(c.navigate===!1){let x=c.fetcherKey||IV();await n(x,r,c.action||d,{preventScrollReset:c.preventScrollReset,formData:m,body:g,formMethod:c.method||h,formEncType:c.encType||f,flushSync:c.flushSync})}else await a(c.action||d,{preventScrollReset:c.preventScrollReset,formData:m,body:g,formMethod:c.method||h,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:r,flushSync:c.flushSync,viewTransition:c.viewTransition})},[n,a,t,r])}function LV(e,{relative:t}={}){let{basename:r}=v.useContext(ca),n=v.useContext(Ca);yr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),l={...Bu(e||".",{relative:t})},c=lo();if(e==null){l.search=c.search;let d=new URLSearchParams(l.search),h=d.getAll("index");if(h.some(m=>m==="")){d.delete("index"),h.filter(g=>g).forEach(g=>d.append("index",g));let m=d.toString();l.search=m?`?${m}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:ti([r,l.pathname])),gu(l)}function zV(e,{relative:t}={}){let r=v.useContext(WT);yr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=rO("useViewTransitionState"),a=Bu(e,{relative:t});if(!r.isTransitioning)return!1;let l=li(r.currentLocation.pathname,n)||r.currentLocation.pathname,c=li(r.nextLocation.pathname,n)||r.nextLocation.pathname;return A0(a.pathname,c)!=null||A0(a.pathname,l)!=null}function nO(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=nO(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function cr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=nO(e))&&(n&&(n+=" "),n+=t);return n}var BV=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Gw(e){if(typeof e!="string")return!1;var t=BV;return t.includes(e)}var UV=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],qV=new Set(UV);function sO(e){return typeof e!="string"?!1:qV.has(e)}function aO(e){return typeof e=="string"&&e.startsWith("data-")}function oi(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(sO(r)||aO(r))&&(t[r]=e[r]);return t}function Kw(e){if(e==null)return null;if(v.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return oi(t)}return typeof e=="object"&&!Array.isArray(e)?oi(e):null}function Bs(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(sO(r)||aO(r)||Gw(r))&&(t[r]=e[r]);return t}var FV=["children","width","height","viewBox","className","style","title","desc"];function dy(){return dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dy.apply(null,arguments)}function HV(e,t){if(e==null)return{};var r,n,a=VV(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iO=v.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:l,className:c,style:d,title:h,desc:f}=e,m=HV(e,FV),g=l||{width:n,height:a,x:0,y:0},x=cr("recharts-surface",c);return v.createElement("svg",dy({},Bs(m),{className:x,width:n,height:a,style:d,viewBox:"".concat(g.x," ").concat(g.y," ").concat(g.width," ").concat(g.height),ref:t}),v.createElement("title",null,h),v.createElement("desc",null,f),r)}),WV=["children","className"];function uy(){return uy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uy.apply(null,arguments)}function GV(e,t){if(e==null)return{};var r,n,a=KV(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ci=v.forwardRef((e,t)=>{var{children:r,className:n}=e,a=GV(e,WV),l=cr("recharts-layer",n);return v.createElement("g",uy({className:l},Bs(a),{ref:t}),r)}),YV=v.createContext(null);function sr(e){return function(){return e}}const lO=Math.cos,T0=Math.sin,da=Math.sqrt,O0=Math.PI,$m=2*O0,hy=Math.PI,fy=2*hy,Il=1e-6,XV=fy-Il;function oO(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function JV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return oO;const r=10**t;return function(n){this._+=n[0];for(let a=1,l=n.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class QV{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?oO:JV(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,l,c){this._append`C${+t},${+r},${+n},${+a},${this._x1=+l},${this._y1=+c}`}arcTo(t,r,n,a,l){if(t=+t,r=+r,n=+n,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let c=this._x1,d=this._y1,h=n-t,f=a-r,m=c-t,g=d-r,x=m*m+g*g;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>Il)if(!(Math.abs(g*h-f*m)>Il)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let b=n-c,j=a-d,w=h*h+f*f,_=b*b+j*j,N=Math.sqrt(w),C=Math.sqrt(x),A=l*Math.tan((hy-Math.acos((w+x-_)/(2*N*C)))/2),E=A/C,S=A/N;Math.abs(E-1)>Il&&this._append`L${t+E*m},${r+E*g}`,this._append`A${l},${l},0,0,${+(g*b>m*j)},${this._x1=t+S*h},${this._y1=r+S*f}`}}arc(t,r,n,a,l,c){if(t=+t,r=+r,n=+n,c=!!c,n<0)throw new Error(`negative radius: ${n}`);let d=n*Math.cos(a),h=n*Math.sin(a),f=t+d,m=r+h,g=1^c,x=c?a-l:l-a;this._x1===null?this._append`M${f},${m}`:(Math.abs(this._x1-f)>Il||Math.abs(this._y1-m)>Il)&&this._append`L${f},${m}`,n&&(x<0&&(x=x%fy+fy),x>XV?this._append`A${n},${n},0,1,${g},${t-d},${r-h}A${n},${n},0,1,${g},${this._x1=f},${this._y1=m}`:x>Il&&this._append`A${n},${n},0,${+(x>=hy)},${g},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Yw(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new QV(t)}function Xw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cO(e){this._context=e}cO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Lm(e){return new cO(e)}function dO(e){return e[0]}function uO(e){return e[1]}function hO(e,t){var r=sr(!0),n=null,a=Lm,l=null,c=Yw(d);e=typeof e=="function"?e:e===void 0?dO:sr(e),t=typeof t=="function"?t:t===void 0?uO:sr(t);function d(h){var f,m=(h=Xw(h)).length,g,x=!1,b;for(n==null&&(l=a(b=c())),f=0;f<=m;++f)!(f<m&&r(g=h[f],f,h))===x&&((x=!x)?l.lineStart():l.lineEnd()),x&&l.point(+e(g,f,h),+t(g,f,h));if(b)return l=null,b+""||null}return d.x=function(h){return arguments.length?(e=typeof h=="function"?h:sr(+h),d):e},d.y=function(h){return arguments.length?(t=typeof h=="function"?h:sr(+h),d):t},d.defined=function(h){return arguments.length?(r=typeof h=="function"?h:sr(!!h),d):r},d.curve=function(h){return arguments.length?(a=h,n!=null&&(l=a(n)),d):a},d.context=function(h){return arguments.length?(h==null?n=l=null:l=a(n=h),d):n},d}function If(e,t,r){var n=null,a=sr(!0),l=null,c=Lm,d=null,h=Yw(f);e=typeof e=="function"?e:e===void 0?dO:sr(+e),t=typeof t=="function"?t:sr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?uO:sr(+r);function f(g){var x,b,j,w=(g=Xw(g)).length,_,N=!1,C,A=new Array(w),E=new Array(w);for(l==null&&(d=c(C=h())),x=0;x<=w;++x){if(!(x<w&&a(_=g[x],x,g))===N)if(N=!N)b=x,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),j=x-1;j>=b;--j)d.point(A[j],E[j]);d.lineEnd(),d.areaEnd()}N&&(A[x]=+e(_,x,g),E[x]=+t(_,x,g),d.point(n?+n(_,x,g):A[x],r?+r(_,x,g):E[x]))}if(C)return d=null,C+""||null}function m(){return hO().defined(a).curve(c).context(l)}return f.x=function(g){return arguments.length?(e=typeof g=="function"?g:sr(+g),n=null,f):e},f.x0=function(g){return arguments.length?(e=typeof g=="function"?g:sr(+g),f):e},f.x1=function(g){return arguments.length?(n=g==null?null:typeof g=="function"?g:sr(+g),f):n},f.y=function(g){return arguments.length?(t=typeof g=="function"?g:sr(+g),r=null,f):t},f.y0=function(g){return arguments.length?(t=typeof g=="function"?g:sr(+g),f):t},f.y1=function(g){return arguments.length?(r=g==null?null:typeof g=="function"?g:sr(+g),f):r},f.lineX0=f.lineY0=function(){return m().x(e).y(t)},f.lineY1=function(){return m().x(e).y(r)},f.lineX1=function(){return m().x(n).y(t)},f.defined=function(g){return arguments.length?(a=typeof g=="function"?g:sr(!!g),f):a},f.curve=function(g){return arguments.length?(c=g,l!=null&&(d=c(l)),f):c},f.context=function(g){return arguments.length?(g==null?l=d=null:d=c(l=g),f):l},f}class fO{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function ZV(e){return new fO(e,!0)}function eW(e){return new fO(e,!1)}const Jw={draw(e,t){const r=da(t/O0);e.moveTo(r,0),e.arc(0,0,r,0,$m)}},tW={draw(e,t){const r=da(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},mO=da(1/3),rW=mO*2,nW={draw(e,t){const r=da(t/rW),n=r*mO;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},sW={draw(e,t){const r=da(t),n=-r/2;e.rect(n,n,r,r)}},aW=.8908130915292852,pO=T0(O0/10)/T0(7*O0/10),iW=T0($m/10)*pO,lW=-lO($m/10)*pO,oW={draw(e,t){const r=da(t*aW),n=iW*r,a=lW*r;e.moveTo(0,-r),e.lineTo(n,a);for(let l=1;l<5;++l){const c=$m*l/5,d=lO(c),h=T0(c);e.lineTo(h*r,-d*r),e.lineTo(d*n-h*a,h*n+d*a)}e.closePath()}},Yx=da(3),cW={draw(e,t){const r=-da(t/(Yx*3));e.moveTo(0,r*2),e.lineTo(-Yx*r,-r),e.lineTo(Yx*r,-r),e.closePath()}},Ds=-.5,Ms=da(3)/2,my=1/da(12),dW=(my/2+1)*3,uW={draw(e,t){const r=da(t/dW),n=r/2,a=r*my,l=n,c=r*my+r,d=-l,h=c;e.moveTo(n,a),e.lineTo(l,c),e.lineTo(d,h),e.lineTo(Ds*n-Ms*a,Ms*n+Ds*a),e.lineTo(Ds*l-Ms*c,Ms*l+Ds*c),e.lineTo(Ds*d-Ms*h,Ms*d+Ds*h),e.lineTo(Ds*n+Ms*a,Ds*a-Ms*n),e.lineTo(Ds*l+Ms*c,Ds*c-Ms*l),e.lineTo(Ds*d+Ms*h,Ds*h-Ms*d),e.closePath()}};function hW(e,t){let r=null,n=Yw(a);e=typeof e=="function"?e:sr(e||Jw),t=typeof t=="function"?t:sr(t===void 0?64:+t);function a(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:sr(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:sr(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function P0(){}function D0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function gO(e){this._context=e}gO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:D0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:D0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function fW(e){return new gO(e)}function xO(e){this._context=e}xO.prototype={areaStart:P0,areaEnd:P0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:D0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mW(e){return new xO(e)}function bO(e){this._context=e}bO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:D0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pW(e){return new bO(e)}function vO(e){this._context=e}vO.prototype={areaStart:P0,areaEnd:P0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gW(e){return new vO(e)}function IS(e){return e<0?-1:1}function $S(e,t,r){var n=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(n||a<0&&-0),c=(r-e._y1)/(a||n<0&&-0),d=(l*a+c*n)/(n+a);return(IS(l)+IS(c))*Math.min(Math.abs(l),Math.abs(c),.5*Math.abs(d))||0}function LS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Xx(e,t,r){var n=e._x0,a=e._y0,l=e._x1,c=e._y1,d=(l-n)/3;e._context.bezierCurveTo(n+d,a+d*t,l-d,c-d*r,l,c)}function M0(e){this._context=e}M0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Xx(this,this._t0,LS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Xx(this,LS(this,r=$S(this,e,t)),r);break;default:Xx(this,this._t0,r=$S(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function yO(e){this._context=new wO(e)}(yO.prototype=Object.create(M0.prototype)).point=function(e,t){M0.prototype.point.call(this,t,e)};function wO(e){this._context=e}wO.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,l){this._context.bezierCurveTo(t,e,n,r,l,a)}};function xW(e){return new M0(e)}function bW(e){return new yO(e)}function jO(e){this._context=e}jO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=zS(e),a=zS(t),l=0,c=1;c<r;++l,++c)this._context.bezierCurveTo(n[0][l],a[0][l],n[1][l],a[1][l],e[c],t[c]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function zS(e){var t,r=e.length-1,n,a=new Array(r),l=new Array(r),c=new Array(r);for(a[0]=0,l[0]=2,c[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,c[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,c[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/l[t-1],l[t]-=n,c[t]-=n*c[t-1];for(a[r-1]=c[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(c[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function vW(e){return new jO(e)}function zm(e,t){this._context=e,this._t=t}zm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function yW(e){return new zm(e,.5)}function wW(e){return new zm(e,0)}function jW(e){return new zm(e,1)}function to(e,t){if((c=e.length)>1)for(var r=1,n,a,l=e[t[0]],c,d=l.length;r<c;++r)for(a=l,l=e[t[r]],n=0;n<d;++n)l[n][1]+=l[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function py(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function _W(e,t){return e[t]}function kW(e){const t=[];return t.key=e,t}function NW(){var e=sr([]),t=py,r=to,n=_W;function a(l){var c=Array.from(e.apply(this,arguments),kW),d,h=c.length,f=-1,m;for(const g of l)for(d=0,++f;d<h;++d)(c[d][f]=[0,+n(g,c[d].key,f,l)]).data=g;for(d=0,m=Xw(t(c));d<h;++d)c[m[d]].index=d;return r(c,m),c}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:sr(Array.from(l)),a):e},a.value=function(l){return arguments.length?(n=typeof l=="function"?l:sr(+l),a):n},a.order=function(l){return arguments.length?(t=l==null?py:typeof l=="function"?l:sr(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??to,a):r},a}function SW(e,t){if((n=e.length)>0){for(var r,n,a=0,l=e[0].length,c;a<l;++a){for(c=r=0;r<n;++r)c+=e[r][a][1]||0;if(c)for(r=0;r<n;++r)e[r][a][1]/=c}to(e,t)}}function CW(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,l=n.length;r<l;++r){for(var c=0,d=0;c<a;++c)d+=e[c][r][1]||0;n[r][1]+=n[r][0]=-d/2}to(e,t)}}function EW(e,t){if(!(!((c=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,l,c;n<l;++n){for(var d=0,h=0,f=0;d<c;++d){for(var m=e[t[d]],g=m[n][1]||0,x=m[n-1][1]||0,b=(g-x)/2,j=0;j<d;++j){var w=e[t[j]],_=w[n][1]||0,N=w[n-1][1]||0;b+=_-N}h+=g,f+=b*g}a[n-1][1]+=a[n-1][0]=r,h&&(r-=f/h)}a[n-1][1]+=a[n-1][0]=r,to(e,t)}}var Jx={},Qx={},BS;function AW(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Qx)),Qx}var Zx={},US;function _O(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Zx)),Zx}var eb={},qS;function Qw(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(eb)),eb}var tb={},rb={},FS;function TW(){return FS||(FS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(rb)),rb}var HS;function Zw(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TW(),r=Qw();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const l=[],c=a.length;if(c===0)return l;let d=0,h="",f="",m=!1;for(a.charCodeAt(0)===46&&(l.push(""),d++);d<c;){const g=a[d];f?g==="\\"&&d+1<c?(d++,h+=a[d]):g===f?f="":h+=g:m?g==='"'||g==="'"?f=g:g==="]"?(m=!1,l.push(h),h=""):h+=g:g==="["?(m=!0,h&&(l.push(h),h="")):g==="."?h&&(l.push(h),h=""):h+=g,d++}return h&&l.push(h),l}e.toPath=n})(tb)),tb}var VS;function e1(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AW(),r=_O(),n=Qw(),a=Zw();function l(d,h,f){if(d==null)return f;switch(typeof h){case"string":{if(t.isUnsafeProperty(h))return f;const m=d[h];return m===void 0?r.isDeepKey(h)?l(d,a.toPath(h),f):f:m}case"number":case"symbol":{typeof h=="number"&&(h=n.toKey(h));const m=d[h];return m===void 0?f:m}default:{if(Array.isArray(h))return c(d,h,f);if(Object.is(h==null?void 0:h.valueOf(),-0)?h="-0":h=String(h),t.isUnsafeProperty(h))return f;const m=d[h];return m===void 0?f:m}}}function c(d,h,f){if(h.length===0)return f;let m=d;for(let g=0;g<h.length;g++){if(m==null||t.isUnsafeProperty(h[g]))return f;m=m[h[g]]}return m===void 0?f:m}e.get=l})(Jx)),Jx}var nb,WS;function OW(){return WS||(WS=1,nb=e1().get),nb}var PW=OW();const Cc=vs(PW);var DW=4;function nl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DW,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function kr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,l,c)=>{var d=r[c-1];return typeof d=="string"?a+d+l:d!==void 0?a+nl(d)+l:a+l},"")}var Kn=e=>e===0?0:e>0?1:-1,ia=e=>typeof e=="number"&&e!=+e,di=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,We=e=>(typeof e=="number"||e instanceof Number)&&!ia(e),ja=e=>We(e)||typeof e=="string",MW=0,xu=e=>{var t=++MW;return"".concat(e||"").concat(t)},la=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!We(t)&&typeof t!="string")return n;var l;if(di(t)){if(r==null)return n;var c=t.indexOf("%");l=r*parseFloat(t.slice(0,c))/100}else l=+t;return ia(l)&&(l=n),a&&r!=null&&l>r&&(l=r),l},kO=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function yn(e,t,r){return We(e)&&We(t)?nl(e+r*(t-e)):t}function RW(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Cc(n,t))===r)}var ln=e=>e===null||typeof e>"u",Uu=e=>ln(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function IW(e){return e!=null}function qu(){}var $W=["type","size","sizeType"];function gy(){return gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gy.apply(null,arguments)}function GS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GS(Object(r),!0).forEach(function(n){LW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LW(e,t,r){return(t=zW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zW(e){var t=BW(e,"string");return typeof t=="symbol"?t:t+""}function BW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UW(e,t){if(e==null)return{};var r,n,a=qW(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var NO={symbolCircle:Jw,symbolCross:tW,symbolDiamond:nW,symbolSquare:sW,symbolStar:oW,symbolTriangle:cW,symbolWye:uW},FW=Math.PI/180,HW=e=>{var t="symbol".concat(Uu(e));return NO[t]||Jw},VW=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*FW;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},WW=(e,t)=>{NO["symbol".concat(Uu(e))]=t},SO=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=UW(e,$W),l=KS(KS({},a),{},{type:t,size:r,sizeType:n}),c="circle";typeof t=="string"&&(c=t);var d=()=>{var x=HW(c),b=hW().type(x).size(VW(r,n,c)),j=b();if(j!==null)return j},{className:h,cx:f,cy:m}=l,g=Bs(l);return We(f)&&We(m)&&We(r)?v.createElement("path",gy({},g,{className:cr("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:d()})):null};SO.registerSymbol=WW;var CO=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,GW=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Gw(a)&&(n[a]=(l=>r[a](r,l)))}),n},KW=(e,t,r)=>n=>(e(t,r,n),null),t1=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var l=e[a];Gw(a)&&typeof l=="function"&&(n||(n={}),n[a]=KW(l,t,r))}),n};function YS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YS(Object(r),!0).forEach(function(n){XW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XW(e,t,r){return(t=JW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=QW(e,"string");return typeof t=="symbol"?t:t+""}function QW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ys(e,t){var r=YW({},e),n=t,a=Object.keys(t),l=a.reduce((c,d)=>(c[d]===void 0&&n[d]!==void 0&&(c[d]=n[d]),c),r);return l}var sb={},ab={},XS;function ZW(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let l=0;l<r.length;l++){const c=r[l],d=n(c);a.has(d)||a.set(d,c)}return Array.from(a.values())}e.uniqBy=t})(ab)),ab}var ib={},JS;function EO(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(ib)),ib}var lb={},ob={},cb={},QS;function eG(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(cb)),cb}var ZS;function r1(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eG();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(ob)),ob}var db={},e5;function tG(){return e5||(e5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(db)),db}var t5;function rG(){return t5||(t5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=r1(),r=tG();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(lb)),lb}var ub={},hb={},r5;function nG(){return r5||(r5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e1();function r(n){return function(a){return t.get(a,n)}}e.property=r})(hb)),hb}var fb={},mb={},pb={},gb={},n5;function AO(){return n5||(n5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(gb)),gb}var xb={},s5;function TO(){return s5||(s5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(xb)),xb}var bb={},a5;function OO(){return a5||(a5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(bb)),bb}var i5;function sG(){return i5||(i5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AO(),r=TO(),n=OO();function a(m,g,x){return typeof x!="function"?a(m,g,()=>{}):l(m,g,function b(j,w,_,N,C,A){const E=x(j,w,_,N,C,A);return E!==void 0?!!E:l(j,w,b,A)},new Map)}function l(m,g,x,b){if(g===m)return!0;switch(typeof g){case"object":return c(m,g,x,b);case"function":return Object.keys(g).length>0?l(m,{...g},x,b):n.eq(m,g);default:return t.isObject(m)?typeof g=="string"?g==="":!0:n.eq(m,g)}}function c(m,g,x,b){if(g==null)return!0;if(Array.isArray(g))return h(m,g,x,b);if(g instanceof Map)return d(m,g,x,b);if(g instanceof Set)return f(m,g,x,b);const j=Object.keys(g);if(m==null||r.isPrimitive(m))return j.length===0;if(j.length===0)return!0;if(b!=null&&b.has(g))return b.get(g)===m;b==null||b.set(g,m);try{for(let w=0;w<j.length;w++){const _=j[w];if(!r.isPrimitive(m)&&!(_ in m)||g[_]===void 0&&m[_]!==void 0||g[_]===null&&m[_]!==null||!x(m[_],g[_],_,m,g,b))return!1}return!0}finally{b==null||b.delete(g)}}function d(m,g,x,b){if(g.size===0)return!0;if(!(m instanceof Map))return!1;for(const[j,w]of g.entries()){const _=m.get(j);if(x(_,w,j,m,g,b)===!1)return!1}return!0}function h(m,g,x,b){if(g.length===0)return!0;if(!Array.isArray(m))return!1;const j=new Set;for(let w=0;w<g.length;w++){const _=g[w];let N=!1;for(let C=0;C<m.length;C++){if(j.has(C))continue;const A=m[C];let E=!1;if(x(A,_,w,m,g,b)&&(E=!0),E){j.add(C),N=!0;break}}if(!N)return!1}return!0}function f(m,g,x,b){return g.size===0?!0:m instanceof Set?h([...m],[...g],x,b):!1}e.isMatchWith=a,e.isSetMatch=f})(pb)),pb}var l5;function PO(){return l5||(l5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sG();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(mb)),mb}var vb={},yb={},wb={},o5;function aG(){return o5||(o5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(wb)),wb}var jb={},c5;function DO(){return c5||(c5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(jb)),jb}var _b={},d5;function MO(){return d5||(d5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",l="[object Arguments]",c="[object Symbol]",d="[object Date]",h="[object Map]",f="[object Set]",m="[object Array]",g="[object Function]",x="[object ArrayBuffer]",b="[object Object]",j="[object Error]",w="[object DataView]",_="[object Uint8Array]",N="[object Uint8ClampedArray]",C="[object Uint16Array]",A="[object Uint32Array]",E="[object BigUint64Array]",S="[object Int8Array]",T="[object Int16Array]",D="[object Int32Array]",P="[object BigInt64Array]",I="[object Float32Array]",$="[object Float64Array]";e.argumentsTag=l,e.arrayBufferTag=x,e.arrayTag=m,e.bigInt64ArrayTag=P,e.bigUint64ArrayTag=E,e.booleanTag=a,e.dataViewTag=w,e.dateTag=d,e.errorTag=j,e.float32ArrayTag=I,e.float64ArrayTag=$,e.functionTag=g,e.int16ArrayTag=T,e.int32ArrayTag=D,e.int8ArrayTag=S,e.mapTag=h,e.numberTag=n,e.objectTag=b,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=c,e.uint16ArrayTag=C,e.uint32ArrayTag=A,e.uint8ArrayTag=_,e.uint8ClampedArrayTag=N})(_b)),_b}var kb={},u5;function iG(){return u5||(u5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(kb)),kb}var h5;function RO(){return h5||(h5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aG(),r=DO(),n=MO(),a=TO(),l=iG();function c(m,g){return d(m,void 0,m,new Map,g)}function d(m,g,x,b=new Map,j=void 0){const w=j==null?void 0:j(m,g,x,b);if(w!==void 0)return w;if(a.isPrimitive(m))return m;if(b.has(m))return b.get(m);if(Array.isArray(m)){const _=new Array(m.length);b.set(m,_);for(let N=0;N<m.length;N++)_[N]=d(m[N],N,x,b,j);return Object.hasOwn(m,"index")&&(_.index=m.index),Object.hasOwn(m,"input")&&(_.input=m.input),_}if(m instanceof Date)return new Date(m.getTime());if(m instanceof RegExp){const _=new RegExp(m.source,m.flags);return _.lastIndex=m.lastIndex,_}if(m instanceof Map){const _=new Map;b.set(m,_);for(const[N,C]of m)_.set(N,d(C,N,x,b,j));return _}if(m instanceof Set){const _=new Set;b.set(m,_);for(const N of m)_.add(d(N,void 0,x,b,j));return _}if(typeof Buffer<"u"&&Buffer.isBuffer(m))return m.subarray();if(l.isTypedArray(m)){const _=new(Object.getPrototypeOf(m)).constructor(m.length);b.set(m,_);for(let N=0;N<m.length;N++)_[N]=d(m[N],N,x,b,j);return _}if(m instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&m instanceof SharedArrayBuffer)return m.slice(0);if(m instanceof DataView){const _=new DataView(m.buffer.slice(0),m.byteOffset,m.byteLength);return b.set(m,_),h(_,m,x,b,j),_}if(typeof File<"u"&&m instanceof File){const _=new File([m],m.name,{type:m.type});return b.set(m,_),h(_,m,x,b,j),_}if(typeof Blob<"u"&&m instanceof Blob){const _=new Blob([m],{type:m.type});return b.set(m,_),h(_,m,x,b,j),_}if(m instanceof Error){const _=new m.constructor;return b.set(m,_),_.message=m.message,_.name=m.name,_.stack=m.stack,_.cause=m.cause,h(_,m,x,b,j),_}if(m instanceof Boolean){const _=new Boolean(m.valueOf());return b.set(m,_),h(_,m,x,b,j),_}if(m instanceof Number){const _=new Number(m.valueOf());return b.set(m,_),h(_,m,x,b,j),_}if(m instanceof String){const _=new String(m.valueOf());return b.set(m,_),h(_,m,x,b,j),_}if(typeof m=="object"&&f(m)){const _=Object.create(Object.getPrototypeOf(m));return b.set(m,_),h(_,m,x,b,j),_}return m}function h(m,g,x=m,b,j){const w=[...Object.keys(g),...t.getSymbols(g)];for(let _=0;_<w.length;_++){const N=w[_],C=Object.getOwnPropertyDescriptor(m,N);(C==null||C.writable)&&(m[N]=d(g[N],N,x,b,j))}}function f(m){switch(r.getTag(m)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=c,e.cloneDeepWithImpl=d,e.copyProperties=h})(yb)),yb}var f5;function lG(){return f5||(f5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RO();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(vb)),vb}var m5;function oG(){return m5||(m5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PO(),r=lG();function n(a){return a=r.cloneDeep(a),l=>t.isMatch(l,a)}e.matches=n})(fb)),fb}var Nb={},Sb={},Cb={},p5;function cG(){return p5||(p5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RO(),r=MO();function n(a,l){return t.cloneDeepWith(a,(c,d,h,f)=>{const m=l==null?void 0:l(c,d,h,f);if(m!==void 0)return m;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const g=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(g,a),g}case r.argumentsTag:{const g={};return t.copyProperties(g,a),g.length=a.length,g[Symbol.iterator]=a[Symbol.iterator],g}default:return}})}e.cloneDeepWith=n})(Cb)),Cb}var g5;function dG(){return g5||(g5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cG();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Sb)),Sb}var Eb={},Ab={},x5;function IO(){return x5||(x5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Ab)),Ab}var Tb={},b5;function uG(){return b5||(b5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DO();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(Tb)),Tb}var v5;function hG(){return v5||(v5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_O(),r=IO(),n=uG(),a=Zw();function l(c,d){let h;if(Array.isArray(d)?h=d:typeof d=="string"&&t.isDeepKey(d)&&(c==null?void 0:c[d])==null?h=a.toPath(d):h=[d],h.length===0)return!1;let f=c;for(let m=0;m<h.length;m++){const g=h[m];if((f==null||!Object.hasOwn(f,g))&&!((Array.isArray(f)||n.isArguments(f))&&r.isIndex(g)&&g<f.length))return!1;f=f[g]}return!0}e.has=l})(Eb)),Eb}var y5;function fG(){return y5||(y5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PO(),r=Qw(),n=dG(),a=e1(),l=hG();function c(d,h){switch(typeof d){case"object":{Object.is(d==null?void 0:d.valueOf(),-0)&&(d="-0");break}case"number":{d=r.toKey(d);break}}return h=n.cloneDeep(h),function(f){const m=a.get(f,d);return m===void 0?l.has(f,d):h===void 0?m===void 0:t.isMatch(m,h)}}e.matchesProperty=c})(Nb)),Nb}var w5;function mG(){return w5||(w5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EO(),r=nG(),n=oG(),a=fG();function l(c){if(c==null)return t.identity;switch(typeof c){case"function":return c;case"object":return Array.isArray(c)&&c.length===2?a.matchesProperty(c[0],c[1]):n.matches(c);case"string":case"symbol":case"number":return r.property(c)}}e.iteratee=l})(ub)),ub}var j5;function pG(){return j5||(j5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZW(),r=EO(),n=rG(),a=mG();function l(c,d=r.identity){return n.isArrayLikeObject(c)?t.uniqBy(Array.from(c),a.iteratee(d)):[]}e.uniqBy=l})(sb)),sb}var Ob,_5;function gG(){return _5||(_5=1,Ob=pG().uniqBy),Ob}var xG=gG();const k5=vs(xG);function bG(e,t,r){return t===!0?k5(e,r):typeof t=="function"?k5(e,t):e}var Pb={exports:{}},Db={},Mb={exports:{}},Rb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N5;function vG(){if(N5)return Rb;N5=1;var e=$c();function t(g,x){return g===x&&(g!==0||1/g===1/x)||g!==g&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,l=e.useLayoutEffect,c=e.useDebugValue;function d(g,x){var b=x(),j=n({inst:{value:b,getSnapshot:x}}),w=j[0].inst,_=j[1];return l(function(){w.value=b,w.getSnapshot=x,h(w)&&_({inst:w})},[g,b,x]),a(function(){return h(w)&&_({inst:w}),g(function(){h(w)&&_({inst:w})})},[g]),c(b),b}function h(g){var x=g.getSnapshot;g=g.value;try{var b=x();return!r(g,b)}catch{return!0}}function f(g,x){return x()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:d;return Rb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:m,Rb}var S5;function yG(){return S5||(S5=1,Mb.exports=vG()),Mb.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C5;function wG(){if(C5)return Db;C5=1;var e=$c(),t=yG();function r(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,l=e.useRef,c=e.useEffect,d=e.useMemo,h=e.useDebugValue;return Db.useSyncExternalStoreWithSelector=function(f,m,g,x,b){var j=l(null);if(j.current===null){var w={hasValue:!1,value:null};j.current=w}else w=j.current;j=d(function(){function N(T){if(!C){if(C=!0,A=T,T=x(T),b!==void 0&&w.hasValue){var D=w.value;if(b(D,T))return E=D}return E=T}if(D=E,n(A,T))return D;var P=x(T);return b!==void 0&&b(D,P)?(A=T,D):(A=T,E=P)}var C=!1,A,E,S=g===void 0?null:g;return[function(){return N(m())},S===null?void 0:function(){return N(S())}]},[m,g,x,b]);var _=a(f,j[0],j[1]);return c(function(){w.hasValue=!0,w.value=_},[_]),h(_),_},Db}var E5;function jG(){return E5||(E5=1,Pb.exports=wG()),Pb.exports}var _G=jG(),n1=v.createContext(null),kG=e=>e,Dr=()=>{var e=v.useContext(n1);return e?e.store.dispatch:kG},o0=()=>{},NG=()=>o0,SG=(e,t)=>e===t;function Xe(e){var t=v.useContext(n1);return _G.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:NG,t?t.store.getState:o0,t?t.store.getState:o0,t?e:o0,SG)}function CG(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function EG(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function AG(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var A5=e=>Array.isArray(e)?e:[e];function TG(e){const t=Array.isArray(e[0])?e[0]:e;return AG(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function OG(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var PG=class{constructor(e){this.value=e}deref(){return this.value}},DG=typeof WeakRef<"u"?WeakRef:PG,MG=0,T5=1;function $f(){return{s:MG,v:void 0,o:null,p:null}}function $O(e,t={}){let r=$f();const{resultEqualityCheck:n}=t;let a,l=0;function c(){var g;let d=r;const{length:h}=arguments;for(let x=0,b=h;x<b;x++){const j=arguments[x];if(typeof j=="function"||typeof j=="object"&&j!==null){let w=d.o;w===null&&(d.o=w=new WeakMap);const _=w.get(j);_===void 0?(d=$f(),w.set(j,d)):d=_}else{let w=d.p;w===null&&(d.p=w=new Map);const _=w.get(j);_===void 0?(d=$f(),w.set(j,d)):d=_}}const f=d;let m;if(d.s===T5)m=d.v;else if(m=e.apply(null,arguments),l++,n){const x=((g=a==null?void 0:a.deref)==null?void 0:g.call(a))??a;x!=null&&n(x,m)&&(m=x,l!==0&&l--),a=typeof m=="object"&&m!==null||typeof m=="function"?new DG(m):m}return f.s=T5,f.v=m,m}return c.clearCache=()=>{r=$f(),c.resetResultsCount()},c.resultsCount=()=>l,c.resetResultsCount=()=>{l=0},c}function RG(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let l=0,c=0,d,h={},f=a.pop();typeof f=="object"&&(h=f,f=a.pop()),CG(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const m={...r,...h},{memoize:g,memoizeOptions:x=[],argsMemoize:b=$O,argsMemoizeOptions:j=[]}=m,w=A5(x),_=A5(j),N=TG(a),C=g(function(){return l++,f.apply(null,arguments)},...w),A=b(function(){c++;const S=OG(N,arguments);return d=C.apply(null,S),d},..._);return Object.assign(A,{resultFunc:f,memoizedResultFunc:C,dependencies:N,dependencyRecomputations:()=>c,resetDependencyRecomputations:()=>{c=0},lastResult:()=>d,recomputations:()=>l,resetRecomputations:()=>{l=0},memoize:g,argsMemoize:b})};return Object.assign(n,{withTypes:()=>n}),n}var de=RG($O),IG=Object.assign((e,t=de)=>{EG(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(l=>e[l]);return t(n,(...l)=>l.reduce((c,d,h)=>(c[r[h]]=d,c),{}))},{withTypes:()=>IG}),Ib={},$b={},Lb={},O5;function $G(){return O5||(O5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,l)=>{if(n!==a){const c=t(n),d=t(a);if(c===d&&c===0){if(n<a)return l==="desc"?1:-1;if(n>a)return l==="desc"?-1:1}return l==="desc"?d-c:c-d}return 0};e.compareValues=r})(Lb)),Lb}var zb={},Bb={},P5;function LO(){return P5||(P5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Bb)),Bb}var D5;function LG(){return D5||(D5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LO(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(l,c){return Array.isArray(l)?!1:typeof l=="number"||typeof l=="boolean"||l==null||t.isSymbol(l)?!0:typeof l=="string"&&(n.test(l)||!r.test(l))||c!=null&&Object.hasOwn(c,l)}e.isKey=a})(zb)),zb}var M5;function zG(){return M5||(M5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$G(),r=LG(),n=Zw();function a(l,c,d,h){if(l==null)return[];d=h?void 0:d,Array.isArray(l)||(l=Object.values(l)),Array.isArray(c)||(c=c==null?[null]:[c]),c.length===0&&(c=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(b=>String(b));const f=(b,j)=>{let w=b;for(let _=0;_<j.length&&w!=null;++_)w=w[j[_]];return w},m=(b,j)=>j==null||b==null?j:typeof b=="object"&&"key"in b?Object.hasOwn(j,b.key)?j[b.key]:f(j,b.path):typeof b=="function"?b(j):Array.isArray(b)?f(j,b):typeof j=="object"?j[b]:j,g=c.map(b=>(Array.isArray(b)&&b.length===1&&(b=b[0]),b==null||typeof b=="function"||Array.isArray(b)||r.isKey(b)?b:{key:b,path:n.toPath(b)}));return l.map(b=>({original:b,criteria:g.map(j=>m(j,b))})).slice().sort((b,j)=>{for(let w=0;w<g.length;w++){const _=t.compareValues(b.criteria[w],j.criteria[w],d[w]);if(_!==0)return _}return 0}).map(b=>b.original)}e.orderBy=a})($b)),$b}var Ub={},R5;function BG(){return R5||(R5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],l=Math.floor(n),c=(d,h)=>{for(let f=0;f<d.length;f++){const m=d[f];Array.isArray(m)&&h<l?c(m,h+1):a.push(m)}};return c(r,0),a}e.flatten=t})(Ub)),Ub}var qb={},I5;function zO(){return I5||(I5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IO(),r=r1(),n=AO(),a=OO();function l(c,d,h){return n.isObject(h)&&(typeof d=="number"&&r.isArrayLike(h)&&t.isIndex(d)&&d<h.length||typeof d=="string"&&d in h)?a.eq(h[d],c):!1}e.isIterateeCall=l})(qb)),qb}var $5;function UG(){return $5||($5=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zG(),r=BG(),n=zO();function a(l,...c){const d=c.length;return d>1&&n.isIterateeCall(l,c[0],c[1])?c=[]:d>2&&n.isIterateeCall(c[0],c[1],c[2])&&(c=[c[0]]),t.orderBy(l,r.flatten(c),["asc"])}e.sortBy=a})(Ib)),Ib}var Fb,L5;function qG(){return L5||(L5=1,Fb=UG().sortBy),Fb}var FG=qG();const Bm=vs(FG);var BO=e=>e.legend.settings,HG=e=>e.legend.size,VG=e=>e.legend.payload;de([VG,BO],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Bm(n,r):n});var Lf=1;function WG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var l=a.getBoundingClientRect(),c={height:l.height,left:l.left,top:l.top,width:l.width};(Math.abs(c.height-t.height)>Lf||Math.abs(c.left-t.left)>Lf||Math.abs(c.top-t.top)>Lf||Math.abs(c.width-t.width)>Lf)&&r({height:c.height,left:c.left,top:c.top,width:c.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function bn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var GG=typeof Symbol=="function"&&Symbol.observable||"@@observable",z5=GG,Hb=()=>Math.random().toString(36).substring(7).split("").join("."),KG={INIT:`@@redux/INIT${Hb()}`,REPLACE:`@@redux/REPLACE${Hb()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Hb()}`},R0=KG;function s1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function UO(e,t,r){if(typeof e!="function")throw new Error(bn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(bn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(bn(1));return r(UO)(e,t)}let n=e,a=t,l=new Map,c=l,d=0,h=!1;function f(){c===l&&(c=new Map,l.forEach((_,N)=>{c.set(N,_)}))}function m(){if(h)throw new Error(bn(3));return a}function g(_){if(typeof _!="function")throw new Error(bn(4));if(h)throw new Error(bn(5));let N=!0;f();const C=d++;return c.set(C,_),function(){if(N){if(h)throw new Error(bn(6));N=!1,f(),c.delete(C),l=null}}}function x(_){if(!s1(_))throw new Error(bn(7));if(typeof _.type>"u")throw new Error(bn(8));if(typeof _.type!="string")throw new Error(bn(17));if(h)throw new Error(bn(9));try{h=!0,a=n(a,_)}finally{h=!1}return(l=c).forEach(C=>{C()}),_}function b(_){if(typeof _!="function")throw new Error(bn(10));n=_,x({type:R0.REPLACE})}function j(){const _=g;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(bn(11));function C(){const E=N;E.next&&E.next(m())}return C(),{unsubscribe:_(C)}},[z5](){return this}}}return x({type:R0.INIT}),{dispatch:x,subscribe:g,getState:m,replaceReducer:b,[z5]:j}}function YG(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:R0.INIT})>"u")throw new Error(bn(12));if(typeof r(void 0,{type:R0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(bn(13))})}function qO(e){const t=Object.keys(e),r={};for(let l=0;l<t.length;l++){const c=t[l];typeof e[c]=="function"&&(r[c]=e[c])}const n=Object.keys(r);let a;try{YG(r)}catch(l){a=l}return function(c={},d){if(a)throw a;let h=!1;const f={};for(let m=0;m<n.length;m++){const g=n[m],x=r[g],b=c[g],j=x(b,d);if(typeof j>"u")throw d&&d.type,new Error(bn(14));f[g]=j,h=h||j!==b}return h=h||n.length!==Object.keys(c).length,h?f:c}}function I0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function XG(...e){return t=>(r,n)=>{const a=t(r,n);let l=()=>{throw new Error(bn(15))};const c={getState:a.getState,dispatch:(h,...f)=>l(h,...f)},d=e.map(h=>h(c));return l=I0(...d)(a.dispatch),{...a,dispatch:l}}}function FO(e){return s1(e)&&"type"in e&&typeof e.type=="string"}var HO=Symbol.for("immer-nothing"),B5=Symbol.for("immer-draftable"),$n=Symbol.for("immer-state");function Qs(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var fs=Object,Ec=fs.getPrototypeOf,$0="constructor",Um="prototype",xy="configurable",L0="enumerable",c0="writable",bu="value",ui=e=>!!e&&!!e[$n];function oa(e){var t;return e?VO(e)||qm(e)||!!e[B5]||!!((t=e[$0])!=null&&t[B5])||Fm(e)||Hm(e):!1}var JG=fs[Um][$0].toString(),U5=new WeakMap;function VO(e){if(!e||!a1(e))return!1;const t=Ec(e);if(t===null||t===fs[Um])return!0;const r=fs.hasOwnProperty.call(t,$0)&&t[$0];if(r===Object)return!0;if(!ic(r))return!1;let n=U5.get(r);return n===void 0&&(n=Function.toString.call(r),U5.set(r,n)),n===JG}function Fu(e,t,r=!0){Hu(e)===0?(r?Reflect.ownKeys(e):fs.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Hu(e){const t=e[$n];return t?t.type_:qm(e)?1:Fm(e)?2:Hm(e)?3:0}var q5=(e,t,r=Hu(e))=>r===2?e.has(t):fs[Um].hasOwnProperty.call(e,t),by=(e,t,r=Hu(e))=>r===2?e.get(t):e[t],z0=(e,t,r,n=Hu(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function QG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var qm=Array.isArray,Fm=e=>e instanceof Map,Hm=e=>e instanceof Set,a1=e=>typeof e=="object",ic=e=>typeof e=="function",Vb=e=>typeof e=="boolean",Xa=e=>e.copy_||e.base_,i1=e=>e.modified_?e.copy_:e.base_;function vy(e,t){if(Fm(e))return new Map(e);if(Hm(e))return new Set(e);if(qm(e))return Array[Um].slice.call(e);const r=VO(e);if(t===!0||t==="class_only"&&!r){const n=fs.getOwnPropertyDescriptors(e);delete n[$n];let a=Reflect.ownKeys(n);for(let l=0;l<a.length;l++){const c=a[l],d=n[c];d[c0]===!1&&(d[c0]=!0,d[xy]=!0),(d.get||d.set)&&(n[c]={[xy]:!0,[c0]:!0,[L0]:d[L0],[bu]:e[c]})}return fs.create(Ec(e),n)}else{const n=Ec(e);if(n!==null&&r)return{...e};const a=fs.create(n);return fs.assign(a,e)}}function l1(e,t=!1){return Vm(e)||ui(e)||!oa(e)||(Hu(e)>1&&fs.defineProperties(e,{set:zf,add:zf,clear:zf,delete:zf}),fs.freeze(e),t&&Fu(e,(r,n)=>{l1(n,!0)},!1)),e}function ZG(){Qs(2)}var zf={[bu]:ZG};function Vm(e){return e===null||!a1(e)?!0:fs.isFrozen(e)}var B0="MapSet",yy="Patches",WO={};function Ac(e){const t=WO[e];return t||Qs(0,e),t}var eK=e=>!!WO[e],vu,GO=()=>vu,tK=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:eK(B0)?Ac(B0):void 0});function F5(e,t){t&&(e.patchPlugin_=Ac(yy),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function wy(e){jy(e),e.drafts_.forEach(rK),e.drafts_=null}function jy(e){e===vu&&(vu=e.parent_)}var H5=e=>vu=tK(vu,e);function rK(e){const t=e[$n];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function V5(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[$n].modified_&&(wy(t),Qs(4)),oa(e)&&(e=W5(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[$n].base_,e,t)}else e=W5(t,r);return nK(t,e,!0),wy(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==HO?e:void 0}function W5(e,t){if(Vm(t))return t;const r=t[$n];if(!r)return o1(t,e.handledSet_,e);if(!Wm(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);XO(r,e)}return r.copy_}function nK(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&l1(t,r)}function KO(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Wm=(e,t)=>e.scope_===t,sK=[];function YO(e,t,r,n){const a=Xa(e),l=e.type_;if(n!==void 0&&by(a,n,l)===t){z0(a,n,r,l);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;Fu(a,(h,f)=>{if(ui(f)){const m=d.get(f)||[];m.push(h),d.set(f,m)}})}const c=e.draftLocations_.get(t)??sK;for(const d of c)z0(a,d,r,l)}function aK(e,t,r){e.callbacks_.push(function(a){var d;const l=t;if(!l||!Wm(l,a))return;(d=a.mapSetPlugin_)==null||d.fixSetContents(l);const c=i1(l);YO(e,l.draft_??l,c,r),XO(l,a)})}function XO(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=t;if(a){const l=a.getPath(e);l&&a.generatePatches_(e,l,t)}KO(e)}}function iK(e,t,r){const{scope_:n}=e;if(ui(r)){const a=r[$n];Wm(a,n)&&a.callbacks_.push(function(){d0(e);const c=i1(a);YO(e,r,c,t)})}else oa(r)&&e.callbacks_.push(function(){const l=Xa(e);by(l,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&o1(by(e.copy_,t,e.type_),n.handledSet_,n)})}function o1(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ui(e)||t.has(e)||!oa(e)||Vm(e)||(t.add(e),Fu(e,(n,a)=>{if(ui(a)){const l=a[$n];if(Wm(l,r)){const c=i1(l);z0(e,n,c,e.type_),KO(l)}}else oa(a)&&o1(a,t,r)})),e}function lK(e,t){const r=qm(e),n={type_:r?1:0,scope_:t?t.scope_:GO(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,l=c1;r&&(a=[n],l=yu);const{revoke:c,proxy:d}=Proxy.revocable(a,l);return n.draft_=d,n.revoke_=c,[d,n]}var c1={get(e,t){if(t===$n)return e;const r=Xa(e);if(!q5(r,t,e.type_))return oK(e,r,t);const n=r[t];if(e.finalized_||!oa(n))return n;if(n===Wb(e.base_,t)){d0(e);const a=e.type_===1?+t:t,l=ky(e.scope_,n,e,a);return e.copy_[a]=l}return n},has(e,t){return t in Xa(e)},ownKeys(e){return Reflect.ownKeys(Xa(e))},set(e,t,r){const n=JO(Xa(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Wb(Xa(e),t),l=a==null?void 0:a[$n];if(l&&l.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(QG(r,a)&&(r!==void 0||q5(e.base_,t,e.type_)))return!0;d0(e),_y(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),iK(e,t,r)),!0},deleteProperty(e,t){return d0(e),Wb(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),_y(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Xa(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[c0]:!0,[xy]:e.type_!==1||t!=="length",[L0]:n[L0],[bu]:r[t]}},defineProperty(){Qs(11)},getPrototypeOf(e){return Ec(e.base_)},setPrototypeOf(){Qs(12)}},yu={};Fu(c1,(e,t)=>{yu[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}});yu.deleteProperty=function(e,t){return yu.set.call(this,e,t,void 0)};yu.set=function(e,t,r){return c1.set.call(this,e[0],t,r,e[0])};function Wb(e,t){const r=e[$n];return(r?Xa(r):e)[t]}function oK(e,t,r){var a;const n=JO(t,r);return n?bu in n?n[bu]:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function JO(e,t){if(!(t in e))return;let r=Ec(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Ec(r)}}function _y(e){e.modified_||(e.modified_=!0,e.parent_&&_y(e.parent_))}function d0(e){e.copy_||(e.assigned_=new Map,e.copy_=vy(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var cK=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(ic(r)&&!ic(n)){const c=n;n=r;const d=this;return function(f=c,...m){return d.produce(f,g=>n.call(this,g,...m))}}ic(n)||Qs(6),a!==void 0&&!ic(a)&&Qs(7);let l;if(oa(r)){const c=H5(this),d=ky(c,r,void 0);let h=!0;try{l=n(d),h=!1}finally{h?wy(c):jy(c)}return F5(c,a),V5(l,c)}else if(!r||!a1(r)){if(l=n(r),l===void 0&&(l=r),l===HO&&(l=void 0),this.autoFreeze_&&l1(l,!0),a){const c=[],d=[];Ac(yy).generateReplacementPatches_(r,l,{patches_:c,inversePatches_:d}),a(c,d)}return l}else Qs(1,r)},this.produceWithPatches=(r,n)=>{if(ic(r))return(d,...h)=>this.produceWithPatches(d,f=>r(f,...h));let a,l;return[this.produce(r,n,(d,h)=>{a=d,l=h}),a,l]},Vb(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Vb(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Vb(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){oa(t)||Qs(8),ui(t)&&(t=ra(t));const r=H5(this),n=ky(r,t,void 0);return n[$n].isManual_=!0,jy(r),n}finishDraft(t,r){const n=t&&t[$n];(!n||!n.isManual_)&&Qs(9);const{scope_:a}=n;return F5(a,r),V5(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const l=r[n];if(l.path.length===0&&l.op==="replace"){t=l.value;break}}n>-1&&(r=r.slice(n+1));const a=Ac(yy).applyPatches_;return ui(t)?a(t,r):this.produce(t,l=>a(l,r))}};function ky(e,t,r,n){const[a,l]=Fm(t)?Ac(B0).proxyMap_(t,r):Hm(t)?Ac(B0).proxySet_(t,r):lK(t,r);return((r==null?void 0:r.scope_)??GO()).drafts_.push(a),l.callbacks_=(r==null?void 0:r.callbacks_)??[],l.key_=n,r&&n!==void 0?aK(r,l,n):l.callbacks_.push(function(h){var m;(m=h.mapSetPlugin_)==null||m.fixSetContents(l);const{patchPlugin_:f}=h;l.modified_&&f&&f.generatePatches_(l,[],h)}),a}function ra(e){return ui(e)||Qs(10,e),QO(e)}function QO(e){if(!oa(e)||Vm(e))return e;const t=e[$n];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=vy(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=vy(e,!0);return Fu(r,(a,l)=>{z0(r,a,QO(l))},n),t&&(t.finalized_=!1),r}var dK=new cK,ZO=dK.produce;function e6(e){return({dispatch:r,getState:n})=>a=>l=>typeof l=="function"?l(r,n,e):a(l)}var uK=e6(),hK=e6,fK=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?I0:I0.apply(null,arguments)};function Us(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(ms(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>FO(n)&&n.type===e,r}var t6=class ru extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ru.prototype)}static get[Symbol.species](){return ru}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ru(...t[0].concat(this)):new ru(...t.concat(this))}};function G5(e){return oa(e)?ZO(e,()=>{}):e}function Bf(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function mK(e){return typeof e=="boolean"}var pK=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:l=!0}=t??{};let c=new t6;return r&&(mK(r)?c.push(uK):c.push(hK(r.extraArgument))),c},r6="RTK_autoBatch",pr=()=>e=>({payload:e,meta:{[r6]:!0}}),K5=e=>t=>{setTimeout(t,e)},n6=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,l=!1,c=!1;const d=new Set,h=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:K5(10):e.type==="callback"?e.queueNotification:K5(e.timeout),f=()=>{c=!1,l&&(l=!1,d.forEach(m=>m()))};return Object.assign({},n,{subscribe(m){const g=()=>a&&m(),x=n.subscribe(g);return d.add(m),()=>{x(),d.delete(m)}},dispatch(m){var g;try{return a=!((g=m==null?void 0:m.meta)!=null&&g[r6]),l=!a,l&&(c||(c=!0,h(f))),n.dispatch(m)}finally{a=!0}}})},gK=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new t6(e);return n&&a.push(n6(typeof n=="object"?n:void 0)),a};function xK(e){const t=pK(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:l=void 0,enhancers:c=void 0}=e||{};let d;if(typeof r=="function")d=r;else if(s1(r))d=qO(r);else throw new Error(ms(1));let h;typeof n=="function"?h=n(t):h=t();let f=I0;a&&(f=fK({trace:!1,...typeof a=="object"&&a}));const m=XG(...h),g=gK(m);let x=typeof c=="function"?c(g):g();const b=f(...x);return UO(d,l,b)}function s6(e){const t={},r=[];let n;const a={addCase(l,c){const d=typeof l=="string"?l:l.type;if(!d)throw new Error(ms(28));if(d in t)throw new Error(ms(29));return t[d]=c,a},addAsyncThunk(l,c){return c.pending&&(t[l.pending.type]=c.pending),c.rejected&&(t[l.rejected.type]=c.rejected),c.fulfilled&&(t[l.fulfilled.type]=c.fulfilled),c.settled&&r.push({matcher:l.settled,reducer:c.settled}),a},addMatcher(l,c){return r.push({matcher:l,reducer:c}),a},addDefaultCase(l){return n=l,a}};return e(a),[t,r,n]}function bK(e){return typeof e=="function"}function vK(e,t){let[r,n,a]=s6(t),l;if(bK(e))l=()=>G5(e());else{const d=G5(e);l=()=>d}function c(d=l(),h){let f=[r[h.type],...n.filter(({matcher:m})=>m(h)).map(({reducer:m})=>m)];return f.filter(m=>!!m).length===0&&(f=[a]),f.reduce((m,g)=>{if(g)if(ui(m)){const b=g(m,h);return b===void 0?m:b}else{if(oa(m))return ZO(m,x=>g(x,h));{const x=g(m,h);if(x===void 0){if(m===null)return m;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return m},d)}return c.getInitialState=l,c}var yK="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",wK=(e=21)=>{let t="",r=e;for(;r--;)t+=yK[Math.random()*64|0];return t},jK=Symbol.for("rtk-slice-createasyncthunk");function _K(e,t){return`${e}/${t}`}function kK({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[jK];return function(a){const{name:l,reducerPath:c=l}=a;if(!l)throw new Error(ms(11));const d=(typeof a.reducers=="function"?a.reducers(SK()):a.reducers)||{},h=Object.keys(d),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},m={addCase(E,S){const T=typeof E=="string"?E:E.type;if(!T)throw new Error(ms(12));if(T in f.sliceCaseReducersByType)throw new Error(ms(13));return f.sliceCaseReducersByType[T]=S,m},addMatcher(E,S){return f.sliceMatchers.push({matcher:E,reducer:S}),m},exposeAction(E,S){return f.actionCreators[E]=S,m},exposeCaseReducer(E,S){return f.sliceCaseReducersByName[E]=S,m}};h.forEach(E=>{const S=d[E],T={reducerName:E,type:_K(l,E),createNotation:typeof a.reducers=="function"};EK(S)?TK(T,S,m,t):CK(T,S,m)});function g(){const[E={},S=[],T=void 0]=typeof a.extraReducers=="function"?s6(a.extraReducers):[a.extraReducers],D={...E,...f.sliceCaseReducersByType};return vK(a.initialState,P=>{for(let I in D)P.addCase(I,D[I]);for(let I of f.sliceMatchers)P.addMatcher(I.matcher,I.reducer);for(let I of S)P.addMatcher(I.matcher,I.reducer);T&&P.addDefaultCase(T)})}const x=E=>E,b=new Map,j=new WeakMap;let w;function _(E,S){return w||(w=g()),w(E,S)}function N(){return w||(w=g()),w.getInitialState()}function C(E,S=!1){function T(P){let I=P[E];return typeof I>"u"&&S&&(I=Bf(j,T,N)),I}function D(P=x){const I=Bf(b,S,()=>new WeakMap);return Bf(I,P,()=>{const $={};for(const[M,R]of Object.entries(a.selectors??{}))$[M]=NK(R,P,()=>Bf(j,P,N),S);return $})}return{reducerPath:E,getSelectors:D,get selectors(){return D(T)},selectSlice:T}}const A={name:l,reducer:_,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:N,...C(c),injectInto(E,{reducerPath:S,...T}={}){const D=S??c;return E.inject({reducerPath:D,reducer:_},T),{...A,...C(D,!0)}}};return A}}function NK(e,t,r,n){function a(l,...c){let d=t(l);return typeof d>"u"&&n&&(d=r()),e(d,...c)}return a.unwrapped=e,a}var Jn=kK();function SK(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function CK({type:e,reducerName:t,createNotation:r},n,a){let l,c;if("reducer"in n){if(r&&!AK(n))throw new Error(ms(17));l=n.reducer,c=n.prepare}else l=n;a.addCase(e,l).exposeCaseReducer(t,l).exposeAction(t,c?Us(e,c):Us(e))}function EK(e){return e._reducerDefinitionType==="asyncThunk"}function AK(e){return e._reducerDefinitionType==="reducerWithPrepare"}function TK({type:e,reducerName:t},r,n,a){if(!a)throw new Error(ms(18));const{payloadCreator:l,fulfilled:c,pending:d,rejected:h,settled:f,options:m}=r,g=a(e,l,m);n.exposeAction(t,g),c&&n.addCase(g.fulfilled,c),d&&n.addCase(g.pending,d),h&&n.addCase(g.rejected,h),f&&n.addMatcher(g.settled,f),n.exposeCaseReducer(t,{fulfilled:c||Uf,pending:d||Uf,rejected:h||Uf,settled:f||Uf})}function Uf(){}var OK="task",a6="listener",i6="completed",d1="cancelled",PK=`task-${d1}`,DK=`task-${i6}`,Ny=`${a6}-${d1}`,MK=`${a6}-${i6}`,Gm=class{constructor(e){Ax(this,"name","TaskAbortError");Ax(this,"message");this.code=e,this.message=`${OK} ${d1} (reason: ${e})`}},u1=(e,t)=>{if(typeof e!="function")throw new TypeError(ms(32))},U0=()=>{},l6=(e,t=U0)=>(e.catch(t),e),o6=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Xl=e=>{if(e.aborted)throw new Gm(e.reason)};function c6(e,t){let r=U0;return new Promise((n,a)=>{const l=()=>a(new Gm(e.reason));if(e.aborted){l();return}r=o6(e,l),t.finally(()=>r()).then(n,a)}).finally(()=>{r=U0})}var RK=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Gm?"cancelled":"rejected",error:r}}finally{t==null||t()}},q0=e=>t=>l6(c6(e,t).then(r=>(Xl(e),r))),d6=e=>{const t=q0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:xc}=Object,Y5={},Km="listenerMiddleware",IK=(e,t)=>{const r=n=>o6(e,()=>n.abort(e.reason));return(n,a)=>{u1(n);const l=new AbortController;r(l);const c=RK(async()=>{Xl(e),Xl(l.signal);const d=await n({pause:q0(l.signal),delay:d6(l.signal),signal:l.signal});return Xl(l.signal),d},()=>l.abort(DK));return a!=null&&a.autoJoin&&t.push(c.catch(U0)),{result:q0(e)(c),cancel(){l.abort(PK)}}}},$K=(e,t)=>{const r=async(n,a)=>{Xl(t);let l=()=>{};const d=[new Promise((h,f)=>{let m=e({predicate:n,effect:(g,x)=>{x.unsubscribe(),h([g,x.getState(),x.getOriginalState()])}});l=()=>{m(),f()}})];a!=null&&d.push(new Promise(h=>setTimeout(h,a,null)));try{const h=await c6(t,Promise.race(d));return Xl(t),h}finally{l()}};return(n,a)=>l6(r(n,a))},u6=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:l}=e;if(t)a=Us(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(ms(21));return u1(l),{predicate:a,type:t,effect:l}},h6=xc(e=>{const{type:t,predicate:r,effect:n}=u6(e);return{id:wK(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ms(22))}}},{withTypes:()=>h6}),X5=(e,t)=>{const{type:r,effect:n,predicate:a}=u6(t);return Array.from(e.values()).find(l=>(typeof r=="string"?l.type===r:l.predicate===a)&&l.effect===n)},Sy=e=>{e.pending.forEach(t=>{t.abort(Ny)})},LK=(e,t)=>()=>{for(const r of t.keys())Sy(r);e.clear()},J5=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},f6=xc(Us(`${Km}/add`),{withTypes:()=>f6}),zK=Us(`${Km}/removeAll`),m6=xc(Us(`${Km}/remove`),{withTypes:()=>m6}),BK=(...e)=>{console.error(`${Km}/error`,...e)},Vu=(e={})=>{const t=new Map,r=new Map,n=b=>{const j=r.get(b)??0;r.set(b,j+1)},a=b=>{const j=r.get(b)??1;j===1?r.delete(b):r.set(b,j-1)},{extra:l,onError:c=BK}=e;u1(c);const d=b=>(b.unsubscribe=()=>t.delete(b.id),t.set(b.id,b),j=>{b.unsubscribe(),j!=null&&j.cancelActive&&Sy(b)}),h=b=>{const j=X5(t,b)??h6(b);return d(j)};xc(h,{withTypes:()=>h});const f=b=>{const j=X5(t,b);return j&&(j.unsubscribe(),b.cancelActive&&Sy(j)),!!j};xc(f,{withTypes:()=>f});const m=async(b,j,w,_)=>{const N=new AbortController,C=$K(h,N.signal),A=[];try{b.pending.add(N),n(b),await Promise.resolve(b.effect(j,xc({},w,{getOriginalState:_,condition:(E,S)=>C(E,S).then(Boolean),take:C,delay:d6(N.signal),pause:q0(N.signal),extra:l,signal:N.signal,fork:IK(N.signal,A),unsubscribe:b.unsubscribe,subscribe:()=>{t.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((E,S,T)=>{E!==N&&(E.abort(Ny),T.delete(E))})},cancel:()=>{N.abort(Ny),b.pending.delete(N)},throwIfCancelled:()=>{Xl(N.signal)}})))}catch(E){E instanceof Gm||J5(c,E,{raisedBy:"effect"})}finally{await Promise.all(A),N.abort(MK),a(b),b.pending.delete(N)}},g=LK(t,r);return{middleware:b=>j=>w=>{if(!FO(w))return j(w);if(f6.match(w))return h(w.payload);if(zK.match(w)){g();return}if(m6.match(w))return f(w.payload);let _=b.getState();const N=()=>{if(_===Y5)throw new Error(ms(23));return _};let C;try{if(C=j(w),t.size>0){const A=b.getState(),E=Array.from(t.values());for(const S of E){let T=!1;try{T=S.predicate(w,A,_)}catch(D){T=!1,J5(c,D,{raisedBy:"predicate"})}T&&m(S,w,b,N)}}}finally{_=Y5}return C},startListening:h,stopListening:f,clearListeners:g}};function ms(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var UK={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},p6=Jn({name:"chartLayout",initialState:UK,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,l;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(l=t.payload.left)!==null&&l!==void 0?l:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:qK,setLayout:FK,setChartSize:HK,setScale:VK}=p6.actions,WK=p6.reducer;function g6(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function wr(e){return Number.isFinite(e)}function _a(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){GK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GK(e,t,r){return(t=KK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KK(e){var t=YK(e,"string");return typeof t=="symbol"?t:t+""}function YK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kn(e,t,r){return ln(e)||ln(t)?r:ja(t)?Cc(e,t,r):typeof t=="function"?t(e):r}var XK=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:l,verticalAlign:c,layout:d}=t;if((d==="vertical"||d==="horizontal"&&c==="middle")&&l!=="center"&&We(e[l]))return dc(dc({},e),{},{[l]:e[l]+(n||0)});if((d==="horizontal"||d==="vertical"&&l==="center")&&c!=="middle"&&We(e[c]))return dc(dc({},e),{},{[c]:e[c]+(a||0)})}return e},oo=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",x6=(e,t,r,n)=>{if(n)return e.map(d=>d.coordinate);var a,l,c=e.map(d=>(d.coordinate===t&&(a=!0),d.coordinate===r&&(l=!0),d.coordinate));return a||c.push(t),l||c.push(r),c},b6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:l,scale:c,realScaleType:d,isCategorical:h,categoricalDomain:f,tickCount:m,ticks:g,niceTicks:x,axisType:b}=e;if(!c)return null;var j=d==="scaleBand"&&c.bandwidth?c.bandwidth()/2:2,w=a==="category"&&c.bandwidth?c.bandwidth()/j:0;if(w=b==="angleAxis"&&l&&l.length>=2?Kn(l[0]-l[1])*2*w:w,g||x){var _=(g||x||[]).map((N,C)=>{var A=n?n.indexOf(N):N;return{coordinate:c(A)+w,value:N,offset:w,index:C}});return _.filter(N=>!ia(N.coordinate))}return h&&f?f.map((N,C)=>({coordinate:c(N)+w,value:N,index:C,offset:w})):c.ticks&&m!=null?c.ticks(m).map((N,C)=>({coordinate:c(N)+w,value:N,offset:w,index:C})):c.domain().map((N,C)=>({coordinate:c(N)+w,value:n?n[N]:N,index:C,offset:w}))},Z5=1e-4,JK=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Z5,l=Math.max(n[0],n[1])+Z5,c=e(t[0]),d=e(t[r-1]);(c<a||c>l||d<a||d>l)&&e.domain([t[0],t[r-1]])}},QK=(e,t)=>{if(!t||t.length!==2||!We(t[0])||!We(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!We(e[0])||e[0]<r)&&(a[0]=r),(!We(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},ZK=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var l=0,c=0,d=0;d<r;++d){var h=e[d],f=h==null?void 0:h[a];if(f!=null){var m=f[1],g=f[0],x=ia(m)?g:m;x>=0?(f[0]=l,f[1]=l+x,l=m):(f[0]=c,f[1]=c+x,c=m)}}}},eY=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var l=0,c=0;c<r;++c){var d=e[c],h=d==null?void 0:d[a];if(h!=null){var f=ia(h[1])?h[0]:h[1];f>=0?(h[0]=l,h[1]=l+f,l=h[1]):(h[0]=0,h[1]=0)}}}},tY={sign:ZK,expand:SW,none:to,silhouette:CW,wiggle:EW,positive:eY},rY=(e,t,r)=>{var n,a=(n=tY[r])!==null&&n!==void 0?n:to,l=NW().keys(t).value((d,h)=>Number(kn(d,h,0))).order(py).offset(a),c=l(e);return c.forEach((d,h)=>{d.forEach((f,m)=>{var g=kn(e[m],t[h],0);Array.isArray(g)&&g.length===2&&We(g[0])&&We(g[1])&&(f[0]=g[0],f[1]=g[1])})}),c};function nY(e){return e==null?void 0:String(e)}var e4=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:l,index:c}=e;if(t.type==="category")return r[c]?r[c].coordinate+n:null;var d=kn(l,t.dataKey,t.scale.domain()[c]);return ln(d)?null:t.scale(d)-a/2+n},sY=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},aY=e=>{var t=e.flat(2).filter(We);return[Math.min(...t),Math.max(...t)]},iY=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],lY=(e,t,r)=>{if(e!=null)return iY(Object.keys(e).reduce((n,a)=>{var l=e[a];if(!l)return n;var{stackedData:c}=l,d=c.reduce((h,f)=>{var m=g6(f,t,r),g=aY(m);return!wr(g[0])||!wr(g[1])?h:[Math.min(h[0],g[0]),Math.max(h[1],g[1])]},[1/0,-1/0]);return[Math.min(d[0],n[0]),Math.max(d[1],n[1])]},[1/0,-1/0]))},t4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,r4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,F0=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Bm(t,m=>m.coordinate),l=1/0,c=1,d=a.length;c<d;c++){var h=a[c],f=a[c-1];l=Math.min(((h==null?void 0:h.coordinate)||0)-((f==null?void 0:f.coordinate)||0),l)}return l===1/0?0:l}return r?void 0:0};function n4(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:l}=e;return dc(dc({},t),{},{dataKey:r,payload:n,value:a,name:l})}function v6(e,t){if(e)return String(e);if(typeof t=="string")return t}var oY=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},cY=(e,t)=>t==="centric"?e.angle:e.radius,xi=e=>e.layout.width,bi=e=>e.layout.height,dY=e=>e.layout.scale,y6=e=>e.layout.margin,Ym=de(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Xm=de(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),uY="data-recharts-item-index",hY="data-recharts-item-id",Wu=60;function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(n){fY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fY(e,t,r){return(t=mY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mY(e){var t=pY(e,"string");return typeof t=="symbol"?t:t+""}function pY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gY=e=>e.brush.height;function xY(e){var t=Xm(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Wu;return r+a}return r},0)}function bY(e){var t=Xm(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Wu;return r+a}return r},0)}function vY(e){var t=Ym(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function yY(e){var t=Ym(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var on=de([xi,bi,y6,gY,xY,bY,vY,yY,BO,HG],(e,t,r,n,a,l,c,d,h,f)=>{var m={left:(r.left||0)+a,right:(r.right||0)+l},g={top:(r.top||0)+c,bottom:(r.bottom||0)+d},x=qf(qf({},g),m),b=x.bottom;x.bottom+=n,x=XK(x,h,f);var j=e-x.left-x.right,w=t-x.top-x.bottom;return qf(qf({brushBottom:b},x),{},{width:Math.max(j,0),height:Math.max(w,0)})}),wY=de(on,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),h1=de(xi,bi,(e,t)=>({x:0,y:0,width:e,height:t})),jY=v.createContext(null),Qn=()=>v.useContext(jY)!=null,Jm=e=>e.brush,Qm=de([Jm,on,y6],(e,t,r)=>({height:e.height,x:We(e.x)?e.x:t.left,y:We(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:We(e.width)?e.width:t.width})),Gb={},Kb={},Yb={},a4;function _Y(){return a4||(a4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:l}={}){let c,d=null;const h=l!=null&&l.includes("leading"),f=l==null||l.includes("trailing"),m=()=>{d!==null&&(r.apply(c,d),c=void 0,d=null)},g=()=>{f&&m(),w()};let x=null;const b=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,g()},n)},j=()=>{x!==null&&(clearTimeout(x),x=null)},w=()=>{j(),c=void 0,d=null},_=()=>{m()},N=function(...C){if(a!=null&&a.aborted)return;c=this,d=C;const A=x==null;b(),h&&A&&m()};return N.schedule=b,N.cancel=w,N.flush=_,a==null||a.addEventListener("abort",w,{once:!0}),N}e.debounce=t})(Yb)),Yb}var i4;function kY(){return i4||(i4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_Y();function r(n,a=0,l={}){typeof l!="object"&&(l={});const{leading:c=!1,trailing:d=!0,maxWait:h}=l,f=Array(2);c&&(f[0]="leading"),d&&(f[1]="trailing");let m,g=null;const x=t.debounce(function(...w){m=n.apply(this,w),g=null},a,{edges:f}),b=function(...w){return h!=null&&(g===null&&(g=Date.now()),Date.now()-g>=h)?(m=n.apply(this,w),g=Date.now(),x.cancel(),x.schedule(),m):(x.apply(this,w),m)},j=()=>(x.flush(),m);return b.cancel=x.cancel,b.flush=j,b}e.debounce=r})(Kb)),Kb}var l4;function NY(){return l4||(l4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kY();function r(n,a=0,l={}){const{leading:c=!0,trailing:d=!0}=l;return t.debounce(n,a,{leading:c,maxWait:a,trailing:d})}e.throttle=r})(Gb)),Gb}var Xb,o4;function SY(){return o4||(o4=1,Xb=NY().throttle),Xb}var CY=SY();const EY=vs(CY);var H0=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=0;console.warn(r.replace(/%s/g,()=>a[c++]))}},w6=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:l,maxHeight:c}=r,d=di(n)?e:Number(n),h=di(a)?t:Number(a);return l&&l>0&&(d?h=d/l:h&&(d=h*l),c&&h!=null&&h>c&&(h=c)),{calculatedWidth:d,calculatedHeight:h}},AY={width:0,height:0,overflow:"visible"},TY={width:0,overflowX:"visible"},OY={height:0,overflowY:"visible"},PY={},DY=e=>{var{width:t,height:r}=e,n=di(t),a=di(r);return n&&a?AY:n?TY:a?OY:PY};function MY(e){var{width:t,height:r,aspect:n}=e,a=t,l=r;return a===void 0&&l===void 0?(a="100%",l="100%"):a===void 0?a=n&&n>0?void 0:"100%":l===void 0&&(l=n&&n>0?void 0:"100%"),{width:a,height:l}}function Cy(){return Cy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cy.apply(null,arguments)}function c4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c4(Object(r),!0).forEach(function(n){RY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RY(e,t,r){return(t=IY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IY(e){var t=$Y(e,"string");return typeof t=="symbol"?t:t+""}function $Y(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j6=v.createContext({width:-1,height:-1});function LY(e){return _a(e.width)&&_a(e.height)}function _6(e){var{children:t,width:r,height:n}=e,a=v.useMemo(()=>({width:r,height:n}),[r,n]);return LY(a)?v.createElement(j6.Provider,{value:a},t):null}var f1=()=>v.useContext(j6),zY=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:l,minWidth:c=0,minHeight:d,maxHeight:h,children:f,debounce:m=0,id:g,className:x,onResize:b,style:j={}}=e,w=v.useRef(null),_=v.useRef();_.current=b,v.useImperativeHandle(t,()=>w.current);var[N,C]=v.useState({containerWidth:n.width,containerHeight:n.height}),A=v.useCallback((P,I)=>{C($=>{var M=Math.round(P),R=Math.round(I);return $.containerWidth===M&&$.containerHeight===R?$:{containerWidth:M,containerHeight:R}})},[]);v.useEffect(()=>{if(w.current==null||typeof ResizeObserver>"u")return qu;var P=R=>{var F,{width:V,height:H}=R[0].contentRect;A(V,H),(F=_.current)===null||F===void 0||F.call(_,V,H)};m>0&&(P=EY(P,m,{trailing:!0,leading:!1}));var I=new ResizeObserver(P),{width:$,height:M}=w.current.getBoundingClientRect();return A($,M),I.observe(w.current),()=>{I.disconnect()}},[A,m]);var{containerWidth:E,containerHeight:S}=N;H0(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:T,calculatedHeight:D}=w6(E,S,{width:a,height:l,aspect:r,maxHeight:h});return H0(T!=null&&T>0||D!=null&&D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,D,a,l,c,d,r),v.createElement("div",{id:g?"".concat(g):void 0,className:cr("recharts-responsive-container",x),style:d4(d4({},j),{},{width:a,height:l,minWidth:c,minHeight:d,maxHeight:h}),ref:w},v.createElement("div",{style:DY({width:a,height:l})},v.createElement(_6,{width:T,height:D},f)))}),k6=v.forwardRef((e,t)=>{var r=f1();if(_a(r.width)&&_a(r.height))return e.children;var{width:n,height:a}=MY({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:l,calculatedHeight:c}=w6(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return We(l)&&We(c)?v.createElement(_6,{width:l,height:c},e.children):v.createElement(zY,Cy({},e,{width:n,height:a,ref:t}))});function N6(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Zm=()=>{var e,t=Qn(),r=Xe(wY),n=Xe(Qm),a=(e=Xe(Jm))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},BY={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},S6=()=>{var e;return(e=Xe(on))!==null&&e!==void 0?e:BY},C6=()=>Xe(xi),E6=()=>Xe(bi),Wt=e=>e.layout.layoutType,Gu=()=>Xe(Wt),UY=()=>{var e=Gu();return e!==void 0},ep=e=>{var t=Dr(),r=Qn(),{width:n,height:a}=e,l=f1(),c=n,d=a;return l&&(c=l.width>0?l.width:n,d=l.height>0?l.height:a),v.useEffect(()=>{!r&&_a(c)&&_a(d)&&t(HK({width:c,height:d}))},[t,r,c,d]),null},A6=Symbol.for("immer-nothing"),u4=Symbol.for("immer-draftable"),bs=Symbol.for("immer-state");function Zs(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var wu=Object.getPrototypeOf;function Tc(e){return!!e&&!!e[bs]}function ro(e){var t;return e?T6(e)||Array.isArray(e)||!!e[u4]||!!((t=e.constructor)!=null&&t[u4])||Ku(e)||rp(e):!1}var qY=Object.prototype.constructor.toString(),h4=new WeakMap;function T6(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=h4.get(r);return n===void 0&&(n=Function.toString.call(r),h4.set(r,n)),n===qY}function V0(e,t,r=!0){tp(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function tp(e){const t=e[bs];return t?t.type_:Array.isArray(e)?1:Ku(e)?2:rp(e)?3:0}function Ey(e,t){return tp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function O6(e,t,r){const n=tp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function FY(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Ku(e){return e instanceof Map}function rp(e){return e instanceof Set}function $l(e){return e.copy_||e.base_}function Ay(e,t){if(Ku(e))return new Map(e);if(rp(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=T6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[bs];let a=Reflect.ownKeys(n);for(let l=0;l<a.length;l++){const c=a[l],d=n[c];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(n[c]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[c]})}return Object.create(wu(e),n)}else{const n=wu(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function m1(e,t=!1){return np(e)||Tc(e)||!ro(e)||(tp(e)>1&&Object.defineProperties(e,{set:Ff,add:Ff,clear:Ff,delete:Ff}),Object.freeze(e),t&&Object.values(e).forEach(r=>m1(r,!0))),e}function HY(){Zs(2)}var Ff={value:HY};function np(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var VY={};function no(e){const t=VY[e];return t||Zs(0,e),t}var ju;function P6(){return ju}function WY(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function f4(e,t){t&&(no("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Ty(e){Oy(e),e.drafts_.forEach(GY),e.drafts_=null}function Oy(e){e===ju&&(ju=e.parent_)}function m4(e){return ju=WY(ju,e)}function GY(e){const t=e[bs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function p4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[bs].modified_&&(Ty(t),Zs(4)),ro(e)&&(e=W0(t,e),t.parent_||G0(t,e)),t.patches_&&no("Patches").generateReplacementPatches_(r[bs].base_,e,t.patches_,t.inversePatches_)):e=W0(t,r,[]),Ty(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==A6?e:void 0}function W0(e,t,r){if(np(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[bs];if(!a)return V0(t,(l,c)=>g4(e,a,t,l,c,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return G0(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const l=a.copy_;let c=l,d=!1;a.type_===3&&(c=new Set(l),l.clear(),d=!0),V0(c,(h,f)=>g4(e,a,l,h,f,r,d),n),G0(e,l,!1),r&&e.patches_&&no("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function g4(e,t,r,n,a,l,c){if(a==null||typeof a!="object"&&!c)return;const d=np(a);if(!(d&&!c)){if(Tc(a)){const h=l&&t&&t.type_!==3&&!Ey(t.assigned_,n)?l.concat(n):void 0,f=W0(e,a,h);if(O6(r,n,f),Tc(f))e.canAutoFreeze_=!1;else return}else c&&r.add(a);if(ro(a)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&d)return;W0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Ku(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&G0(e,a)}}}function G0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&m1(t,r)}function KY(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:P6(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,l=p1;r&&(a=[n],l=_u);const{revoke:c,proxy:d}=Proxy.revocable(a,l);return n.draft_=d,n.revoke_=c,d}var p1={get(e,t){if(t===bs)return e;const r=$l(e);if(!Ey(r,t))return YY(e,r,t);const n=r[t];return e.finalized_||!ro(n)?n:n===Jb(e.base_,t)?(Qb(e),e.copy_[t]=Dy(n,e)):n},has(e,t){return t in $l(e)},ownKeys(e){return Reflect.ownKeys($l(e))},set(e,t,r){const n=D6($l(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Jb($l(e),t),l=a==null?void 0:a[bs];if(l&&l.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(FY(r,a)&&(r!==void 0||Ey(e.base_,t)))return!0;Qb(e),Py(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Jb(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Qb(e),Py(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=$l(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Zs(11)},getPrototypeOf(e){return wu(e.base_)},setPrototypeOf(){Zs(12)}},_u={};V0(p1,(e,t)=>{_u[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});_u.deleteProperty=function(e,t){return _u.set.call(this,e,t,void 0)};_u.set=function(e,t,r){return p1.set.call(this,e[0],t,r,e[0])};function Jb(e,t){const r=e[bs];return(r?$l(r):e)[t]}function YY(e,t,r){var a;const n=D6(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function D6(e,t){if(!(t in e))return;let r=wu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=wu(r)}}function Py(e){e.modified_||(e.modified_=!0,e.parent_&&Py(e.parent_))}function Qb(e){e.copy_||(e.copy_=Ay(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var XY=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const l=r;r=t;const c=this;return function(h=l,...f){return c.produce(h,m=>r.call(this,m,...f))}}typeof r!="function"&&Zs(6),n!==void 0&&typeof n!="function"&&Zs(7);let a;if(ro(t)){const l=m4(this),c=Dy(t,void 0);let d=!0;try{a=r(c),d=!1}finally{d?Ty(l):Oy(l)}return f4(l,n),p4(a,l)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===A6&&(a=void 0),this.autoFreeze_&&m1(a,!0),n){const l=[],c=[];no("Patches").generateReplacementPatches_(t,a,l,c),n(l,c)}return a}else Zs(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(c,...d)=>this.produceWithPatches(c,h=>t(h,...d));let n,a;return[this.produce(t,r,(c,d)=>{n=c,a=d}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){ro(e)||Zs(8),Tc(e)&&(e=JY(e));const t=m4(this),r=Dy(e,void 0);return r[bs].isManual_=!0,Oy(t),r}finishDraft(e,t){const r=e&&e[bs];(!r||!r.isManual_)&&Zs(9);const{scope_:n}=r;return f4(n,t),p4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=no("Patches").applyPatches_;return Tc(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Dy(e,t){const r=Ku(e)?no("MapSet").proxyMap_(e,t):rp(e)?no("MapSet").proxySet_(e,t):KY(e,t);return(t?t.scope_:P6()).drafts_.push(r),r}function JY(e){return Tc(e)||Zs(10,e),M6(e)}function M6(e){if(!ro(e)||np(e))return e;const t=e[bs];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ay(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Ay(e,!0);return V0(r,(a,l)=>{O6(r,a,M6(l))},n),t&&(t.finalized_=!1),r}var QY=new XY;QY.produce;var ZY={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},R6=Jn({name:"legend",initialState:ZY,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:pr()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ra(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:pr()},removeLegendPayload:{reducer(e,t){var r=ra(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:pr()}}}),{setLegendSize:Qde,setLegendSettings:Zde,addLegendPayload:eX,replaceLegendPayload:tX,removeLegendPayload:rX}=R6.actions,nX=R6.reducer;function My(){return My=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},My.apply(null,arguments)}function x4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x4(Object(r),!0).forEach(function(n){sX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sX(e,t,r){return(t=aX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aX(e){var t=iX(e,"string");return typeof t=="symbol"?t:t+""}function iX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lX(e){return Array.isArray(e)&&ja(e[0])&&ja(e[1])?e.join(" ~ "):e}var oX=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:l,formatter:c,itemSorter:d,wrapperClassName:h,labelClassName:f,label:m,labelFormatter:g,accessibilityLayer:x=!1}=e,b=()=>{if(l&&l.length){var S={padding:0,margin:0},T=(d?Bm(l,d):l).map((D,P)=>{if(D.type==="none")return null;var I=D.formatter||c||lX,{value:$,name:M}=D,R=$,F=M;if(I){var V=I($,M,D,P,l);if(Array.isArray(V))[R,F]=V;else if(V!=null)R=V;else return null}var H=Zb({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:H},ja(F)?v.createElement("span",{className:"recharts-tooltip-item-name"},F):null,ja(F)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},R),v.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:S},T)}return null},j=Zb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),w=Zb({margin:0},a),_=!ln(m),N=_?m:"",C=cr("recharts-default-tooltip",h),A=cr("recharts-tooltip-label",f);_&&g&&l!==void 0&&l!==null&&(N=g(m,l));var E=x?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",My({className:C,style:j},E),v.createElement("p",{className:A,style:w},v.isValidElement(N)?N:"".concat(N)),b())},Fd="recharts-tooltip-wrapper",cX={visibility:"hidden"};function dX(e){var{coordinate:t,translateX:r,translateY:n}=e;return cr(Fd,{["".concat(Fd,"-right")]:We(r)&&t&&We(t.x)&&r>=t.x,["".concat(Fd,"-left")]:We(r)&&t&&We(t.x)&&r<t.x,["".concat(Fd,"-bottom")]:We(n)&&t&&We(t.y)&&n>=t.y,["".concat(Fd,"-top")]:We(n)&&t&&We(t.y)&&n<t.y})}function b4(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:l,reverseDirection:c,tooltipDimension:d,viewBox:h,viewBoxDimension:f}=e;if(l&&We(l[n]))return l[n];var m=r[n]-d-(a>0?a:0),g=r[n]+a;if(t[n])return c[n]?m:g;var x=h[n];if(x==null)return 0;if(c[n]){var b=m,j=x;return b<j?Math.max(g,x):Math.max(m,x)}if(f==null)return 0;var w=g+d,_=x+f;return w>_?Math.max(m,x):Math.max(g,x)}function uX(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function hX(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:l,tooltipBox:c,useTranslate3d:d,viewBox:h}=e,f,m,g;return c.height>0&&c.width>0&&r?(m=b4({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:c.width,viewBox:h,viewBoxDimension:h.width}),g=b4({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:c.height,viewBox:h,viewBoxDimension:h.height}),f=uX({translateX:m,translateY:g,useTranslate3d:d})):f=cX,{cssProperties:f,cssClasses:dX({translateX:m,translateY:g,coordinate:r})}}function v4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v4(Object(r),!0).forEach(function(n){Ry(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ry(e,t,r){return(t=fX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fX(e){var t=mX(e,"string");return typeof t=="symbol"?t:t+""}function mX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class pX extends v.PureComponent{constructor(){super(...arguments),Ry(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Ry(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,l;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:l,coordinate:c,hasPayload:d,isAnimationActive:h,offset:f,position:m,reverseDirection:g,useTranslate3d:x,viewBox:b,wrapperStyle:j,lastBoundingBox:w,innerRef:_,hasPortalFromProps:N}=this.props,{cssClasses:C,cssProperties:A}=hX({allowEscapeViewBox:r,coordinate:c,offsetTopLeft:f,position:m,reverseDirection:g,tooltipBox:{height:w.height,width:w.width},useTranslate3d:x,viewBox:b}),E=N?{}:Hf(Hf({transition:h&&t?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&d?"visible":"hidden",position:"absolute",top:0,left:0}),S=Hf(Hf({},E),{},{visibility:!this.state.dismissed&&t&&d?"visible":"hidden"},j);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:C,style:S,ref:_},l)}}var I6=()=>{var e;return(e=Xe(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iy.apply(null,arguments)}function y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y4(Object(r),!0).forEach(function(n){gX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gX(e,t,r){return(t=xX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xX(e){var t=bX(e,"string");return typeof t=="symbol"?t:t+""}function bX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j4={curveBasisClosed:mW,curveBasisOpen:pW,curveBasis:fW,curveBumpX:ZV,curveBumpY:eW,curveLinearClosed:gW,curveLinear:Lm,curveMonotoneX:xW,curveMonotoneY:bW,curveNatural:vW,curveStep:yW,curveStepAfter:jW,curveStepBefore:wW},K0=e=>wr(e.x)&&wr(e.y),_4=e=>e.base!=null&&K0(e.base)&&K0(e),Hd=e=>e.x,Vd=e=>e.y,vX=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Uu(e));return(r==="curveMonotone"||r==="curveBump")&&t?j4["".concat(r).concat(t==="vertical"?"Y":"X")]:j4[r]||Lm},yX=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:l=!1}=e,c=vX(t,a),d=l?r.filter(K0):r,h;if(Array.isArray(n)){var f=r.map((b,j)=>w4(w4({},b),{},{base:n[j]}));a==="vertical"?h=If().y(Vd).x1(Hd).x0(b=>b.base.x):h=If().x(Hd).y1(Vd).y0(b=>b.base.y);var m=h.defined(_4).curve(c),g=l?f.filter(_4):f;return m(g)}a==="vertical"&&We(n)?h=If().y(Vd).x1(Hd).x0(n):We(n)?h=If().x(Hd).y1(Vd).y0(n):h=hO().x(Hd).y(Vd);var x=h.defined(K0).curve(c);return x(d)},$6=e=>{var{className:t,points:r,path:n,pathRef:a}=e,l=Gu();if((!r||!r.length)&&!n)return null;var c={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||l,connectNulls:e.connectNulls},d=r&&r.length?yX(c):n;return v.createElement("path",Iy({},oi(e),GW(e),{className:cr("recharts-curve",t),d:d===null?void 0:d,ref:a}))},wX=["x","y","top","left","width","height","className"];function $y(){return $y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$y.apply(null,arguments)}function k4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k4(Object(r),!0).forEach(function(n){_X(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _X(e,t,r){return(t=kX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kX(e){var t=NX(e,"string");return typeof t=="symbol"?t:t+""}function NX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SX(e,t){if(e==null)return{};var r,n,a=CX(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var EX=(e,t,r,n,a,l)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(l,",").concat(t,"h").concat(r),AX=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:l=0,height:c=0,className:d}=e,h=SX(e,wX),f=jX({x:t,y:r,top:n,left:a,width:l,height:c},h);return!We(t)||!We(r)||!We(l)||!We(c)||!We(n)||!We(a)?null:v.createElement("path",$y({},Bs(f),{className:cr("recharts-cross",d),d:EX(t,r,l,c,n,a)}))};function TX(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function N4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N4(Object(r),!0).forEach(function(n){OX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OX(e,t,r){return(t=PX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PX(e){var t=DX(e,"string");return typeof t=="symbol"?t:t+""}function DX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MX=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),L6=(e,t,r)=>e.map(n=>"".concat(MX(n)," ").concat(t,"ms ").concat(r)).join(","),RX=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),ku=(e,t)=>Object.keys(t).reduce((r,n)=>S4(S4({},r),{},{[n]:e(n,t[n])}),{});function C4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C4(Object(r),!0).forEach(function(n){IX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IX(e,t,r){return(t=$X(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $X(e){var t=LX(e,"string");return typeof t=="symbol"?t:t+""}function LX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y0=(e,t,r)=>e+(t-e)*r,Ly=e=>{var{from:t,to:r}=e;return t!==r},z6=(e,t,r)=>{var n=ku((a,l)=>{if(Ly(l)){var[c,d]=e(l.from,l.to,l.velocity);return Wr(Wr({},l),{},{from:c,velocity:d})}return l},t);return r<1?ku((a,l)=>Ly(l)&&n[a]!=null?Wr(Wr({},l),{},{velocity:Y0(l.velocity,n[a].velocity,r),from:Y0(l.from,n[a].from,r)}):l,t):z6(e,n,r-1)};function zX(e,t,r,n,a,l){var c,d=n.reduce((x,b)=>Wr(Wr({},x),{},{[b]:{from:e[b],velocity:0,to:t[b]}}),{}),h=()=>ku((x,b)=>b.from,d),f=()=>!Object.values(d).filter(Ly).length,m=null,g=x=>{c||(c=x);var b=x-c,j=b/r.dt;d=z6(r,d,j),a(Wr(Wr(Wr({},e),t),h())),c=x,f()||(m=l.setTimeout(g))};return()=>(m=l.setTimeout(g),()=>{var x;(x=m)===null||x===void 0||x()})}function BX(e,t,r,n,a,l,c){var d=null,h=a.reduce((g,x)=>{var b=e[x],j=t[x];return b==null||j==null?g:Wr(Wr({},g),{},{[x]:[b,j]})},{}),f,m=g=>{f||(f=g);var x=(g-f)/n,b=ku((w,_)=>Y0(..._,r(x)),h);if(l(Wr(Wr(Wr({},e),t),b)),x<1)d=c.setTimeout(m);else{var j=ku((w,_)=>Y0(..._,r(1)),h);l(Wr(Wr(Wr({},e),t),j))}};return()=>(d=c.setTimeout(m),()=>{var g;(g=d)===null||g===void 0||g()})}const UX=(e,t,r,n,a,l)=>{var c=RX(e,t);return r==null?()=>(a(Wr(Wr({},e),t)),()=>{}):r.isStepper===!0?zX(e,t,r,c,a,l):BX(e,t,r,n,c,a,l)};var X0=1e-4,B6=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],U6=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),E4=(e,t)=>r=>{var n=B6(e,t);return U6(n,r)},qX=(e,t)=>r=>{var n=B6(e,t),a=[...n.map((l,c)=>l*c).slice(1),0];return U6(a,r)},FX=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(l=>parseFloat(l));return[a[0],a[1],a[2],a[3]]},HX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=FX(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},VX=(e,t,r,n)=>{var a=E4(e,r),l=E4(t,n),c=qX(e,r),d=f=>f>1?1:f<0?0:f,h=f=>{for(var m=f>1?1:f,g=m,x=0;x<8;++x){var b=a(g)-m,j=c(g);if(Math.abs(b-m)<X0||j<X0)return l(g);g=d(g-b/j)}return l(g)};return h.isStepper=!1,h},A4=function(){return VX(...HX(...arguments))},WX=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,l=(c,d,h)=>{var f=-(c-d)*r,m=h*n,g=h+(f-m)*a/1e3,x=h*a/1e3+c;return Math.abs(x-d)<X0&&Math.abs(g)<X0?[d,0]:[x,g]};return l.isStepper=!0,l.dt=a,l},GX=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return A4(e);case"spring":return WX();default:if(e.split("(")[0]==="cubic-bezier")return A4(e)}return typeof e=="function"?e:null};function KX(e){var t,r=()=>null,n=!1,a=null,l=c=>{if(!n){if(Array.isArray(c)){if(!c.length)return;var d=c,[h,...f]=d;if(typeof h=="number"){a=e.setTimeout(l.bind(null,f),h);return}l(h),a=e.setTimeout(l.bind(null,f));return}typeof c=="string"&&(t=c,r(t)),typeof c=="object"&&(t=c,r(t)),typeof c=="function"&&c()}};return{stop:()=>{n=!0},start:c=>{n=!1,a&&(a(),a=null),l(c)},subscribe:c=>(r=c,()=>{r=()=>null}),getTimeoutController:()=>e}}class YX{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,l=c=>{c-n>=r?t(c):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(l))};return a=requestAnimationFrame(l),()=>{a!=null&&cancelAnimationFrame(a)}}}function XX(){return KX(new YX)}var JX=v.createContext(XX);function QX(e,t){var r=v.useContext(JX);return v.useMemo(()=>t??r(e),[e,t,r])}var ZX=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),sp={isSsr:ZX()},eJ={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},T4={t:0},ev={t:1};function g1(e){var t=ys(e,eJ),{isActive:r,canBegin:n,duration:a,easing:l,begin:c,onAnimationEnd:d,onAnimationStart:h,children:f}=t,m=r==="auto"?!sp.isSsr:r,g=QX(t.animationId,t.animationManager),[x,b]=v.useState(m?T4:ev),j=v.useRef(null);return v.useEffect(()=>{m||b(ev)},[m]),v.useEffect(()=>{if(!m||!n)return qu;var w=UX(T4,ev,GX(l),a,b,g.getTimeoutController()),_=()=>{j.current=w()};return g.start([h,c,_,a,d]),()=>{g.stop(),j.current&&j.current(),d()}},[m,n,a,l,c,h,d,g]),f(x.t)}function x1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(xu(t)),n=v.useRef(e);return n.current!==e&&(r.current=xu(t),n.current=e),r.current}var tJ=["radius"],rJ=["radius"],O4,P4,D4,M4,R4,I4,$4,L4,z4,B4;function U4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U4(Object(r),!0).forEach(function(n){nJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nJ(e,t,r){return(t=sJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sJ(e){var t=aJ(e,"string");return typeof t=="symbol"?t:t+""}function aJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J0.apply(null,arguments)}function F4(e,t){if(e==null)return{};var r,n,a=iJ(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ga(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var H4=(e,t,r,n,a)=>{var l=nl(r),c=nl(n),d=Math.min(Math.abs(l)/2,Math.abs(c)/2),h=c>=0?1:-1,f=l>=0?1:-1,m=c>=0&&l>=0||c<0&&l<0?1:0,g;if(d>0&&a instanceof Array){for(var x=[0,0,0,0],b=0,j=4;b<j;b++)x[b]=a[b]>d?d:a[b];g=kr(O4||(O4=ga(["M",",",""])),e,t+h*x[0]),x[0]>0&&(g+=kr(P4||(P4=ga(["A ",",",",0,0,",",",",",""])),x[0],x[0],m,e+f*x[0],t)),g+=kr(D4||(D4=ga(["L ",",",""])),e+r-f*x[1],t),x[1]>0&&(g+=kr(M4||(M4=ga(["A ",",",",0,0,",`,
        `,",",""])),x[1],x[1],m,e+r,t+h*x[1])),g+=kr(R4||(R4=ga(["L ",",",""])),e+r,t+n-h*x[2]),x[2]>0&&(g+=kr(I4||(I4=ga(["A ",",",",0,0,",`,
        `,",",""])),x[2],x[2],m,e+r-f*x[2],t+n)),g+=kr($4||($4=ga(["L ",",",""])),e+f*x[3],t+n),x[3]>0&&(g+=kr(L4||(L4=ga(["A ",",",",0,0,",`,
        `,",",""])),x[3],x[3],m,e,t+n-h*x[3])),g+="Z"}else if(d>0&&a===+a&&a>0){var w=Math.min(d,a);g=kr(z4||(z4=ga(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+h*w,w,w,m,e+f*w,t,e+r-f*w,t,w,w,m,e+r,t+h*w,e+r,t+n-h*w,w,w,m,e+r-f*w,t+n,e+f*w,t+n,w,w,m,e,t+n-h*w)}else g=kr(B4||(B4=ga(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return g},V4={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},q6=e=>{var t=ys(e,V4),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var U=r.current.getTotalLength();U&&a(U)}catch{}},[]);var{x:l,y:c,width:d,height:h,radius:f,className:m}=t,{animationEasing:g,animationDuration:x,animationBegin:b,isAnimationActive:j,isUpdateAnimationActive:w}=t,_=v.useRef(d),N=v.useRef(h),C=v.useRef(l),A=v.useRef(c),E=v.useMemo(()=>({x:l,y:c,width:d,height:h,radius:f}),[l,c,d,h,f]),S=x1(E,"rectangle-");if(l!==+l||c!==+c||d!==+d||h!==+h||d===0||h===0)return null;var T=cr("recharts-rectangle",m);if(!w){var D=Bs(t),{radius:P}=D,I=F4(D,tJ);return v.createElement("path",J0({},I,{x:nl(l),y:nl(c),width:nl(d),height:nl(h),radius:typeof f=="number"?f:void 0,className:T,d:H4(l,c,d,h,f)}))}var $=_.current,M=N.current,R=C.current,F=A.current,V="0px ".concat(n===-1?1:n,"px"),H="".concat(n,"px 0px"),L=L6(["strokeDasharray"],x,typeof g=="string"?g:V4.animationEasing);return v.createElement(g1,{animationId:S,key:S,canBegin:n>0,duration:x,easing:g,isActive:w,begin:b},U=>{var W=yn($,d,U),le=yn(M,h,U),ve=yn(R,l,U),B=yn(F,c,U);r.current&&(_.current=W,N.current=le,C.current=ve,A.current=B);var G;j?U>0?G={transition:L,strokeDasharray:H}:G={strokeDasharray:V}:G={strokeDasharray:H};var ie=Bs(t),{radius:he}=ie,_e=F4(ie,rJ);return v.createElement("path",J0({},_e,{radius:typeof f=="number"?f:void 0,className:T,d:H4(ve,B,W,le,f),ref:r,style:q4(q4({},G),t.style)}))})};function W4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function G4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W4(Object(r),!0).forEach(function(n){lJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lJ(e,t,r){return(t=oJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oJ(e){var t=cJ(e,"string");return typeof t=="symbol"?t:t+""}function cJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q0=Math.PI/180,dJ=e=>e*180/Math.PI,jn=(e,t,r,n)=>({x:e+Math.cos(-Q0*n)*r,y:t+Math.sin(-Q0*n)*r}),uJ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},hJ=(e,t)=>{var{x:r,y:n}=e,{x:a,y:l}=t;return Math.sqrt((r-a)**2+(n-l)**2)},fJ=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:l}=t,c=hJ({x:r,y:n},{x:a,y:l});if(c<=0)return{radius:c,angle:0};var d=(r-a)/c,h=Math.acos(d);return n>l&&(h=2*Math.PI-h),{radius:c,angle:dJ(h),angleInRadian:h}},mJ=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),l=Math.min(n,a);return{startAngle:t-l*360,endAngle:r-l*360}},pJ=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),l=Math.floor(n/360),c=Math.min(a,l);return e+c*360},gJ=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:l}=fJ({x:r,y:n},t),{innerRadius:c,outerRadius:d}=t;if(a<c||a>d||a===0)return null;var{startAngle:h,endAngle:f}=mJ(t),m=l,g;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;g=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;g=m>=f&&m<=h}return g?G4(G4({},t),{},{radius:a,angle:pJ(m,t)}):null};function F6(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:l}=e,c=jn(t,r,n,a),d=jn(t,r,n,l);return{points:[c,d],cx:t,cy:r,radius:n,startAngle:a,endAngle:l}}var K4,Y4,X4,J4,Q4,Z4,eC;function zy(){return zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zy.apply(null,arguments)}function Hl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var xJ=(e,t)=>{var r=Kn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Vf=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:l,isExternal:c,cornerRadius:d,cornerIsExternal:h}=e,f=d*(c?1:-1)+n,m=Math.asin(d/f)/Q0,g=h?a:a+l*m,x=jn(t,r,f,g),b=jn(t,r,n,g),j=h?a-l*m:a,w=jn(t,r,f*Math.cos(m*Q0),j);return{center:x,circleTangency:b,lineTangency:w,theta:m}},H6=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:c}=e,d=xJ(l,c),h=l+d,f=jn(t,r,a,l),m=jn(t,r,a,h),g=kr(K4||(K4=Hl(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),f.x,f.y,a,a,+(Math.abs(d)>180),+(l>h),m.x,m.y);if(n>0){var x=jn(t,r,n,l),b=jn(t,r,n,h);g+=kr(Y4||(Y4=Hl(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),b.x,b.y,n,n,+(Math.abs(d)>180),+(l<=h),x.x,x.y)}else g+=kr(X4||(X4=Hl(["L ",","," Z"])),t,r);return g},bJ=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:l,forceCornerRadius:c,cornerIsExternal:d,startAngle:h,endAngle:f}=e,m=Kn(f-h),{circleTangency:g,lineTangency:x,theta:b}=Vf({cx:t,cy:r,radius:a,angle:h,sign:m,cornerRadius:l,cornerIsExternal:d}),{circleTangency:j,lineTangency:w,theta:_}=Vf({cx:t,cy:r,radius:a,angle:f,sign:-m,cornerRadius:l,cornerIsExternal:d}),N=d?Math.abs(h-f):Math.abs(h-f)-b-_;if(N<0)return c?kr(J4||(J4=Hl(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),x.x,x.y,l,l,l*2,l,l,-l*2):H6({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:h,endAngle:f});var C=kr(Q4||(Q4=Hl(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),x.x,x.y,l,l,+(m<0),g.x,g.y,a,a,+(N>180),+(m<0),j.x,j.y,l,l,+(m<0),w.x,w.y);if(n>0){var{circleTangency:A,lineTangency:E,theta:S}=Vf({cx:t,cy:r,radius:n,angle:h,sign:m,isExternal:!0,cornerRadius:l,cornerIsExternal:d}),{circleTangency:T,lineTangency:D,theta:P}=Vf({cx:t,cy:r,radius:n,angle:f,sign:-m,isExternal:!0,cornerRadius:l,cornerIsExternal:d}),I=d?Math.abs(h-f):Math.abs(h-f)-S-P;if(I<0&&l===0)return"".concat(C,"L").concat(t,",").concat(r,"Z");C+=kr(Z4||(Z4=Hl(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),D.x,D.y,l,l,+(m<0),T.x,T.y,n,n,+(I>180),+(m>0),A.x,A.y,l,l,+(m<0),E.x,E.y)}else C+=kr(eC||(eC=Hl(["L",",","Z"])),t,r);return C},vJ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},V6=e=>{var t=ys(e,vJ),{cx:r,cy:n,innerRadius:a,outerRadius:l,cornerRadius:c,forceCornerRadius:d,cornerIsExternal:h,startAngle:f,endAngle:m,className:g}=t;if(l<a||f===m)return null;var x=cr("recharts-sector",g),b=l-a,j=la(c,b,0,!0),w;return j>0&&Math.abs(f-m)<360?w=bJ({cx:r,cy:n,innerRadius:a,outerRadius:l,cornerRadius:Math.min(j,b/2),forceCornerRadius:d,cornerIsExternal:h,startAngle:f,endAngle:m}):w=H6({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:f,endAngle:m}),v.createElement("path",zy({},Bs(t),{className:x,d:w}))};function yJ(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(CO(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:l,outerRadius:c,angle:d}=t,h=jn(n,a,l,d),f=jn(n,a,c,d);return[{x:h.x,y:h.y},{x:f.x,y:f.y}]}return F6(t)}}var tv={},rv={},nv={},tC;function wJ(){return tC||(tC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LO();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(nv)),nv}var rC;function jJ(){return rC||(rC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wJ();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(rv)),rv}var nC;function _J(){return nC||(nC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zO(),r=jJ();function n(a,l,c){c&&typeof c!="number"&&t.isIterateeCall(a,l,c)&&(l=c=void 0),a=r.toFinite(a),l===void 0?(l=a,a=0):l=r.toFinite(l),c=c===void 0?a<l?1:-1:r.toFinite(c);const d=Math.max(Math.ceil((l-a)/(c||1)),0),h=new Array(d);for(let f=0;f<d;f++)h[f]=a,a+=c;return h}e.range=n})(tv)),tv}var sv,sC;function kJ(){return sC||(sC=1,sv=_J().range),sv}var NJ=kJ();const W6=vs(NJ);function il(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function SJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function b1(e){let t,r,n;e.length!==2?(t=il,r=(d,h)=>il(e(d),h),n=(d,h)=>e(d)-h):(t=e===il||e===SJ?e:CJ,r=e,n=e);function a(d,h,f=0,m=d.length){if(f<m){if(t(h,h)!==0)return m;do{const g=f+m>>>1;r(d[g],h)<0?f=g+1:m=g}while(f<m)}return f}function l(d,h,f=0,m=d.length){if(f<m){if(t(h,h)!==0)return m;do{const g=f+m>>>1;r(d[g],h)<=0?f=g+1:m=g}while(f<m)}return f}function c(d,h,f=0,m=d.length){const g=a(d,h,f,m-1);return g>f&&n(d[g-1],h)>-n(d[g],h)?g-1:g}return{left:a,center:c,right:l}}function CJ(){return 0}function G6(e){return e===null?NaN:+e}function*EJ(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const AJ=b1(il),Yu=AJ.right;b1(G6).center;class aC extends Map{constructor(t,r=PJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(iC(this,t))}has(t){return super.has(iC(this,t))}set(t,r){return super.set(TJ(this,t),r)}delete(t){return super.delete(OJ(this,t))}}function iC({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function TJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function OJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function PJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function DJ(e=il){if(e===il)return K6;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function K6(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const MJ=Math.sqrt(50),RJ=Math.sqrt(10),IJ=Math.sqrt(2);function Z0(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),l=n/Math.pow(10,a),c=l>=MJ?10:l>=RJ?5:l>=IJ?2:1;let d,h,f;return a<0?(f=Math.pow(10,-a)/c,d=Math.round(e*f),h=Math.round(t*f),d/f<e&&++d,h/f>t&&--h,f=-f):(f=Math.pow(10,a)*c,d=Math.round(e/f),h=Math.round(t/f),d*f<e&&++d,h*f>t&&--h),h<d&&.5<=r&&r<2?Z0(e,t,r*2):[d,h,f]}function By(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,l,c]=n?Z0(t,e,r):Z0(e,t,r);if(!(l>=a))return[];const d=l-a+1,h=new Array(d);if(n)if(c<0)for(let f=0;f<d;++f)h[f]=(l-f)/-c;else for(let f=0;f<d;++f)h[f]=(l-f)*c;else if(c<0)for(let f=0;f<d;++f)h[f]=(a+f)/-c;else for(let f=0;f<d;++f)h[f]=(a+f)*c;return h}function Uy(e,t,r){return t=+t,e=+e,r=+r,Z0(e,t,r)[2]}function qy(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Uy(t,e,r):Uy(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function lC(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function oC(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Y6(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?K6:DJ(a);n>r;){if(n-r>600){const h=n-r+1,f=t-r+1,m=Math.log(h),g=.5*Math.exp(2*m/3),x=.5*Math.sqrt(m*g*(h-g)/h)*(f-h/2<0?-1:1),b=Math.max(r,Math.floor(t-f*g/h+x)),j=Math.min(n,Math.floor(t+(h-f)*g/h+x));Y6(e,t,b,j,a)}const l=e[t];let c=r,d=n;for(Wd(e,r,t),a(e[n],l)>0&&Wd(e,r,n);c<d;){for(Wd(e,c,d),++c,--d;a(e[c],l)<0;)++c;for(;a(e[d],l)>0;)--d}a(e[r],l)===0?Wd(e,r,d):(++d,Wd(e,d,n)),d<=t&&(r=d+1),t<=d&&(n=d-1)}return e}function Wd(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function $J(e,t,r){if(e=Float64Array.from(EJ(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return oC(e);if(t>=1)return lC(e);var n,a=(n-1)*t,l=Math.floor(a),c=lC(Y6(e,l).subarray(0,l+1)),d=oC(e.subarray(l+1));return c+(d-c)*(a-l)}}function LJ(e,t,r=G6){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,l=Math.floor(a),c=+r(e[l],l,e),d=+r(e[l+1],l+1,e);return c+(d-c)*(a-l)}}function zJ(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++n<a;)l[n]=e+n*r;return l}function Fs(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function vi(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Fy=Symbol("implicit");function v1(){var e=new aC,t=[],r=[],n=Fy;function a(l){let c=e.get(l);if(c===void 0){if(n!==Fy)return n;e.set(l,c=t.push(l)-1)}return r[c%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new aC;for(const c of l)e.has(c)||e.set(c,t.push(c)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return v1(t,r).unknown(n)},Fs.apply(a,arguments),a}function y1(){var e=v1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,l,c,d=!1,h=0,f=0,m=.5;delete e.unknown;function g(){var x=t().length,b=a<n,j=b?a:n,w=b?n:a;l=(w-j)/Math.max(1,x-h+f*2),d&&(l=Math.floor(l)),j+=(w-j-l*(x-h))*m,c=l*(1-h),d&&(j=Math.round(j),c=Math.round(c));var _=zJ(x).map(function(N){return j+l*N});return r(b?_.reverse():_)}return e.domain=function(x){return arguments.length?(t(x),g()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,g()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,d=!0,g()},e.bandwidth=function(){return c},e.step=function(){return l},e.round=function(x){return arguments.length?(d=!!x,g()):d},e.padding=function(x){return arguments.length?(h=Math.min(1,f=+x),g()):h},e.paddingInner=function(x){return arguments.length?(h=Math.min(1,x),g()):h},e.paddingOuter=function(x){return arguments.length?(f=+x,g()):f},e.align=function(x){return arguments.length?(m=Math.max(0,Math.min(1,x)),g()):m},e.copy=function(){return y1(t(),[n,a]).round(d).paddingInner(h).paddingOuter(f).align(m)},Fs.apply(g(),arguments)}function X6(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return X6(t())},e}function BJ(){return X6(y1.apply(null,arguments).paddingInner(1))}function w1(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function J6(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Xu(){}var Nu=.7,em=1/Nu,bc="\\s*([+-]?\\d+)\\s*",Su="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",UJ=/^#([0-9a-f]{3,8})$/,qJ=new RegExp(`^rgb\\(${bc},${bc},${bc}\\)$`),FJ=new RegExp(`^rgb\\(${wa},${wa},${wa}\\)$`),HJ=new RegExp(`^rgba\\(${bc},${bc},${bc},${Su}\\)$`),VJ=new RegExp(`^rgba\\(${wa},${wa},${wa},${Su}\\)$`),WJ=new RegExp(`^hsl\\(${Su},${wa},${wa}\\)$`),GJ=new RegExp(`^hsla\\(${Su},${wa},${wa},${Su}\\)$`),cC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};w1(Xu,Cu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:dC,formatHex:dC,formatHex8:KJ,formatHsl:YJ,formatRgb:uC,toString:uC});function dC(){return this.rgb().formatHex()}function KJ(){return this.rgb().formatHex8()}function YJ(){return Q6(this).formatHsl()}function uC(){return this.rgb().formatRgb()}function Cu(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=UJ.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?hC(t):r===3?new Yn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Wf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Wf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qJ.exec(e))?new Yn(t[1],t[2],t[3],1):(t=FJ.exec(e))?new Yn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=HJ.exec(e))?Wf(t[1],t[2],t[3],t[4]):(t=VJ.exec(e))?Wf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=WJ.exec(e))?pC(t[1],t[2]/100,t[3]/100,1):(t=GJ.exec(e))?pC(t[1],t[2]/100,t[3]/100,t[4]):cC.hasOwnProperty(e)?hC(cC[e]):e==="transparent"?new Yn(NaN,NaN,NaN,0):null}function hC(e){return new Yn(e>>16&255,e>>8&255,e&255,1)}function Wf(e,t,r,n){return n<=0&&(e=t=r=NaN),new Yn(e,t,r,n)}function XJ(e){return e instanceof Xu||(e=Cu(e)),e?(e=e.rgb(),new Yn(e.r,e.g,e.b,e.opacity)):new Yn}function Hy(e,t,r,n){return arguments.length===1?XJ(e):new Yn(e,t,r,n??1)}function Yn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}w1(Yn,Hy,J6(Xu,{brighter(e){return e=e==null?em:Math.pow(em,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Nu:Math.pow(Nu,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yn(Jl(this.r),Jl(this.g),Jl(this.b),tm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fC,formatHex:fC,formatHex8:JJ,formatRgb:mC,toString:mC}));function fC(){return`#${Vl(this.r)}${Vl(this.g)}${Vl(this.b)}`}function JJ(){return`#${Vl(this.r)}${Vl(this.g)}${Vl(this.b)}${Vl((isNaN(this.opacity)?1:this.opacity)*255)}`}function mC(){const e=tm(this.opacity);return`${e===1?"rgb(":"rgba("}${Jl(this.r)}, ${Jl(this.g)}, ${Jl(this.b)}${e===1?")":`, ${e})`}`}function tm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vl(e){return e=Jl(e),(e<16?"0":"")+e.toString(16)}function pC(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ea(e,t,r,n)}function Q6(e){if(e instanceof ea)return new ea(e.h,e.s,e.l,e.opacity);if(e instanceof Xu||(e=Cu(e)),!e)return new ea;if(e instanceof ea)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),l=Math.max(t,r,n),c=NaN,d=l-a,h=(l+a)/2;return d?(t===l?c=(r-n)/d+(r<n)*6:r===l?c=(n-t)/d+2:c=(t-r)/d+4,d/=h<.5?l+a:2-l-a,c*=60):d=h>0&&h<1?0:c,new ea(c,d,h,e.opacity)}function QJ(e,t,r,n){return arguments.length===1?Q6(e):new ea(e,t,r,n??1)}function ea(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}w1(ea,QJ,J6(Xu,{brighter(e){return e=e==null?em:Math.pow(em,e),new ea(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Nu:Math.pow(Nu,e),new ea(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Yn(av(e>=240?e-240:e+120,a,n),av(e,a,n),av(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ea(gC(this.h),Gf(this.s),Gf(this.l),tm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tm(this.opacity);return`${e===1?"hsl(":"hsla("}${gC(this.h)}, ${Gf(this.s)*100}%, ${Gf(this.l)*100}%${e===1?")":`, ${e})`}`}}));function gC(e){return e=(e||0)%360,e<0?e+360:e}function Gf(e){return Math.max(0,Math.min(1,e||0))}function av(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const j1=e=>()=>e;function ZJ(e,t){return function(r){return e+r*t}}function eQ(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function tQ(e){return(e=+e)==1?Z6:function(t,r){return r-t?eQ(t,r,e):j1(isNaN(t)?r:t)}}function Z6(e,t){var r=t-e;return r?ZJ(e,r):j1(isNaN(e)?t:e)}const xC=(function e(t){var r=tQ(t);function n(a,l){var c=r((a=Hy(a)).r,(l=Hy(l)).r),d=r(a.g,l.g),h=r(a.b,l.b),f=Z6(a.opacity,l.opacity);return function(m){return a.r=c(m),a.g=d(m),a.b=h(m),a.opacity=f(m),a+""}}return n.gamma=e,n})(1);function rQ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(l){for(a=0;a<r;++a)n[a]=e[a]*(1-l)+t[a]*l;return n}}function nQ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sQ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),l=new Array(r),c;for(c=0;c<n;++c)a[c]=Vc(e[c],t[c]);for(;c<r;++c)l[c]=t[c];return function(d){for(c=0;c<n;++c)l[c]=a[c](d);return l}}function aQ(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function rm(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function iQ(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Vc(e[a],t[a]):n[a]=t[a];return function(l){for(a in r)n[a]=r[a](l);return n}}var Vy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iv=new RegExp(Vy.source,"g");function lQ(e){return function(){return e}}function oQ(e){return function(t){return e(t)+""}}function cQ(e,t){var r=Vy.lastIndex=iv.lastIndex=0,n,a,l,c=-1,d=[],h=[];for(e=e+"",t=t+"";(n=Vy.exec(e))&&(a=iv.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),d[c]?d[c]+=l:d[++c]=l),(n=n[0])===(a=a[0])?d[c]?d[c]+=a:d[++c]=a:(d[++c]=null,h.push({i:c,x:rm(n,a)})),r=iv.lastIndex;return r<t.length&&(l=t.slice(r),d[c]?d[c]+=l:d[++c]=l),d.length<2?h[0]?oQ(h[0].x):lQ(t):(t=h.length,function(f){for(var m=0,g;m<t;++m)d[(g=h[m]).i]=g.x(f);return d.join("")})}function Vc(e,t){var r=typeof t,n;return t==null||r==="boolean"?j1(t):(r==="number"?rm:r==="string"?(n=Cu(t))?(t=n,xC):cQ:t instanceof Cu?xC:t instanceof Date?aQ:nQ(t)?rQ:Array.isArray(t)?sQ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?iQ:rm)(e,t)}function _1(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function dQ(e,t){t===void 0&&(t=e,e=Vc);for(var r=0,n=t.length-1,a=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(a,a=t[++r]);return function(c){var d=Math.max(0,Math.min(n-1,Math.floor(c*=n)));return l[d](c-d)}}function uQ(e){return function(){return e}}function nm(e){return+e}var bC=[0,1];function Dn(e){return e}function Wy(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:uQ(isNaN(t)?NaN:.5)}function hQ(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function fQ(e,t,r){var n=e[0],a=e[1],l=t[0],c=t[1];return a<n?(n=Wy(a,n),l=r(c,l)):(n=Wy(n,a),l=r(l,c)),function(d){return l(n(d))}}function mQ(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),l=new Array(n),c=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++c<n;)a[c]=Wy(e[c],e[c+1]),l[c]=r(t[c],t[c+1]);return function(d){var h=Yu(e,d,1,n)-1;return l[h](a[h](d))}}function Ju(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ap(){var e=bC,t=bC,r=Vc,n,a,l,c=Dn,d,h,f;function m(){var x=Math.min(e.length,t.length);return c!==Dn&&(c=hQ(e[0],e[x-1])),d=x>2?mQ:fQ,h=f=null,g}function g(x){return x==null||isNaN(x=+x)?l:(h||(h=d(e.map(n),t,r)))(n(c(x)))}return g.invert=function(x){return c(a((f||(f=d(t,e.map(n),rm)))(x)))},g.domain=function(x){return arguments.length?(e=Array.from(x,nm),m()):e.slice()},g.range=function(x){return arguments.length?(t=Array.from(x),m()):t.slice()},g.rangeRound=function(x){return t=Array.from(x),r=_1,m()},g.clamp=function(x){return arguments.length?(c=x?!0:Dn,m()):c!==Dn},g.interpolate=function(x){return arguments.length?(r=x,m()):r},g.unknown=function(x){return arguments.length?(l=x,g):l},function(x,b){return n=x,a=b,m()}}function k1(){return ap()(Dn,Dn)}function pQ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function sm(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Oc(e){return e=sm(Math.abs(e)),e?e[1]:NaN}function gQ(e,t){return function(r,n){for(var a=r.length,l=[],c=0,d=e[0],h=0;a>0&&d>0&&(h+d+1>n&&(d=Math.max(1,n-h)),l.push(r.substring(a-=d,a+d)),!((h+=d+1)>n));)d=e[c=(c+1)%e.length];return l.reverse().join(t)}}function xQ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var bQ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Eu(e){if(!(t=bQ.exec(e)))throw new Error("invalid format: "+e);var t;return new N1({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Eu.prototype=N1.prototype;function N1(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}N1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vQ(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var eP;function yQ(e,t){var r=sm(e,t);if(!r)return e+"";var n=r[0],a=r[1],l=a-(eP=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,c=n.length;return l===c?n:l>c?n+new Array(l-c+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+sm(e,Math.max(0,t+l-1))[0]}function vC(e,t){var r=sm(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const yC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:pQ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>vC(e*100,t),r:vC,s:yQ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function wC(e){return e}var jC=Array.prototype.map,_C=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function wQ(e){var t=e.grouping===void 0||e.thousands===void 0?wC:gQ(jC.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?wC:xQ(jC.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function f(g){g=Eu(g);var x=g.fill,b=g.align,j=g.sign,w=g.symbol,_=g.zero,N=g.width,C=g.comma,A=g.precision,E=g.trim,S=g.type;S==="n"?(C=!0,S="g"):yC[S]||(A===void 0&&(A=12),E=!0,S="g"),(_||x==="0"&&b==="=")&&(_=!0,x="0",b="=");var T=w==="$"?r:w==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",D=w==="$"?n:/[%p]/.test(S)?c:"",P=yC[S],I=/[defgprs%]/.test(S);A=A===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function $(M){var R=T,F=D,V,H,L;if(S==="c")F=P(M)+F,M="";else{M=+M;var U=M<0||1/M<0;if(M=isNaN(M)?h:P(Math.abs(M),A),E&&(M=vQ(M)),U&&+M==0&&j!=="+"&&(U=!1),R=(U?j==="("?j:d:j==="-"||j==="("?"":j)+R,F=(S==="s"?_C[8+eP/3]:"")+F+(U&&j==="("?")":""),I){for(V=-1,H=M.length;++V<H;)if(L=M.charCodeAt(V),48>L||L>57){F=(L===46?a+M.slice(V+1):M.slice(V))+F,M=M.slice(0,V);break}}}C&&!_&&(M=t(M,1/0));var W=R.length+M.length+F.length,le=W<N?new Array(N-W+1).join(x):"";switch(C&&_&&(M=t(le+M,le.length?N-F.length:1/0),le=""),b){case"<":M=R+M+F+le;break;case"=":M=R+le+M+F;break;case"^":M=le.slice(0,W=le.length>>1)+R+M+F+le.slice(W);break;default:M=le+R+M+F;break}return l(M)}return $.toString=function(){return g+""},$}function m(g,x){var b=f((g=Eu(g),g.type="f",g)),j=Math.max(-8,Math.min(8,Math.floor(Oc(x)/3)))*3,w=Math.pow(10,-j),_=_C[8+j/3];return function(N){return b(w*N)+_}}return{format:f,formatPrefix:m}}var Kf,S1,tP;jQ({thousands:",",grouping:[3],currency:["$",""]});function jQ(e){return Kf=wQ(e),S1=Kf.format,tP=Kf.formatPrefix,Kf}function _Q(e){return Math.max(0,-Oc(Math.abs(e)))}function kQ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Oc(t)/3)))*3-Oc(Math.abs(e)))}function NQ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Oc(t)-Oc(e))+1}function rP(e,t,r,n){var a=qy(e,t,r),l;switch(n=Eu(n??",f"),n.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=kQ(a,c))&&(n.precision=l),tP(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=NQ(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=_Q(a))&&(n.precision=l-(n.type==="%")*2);break}}return S1(n)}function dl(e){var t=e.domain;return e.ticks=function(r){var n=t();return By(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return rP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,l=n.length-1,c=n[a],d=n[l],h,f,m=10;for(d<c&&(f=c,c=d,d=f,f=a,a=l,l=f);m-- >0;){if(f=Uy(c,d,r),f===h)return n[a]=c,n[l]=d,t(n);if(f>0)c=Math.floor(c/f)*f,d=Math.ceil(d/f)*f;else if(f<0)c=Math.ceil(c*f)/f,d=Math.floor(d*f)/f;else break;h=f}return e},e}function nP(){var e=k1();return e.copy=function(){return Ju(e,nP())},Fs.apply(e,arguments),dl(e)}function sP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,nm),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return sP(e).unknown(t)},e=arguments.length?Array.from(e,nm):[0,1],dl(r)}function aP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],l=e[n],c;return l<a&&(c=r,r=n,n=c,c=a,a=l,l=c),e[r]=t.floor(a),e[n]=t.ceil(l),e}function kC(e){return Math.log(e)}function NC(e){return Math.exp(e)}function SQ(e){return-Math.log(-e)}function CQ(e){return-Math.exp(-e)}function EQ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function AQ(e){return e===10?EQ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function TQ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function SC(e){return(t,r)=>-e(-t,r)}function C1(e){const t=e(kC,NC),r=t.domain;let n=10,a,l;function c(){return a=TQ(n),l=AQ(n),r()[0]<0?(a=SC(a),l=SC(l),e(SQ,CQ)):e(kC,NC),t}return t.base=function(d){return arguments.length?(n=+d,c()):n},t.domain=function(d){return arguments.length?(r(d),c()):r()},t.ticks=d=>{const h=r();let f=h[0],m=h[h.length-1];const g=m<f;g&&([f,m]=[m,f]);let x=a(f),b=a(m),j,w;const _=d==null?10:+d;let N=[];if(!(n%1)&&b-x<_){if(x=Math.floor(x),b=Math.ceil(b),f>0){for(;x<=b;++x)for(j=1;j<n;++j)if(w=x<0?j/l(-x):j*l(x),!(w<f)){if(w>m)break;N.push(w)}}else for(;x<=b;++x)for(j=n-1;j>=1;--j)if(w=x>0?j/l(-x):j*l(x),!(w<f)){if(w>m)break;N.push(w)}N.length*2<_&&(N=By(f,m,_))}else N=By(x,b,Math.min(b-x,_)).map(l);return g?N.reverse():N},t.tickFormat=(d,h)=>{if(d==null&&(d=10),h==null&&(h=n===10?"s":","),typeof h!="function"&&(!(n%1)&&(h=Eu(h)).precision==null&&(h.trim=!0),h=S1(h)),d===1/0)return h;const f=Math.max(1,n*d/t.ticks().length);return m=>{let g=m/l(Math.round(a(m)));return g*n<n-.5&&(g*=n),g<=f?h(m):""}},t.nice=()=>r(aP(r(),{floor:d=>l(Math.floor(a(d))),ceil:d=>l(Math.ceil(a(d)))})),t}function iP(){const e=C1(ap()).domain([1,10]);return e.copy=()=>Ju(e,iP()).base(e.base()),Fs.apply(e,arguments),e}function CC(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function EC(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function E1(e){var t=1,r=e(CC(t),EC(t));return r.constant=function(n){return arguments.length?e(CC(t=+n),EC(t)):t},dl(r)}function lP(){var e=E1(ap());return e.copy=function(){return Ju(e,lP()).constant(e.constant())},Fs.apply(e,arguments)}function AC(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function OQ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function PQ(e){return e<0?-e*e:e*e}function A1(e){var t=e(Dn,Dn),r=1;function n(){return r===1?e(Dn,Dn):r===.5?e(OQ,PQ):e(AC(r),AC(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},dl(t)}function T1(){var e=A1(ap());return e.copy=function(){return Ju(e,T1()).exponent(e.exponent())},Fs.apply(e,arguments),e}function DQ(){return T1.apply(null,arguments).exponent(.5)}function TC(e){return Math.sign(e)*e*e}function MQ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oP(){var e=k1(),t=[0,1],r=!1,n;function a(l){var c=MQ(e(l));return isNaN(c)?n:r?Math.round(c):c}return a.invert=function(l){return e.invert(TC(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,nm)).map(TC)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return oP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Fs.apply(a,arguments),dl(a)}function cP(){var e=[],t=[],r=[],n;function a(){var c=0,d=Math.max(1,t.length);for(r=new Array(d-1);++c<d;)r[c-1]=LJ(e,c/d);return l}function l(c){return c==null||isNaN(c=+c)?n:t[Yu(r,c)]}return l.invertExtent=function(c){var d=t.indexOf(c);return d<0?[NaN,NaN]:[d>0?r[d-1]:e[0],d<r.length?r[d]:e[e.length-1]]},l.domain=function(c){if(!arguments.length)return e.slice();e=[];for(let d of c)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(il),a()},l.range=function(c){return arguments.length?(t=Array.from(c),a()):t.slice()},l.unknown=function(c){return arguments.length?(n=c,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return cP().domain(e).range(t).unknown(n)},Fs.apply(l,arguments)}function dP(){var e=0,t=1,r=1,n=[.5],a=[0,1],l;function c(h){return h!=null&&h<=h?a[Yu(n,h,0,r)]:l}function d(){var h=-1;for(n=new Array(r);++h<r;)n[h]=((h+1)*t-(h-r)*e)/(r+1);return c}return c.domain=function(h){return arguments.length?([e,t]=h,e=+e,t=+t,d()):[e,t]},c.range=function(h){return arguments.length?(r=(a=Array.from(h)).length-1,d()):a.slice()},c.invertExtent=function(h){var f=a.indexOf(h);return f<0?[NaN,NaN]:f<1?[e,n[0]]:f>=r?[n[r-1],t]:[n[f-1],n[f]]},c.unknown=function(h){return arguments.length&&(l=h),c},c.thresholds=function(){return n.slice()},c.copy=function(){return dP().domain([e,t]).range(a).unknown(l)},Fs.apply(dl(c),arguments)}function uP(){var e=[.5],t=[0,1],r,n=1;function a(l){return l!=null&&l<=l?t[Yu(e,l,0,n)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var c=t.indexOf(l);return[e[c-1],e[c]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return uP().domain(e).range(t).unknown(r)},Fs.apply(a,arguments)}const lv=new Date,ov=new Date;function Yr(e,t,r,n){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const c=a(l),d=a.ceil(l);return l-c<d-l?c:d},a.offset=(l,c)=>(t(l=new Date(+l),c==null?1:Math.floor(c)),l),a.range=(l,c,d)=>{const h=[];if(l=a.ceil(l),d=d==null?1:Math.floor(d),!(l<c)||!(d>0))return h;let f;do h.push(f=new Date(+l)),t(l,d),e(l);while(f<l&&l<c);return h},a.filter=l=>Yr(c=>{if(c>=c)for(;e(c),!l(c);)c.setTime(c-1)},(c,d)=>{if(c>=c)if(d<0)for(;++d<=0;)for(;t(c,-1),!l(c););else for(;--d>=0;)for(;t(c,1),!l(c););}),r&&(a.count=(l,c)=>(lv.setTime(+l),ov.setTime(+c),e(lv),e(ov),Math.floor(r(lv,ov))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(n?c=>n(c)%l===0:c=>a.count(0,c)%l===0):a)),a}const am=Yr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);am.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Yr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):am);am.range;const Za=1e3,$s=Za*60,ei=$s*60,hi=ei*24,O1=hi*7,OC=hi*30,cv=hi*365,Wl=Yr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Za)},(e,t)=>(t-e)/Za,e=>e.getUTCSeconds());Wl.range;const P1=Yr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Za)},(e,t)=>{e.setTime(+e+t*$s)},(e,t)=>(t-e)/$s,e=>e.getMinutes());P1.range;const D1=Yr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*$s)},(e,t)=>(t-e)/$s,e=>e.getUTCMinutes());D1.range;const M1=Yr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Za-e.getMinutes()*$s)},(e,t)=>{e.setTime(+e+t*ei)},(e,t)=>(t-e)/ei,e=>e.getHours());M1.range;const R1=Yr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ei)},(e,t)=>(t-e)/ei,e=>e.getUTCHours());R1.range;const Qu=Yr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$s)/hi,e=>e.getDate()-1);Qu.range;const ip=Yr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hi,e=>e.getUTCDate()-1);ip.range;const hP=Yr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hi,e=>Math.floor(e/hi));hP.range;function co(e){return Yr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*$s)/O1)}const lp=co(0),im=co(1),RQ=co(2),IQ=co(3),Pc=co(4),$Q=co(5),LQ=co(6);lp.range;im.range;RQ.range;IQ.range;Pc.range;$Q.range;LQ.range;function uo(e){return Yr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/O1)}const op=uo(0),lm=uo(1),zQ=uo(2),BQ=uo(3),Dc=uo(4),UQ=uo(5),qQ=uo(6);op.range;lm.range;zQ.range;BQ.range;Dc.range;UQ.range;qQ.range;const I1=Yr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());I1.range;const $1=Yr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$1.range;const fi=Yr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});fi.range;const mi=Yr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());mi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});mi.range;function fP(e,t,r,n,a,l){const c=[[Wl,1,Za],[Wl,5,5*Za],[Wl,15,15*Za],[Wl,30,30*Za],[l,1,$s],[l,5,5*$s],[l,15,15*$s],[l,30,30*$s],[a,1,ei],[a,3,3*ei],[a,6,6*ei],[a,12,12*ei],[n,1,hi],[n,2,2*hi],[r,1,O1],[t,1,OC],[t,3,3*OC],[e,1,cv]];function d(f,m,g){const x=m<f;x&&([f,m]=[m,f]);const b=g&&typeof g.range=="function"?g:h(f,m,g),j=b?b.range(f,+m+1):[];return x?j.reverse():j}function h(f,m,g){const x=Math.abs(m-f)/g,b=b1(([,,_])=>_).right(c,x);if(b===c.length)return e.every(qy(f/cv,m/cv,g));if(b===0)return am.every(Math.max(qy(f,m,g),1));const[j,w]=c[x/c[b-1][2]<c[b][2]/x?b-1:b];return j.every(w)}return[d,h]}const[FQ,HQ]=fP(mi,$1,op,hP,R1,D1),[VQ,WQ]=fP(fi,I1,lp,Qu,M1,P1);function dv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Gd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function GQ(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,l=e.days,c=e.shortDays,d=e.months,h=e.shortMonths,f=Kd(a),m=Yd(a),g=Kd(l),x=Yd(l),b=Kd(c),j=Yd(c),w=Kd(d),_=Yd(d),N=Kd(h),C=Yd(h),A={a:U,A:W,b:le,B:ve,c:null,d:$C,e:$C,f:gZ,g:SZ,G:EZ,H:fZ,I:mZ,j:pZ,L:mP,m:xZ,M:bZ,p:B,q:G,Q:BC,s:UC,S:vZ,u:yZ,U:wZ,V:jZ,w:_Z,W:kZ,x:null,X:null,y:NZ,Y:CZ,Z:AZ,"%":zC},E={a:ie,A:he,b:_e,B:Ee,c:null,d:LC,e:LC,f:DZ,g:FZ,G:VZ,H:TZ,I:OZ,j:PZ,L:gP,m:MZ,M:RZ,p:we,q:ye,Q:BC,s:UC,S:IZ,u:$Z,U:LZ,V:zZ,w:BZ,W:UZ,x:null,X:null,y:qZ,Y:HZ,Z:WZ,"%":zC},S={a:$,A:M,b:R,B:F,c:V,d:RC,e:RC,f:cZ,g:MC,G:DC,H:IC,I:IC,j:aZ,L:oZ,m:sZ,M:iZ,p:I,q:nZ,Q:uZ,s:hZ,S:lZ,u:QQ,U:ZQ,V:eZ,w:JQ,W:tZ,x:H,X:L,y:MC,Y:DC,Z:rZ,"%":dZ};A.x=T(r,A),A.X=T(n,A),A.c=T(t,A),E.x=T(r,E),E.X=T(n,E),E.c=T(t,E);function T(ee,ke){return function(Te){var J=[],Le=-1,$e=0,ut=ee.length,yt,Dt,Zt;for(Te instanceof Date||(Te=new Date(+Te));++Le<ut;)ee.charCodeAt(Le)===37&&(J.push(ee.slice($e,Le)),(Dt=PC[yt=ee.charAt(++Le)])!=null?yt=ee.charAt(++Le):Dt=yt==="e"?" ":"0",(Zt=ke[yt])&&(yt=Zt(Te,Dt)),J.push(yt),$e=Le+1);return J.push(ee.slice($e,Le)),J.join("")}}function D(ee,ke){return function(Te){var J=Gd(1900,void 0,1),Le=P(J,ee,Te+="",0),$e,ut;if(Le!=Te.length)return null;if("Q"in J)return new Date(J.Q);if("s"in J)return new Date(J.s*1e3+("L"in J?J.L:0));if(ke&&!("Z"in J)&&(J.Z=0),"p"in J&&(J.H=J.H%12+J.p*12),J.m===void 0&&(J.m="q"in J?J.q:0),"V"in J){if(J.V<1||J.V>53)return null;"w"in J||(J.w=1),"Z"in J?($e=uv(Gd(J.y,0,1)),ut=$e.getUTCDay(),$e=ut>4||ut===0?lm.ceil($e):lm($e),$e=ip.offset($e,(J.V-1)*7),J.y=$e.getUTCFullYear(),J.m=$e.getUTCMonth(),J.d=$e.getUTCDate()+(J.w+6)%7):($e=dv(Gd(J.y,0,1)),ut=$e.getDay(),$e=ut>4||ut===0?im.ceil($e):im($e),$e=Qu.offset($e,(J.V-1)*7),J.y=$e.getFullYear(),J.m=$e.getMonth(),J.d=$e.getDate()+(J.w+6)%7)}else("W"in J||"U"in J)&&("w"in J||(J.w="u"in J?J.u%7:"W"in J?1:0),ut="Z"in J?uv(Gd(J.y,0,1)).getUTCDay():dv(Gd(J.y,0,1)).getDay(),J.m=0,J.d="W"in J?(J.w+6)%7+J.W*7-(ut+5)%7:J.w+J.U*7-(ut+6)%7);return"Z"in J?(J.H+=J.Z/100|0,J.M+=J.Z%100,uv(J)):dv(J)}}function P(ee,ke,Te,J){for(var Le=0,$e=ke.length,ut=Te.length,yt,Dt;Le<$e;){if(J>=ut)return-1;if(yt=ke.charCodeAt(Le++),yt===37){if(yt=ke.charAt(Le++),Dt=S[yt in PC?ke.charAt(Le++):yt],!Dt||(J=Dt(ee,Te,J))<0)return-1}else if(yt!=Te.charCodeAt(J++))return-1}return J}function I(ee,ke,Te){var J=f.exec(ke.slice(Te));return J?(ee.p=m.get(J[0].toLowerCase()),Te+J[0].length):-1}function $(ee,ke,Te){var J=b.exec(ke.slice(Te));return J?(ee.w=j.get(J[0].toLowerCase()),Te+J[0].length):-1}function M(ee,ke,Te){var J=g.exec(ke.slice(Te));return J?(ee.w=x.get(J[0].toLowerCase()),Te+J[0].length):-1}function R(ee,ke,Te){var J=N.exec(ke.slice(Te));return J?(ee.m=C.get(J[0].toLowerCase()),Te+J[0].length):-1}function F(ee,ke,Te){var J=w.exec(ke.slice(Te));return J?(ee.m=_.get(J[0].toLowerCase()),Te+J[0].length):-1}function V(ee,ke,Te){return P(ee,t,ke,Te)}function H(ee,ke,Te){return P(ee,r,ke,Te)}function L(ee,ke,Te){return P(ee,n,ke,Te)}function U(ee){return c[ee.getDay()]}function W(ee){return l[ee.getDay()]}function le(ee){return h[ee.getMonth()]}function ve(ee){return d[ee.getMonth()]}function B(ee){return a[+(ee.getHours()>=12)]}function G(ee){return 1+~~(ee.getMonth()/3)}function ie(ee){return c[ee.getUTCDay()]}function he(ee){return l[ee.getUTCDay()]}function _e(ee){return h[ee.getUTCMonth()]}function Ee(ee){return d[ee.getUTCMonth()]}function we(ee){return a[+(ee.getUTCHours()>=12)]}function ye(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var ke=T(ee+="",A);return ke.toString=function(){return ee},ke},parse:function(ee){var ke=D(ee+="",!1);return ke.toString=function(){return ee},ke},utcFormat:function(ee){var ke=T(ee+="",E);return ke.toString=function(){return ee},ke},utcParse:function(ee){var ke=D(ee+="",!0);return ke.toString=function(){return ee},ke}}}var PC={"-":"",_:" ",0:"0"},cn=/^\s*\d+/,KQ=/^%/,YQ=/[\\^$*+?|[\]().{}]/g;function It(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",l=a.length;return n+(l<r?new Array(r-l+1).join(t)+a:a)}function XQ(e){return e.replace(YQ,"\\$&")}function Kd(e){return new RegExp("^(?:"+e.map(XQ).join("|")+")","i")}function Yd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function JQ(e,t,r){var n=cn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function QQ(e,t,r){var n=cn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function ZQ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function eZ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function tZ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function DC(e,t,r){var n=cn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function MC(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function rZ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function nZ(e,t,r){var n=cn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function sZ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function RC(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function aZ(e,t,r){var n=cn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function IC(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function iZ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function lZ(e,t,r){var n=cn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function oZ(e,t,r){var n=cn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cZ(e,t,r){var n=cn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function dZ(e,t,r){var n=KQ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function uZ(e,t,r){var n=cn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function hZ(e,t,r){var n=cn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function $C(e,t){return It(e.getDate(),t,2)}function fZ(e,t){return It(e.getHours(),t,2)}function mZ(e,t){return It(e.getHours()%12||12,t,2)}function pZ(e,t){return It(1+Qu.count(fi(e),e),t,3)}function mP(e,t){return It(e.getMilliseconds(),t,3)}function gZ(e,t){return mP(e,t)+"000"}function xZ(e,t){return It(e.getMonth()+1,t,2)}function bZ(e,t){return It(e.getMinutes(),t,2)}function vZ(e,t){return It(e.getSeconds(),t,2)}function yZ(e){var t=e.getDay();return t===0?7:t}function wZ(e,t){return It(lp.count(fi(e)-1,e),t,2)}function pP(e){var t=e.getDay();return t>=4||t===0?Pc(e):Pc.ceil(e)}function jZ(e,t){return e=pP(e),It(Pc.count(fi(e),e)+(fi(e).getDay()===4),t,2)}function _Z(e){return e.getDay()}function kZ(e,t){return It(im.count(fi(e)-1,e),t,2)}function NZ(e,t){return It(e.getFullYear()%100,t,2)}function SZ(e,t){return e=pP(e),It(e.getFullYear()%100,t,2)}function CZ(e,t){return It(e.getFullYear()%1e4,t,4)}function EZ(e,t){var r=e.getDay();return e=r>=4||r===0?Pc(e):Pc.ceil(e),It(e.getFullYear()%1e4,t,4)}function AZ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+It(t/60|0,"0",2)+It(t%60,"0",2)}function LC(e,t){return It(e.getUTCDate(),t,2)}function TZ(e,t){return It(e.getUTCHours(),t,2)}function OZ(e,t){return It(e.getUTCHours()%12||12,t,2)}function PZ(e,t){return It(1+ip.count(mi(e),e),t,3)}function gP(e,t){return It(e.getUTCMilliseconds(),t,3)}function DZ(e,t){return gP(e,t)+"000"}function MZ(e,t){return It(e.getUTCMonth()+1,t,2)}function RZ(e,t){return It(e.getUTCMinutes(),t,2)}function IZ(e,t){return It(e.getUTCSeconds(),t,2)}function $Z(e){var t=e.getUTCDay();return t===0?7:t}function LZ(e,t){return It(op.count(mi(e)-1,e),t,2)}function xP(e){var t=e.getUTCDay();return t>=4||t===0?Dc(e):Dc.ceil(e)}function zZ(e,t){return e=xP(e),It(Dc.count(mi(e),e)+(mi(e).getUTCDay()===4),t,2)}function BZ(e){return e.getUTCDay()}function UZ(e,t){return It(lm.count(mi(e)-1,e),t,2)}function qZ(e,t){return It(e.getUTCFullYear()%100,t,2)}function FZ(e,t){return e=xP(e),It(e.getUTCFullYear()%100,t,2)}function HZ(e,t){return It(e.getUTCFullYear()%1e4,t,4)}function VZ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Dc(e):Dc.ceil(e),It(e.getUTCFullYear()%1e4,t,4)}function WZ(){return"+0000"}function zC(){return"%"}function BC(e){return+e}function UC(e){return Math.floor(+e/1e3)}var ec,bP,vP;GZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function GZ(e){return ec=GQ(e),bP=ec.format,ec.parse,vP=ec.utcFormat,ec.utcParse,ec}function KZ(e){return new Date(e)}function YZ(e){return e instanceof Date?+e:+new Date(+e)}function L1(e,t,r,n,a,l,c,d,h,f){var m=k1(),g=m.invert,x=m.domain,b=f(".%L"),j=f(":%S"),w=f("%I:%M"),_=f("%I %p"),N=f("%a %d"),C=f("%b %d"),A=f("%B"),E=f("%Y");function S(T){return(h(T)<T?b:d(T)<T?j:c(T)<T?w:l(T)<T?_:n(T)<T?a(T)<T?N:C:r(T)<T?A:E)(T)}return m.invert=function(T){return new Date(g(T))},m.domain=function(T){return arguments.length?x(Array.from(T,YZ)):x().map(KZ)},m.ticks=function(T){var D=x();return e(D[0],D[D.length-1],T??10)},m.tickFormat=function(T,D){return D==null?S:f(D)},m.nice=function(T){var D=x();return(!T||typeof T.range!="function")&&(T=t(D[0],D[D.length-1],T??10)),T?x(aP(D,T)):m},m.copy=function(){return Ju(m,L1(e,t,r,n,a,l,c,d,h,f))},m}function XZ(){return Fs.apply(L1(VQ,WQ,fi,I1,lp,Qu,M1,P1,Wl,bP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function JZ(){return Fs.apply(L1(FQ,HQ,mi,$1,op,ip,R1,D1,Wl,vP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function cp(){var e=0,t=1,r,n,a,l,c=Dn,d=!1,h;function f(g){return g==null||isNaN(g=+g)?h:c(a===0?.5:(g=(l(g)-r)*a,d?Math.max(0,Math.min(1,g)):g))}f.domain=function(g){return arguments.length?([e,t]=g,r=l(e=+e),n=l(t=+t),a=r===n?0:1/(n-r),f):[e,t]},f.clamp=function(g){return arguments.length?(d=!!g,f):d},f.interpolator=function(g){return arguments.length?(c=g,f):c};function m(g){return function(x){var b,j;return arguments.length?([b,j]=x,c=g(b,j),f):[c(0),c(1)]}}return f.range=m(Vc),f.rangeRound=m(_1),f.unknown=function(g){return arguments.length?(h=g,f):h},function(g){return l=g,r=g(e),n=g(t),a=r===n?0:1/(n-r),f}}function ul(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yP(){var e=dl(cp()(Dn));return e.copy=function(){return ul(e,yP())},vi.apply(e,arguments)}function wP(){var e=C1(cp()).domain([1,10]);return e.copy=function(){return ul(e,wP()).base(e.base())},vi.apply(e,arguments)}function jP(){var e=E1(cp());return e.copy=function(){return ul(e,jP()).constant(e.constant())},vi.apply(e,arguments)}function z1(){var e=A1(cp());return e.copy=function(){return ul(e,z1()).exponent(e.exponent())},vi.apply(e,arguments)}function QZ(){return z1.apply(null,arguments).exponent(.5)}function _P(){var e=[],t=Dn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Yu(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(il),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,l)=>$J(e,l/n))},r.copy=function(){return _P(t).domain(e)},vi.apply(r,arguments)}function dp(){var e=0,t=.5,r=1,n=1,a,l,c,d,h,f=Dn,m,g=!1,x;function b(w){return isNaN(w=+w)?x:(w=.5+((w=+m(w))-l)*(n*w<n*l?d:h),f(g?Math.max(0,Math.min(1,w)):w))}b.domain=function(w){return arguments.length?([e,t,r]=w,a=m(e=+e),l=m(t=+t),c=m(r=+r),d=a===l?0:.5/(l-a),h=l===c?0:.5/(c-l),n=l<a?-1:1,b):[e,t,r]},b.clamp=function(w){return arguments.length?(g=!!w,b):g},b.interpolator=function(w){return arguments.length?(f=w,b):f};function j(w){return function(_){var N,C,A;return arguments.length?([N,C,A]=_,f=dQ(w,[N,C,A]),b):[f(0),f(.5),f(1)]}}return b.range=j(Vc),b.rangeRound=j(_1),b.unknown=function(w){return arguments.length?(x=w,b):x},function(w){return m=w,a=w(e),l=w(t),c=w(r),d=a===l?0:.5/(l-a),h=l===c?0:.5/(c-l),n=l<a?-1:1,b}}function kP(){var e=dl(dp()(Dn));return e.copy=function(){return ul(e,kP())},vi.apply(e,arguments)}function NP(){var e=C1(dp()).domain([.1,1,10]);return e.copy=function(){return ul(e,NP()).base(e.base())},vi.apply(e,arguments)}function SP(){var e=E1(dp());return e.copy=function(){return ul(e,SP()).constant(e.constant())},vi.apply(e,arguments)}function B1(){var e=A1(dp());return e.copy=function(){return ul(e,B1()).exponent(e.exponent())},vi.apply(e,arguments)}function ZZ(){return B1.apply(null,arguments).exponent(.5)}const nu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:y1,scaleDiverging:kP,scaleDivergingLog:NP,scaleDivergingPow:B1,scaleDivergingSqrt:ZZ,scaleDivergingSymlog:SP,scaleIdentity:sP,scaleImplicit:Fy,scaleLinear:nP,scaleLog:iP,scaleOrdinal:v1,scalePoint:BJ,scalePow:T1,scaleQuantile:cP,scaleQuantize:dP,scaleRadial:oP,scaleSequential:yP,scaleSequentialLog:wP,scaleSequentialPow:z1,scaleSequentialQuantile:_P,scaleSequentialSqrt:QZ,scaleSequentialSymlog:jP,scaleSqrt:DQ,scaleSymlog:lP,scaleThreshold:uP,scaleTime:XZ,scaleUtc:JZ,tickFormat:rP},Symbol.toStringTag,{value:"Module"}));var yi=e=>e.chartData,CP=de([yi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),EP=(e,t,r,n)=>n?CP(e):yi(e),eee=(e,t,r)=>r?CP(e):yi(e);function ll(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(wr(t)&&wr(r))return!0}return!1}function qC(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function AP(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,l;if(wr(r))a=r;else if(typeof r=="function")return;if(wr(n))l=n;else if(typeof n=="function")return;var c=[a,l];if(ll(c))return c}}function tee(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ll(n))return qC(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,l]=e,c,d;if(a==="auto")t!=null&&(c=Math.min(...t));else if(We(a))c=a;else if(typeof a=="function")try{t!=null&&(c=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&t4.test(a)){var h=t4.exec(a);if(h==null||h[1]==null||t==null)c=void 0;else{var f=+h[1];c=t[0]-f}}else c=t==null?void 0:t[0];if(l==="auto")t!=null&&(d=Math.max(...t));else if(We(l))d=l;else if(typeof l=="function")try{t!=null&&(d=l(t==null?void 0:t[1]))}catch{}else if(typeof l=="string"&&r4.test(l)){var m=r4.exec(l);if(m==null||m[1]==null||t==null)d=void 0;else{var g=+m[1];d=t[1]+g}}else d=t==null?void 0:t[1];var x=[c,d];if(ll(x))return t==null?x:qC(x,t,r)}}}var Wc=1e9,ree={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},q1,gr=!0,qs="[DecimalError] ",Ql=qs+"Invalid argument: ",U1=qs+"Exponent out of range: ",Gc=Math.floor,Ll=Math.pow,nee=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hs,sn=1e7,or=7,TP=9007199254740991,om=Gc(TP/or),Be={};Be.absoluteValue=Be.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Be.comparedTo=Be.cmp=function(e){var t,r,n,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===a?0:n>a^l.s<0?1:-1};Be.decimalPlaces=Be.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*or;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Be.dividedBy=Be.div=function(e){return ri(this,new this.constructor(e))};Be.dividedToIntegerBy=Be.idiv=function(e){var t=this,r=t.constructor;return rr(ri(t,new r(e),0,1),r.precision)};Be.equals=Be.eq=function(e){return!this.cmp(e)};Be.exponent=function(){return Fr(this)};Be.greaterThan=Be.gt=function(e){return this.cmp(e)>0};Be.greaterThanOrEqualTo=Be.gte=function(e){return this.cmp(e)>=0};Be.isInteger=Be.isint=function(){return this.e>this.d.length-2};Be.isNegative=Be.isneg=function(){return this.s<0};Be.isPositive=Be.ispos=function(){return this.s>0};Be.isZero=function(){return this.s===0};Be.lessThan=Be.lt=function(e){return this.cmp(e)<0};Be.lessThanOrEqualTo=Be.lte=function(e){return this.cmp(e)<1};Be.logarithm=Be.log=function(e){var t,r=this,n=r.constructor,a=n.precision,l=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(hs))throw Error(qs+"NaN");if(r.s<1)throw Error(qs+(r.s?"NaN":"-Infinity"));return r.eq(hs)?new n(0):(gr=!1,t=ri(Au(r,l),Au(e,l),l),gr=!0,rr(t,a))};Be.minus=Be.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?DP(t,e):OP(t,(e.s=-e.s,e))};Be.modulo=Be.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(qs+"NaN");return r.s?(gr=!1,t=ri(r,e,0,1).times(e),gr=!0,r.minus(t)):rr(new n(r),a)};Be.naturalExponential=Be.exp=function(){return PP(this)};Be.naturalLogarithm=Be.ln=function(){return Au(this)};Be.negated=Be.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Be.plus=Be.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OP(t,e):DP(t,(e.s=-e.s,e))};Be.precision=Be.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ql+e);if(t=Fr(a)+1,n=a.d.length-1,r=n*or+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Be.squareRoot=Be.sqrt=function(){var e,t,r,n,a,l,c,d=this,h=d.constructor;if(d.s<1){if(!d.s)return new h(0);throw Error(qs+"NaN")}for(e=Fr(d),gr=!1,a=Math.sqrt(+d),a==0||a==1/0?(t=ba(d.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Gc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new h(t)):n=new h(a.toString()),r=h.precision,a=c=r+3;;)if(l=n,n=l.plus(ri(d,l,c+2)).times(.5),ba(l.d).slice(0,c)===(t=ba(n.d)).slice(0,c)){if(t=t.slice(c-3,c+1),a==c&&t=="4999"){if(rr(l,r+1,0),l.times(l).eq(d)){n=l;break}}else if(t!="9999")break;c+=4}return gr=!0,rr(n,r)};Be.times=Be.mul=function(e){var t,r,n,a,l,c,d,h,f,m=this,g=m.constructor,x=m.d,b=(e=new g(e)).d;if(!m.s||!e.s)return new g(0);for(e.s*=m.s,r=m.e+e.e,h=x.length,f=b.length,h<f&&(l=x,x=b,b=l,c=h,h=f,f=c),l=[],c=h+f,n=c;n--;)l.push(0);for(n=f;--n>=0;){for(t=0,a=h+n;a>n;)d=l[a]+b[n]*x[a-n-1]+t,l[a--]=d%sn|0,t=d/sn|0;l[a]=(l[a]+t)%sn|0}for(;!l[--c];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,gr?rr(e,g.precision):e};Be.toDecimalPlaces=Be.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ka(e,0,Wc),t===void 0?t=n.rounding:ka(t,0,8),rr(r,e+Fr(r)+1,t))};Be.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=so(n,!0):(ka(e,0,Wc),t===void 0?t=a.rounding:ka(t,0,8),n=rr(new a(n),e+1,t),r=so(n,!0,e+1)),r};Be.toFixed=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?so(a):(ka(e,0,Wc),t===void 0?t=l.rounding:ka(t,0,8),n=rr(new l(a),e+Fr(a)+1,t),r=so(n.abs(),!1,e+Fr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Be.toInteger=Be.toint=function(){var e=this,t=e.constructor;return rr(new t(e),Fr(e)+1,t.rounding)};Be.toNumber=function(){return+this};Be.toPower=Be.pow=function(e){var t,r,n,a,l,c,d=this,h=d.constructor,f=12,m=+(e=new h(e));if(!e.s)return new h(hs);if(d=new h(d),!d.s){if(e.s<1)throw Error(qs+"Infinity");return d}if(d.eq(hs))return d;if(n=h.precision,e.eq(hs))return rr(d,n);if(t=e.e,r=e.d.length-1,c=t>=r,l=d.s,c){if((r=m<0?-m:m)<=TP){for(a=new h(hs),t=Math.ceil(n/or+4),gr=!1;r%2&&(a=a.times(d),HC(a.d,t)),r=Gc(r/2),r!==0;)d=d.times(d),HC(d.d,t);return gr=!0,e.s<0?new h(hs).div(a):rr(a,n)}}else if(l<0)throw Error(qs+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,d.s=1,gr=!1,a=e.times(Au(d,n+f)),gr=!0,a=PP(a),a.s=l,a};Be.toPrecision=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?(r=Fr(a),n=so(a,r<=l.toExpNeg||r>=l.toExpPos)):(ka(e,1,Wc),t===void 0?t=l.rounding:ka(t,0,8),a=rr(new l(a),e,t),r=Fr(a),n=so(a,e<=r||r<=l.toExpNeg,e)),n};Be.toSignificantDigits=Be.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ka(e,1,Wc),t===void 0?t=n.rounding:ka(t,0,8)),rr(new n(r),e,t)};Be.toString=Be.valueOf=Be.val=Be.toJSON=Be[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Fr(e),r=e.constructor;return so(e,t<=r.toExpNeg||t>=r.toExpPos)};function OP(e,t){var r,n,a,l,c,d,h,f,m=e.constructor,g=m.precision;if(!e.s||!t.s)return t.s||(t=new m(e)),gr?rr(t,g):t;if(h=e.d,f=t.d,c=e.e,a=t.e,h=h.slice(),l=c-a,l){for(l<0?(n=h,l=-l,d=f.length):(n=f,a=c,d=h.length),c=Math.ceil(g/or),d=c>d?c+1:d+1,l>d&&(l=d,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(d=h.length,l=f.length,d-l<0&&(l=d,n=f,f=h,h=n),r=0;l;)r=(h[--l]=h[l]+f[l]+r)/sn|0,h[l]%=sn;for(r&&(h.unshift(r),++a),d=h.length;h[--d]==0;)h.pop();return t.d=h,t.e=a,gr?rr(t,g):t}function ka(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ql+e)}function ba(e){var t,r,n,a=e.length-1,l="",c=e[0];if(a>0){for(l+=c,t=1;t<a;t++)n=e[t]+"",r=or-n.length,r&&(l+=Qi(r)),l+=n;c=e[t],n=c+"",r=or-n.length,r&&(l+=Qi(r))}else if(c===0)return"0";for(;c%10===0;)c/=10;return l+c}var ri=(function(){function e(n,a){var l,c=0,d=n.length;for(n=n.slice();d--;)l=n[d]*a+c,n[d]=l%sn|0,c=l/sn|0;return c&&n.unshift(c),n}function t(n,a,l,c){var d,h;if(l!=c)h=l>c?1:-1;else for(d=h=0;d<l;d++)if(n[d]!=a[d]){h=n[d]>a[d]?1:-1;break}return h}function r(n,a,l){for(var c=0;l--;)n[l]-=c,c=n[l]<a[l]?1:0,n[l]=c*sn+n[l]-a[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,l,c){var d,h,f,m,g,x,b,j,w,_,N,C,A,E,S,T,D,P,I=n.constructor,$=n.s==a.s?1:-1,M=n.d,R=a.d;if(!n.s)return new I(n);if(!a.s)throw Error(qs+"Division by zero");for(h=n.e-a.e,D=R.length,S=M.length,b=new I($),j=b.d=[],f=0;R[f]==(M[f]||0);)++f;if(R[f]>(M[f]||0)&&--h,l==null?C=l=I.precision:c?C=l+(Fr(n)-Fr(a))+1:C=l,C<0)return new I(0);if(C=C/or+2|0,f=0,D==1)for(m=0,R=R[0],C++;(f<S||m)&&C--;f++)A=m*sn+(M[f]||0),j[f]=A/R|0,m=A%R|0;else{for(m=sn/(R[0]+1)|0,m>1&&(R=e(R,m),M=e(M,m),D=R.length,S=M.length),E=D,w=M.slice(0,D),_=w.length;_<D;)w[_++]=0;P=R.slice(),P.unshift(0),T=R[0],R[1]>=sn/2&&++T;do m=0,d=t(R,w,D,_),d<0?(N=w[0],D!=_&&(N=N*sn+(w[1]||0)),m=N/T|0,m>1?(m>=sn&&(m=sn-1),g=e(R,m),x=g.length,_=w.length,d=t(g,w,x,_),d==1&&(m--,r(g,D<x?P:R,x))):(m==0&&(d=m=1),g=R.slice()),x=g.length,x<_&&g.unshift(0),r(w,g,_),d==-1&&(_=w.length,d=t(R,w,D,_),d<1&&(m++,r(w,D<_?P:R,_))),_=w.length):d===0&&(m++,w=[0]),j[f++]=m,d&&w[0]?w[_++]=M[E]||0:(w=[M[E]],_=1);while((E++<S||w[0]!==void 0)&&C--)}return j[0]||j.shift(),b.e=h,rr(b,c?l+Fr(b)+1:l)}})();function PP(e,t){var r,n,a,l,c,d,h=0,f=0,m=e.constructor,g=m.precision;if(Fr(e)>16)throw Error(U1+Fr(e));if(!e.s)return new m(hs);for(gr=!1,d=g,c=new m(.03125);e.abs().gte(.1);)e=e.times(c),f+=5;for(n=Math.log(Ll(2,f))/Math.LN10*2+5|0,d+=n,r=a=l=new m(hs),m.precision=d;;){if(a=rr(a.times(e),d),r=r.times(++h),c=l.plus(ri(a,r,d)),ba(c.d).slice(0,d)===ba(l.d).slice(0,d)){for(;f--;)l=rr(l.times(l),d);return m.precision=g,t==null?(gr=!0,rr(l,g)):l}l=c}}function Fr(e){for(var t=e.e*or,r=e.d[0];r>=10;r/=10)t++;return t}function hv(e,t,r){if(t>e.LN10.sd())throw gr=!0,r&&(e.precision=r),Error(qs+"LN10 precision limit exceeded");return rr(new e(e.LN10),t)}function Qi(e){for(var t="";e--;)t+="0";return t}function Au(e,t){var r,n,a,l,c,d,h,f,m,g=1,x=10,b=e,j=b.d,w=b.constructor,_=w.precision;if(b.s<1)throw Error(qs+(b.s?"NaN":"-Infinity"));if(b.eq(hs))return new w(0);if(t==null?(gr=!1,f=_):f=t,b.eq(10))return t==null&&(gr=!0),hv(w,f);if(f+=x,w.precision=f,r=ba(j),n=r.charAt(0),l=Fr(b),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)b=b.times(e),r=ba(b.d),n=r.charAt(0),g++;l=Fr(b),n>1?(b=new w("0."+r),l++):b=new w(n+"."+r.slice(1))}else return h=hv(w,f+2,_).times(l+""),b=Au(new w(n+"."+r.slice(1)),f-x).plus(h),w.precision=_,t==null?(gr=!0,rr(b,_)):b;for(d=c=b=ri(b.minus(hs),b.plus(hs),f),m=rr(b.times(b),f),a=3;;){if(c=rr(c.times(m),f),h=d.plus(ri(c,new w(a),f)),ba(h.d).slice(0,f)===ba(d.d).slice(0,f))return d=d.times(2),l!==0&&(d=d.plus(hv(w,f+2,_).times(l+""))),d=ri(d,new w(g),f),w.precision=_,t==null?(gr=!0,rr(d,_)):d;d=h,a+=2}}function FC(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Gc(r/or),e.d=[],n=(r+1)%or,r<0&&(n+=or),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=or;n<a;)e.d.push(+t.slice(n,n+=or));t=t.slice(n),n=or-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),gr&&(e.e>om||e.e<-om))throw Error(U1+r)}else e.s=0,e.e=0,e.d=[0];return e}function rr(e,t,r){var n,a,l,c,d,h,f,m,g=e.d;for(c=1,l=g[0];l>=10;l/=10)c++;if(n=t-c,n<0)n+=or,a=t,f=g[m=0];else{if(m=Math.ceil((n+1)/or),l=g.length,m>=l)return e;for(f=l=g[m],c=1;l>=10;l/=10)c++;n%=or,a=n-or+c}if(r!==void 0&&(l=Ll(10,c-a-1),d=f/l%10|0,h=t<0||g[m+1]!==void 0||f%l,h=r<4?(d||h)&&(r==0||r==(e.s<0?3:2)):d>5||d==5&&(r==4||h||r==6&&(n>0?a>0?f/Ll(10,c-a):0:g[m-1])%10&1||r==(e.s<0?8:7))),t<1||!g[0])return h?(l=Fr(e),g.length=1,t=t-l-1,g[0]=Ll(10,(or-t%or)%or),e.e=Gc(-t/or)||0):(g.length=1,g[0]=e.e=e.s=0),e;if(n==0?(g.length=m,l=1,m--):(g.length=m+1,l=Ll(10,or-n),g[m]=a>0?(f/Ll(10,c-a)%Ll(10,a)|0)*l:0),h)for(;;)if(m==0){(g[0]+=l)==sn&&(g[0]=1,++e.e);break}else{if(g[m]+=l,g[m]!=sn)break;g[m--]=0,l=1}for(n=g.length;g[--n]===0;)g.pop();if(gr&&(e.e>om||e.e<-om))throw Error(U1+Fr(e));return e}function DP(e,t){var r,n,a,l,c,d,h,f,m,g,x=e.constructor,b=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),gr?rr(t,b):t;if(h=e.d,g=t.d,n=t.e,f=e.e,h=h.slice(),c=f-n,c){for(m=c<0,m?(r=h,c=-c,d=g.length):(r=g,n=f,d=h.length),a=Math.max(Math.ceil(b/or),d)+2,c>a&&(c=a,r.length=1),r.reverse(),a=c;a--;)r.push(0);r.reverse()}else{for(a=h.length,d=g.length,m=a<d,m&&(d=a),a=0;a<d;a++)if(h[a]!=g[a]){m=h[a]<g[a];break}c=0}for(m&&(r=h,h=g,g=r,t.s=-t.s),d=h.length,a=g.length-d;a>0;--a)h[d++]=0;for(a=g.length;a>c;){if(h[--a]<g[a]){for(l=a;l&&h[--l]===0;)h[l]=sn-1;--h[l],h[a]+=sn}h[a]-=g[a]}for(;h[--d]===0;)h.pop();for(;h[0]===0;h.shift())--n;return h[0]?(t.d=h,t.e=n,gr?rr(t,b):t):new x(0)}function so(e,t,r){var n,a=Fr(e),l=ba(e.d),c=l.length;return t?(r&&(n=r-c)>0?l=l.charAt(0)+"."+l.slice(1)+Qi(n):c>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+Qi(-a-1)+l,r&&(n=r-c)>0&&(l+=Qi(n))):a>=c?(l+=Qi(a+1-c),r&&(n=r-a-1)>0&&(l=l+"."+Qi(n))):((n=a+1)<c&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-c)>0&&(a+1===c&&(l+="."),l+=Qi(n))),e.s<0?"-"+l:l}function HC(e,t){if(e.length>t)return e.length=t,!0}function MP(e){var t,r,n;function a(l){var c=this;if(!(c instanceof a))return new a(l);if(c.constructor=a,l instanceof a){c.s=l.s,c.e=l.e,c.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(Ql+l);if(l>0)c.s=1;else if(l<0)l=-l,c.s=-1;else{c.s=0,c.e=0,c.d=[0];return}if(l===~~l&&l<1e7){c.e=0,c.d=[l];return}return FC(c,l.toString())}else if(typeof l!="string")throw Error(Ql+l);if(l.charCodeAt(0)===45?(l=l.slice(1),c.s=-1):c.s=1,nee.test(l))FC(c,l);else throw Error(Ql+l)}if(a.prototype=Be,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=MP,a.config=a.set=see,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function see(e){if(!e||typeof e!="object")throw Error(qs+"Object expected");var t,r,n,a=["precision",1,Wc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Gc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ql+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ql+r+": "+n);return this}var q1=MP(ree);hs=new q1(1);const Ht=q1;var aee=e=>e,RP={},IP=e=>e===RP,VC=e=>function t(){return arguments.length===0||arguments.length===1&&IP(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},$P=(e,t)=>e===1?t:VC(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var l=n.filter(c=>c!==RP).length;return l>=e?t(...n):$P(e-l,VC(function(){for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];var f=n.map(m=>IP(m)?d.shift():m);return t(...f,...d)}))}),iee=e=>$P(e.length,e),Gy=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},lee=iee((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),oee=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return aee;var a=r.reverse(),l=a[0],c=a.slice(1);return function(){return c.reduce((d,h)=>h(d),l(...arguments))}};function LP(e){var t;return e===0?t=1:t=Math.floor(new Ht(e).abs().log(10).toNumber())+1,t}function zP(e,t,r){for(var n=new Ht(e),a=0,l=[];n.lt(t)&&a<1e5;)l.push(n.toNumber()),n=n.add(r),a++;return l}var BP=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},UP=(e,t,r)=>{if(e.lte(0))return new Ht(0);var n=LP(e.toNumber()),a=new Ht(10).pow(n),l=e.div(a),c=n!==1?.05:.1,d=new Ht(Math.ceil(l.div(c).toNumber())).add(r).mul(c),h=d.mul(a);return t?new Ht(h.toNumber()):new Ht(Math.ceil(h.toNumber()))},cee=(e,t,r)=>{var n=new Ht(1),a=new Ht(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(n=new Ht(10).pow(LP(e)-1),a=new Ht(Math.floor(a.div(n).toNumber())).mul(n)):l>1&&(a=new Ht(Math.floor(e)))}else e===0?a=new Ht(Math.floor((t-1)/2)):r||(a=new Ht(Math.floor(e)));var c=Math.floor((t-1)/2),d=oee(lee(h=>a.add(new Ht(h-c).mul(n)).toNumber()),Gy);return d(0,t)},qP=function(t,r,n,a){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Ht(0),tickMin:new Ht(0),tickMax:new Ht(0)};var c=UP(new Ht(r).sub(t).div(n-1),a,l),d;t<=0&&r>=0?d=new Ht(0):(d=new Ht(t).add(r).div(2),d=d.sub(new Ht(d).mod(c)));var h=Math.ceil(d.sub(t).div(c).toNumber()),f=Math.ceil(new Ht(r).sub(d).div(c).toNumber()),m=h+f+1;return m>n?qP(t,r,n,a,l+1):(m<n&&(f=r>0?f+(n-m):f,h=r>0?h:h+(n-m)),{step:c,tickMin:d.sub(new Ht(h).mul(c)),tickMax:d.add(new Ht(f).mul(c))})},dee=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=Math.max(a,2),[d,h]=BP([r,n]);if(d===-1/0||h===1/0){var f=h===1/0?[d,...Gy(0,a-1).map(()=>1/0)]:[...Gy(0,a-1).map(()=>-1/0),h];return r>n?f.reverse():f}if(d===h)return cee(d,a,l);var{step:m,tickMin:g,tickMax:x}=qP(d,h,c,l,0),b=zP(g,x.add(new Ht(.1).mul(m)),m);return r>n?b.reverse():b},uee=function(t,r){var[n,a]=t,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[c,d]=BP([n,a]);if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var h=Math.max(r,2),f=UP(new Ht(d).sub(c).div(h-1),l,0),m=[...zP(new Ht(c),new Ht(d),f),d];return l===!1&&(m=m.map(g=>Math.round(g))),n>a?m.reverse():m},FP=e=>e.rootProps.maxBarSize,hee=e=>e.rootProps.barGap,HP=e=>e.rootProps.barCategoryGap,fee=e=>e.rootProps.barSize,up=e=>e.rootProps.stackOffset,VP=e=>e.rootProps.reverseStackOrder,F1=e=>e.options.chartName,H1=e=>e.rootProps.syncId,WP=e=>e.rootProps.syncMethod,V1=e=>e.options.eventEmitter,Mn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ja={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},cs={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},hp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},mee={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ja.angleAxisId,includeHidden:!1,name:void 0,reversed:Ja.reversed,scale:Ja.scale,tick:Ja.tick,tickCount:void 0,ticks:void 0,type:Ja.type,unit:void 0},pee={allowDataOverflow:cs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:cs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:cs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:cs.scale,tick:cs.tick,tickCount:cs.tickCount,ticks:void 0,type:cs.type,unit:void 0},gee={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ja.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ja.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ja.scale,tick:Ja.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},xee={allowDataOverflow:cs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:cs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:cs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:cs.scale,tick:cs.tick,tickCount:cs.tickCount,ticks:void 0,type:"category",unit:void 0},W1=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?gee:mee,G1=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?xee:pee,fp=e=>e.polarOptions,K1=de([xi,bi,on],uJ),GP=de([fp,K1],(e,t)=>{if(e!=null)return la(e.innerRadius,t,0)}),KP=de([fp,K1],(e,t)=>{if(e!=null)return la(e.outerRadius,t,t*.8)}),bee=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},YP=de([fp],bee);de([W1,YP],hp);var XP=de([K1,GP,KP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});de([G1,XP],hp);var JP=de([Wt,fp,GP,KP,xi,bi],(e,t,r,n,a,l)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:c,cy:d,startAngle:h,endAngle:f}=t;return{cx:la(c,a,a/2),cy:la(d,l,l/2),innerRadius:r,outerRadius:n,startAngle:h,endAngle:f,clockWise:!1}}}),Xr=(e,t)=>t,mp=(e,t,r)=>r;function Y1(e){return e==null?void 0:e.id}function QP(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:l}=r,c=new Map;return e.forEach(d=>{var h,f=(h=d.data)!==null&&h!==void 0?h:n;if(!(f==null||f.length===0)){var m=Y1(d);f.forEach((g,x)=>{var b=l==null||a?x:String(kn(g,l,null)),j=kn(g,d.dataKey,0),w;c.has(b)?w=c.get(b):w={},Object.assign(w,{[m]:j}),c.set(b,w)})}}),Array.from(c.values())}function pp(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var gp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function xp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function vee(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Jr=e=>{var t=Wt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Kc=e=>e.tooltip.settings.axisId;function WC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WC(Object(r),!0).forEach(function(n){yee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yee(e,t,r){return(t=wee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wee(e){var t=jee(e,"string");return typeof t=="symbol"?t:t+""}function jee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ky=[0,"auto"],rn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},ZP=(e,t)=>e.cartesianAxis.xAxis[t],wi=(e,t)=>{var r=ZP(e,t);return r??rn},nn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Ky,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Wu},eD=(e,t)=>e.cartesianAxis.yAxis[t],ji=(e,t)=>{var r=eD(e,t);return r??nn},_ee={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},X1=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??_ee},Ln=(e,t,r)=>{switch(t){case"xAxis":return wi(e,r);case"yAxis":return ji(e,r);case"zAxis":return X1(e,r);case"angleAxis":return W1(e,r);case"radiusAxis":return G1(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},kee=(e,t,r)=>{switch(t){case"xAxis":return wi(e,r);case"yAxis":return ji(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Zu=(e,t,r)=>{switch(t){case"xAxis":return wi(e,r);case"yAxis":return ji(e,r);case"angleAxis":return W1(e,r);case"radiusAxis":return G1(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},tD=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function rD(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var J1=e=>e.graphicalItems.cartesianItems,Nee=de([Xr,mp],rD),nD=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),eh=de([J1,Ln,Nee],nD,{memoizeOptions:{resultEqualityCheck:xp}}),sD=de([eh],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(pp)),aD=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),See=de([eh],aD),iD=e=>e.map(t=>t.data).filter(Boolean).flat(1),Cee=de([eh],iD,{memoizeOptions:{resultEqualityCheck:xp}}),lD=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Q1=de([Cee,EP],lD),oD=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:kn(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:kn(a,n)}))):e.map(n=>({value:n})),bp=de([Q1,Ln,eh],oD);function cD(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function u0(e){if(ja(e)||e instanceof Date){var t=Number(e);if(wr(t))return t}}function GC(e){if(Array.isArray(e)){var t=[u0(e[0]),u0(e[1])];return ll(t)?t:void 0}var r=u0(e);if(r!=null)return[r,r]}function pi(e){return e.map(u0).filter(IW)}function Eee(e,t,r){return!r||typeof t!="number"||ia(t)?[]:r.length?pi(r.flatMap(n=>{var a=kn(e,n.dataKey),l,c;if(Array.isArray(a)?[l,c]=a:l=c=a,!(!wr(l)||!wr(c)))return[t-l,t+c]})):[]}var Qr=e=>{var t=Jr(e),r=Kc(e);return Zu(e,t,r)},th=de([Qr],e=>e==null?void 0:e.dataKey),Aee=de([sD,EP,Qr],QP),dD=(e,t,r,n)=>{var a={},l=t.reduce((c,d)=>{if(d.stackId==null)return c;var h=c[d.stackId];return h==null&&(h=[]),h.push(d),c[d.stackId]=h,c},a);return Object.fromEntries(Object.entries(l).map(c=>{var[d,h]=c,f=n?[...h].reverse():h,m=f.map(Y1);return[d,{stackedData:rY(e,m,r),graphicalItems:f}]}))},Yy=de([Aee,sD,up,VP],dD),uD=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:l}=t;if(n==null&&r!=="zAxis"){var c=lY(e,a,l);if(!(c!=null&&c[0]===0&&c[1]===0))return c}},Tee=de([Ln],e=>e.allowDataOverflow),Z1=e=>{var t;if(e==null||!("domain"in e))return Ky;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=pi(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Ky},hD=de([Ln],Z1),fD=de([hD,Tee],AP),Oee=de([Yy,yi,Xr,fD],uD,{memoizeOptions:{resultEqualityCheck:gp}}),ej=e=>e.errorBars,Pee=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>cD(r,n)),dm=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var l=a.flat(),c=Math.min(...l),d=Math.max(...l);return[c,d]}},mD=(e,t,r,n,a)=>{var l,c;if(r.length>0&&e.forEach(d=>{r.forEach(h=>{var f,m,g=(f=n[h.id])===null||f===void 0?void 0:f.filter(N=>cD(a,N)),x=kn(d,(m=t.dataKey)!==null&&m!==void 0?m:h.dataKey),b=Eee(d,x,g);if(b.length>=2){var j=Math.min(...b),w=Math.max(...b);(l==null||j<l)&&(l=j),(c==null||w>c)&&(c=w)}var _=GC(x);_!=null&&(l=l==null?_[0]:Math.min(l,_[0]),c=c==null?_[1]:Math.max(c,_[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(d=>{var h=GC(kn(d,t.dataKey));h!=null&&(l=l==null?h[0]:Math.min(l,h[0]),c=c==null?h[1]:Math.max(c,h[1]))}),wr(l)&&wr(c))return[l,c]},Dee=de([Q1,Ln,See,ej,Xr],mD,{memoizeOptions:{resultEqualityCheck:gp}});function Mee(e){var{value:t}=e;if(ja(t)||t instanceof Date)return t}var Ree=(e,t,r)=>{var n=e.map(Mee).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&kO(n))?W6(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},pD=e=>e.referenceElements.dots,Yc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),Iee=de([pD,Xr,mp],Yc),gD=e=>e.referenceElements.areas,$ee=de([gD,Xr,mp],Yc),xD=e=>e.referenceElements.lines,Lee=de([xD,Xr,mp],Yc),bD=(e,t)=>{if(e!=null){var r=pi(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},zee=de(Iee,Xr,bD),vD=(e,t)=>{if(e!=null){var r=pi(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Bee=de([$ee,Xr],vD);function Uee(e){var t;if(e.x!=null)return pi([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:pi(r)}function qee(e){var t;if(e.y!=null)return pi([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:pi(r)}var yD=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?Uee(n):qee(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Fee=de([Lee,Xr],yD),Hee=de(zee,Fee,Bee,(e,t,r)=>dm(e,r,t)),wD=(e,t,r,n,a,l,c,d)=>{if(r!=null)return r;var h=c==="vertical"&&d==="xAxis"||c==="horizontal"&&d==="yAxis",f=h?dm(n,l,a):dm(l,a);return tee(t,f,e.allowDataOverflow)},Vee=de([Ln,hD,fD,Oee,Dee,Hee,Wt,Xr],wD,{memoizeOptions:{resultEqualityCheck:gp}}),Wee=[0,1],jD=(e,t,r,n,a,l,c)=>{if(!((e==null||r==null||r.length===0)&&c===void 0)){var{dataKey:d,type:h}=e,f=oo(t,l);if(f&&d==null){var m;return W6(0,(m=r==null?void 0:r.length)!==null&&m!==void 0?m:0)}return h==="category"?Ree(n,e,f):a==="expand"?Wee:c}},tj=de([Ln,Wt,Q1,bp,up,Xr,Vee],jD),_D=(e,t,r,n,a)=>{if(e!=null){var{scale:l,type:c}=e;if(l==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":c==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":c==="category"?"band":"linear";if(typeof l=="string"){var d="scale".concat(Uu(l));return d in nu?d:"point"}}},rh=de([Ln,Wt,tD,F1,Xr],_D);function Gee(e){if(e!=null){if(e in nu)return nu[e]();var t="scale".concat(Uu(e));if(t in nu)return nu[t]()}}function rj(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=Gee(t);if(a!=null){var l=a.domain(r).range(n);return JK(l),l}}}var kD=(e,t,r)=>{var n=Z1(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ll(e))return dee(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ll(e))return uee(e,t.tickCount,t.allowDecimals)}},nj=de([tj,Zu,rh],kD),ND=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&ll(t)&&Array.isArray(r)&&r.length>0){var a=t[0],l=r[0],c=t[1],d=r[r.length-1];return[Math.min(a,l),Math.max(c,d)]}return t},Kee=de([Ln,tj,nj,Xr],ND),Yee=de(bp,Ln,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(pi(e.map(g=>g.value))).sort((g,x)=>g-x),a=n[0],l=n[n.length-1];if(a==null||l==null)return 1/0;var c=l-a;if(c===0)return 1/0;for(var d=0;d<n.length-1;d++){var h=n[d],f=n[d+1];if(!(h==null||f==null)){var m=f-h;r=Math.min(r,m)}}return r/c}}),SD=de(Yee,Wt,HP,on,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!wr(e))return 0;var l=t==="vertical"?n.height:n.width;if(a==="gap")return e*l/2;if(a==="no-gap"){var c=la(r,e*l),d=e*l/2;return d-c-(d-c)/l*c}return 0}),Xee=(e,t,r)=>{var n=wi(e,t);return n==null||typeof n.padding!="string"?0:SD(e,"xAxis",t,r,n.padding)},Jee=(e,t,r)=>{var n=ji(e,t);return n==null||typeof n.padding!="string"?0:SD(e,"yAxis",t,r,n.padding)},Qee=de(wi,Xee,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),Zee=de(ji,Jee,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),ete=de([on,Qee,Qm,Jm,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:l}=n;return a?[l.left,r.width-l.right]:[e.left+t.left,e.left+e.width-t.right]}),tte=de([on,Wt,Zee,Qm,Jm,(e,t,r)=>r],(e,t,r,n,a,l)=>{var{padding:c}=a;return l?[n.height-c.bottom,c.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),nh=(e,t,r,n)=>{var a;switch(t){case"xAxis":return ete(e,r,n);case"yAxis":return tte(e,r,n);case"zAxis":return(a=X1(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return YP(e);case"radiusAxis":return XP(e,r);default:return}},CD=de([Ln,nh],hp),vp=de([Ln,rh,Kee,CD],rj);de([eh,ej,Xr],Pee);function ED(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var yp=(e,t)=>t,wp=(e,t,r)=>r,rte=de(Ym,yp,wp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ED)),nte=de(Xm,yp,wp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ED)),AD=(e,t)=>({width:e.width,height:t.height}),ste=(e,t)=>{var r=typeof t.width=="number"?t.width:Wu;return{width:r,height:e.height}},TD=de(on,wi,AD),ate=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},ite=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},lte=de(bi,on,rte,yp,wp,(e,t,r,n,a)=>{var l={},c;return r.forEach(d=>{var h=AD(t,d);c==null&&(c=ate(t,n,e));var f=n==="top"&&!a||n==="bottom"&&a;l[d.id]=c-Number(f)*h.height,c+=(f?-1:1)*h.height}),l}),ote=de(xi,on,nte,yp,wp,(e,t,r,n,a)=>{var l={},c;return r.forEach(d=>{var h=ste(t,d);c==null&&(c=ite(t,n,e));var f=n==="left"&&!a||n==="right"&&a;l[d.id]=c-Number(f)*h.width,c+=(f?-1:1)*h.width}),l}),cte=(e,t)=>{var r=wi(e,t);if(r!=null)return lte(e,r.orientation,r.mirror)},dte=de([on,wi,cte,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),ute=(e,t)=>{var r=ji(e,t);if(r!=null)return ote(e,r.orientation,r.mirror)},hte=de([on,ji,ute,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),OD=de(on,ji,(e,t)=>{var r=typeof t.width=="number"?t.width:Wu;return{width:r,height:e.height}}),KC=(e,t,r)=>{switch(t){case"xAxis":return TD(e,r).width;case"yAxis":return OD(e,r).height;default:return}},PD=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:l,dataKey:c}=r,d=oo(e,n),h=t.map(f=>f.value);if(c&&d&&l==="category"&&a&&kO(h))return h}},sj=de([Wt,bp,Ln,Xr],PD),DD=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:l}=r,c=oo(e,n);if(c&&(a==="number"||l!=="auto"))return t.map(d=>d.value)}},aj=de([Wt,bp,Zu,Xr],DD),YC=de([Wt,kee,rh,vp,sj,aj,nh,nj,Xr],(e,t,r,n,a,l,c,d,h)=>{if(t!=null){var f=oo(e,h);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:h,categoricalDomain:l,duplicateDomain:a,isCategorical:f,niceTicks:d,range:c,realScaleType:r,scale:n}}}),fte=(e,t,r,n,a,l,c,d,h)=>{if(!(t==null||n==null)){var f=oo(e,h),{type:m,ticks:g,tickCount:x}=t,b=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,j=m==="category"&&n.bandwidth?n.bandwidth()/b:0;j=h==="angleAxis"&&l!=null&&l.length>=2?Kn(l[0]-l[1])*2*j:j;var w=g||a;if(w){var _=w.map((N,C)=>{var A=c?c.indexOf(N):N;return{index:C,coordinate:n(A)+j,value:N,offset:j}});return _.filter(N=>wr(N.coordinate))}return f&&d?d.map((N,C)=>({coordinate:n(N)+j,value:N,index:C,offset:j})).filter(N=>wr(N.coordinate)):n.ticks?n.ticks(x).map(N=>({coordinate:n(N)+j,value:N,offset:j})):n.domain().map((N,C)=>({coordinate:n(N)+j,value:c?c[N]:N,index:C,offset:j}))}},MD=de([Wt,Zu,rh,vp,nj,nh,sj,aj,Xr],fte),mte=(e,t,r,n,a,l,c)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var d=oo(e,c),{tickCount:h}=t,f=0;return f=c==="angleAxis"&&(n==null?void 0:n.length)>=2?Kn(n[0]-n[1])*2*f:f,d&&l?l.map((m,g)=>({coordinate:r(m)+f,value:m,index:g,offset:f})):r.ticks?r.ticks(h).map(m=>({coordinate:r(m)+f,value:m,offset:f})):r.domain().map((m,g)=>({coordinate:r(m)+f,value:a?a[m]:m,index:g,offset:f}))}},Mc=de([Wt,Zu,vp,nh,sj,aj,Xr],mte),Rc=de(Ln,vp,(e,t)=>{if(!(e==null||t==null))return cm(cm({},e),{},{scale:t})}),pte=de([Ln,rh,tj,CD],rj);de((e,t,r)=>X1(e,r),pte,(e,t)=>{if(!(e==null||t==null))return cm(cm({},e),{},{scale:t})});var gte=de([Wt,Ym,Xm],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),RD=e=>e.options.defaultTooltipEventType,ID=e=>e.options.validateTooltipEventTypes;function $D(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function ij(e,t){var r=RD(e),n=ID(e);return $D(t,r,n)}function xte(e){return Xe(t=>ij(t,e))}var LD=(e,t)=>{var r,n=Number(t);if(!(ia(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},bte=e=>e.tooltip.settings,rl={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},vte={itemInteraction:{click:rl,hover:rl},axisInteraction:{click:rl,hover:rl},keyboardInteraction:rl,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},zD=Jn({name:"tooltip",initialState:vte,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:pr()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ra(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:pr()},removeTooltipEntrySettings:{reducer(e,t){var r=ra(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:pr()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:yte,replaceTooltipEntrySettings:wte,removeTooltipEntrySettings:jte,setTooltipSettingsState:_te,setActiveMouseOverItemIndex:BD,mouseLeaveItem:kte,mouseLeaveChart:UD,setActiveClickItemIndex:Nte,setMouseOverAxisIndex:qD,setMouseClickAxisIndex:Ste,setSyncInteraction:Xy,setKeyboardInteraction:Jy}=zD.actions,Cte=zD.reducer;function XC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XC(Object(r),!0).forEach(function(n){Ete(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ete(e,t,r){return(t=Ate(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ate(e){var t=Tte(e,"string");return typeof t=="symbol"?t:t+""}function Tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ote(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function Pte(e){return e.index!=null}var FD=(e,t,r,n)=>{if(t==null)return rl;var a=Ote(e,t,r);if(a==null)return rl;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var l=e.settings.active===!0;if(Pte(a)){if(l)return Yf(Yf({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return Yf(Yf({},rl),{},{coordinate:a.coordinate})};function Dte(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function Mte(e,t){var r=Dte(e),n=t[0],a=t[1];if(r===void 0)return!1;var l=Math.min(n,a),c=Math.max(n,a);return r>=l&&r<=c}function Rte(e,t,r){if(r==null||t==null)return!0;var n=kn(e,t);return n==null||!ll(r)?!0:Mte(n,r)}var lj=(e,t,r,n)=>{var a=e==null?void 0:e.index;if(a==null)return null;var l=Number(a);if(!wr(l))return a;var c=0,d=1/0;t.length>0&&(d=t.length-1);var h=Math.max(c,Math.min(l,d)),f=t[h];return f==null||Rte(f,r,n)?String(h):null},HD=(e,t,r,n,a,l,c,d)=>{if(!(l==null||d==null)){var h=c[0],f=h==null?void 0:d(h.positions,l);if(f!=null)return f;var m=a==null?void 0:a[Number(l)];if(m)switch(r){case"horizontal":return{x:m.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:m.coordinate}}}},VD=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var l=e.tooltipItemPayloads[0];return l!=null?[l]:[]}return e.tooltipItemPayloads.filter(c=>{var d;return((d=c.settings)===null||d===void 0?void 0:d.graphicalItemId)===a})},sh=e=>e.options.tooltipPayloadSearcher,Xc=e=>e.tooltip;function JC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JC(Object(r),!0).forEach(function(n){Ite(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ite(e,t,r){return(t=$te(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $te(e){var t=Lte(e,"string");return typeof t=="symbol"?t:t+""}function Lte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zte(e,t){return e??t}var WD=(e,t,r,n,a,l,c)=>{if(!(t==null||l==null)){var{chartData:d,computedData:h,dataStartIndex:f,dataEndIndex:m}=r,g=[];return e.reduce((x,b)=>{var j,{dataDefinedOnItem:w,settings:_}=b,N=zte(w,d),C=Array.isArray(N)?g6(N,f,m):N,A=(j=_==null?void 0:_.dataKey)!==null&&j!==void 0?j:n,E=_==null?void 0:_.nameKey,S;if(n&&Array.isArray(C)&&!Array.isArray(C[0])&&c==="axis"?S=RW(C,n,a):S=l(C,t,h,E),Array.isArray(S))S.forEach(D=>{var P=QC(QC({},_),{},{name:D.name,unit:D.unit,color:void 0,fill:void 0});x.push(n4({tooltipEntrySettings:P,dataKey:D.dataKey,payload:D.payload,value:kn(D.payload,D.dataKey),name:D.name}))});else{var T;x.push(n4({tooltipEntrySettings:_,dataKey:A,payload:S,value:kn(S,A),name:(T=kn(S,E))!==null&&T!==void 0?T:_==null?void 0:_.name}))}return x},g)}},oj=de([Qr,Wt,tD,F1,Jr],_D),Bte=de([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Ute=de([Jr,Kc],rD),Jc=de([Bte,Qr,Ute],nD,{memoizeOptions:{resultEqualityCheck:xp}}),qte=de([Jc],e=>e.filter(pp)),Fte=de([Jc],iD,{memoizeOptions:{resultEqualityCheck:xp}}),Qc=de([Fte,yi],lD),Hte=de([qte,yi,Qr],QP),cj=de([Qc,Qr,Jc],oD),GD=de([Qr],Z1),Vte=de([Qr],e=>e.allowDataOverflow),KD=de([GD,Vte],AP),Wte=de([Jc],e=>e.filter(pp)),Gte=de([Hte,Wte,up,VP],dD),Kte=de([Gte,yi,Jr,KD],uD),Yte=de([Jc],aD),Xte=de([Qc,Qr,Yte,ej,Jr],mD,{memoizeOptions:{resultEqualityCheck:gp}}),Jte=de([pD,Jr,Kc],Yc),Qte=de([Jte,Jr],bD),Zte=de([gD,Jr,Kc],Yc),ere=de([Zte,Jr],vD),tre=de([xD,Jr,Kc],Yc),rre=de([tre,Jr],yD),nre=de([Qte,rre,ere],dm),sre=de([Qr,GD,KD,Kte,Xte,nre,Wt,Jr],wD),ah=de([Qr,Wt,Qc,cj,up,Jr,sre],jD),are=de([ah,Qr,oj],kD),ire=de([Qr,ah,are,Jr],ND),YD=e=>{var t=Jr(e),r=Kc(e),n=!1;return nh(e,t,r,n)},XD=de([Qr,YD],hp),JD=de([Qr,oj,ire,XD],rj),lre=de([Wt,cj,Qr,Jr],PD),ore=de([Wt,cj,Qr,Jr],DD),cre=(e,t,r,n,a,l,c,d)=>{if(t){var{type:h}=t,f=oo(e,d);if(n){var m=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,g=h==="category"&&n.bandwidth?n.bandwidth()/m:0;return g=d==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Kn(a[0]-a[1])*2*g:g,f&&c?c.map((x,b)=>({coordinate:n(x)+g,value:x,index:b,offset:g})):n.domain().map((x,b)=>({coordinate:n(x)+g,value:l?l[x]:x,index:b,offset:g}))}}},_i=de([Wt,Qr,oj,JD,YD,lre,ore,Jr],cre),dj=de([RD,ID,bte],(e,t,r)=>$D(r.shared,e,t)),QD=e=>e.tooltip.settings.trigger,uj=e=>e.tooltip.settings.defaultIndex,ih=de([Xc,dj,QD,uj],FD),Ic=de([ih,Qc,th,ah],lj),ZD=de([_i,Ic],LD),eM=de([ih],e=>{if(e)return e.dataKey});de([ih],e=>{if(e)return e.graphicalItemId});var tM=de([Xc,dj,QD,uj],VD),dre=de([xi,bi,Wt,on,_i,uj,tM,sh],HD),ure=de([ih,dre],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),hre=de([ih],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),fre=de([tM,Ic,yi,th,ZD,sh,dj],WD);de([fre],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function ZC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZC(Object(r),!0).forEach(function(n){mre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mre(e,t,r){return(t=pre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pre(e){var t=gre(e,"string");return typeof t=="symbol"?t:t+""}function gre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xre=()=>Xe(Qr),bre=()=>{var e=xre(),t=Xe(_i),r=Xe(JD);return F0(!e||!r?void 0:e3(e3({},e),{},{scale:r}),t)};function t3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t3(Object(r),!0).forEach(function(n){vre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vre(e,t,r){return(t=yre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yre(e){var t=wre(e,"string");return typeof t=="symbol"?t:t+""}function wre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jre=(e,t,r,n)=>{var a=t.find(l=>l&&l.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},_re=(e,t,r,n)=>{var a=t.find(f=>f&&f.index===r);if(a){if(e==="centric"){var l=a.coordinate,{radius:c}=n;return tc(tc(tc({},n),jn(n.cx,n.cy,c,l)),{},{angle:l,radius:c})}var d=a.coordinate,{angle:h}=n;return tc(tc(tc({},n),jn(n.cx,n.cy,d,h)),{},{angle:h,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function kre(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var rM=(e,t,r,n,a)=>{var l,c=(l=t==null?void 0:t.length)!==null&&l!==void 0?l:0;if(c<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var d=0;d<c;d++){var h,f,m,g,x,b=d>0?(h=r[d-1])===null||h===void 0?void 0:h.coordinate:(f=r[c-1])===null||f===void 0?void 0:f.coordinate,j=(m=r[d])===null||m===void 0?void 0:m.coordinate,w=d>=c-1?(g=r[0])===null||g===void 0?void 0:g.coordinate:(x=r[d+1])===null||x===void 0?void 0:x.coordinate,_=void 0;if(!(b==null||j==null||w==null))if(Kn(j-b)!==Kn(w-j)){var N=[];if(Kn(w-j)===Kn(a[1]-a[0])){_=w;var C=j+a[1]-a[0];N[0]=Math.min(C,(C+b)/2),N[1]=Math.max(C,(C+b)/2)}else{_=b;var A=w+a[1]-a[0];N[0]=Math.min(j,(A+j)/2),N[1]=Math.max(j,(A+j)/2)}var E=[Math.min(j,(_+j)/2),Math.max(j,(_+j)/2)];if(e>E[0]&&e<=E[1]||e>=N[0]&&e<=N[1]){var S;return(S=r[d])===null||S===void 0?void 0:S.index}}else{var T=Math.min(b,w),D=Math.max(b,w);if(e>(T+j)/2&&e<=(D+j)/2){var P;return(P=r[d])===null||P===void 0?void 0:P.index}}}else if(t)for(var I=0;I<c;I++){var $=t[I];if($!=null){var M=t[I+1],R=t[I-1];if(I===0&&M!=null&&e<=($.coordinate+M.coordinate)/2||I===c-1&&R!=null&&e>($.coordinate+R.coordinate)/2||I>0&&I<c-1&&R!=null&&M!=null&&e>($.coordinate+R.coordinate)/2&&e<=($.coordinate+M.coordinate)/2)return $.index}}return-1},Nre=()=>Xe(F1),hj=(e,t)=>t,nM=(e,t,r)=>r,fj=(e,t,r,n)=>n,Sre=de(_i,e=>Bm(e,t=>t.coordinate)),mj=de([Xc,hj,nM,fj],FD),pj=de([mj,Qc,th,ah],lj),Cre=(e,t,r)=>{if(t!=null){var n=Xc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},sM=de([Xc,hj,nM,fj],VD),um=de([xi,bi,Wt,on,_i,fj,sM,sh],HD),Ere=de([mj,um],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),aM=de([_i,pj],LD),Are=de([sM,pj,yi,th,aM,sh,hj],WD),Tre=de([mj,pj],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Ore=(e,t,r,n,a,l,c)=>{if(!(!e||!r||!n||!a)&&kre(e,c)){var d=oY(e,t),h=rM(d,l,a,r,n),f=jre(t,a,h,e);return{activeIndex:String(h),activeCoordinate:f}}},Pre=(e,t,r,n,a,l,c)=>{if(!(!e||!n||!a||!l||!r)){var d=gJ(e,r);if(d){var h=cY(d,t),f=rM(h,c,l,n,a),m=_re(t,l,f,d);return{activeIndex:String(f),activeCoordinate:m}}}},Dre=(e,t,r,n,a,l,c,d)=>{if(!(!e||!t||!n||!a||!l))return t==="horizontal"||t==="vertical"?Ore(e,t,n,a,l,c,d):Pre(e,t,r,n,a,l,c)},Mre=de(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),Rre=de(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Mn)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:vee}});function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){Ire(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ire(e,t,r){return(t=$re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $re(e){var t=Lre(e,"string");return typeof t=="symbol"?t:t+""}function Lre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zre={},Bre={zIndexMap:Object.values(Mn).reduce((e,t)=>n3(n3({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),zre)},Ure=new Set(Object.values(Mn));function qre(e){return Ure.has(e)}var iM=Jn({name:"zIndex",initialState:Bre,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:pr()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!qre(r)&&delete e.zIndexMap[r])},prepare:pr()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:pr()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:pr()}}}),{registerZIndexPortal:Fre,unregisterZIndexPortal:Hre,registerZIndexPortalElement:Vre,unregisterZIndexPortalElement:Wre}=iM.actions,Gre=iM.reducer;function ki(e){var{zIndex:t,children:r}=e,n=UY(),a=n&&t!==void 0&&t!==0,l=Qn(),c=Dr();v.useLayoutEffect(()=>a?(c(Fre({zIndex:t})),()=>{c(Hre({zIndex:t}))}):qu,[c,t,a]);var d=Xe(h=>Mre(h,t,l));return a?d?Dm.createPortal(r,d):null:r}function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qy.apply(null,arguments)}function s3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s3(Object(r),!0).forEach(function(n){Kre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kre(e,t,r){return(t=Yre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yre(e){var t=Xre(e,"string");return typeof t=="symbol"?t:t+""}function Xre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jre(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return v.isValidElement(t)?v.cloneElement(t,n):v.createElement(r,n)}function Qre(e){var t,{coordinate:r,payload:n,index:a,offset:l,tooltipAxisBandSize:c,layout:d,cursor:h,tooltipEventType:f,chartName:m}=e,g=r,x=n,b=a;if(!h||!g||m!=="ScatterChart"&&f!=="axis")return null;var j,w,_;if(m==="ScatterChart")j=g,w=AX,_=Mn.cursorLine;else if(m==="BarChart")j=TX(d,g,l,c),w=q6,_=Mn.cursorRectangle;else if(d==="radial"&&CO(g)){var{cx:N,cy:C,radius:A,startAngle:E,endAngle:S}=F6(g);j={cx:N,cy:C,startAngle:E,endAngle:S,innerRadius:A,outerRadius:A},w=V6,_=Mn.cursorLine}else j={points:yJ(d,g,l)},w=$6,_=Mn.cursorLine;var T=typeof h=="object"&&"className"in h?h.className:void 0,D=Xf(Xf(Xf(Xf({stroke:"#ccc",pointerEvents:"none"},l),j),Kw(h)),{},{payload:x,payloadIndex:b,className:cr("recharts-tooltip-cursor",T)});return v.createElement(ki,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:_},v.createElement(Jre,{cursor:h,cursorComp:w,cursorProps:D}))}function Zre(e){var t=bre(),r=S6(),n=Gu(),a=Nre();return t==null||r==null||n==null||a==null?null:v.createElement(Qre,Qy({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var lM=v.createContext(null),ene=()=>v.useContext(lM),fv={exports:{}},a3;function tne(){return a3||(a3=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(h,f,m){this.fn=h,this.context=f,this.once=m||!1}function l(h,f,m,g,x){if(typeof m!="function")throw new TypeError("The listener must be a function");var b=new a(m,g||h,x),j=r?r+f:f;return h._events[j]?h._events[j].fn?h._events[j]=[h._events[j],b]:h._events[j].push(b):(h._events[j]=b,h._eventsCount++),h}function c(h,f){--h._eventsCount===0?h._events=new n:delete h._events[f]}function d(){this._events=new n,this._eventsCount=0}d.prototype.eventNames=function(){var f=[],m,g;if(this._eventsCount===0)return f;for(g in m=this._events)t.call(m,g)&&f.push(r?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(m)):f},d.prototype.listeners=function(f){var m=r?r+f:f,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var x=0,b=g.length,j=new Array(b);x<b;x++)j[x]=g[x].fn;return j},d.prototype.listenerCount=function(f){var m=r?r+f:f,g=this._events[m];return g?g.fn?1:g.length:0},d.prototype.emit=function(f,m,g,x,b,j){var w=r?r+f:f;if(!this._events[w])return!1;var _=this._events[w],N=arguments.length,C,A;if(_.fn){switch(_.once&&this.removeListener(f,_.fn,void 0,!0),N){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,m),!0;case 3:return _.fn.call(_.context,m,g),!0;case 4:return _.fn.call(_.context,m,g,x),!0;case 5:return _.fn.call(_.context,m,g,x,b),!0;case 6:return _.fn.call(_.context,m,g,x,b,j),!0}for(A=1,C=new Array(N-1);A<N;A++)C[A-1]=arguments[A];_.fn.apply(_.context,C)}else{var E=_.length,S;for(A=0;A<E;A++)switch(_[A].once&&this.removeListener(f,_[A].fn,void 0,!0),N){case 1:_[A].fn.call(_[A].context);break;case 2:_[A].fn.call(_[A].context,m);break;case 3:_[A].fn.call(_[A].context,m,g);break;case 4:_[A].fn.call(_[A].context,m,g,x);break;default:if(!C)for(S=1,C=new Array(N-1);S<N;S++)C[S-1]=arguments[S];_[A].fn.apply(_[A].context,C)}}return!0},d.prototype.on=function(f,m,g){return l(this,f,m,g,!1)},d.prototype.once=function(f,m,g){return l(this,f,m,g,!0)},d.prototype.removeListener=function(f,m,g,x){var b=r?r+f:f;if(!this._events[b])return this;if(!m)return c(this,b),this;var j=this._events[b];if(j.fn)j.fn===m&&(!x||j.once)&&(!g||j.context===g)&&c(this,b);else{for(var w=0,_=[],N=j.length;w<N;w++)(j[w].fn!==m||x&&!j[w].once||g&&j[w].context!==g)&&_.push(j[w]);_.length?this._events[b]=_.length===1?_[0]:_:c(this,b)}return this},d.prototype.removeAllListeners=function(f){var m;return f?(m=r?r+f:f,this._events[m]&&c(this,m)):(this._events=new n,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=r,d.EventEmitter=d,e.exports=d})(fv)),fv.exports}var rne=tne();const nne=vs(rne);var Tu=new nne,Zy="recharts.syncEvent.tooltip",i3="recharts.syncEvent.brush";function sne(e,t){if(t){var r=Number.parseInt(t,10);if(!ia(r))return e==null?void 0:e[r]}}var ane={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},oM=Jn({name:"options",initialState:ane,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),ine=oM.reducer,{createEventEmitter:lne}=oM.actions;function one(e){return e.tooltip.syncInteraction}var cne={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},cM=Jn({name:"chartData",initialState:cne,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:l3,setDataStartEndIndexes:dne,setComputedData:eue}=cM.actions,une=cM.reducer,hne=["x","y"];function o3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o3(Object(r),!0).forEach(function(n){fne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fne(e,t,r){return(t=mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=pne(e,"string");return typeof t=="symbol"?t:t+""}function pne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gne(e,t){if(e==null)return{};var r,n,a=xne(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bne(){var e=Xe(H1),t=Xe(V1),r=Dr(),n=Xe(WP),a=Xe(_i),l=Gu(),c=Zm(),d=Xe(h=>h.rootProps.className);v.useEffect(()=>{if(e==null)return qu;var h=(f,m,g)=>{if(t!==g&&e===f){if(n==="index"){var x;if(c&&m!==null&&m!==void 0&&(x=m.payload)!==null&&x!==void 0&&x.coordinate&&m.payload.sourceViewBox){var b=m.payload.coordinate,{x:j,y:w}=b,_=gne(b,hne),{x:N,y:C,width:A,height:E}=m.payload.sourceViewBox,S=rc(rc({},_),{},{x:c.x+(A?(j-N)/A:0)*c.width,y:c.y+(E?(w-C)/E:0)*c.height});r(rc(rc({},m),{},{payload:rc(rc({},m.payload),{},{coordinate:S})}))}else r(m);return}if(a!=null){var T;if(typeof n=="function"){var D={activeTooltipIndex:m.payload.index==null?void 0:Number(m.payload.index),isTooltipActive:m.payload.active,activeIndex:m.payload.index==null?void 0:Number(m.payload.index),activeLabel:m.payload.label,activeDataKey:m.payload.dataKey,activeCoordinate:m.payload.coordinate},P=n(a,D);T=a[P]}else n==="value"&&(T=a.find(L=>String(L.value)===m.payload.label));var{coordinate:I}=m.payload;if(T==null||m.payload.active===!1||I==null||c==null){r(Xy({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:$,y:M}=I,R=Math.min($,c.x+c.width),F=Math.min(M,c.y+c.height),V={x:l==="horizontal"?T.coordinate:R,y:l==="horizontal"?F:T.coordinate},H=Xy({active:m.payload.active,coordinate:V,dataKey:m.payload.dataKey,index:String(T.index),label:m.payload.label,sourceViewBox:m.payload.sourceViewBox,graphicalItemId:m.payload.graphicalItemId});r(H)}}};return Tu.on(Zy,h),()=>{Tu.off(Zy,h)}},[d,r,t,e,n,a,l,c])}function vne(){var e=Xe(H1),t=Xe(V1),r=Dr();v.useEffect(()=>{if(e==null)return qu;var n=(a,l,c)=>{t!==c&&e===a&&r(dne(l))};return Tu.on(i3,n),()=>{Tu.off(i3,n)}},[r,t,e])}function yne(){var e=Dr();v.useEffect(()=>{e(lne())},[e]),bne(),vne()}function wne(e,t,r,n,a,l){var c=Xe(b=>Cre(b,e,t)),d=Xe(V1),h=Xe(H1),f=Xe(WP),m=Xe(one),g=m==null?void 0:m.active,x=Zm();v.useEffect(()=>{if(!g&&h!=null&&d!=null){var b=Xy({active:l,coordinate:r,dataKey:c,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:x,graphicalItemId:void 0});Tu.emit(Zy,h,b,d)}},[g,r,c,a,n,d,h,f,l,x])}function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){jne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jne(e,t,r){return(t=_ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ne(e){var t=kne(e,"string");return typeof t=="symbol"?t:t+""}function kne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nne(e){return e.dataKey}function Sne(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(oX,t)}var u3=[],Cne={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function dM(e){var t,r,n=ys(e,Cne),{active:a,allowEscapeViewBox:l,animationDuration:c,animationEasing:d,content:h,filterNull:f,isAnimationActive:m,offset:g,payloadUniqBy:x,position:b,reverseDirection:j,useTranslate3d:w,wrapperStyle:_,cursor:N,shared:C,trigger:A,defaultIndex:E,portal:S,axisId:T}=n,D=Dr(),P=typeof E=="number"?String(E):E;v.useEffect(()=>{D(_te({shared:C,trigger:A,axisId:T,active:a,defaultIndex:P}))},[D,C,A,T,a,P]);var I=Zm(),$=I6(),M=xte(C),{activeIndex:R,isActive:F}=(t=Xe(we=>Tre(we,M,A,P)))!==null&&t!==void 0?t:{},V=Xe(we=>Are(we,M,A,P)),H=Xe(we=>aM(we,M,A,P)),L=Xe(we=>Ere(we,M,A,P)),U=V,W=ene(),le=(r=a??F)!==null&&r!==void 0?r:!1,[ve,B]=WG([U,le]),G=M==="axis"?H:void 0;wne(M,A,L,G,R,le);var ie=S??W;if(ie==null||I==null||M==null)return null;var he=U??u3;le||(he=u3),f&&he.length&&(he=bG(he.filter(we=>we.value!=null&&(we.hide!==!0||n.includeHidden)),x,Nne));var _e=he.length>0,Ee=v.createElement(pX,{allowEscapeViewBox:l,animationDuration:c,animationEasing:d,isAnimationActive:m,active:le,coordinate:L,hasPayload:_e,offset:g,position:b,reverseDirection:j,useTranslate3d:w,viewBox:I,wrapperStyle:_,lastBoundingBox:ve,innerRef:B,hasPortalFromProps:!!S},Sne(h,d3(d3({},n),{},{payload:he,label:G,active:le,activeIndex:R,coordinate:L,accessibilityLayer:$})));return v.createElement(v.Fragment,null,Dm.createPortal(Ee,ie),le&&v.createElement(Zre,{cursor:N,tooltipEventType:M,coordinate:L,payload:he,index:R}))}var uM=e=>null;uM.displayName="Cell";function Ene(e,t,r){return(t=Ane(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ane(e){var t=Tne(e,"string");return typeof t=="symbol"?t:t+""}function Tne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class One{constructor(t){Ene(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function h3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h3(Object(r),!0).forEach(function(n){Dne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dne(e,t,r){return(t=Mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mne(e){var t=Rne(e,"string");return typeof t=="symbol"?t:t+""}function Rne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ine={cacheSize:2e3,enableCache:!0},hM=Pne({},Ine),f3=new One(hM.cacheSize),$ne={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},m3="recharts_measurement_span";function Lne(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",l=t.fontStyle||"",c=t.letterSpacing||"",d=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(l,"|").concat(c,"|").concat(d)}var p3=(e,t)=>{try{var r=document.getElementById(m3);r||(r=document.createElement("span"),r.setAttribute("id",m3),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,$ne,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},lu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||sp.isSsr)return{width:0,height:0};if(!hM.enableCache)return p3(t,r);var n=Lne(t,r),a=f3.get(n);if(a)return a;var l=p3(t,r);return f3.set(n,l),l},fM;function zne(e,t,r){return(t=Bne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bne(e){var t=Une(e,"string");return typeof t=="symbol"?t:t+""}function Une(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,x3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qne=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Fne=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Hne={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Vne=["cm","mm","pt","pc","in","Q","px"];function Wne(e){return Vne.includes(e)}var uc="NaN";function Gne(e,t){return e*Hne[t]}class vn{static parse(t){var r,[,n,a]=(r=Fne.exec(t))!==null&&r!==void 0?r:[];return n==null?vn.NaN:new vn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ia(t)&&(this.unit=""),r!==""&&!qne.test(r)&&(this.num=NaN,this.unit=""),Wne(r)&&(this.num=Gne(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new vn(NaN,""):new vn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new vn(NaN,""):new vn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vn(NaN,""):new vn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vn(NaN,""):new vn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ia(this.num)}}fM=vn;zne(vn,"NaN",new fM(NaN,""));function mM(e){if(e==null||e.includes(uc))return uc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,l]=(r=g3.exec(t))!==null&&r!==void 0?r:[],c=vn.parse(n??""),d=vn.parse(l??""),h=a==="*"?c.multiply(d):c.divide(d);if(h.isNaN())return uc;t=t.replace(g3,h.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,m,g,x]=(f=x3.exec(t))!==null&&f!==void 0?f:[],b=vn.parse(m??""),j=vn.parse(x??""),w=g==="+"?b.add(j):b.subtract(j);if(w.isNaN())return uc;t=t.replace(x3,w.toString())}return t}var b3=/\(([^()]*)\)/;function Kne(e){for(var t=e,r;(r=b3.exec(t))!=null;){var[,n]=r;t=t.replace(b3,mM(n))}return t}function Yne(e){var t=e.replace(/\s+/g,"");return t=Kne(t),t=mM(t),t}function Xne(e){try{return Yne(e)}catch{return uc}}function mv(e){var t=Xne(e.slice(5,-1));return t===uc?"":t}var Jne=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Qne=["dx","dy","angle","className","breakAll"];function ew(){return ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ew.apply(null,arguments)}function v3(e,t){if(e==null)return{};var r,n,a=Zne(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Zne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pM=/[ \f\n\r\t\v\u2028\u2029]+/,gM=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];ln(t)||(r?a=t.toString().split(""):a=t.toString().split(pM));var l=a.map(d=>({word:d,width:lu(d,n).width})),c=r?0:lu("",n).width;return{wordsWithComputedWidth:l,spaceWidth:c}}catch{return null}};function ese(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var xM=(e,t,r,n)=>e.reduce((a,l)=>{var{word:c,width:d}=l,h=a[a.length-1];if(h&&d!=null&&(t==null||n||h.width+d+r<Number(t)))h.words.push(c),h.width+=d+r;else{var f={words:[c],width:d};a.push(f)}return a},[]),bM=e=>e.reduce((t,r)=>t.width>r.width?t:r),tse="",y3=(e,t,r,n,a,l,c,d)=>{var h=e.slice(0,t),f=gM({breakAll:r,style:n,children:h+tse});if(!f)return[!1,[]];var m=xM(f.wordsWithComputedWidth,l,c,d),g=m.length>a||bM(m).width>Number(l);return[g,m]},rse=(e,t,r,n,a)=>{var{maxLines:l,children:c,style:d,breakAll:h}=e,f=We(l),m=String(c),g=xM(t,n,r,a);if(!f||a)return g;var x=g.length>l||bM(g).width>Number(n);if(!x)return g;for(var b=0,j=m.length-1,w=0,_;b<=j&&w<=m.length-1;){var N=Math.floor((b+j)/2),C=N-1,[A,E]=y3(m,C,h,d,l,n,r,a),[S]=y3(m,N,h,d,l,n,r,a);if(!A&&!S&&(b=N+1),A&&S&&(j=N-1),!A&&S){_=E;break}w++}return _||g},w3=e=>{var t=ln(e)?[]:e.toString().split(pM);return[{words:t,width:void 0}]},nse=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:l,maxLines:c}=e;if((t||r)&&!sp.isSsr){var d,h,f=gM({breakAll:l,children:n,style:a});if(f){var{wordsWithComputedWidth:m,spaceWidth:g}=f;d=m,h=g}else return w3(n);return rse({breakAll:l,children:n,maxLines:c,style:a},d,h,t,!!r)}return w3(n)},vM="#808080",sse={angle:0,breakAll:!1,capHeight:"0.71em",fill:vM,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},gj=v.forwardRef((e,t)=>{var r=ys(e,sse),{x:n,y:a,lineHeight:l,capHeight:c,fill:d,scaleToFit:h,textAnchor:f,verticalAnchor:m}=r,g=v3(r,Jne),x=v.useMemo(()=>nse({breakAll:g.breakAll,children:g.children,maxLines:g.maxLines,scaleToFit:h,style:g.style,width:g.width}),[g.breakAll,g.children,g.maxLines,h,g.style,g.width]),{dx:b,dy:j,angle:w,className:_,breakAll:N}=g,C=v3(g,Qne);if(!ja(n)||!ja(a)||x.length===0)return null;var A=Number(n)+(We(b)?b:0),E=Number(a)+(We(j)?j:0);if(!wr(A)||!wr(E))return null;var S;switch(m){case"start":S=mv("calc(".concat(c,")"));break;case"middle":S=mv("calc(".concat((x.length-1)/2," * -").concat(l," + (").concat(c," / 2))"));break;default:S=mv("calc(".concat(x.length-1," * -").concat(l,")"));break}var T=[];if(h){var D=x[0].width,{width:P}=g;T.push("scale(".concat(We(P)&&We(D)?P/D:1,")"))}return w&&T.push("rotate(".concat(w,", ").concat(A,", ").concat(E,")")),T.length&&(C.transform=T.join(" ")),v.createElement("text",ew({},Bs(C),{ref:t,x:A,y:E,className:cr("recharts-text",_),textAnchor:f,fill:d.includes("url")?vM:d}),x.map((I,$)=>{var M=I.words.join(N?"":" ");return v.createElement("tspan",{x:A,dy:$===0?S:l,key:"".concat(M,"-").concat($)},M)}))});gj.displayName="Text";var ase=["labelRef"],ise=["content"];function j3(e,t){if(e==null)return{};var r,n,a=lse(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function _3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_3(Object(r),!0).forEach(function(n){ose(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ose(e,t,r){return(t=cse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cse(e){var t=dse(e,"string");return typeof t=="symbol"?t:t+""}function dse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qa(){return Qa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qa.apply(null,arguments)}var yM=v.createContext(null),use=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:l,height:c,children:d}=e,h=v.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:l,height:c}),[t,r,n,a,l,c]);return v.createElement(yM.Provider,{value:h},d)},wM=()=>{var e=v.useContext(yM),t=Zm();return e||N6(t)},hse=v.createContext(null),fse=()=>{var e=v.useContext(hse),t=Xe(JP);return e||t},mse=e=>{var{value:t,formatter:r}=e,n=ln(e.children)?t:e.children;return typeof r=="function"?r(n):n},xj=e=>e!=null&&typeof e=="function",pse=(e,t)=>{var r=Kn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},gse=(e,t,r,n,a)=>{var{offset:l,className:c}=e,{cx:d,cy:h,innerRadius:f,outerRadius:m,startAngle:g,endAngle:x,clockWise:b}=a,j=(f+m)/2,w=pse(g,x),_=w>=0?1:-1,N,C;switch(t){case"insideStart":N=g+_*l,C=b;break;case"insideEnd":N=x-_*l,C=!b;break;case"end":N=x+_*l,C=b;break;default:throw new Error("Unsupported position ".concat(t))}C=w<=0?C:!C;var A=jn(d,h,j,N),E=jn(d,h,j,N+(C?1:-1)*359),S="M".concat(A.x,",").concat(A.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(C?0:1,`,
    `).concat(E.x,",").concat(E.y),T=ln(e.id)?xu("recharts-radial-line-"):e.id;return v.createElement("text",Qa({},n,{dominantBaseline:"central",className:cr("recharts-radial-bar-label",c)}),v.createElement("defs",null,v.createElement("path",{id:T,d:S})),v.createElement("textPath",{xlinkHref:"#".concat(T)},r))},xse=(e,t,r)=>{var{cx:n,cy:a,innerRadius:l,outerRadius:c,startAngle:d,endAngle:h}=e,f=(d+h)/2;if(r==="outside"){var{x:m,y:g}=jn(n,a,c+t,f);return{x:m,y:g,textAnchor:m>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(l+c)/2,{x:b,y:j}=jn(n,a,x,f);return{x:b,y:j,textAnchor:"middle",verticalAnchor:"middle"}},tw=e=>"cx"in e&&We(e.cx),bse=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,l;r!=null&&!tw(r)&&(l=r);var{x:c,y:d,upperWidth:h,lowerWidth:f,height:m}=t,g=c,x=c+(h-f)/2,b=(g+x)/2,j=(h+f)/2,w=g+h/2,_=m>=0?1:-1,N=_*n,C=_>0?"end":"start",A=_>0?"start":"end",E=h>=0?1:-1,S=E*n,T=E>0?"end":"start",D=E>0?"start":"end";if(a==="top"){var P={x:g+h/2,y:d-N,textAnchor:"middle",verticalAnchor:C};return Tr(Tr({},P),l?{height:Math.max(d-l.y,0),width:h}:{})}if(a==="bottom"){var I={x:x+f/2,y:d+m+N,textAnchor:"middle",verticalAnchor:A};return Tr(Tr({},I),l?{height:Math.max(l.y+l.height-(d+m),0),width:f}:{})}if(a==="left"){var $={x:b-S,y:d+m/2,textAnchor:T,verticalAnchor:"middle"};return Tr(Tr({},$),l?{width:Math.max($.x-l.x,0),height:m}:{})}if(a==="right"){var M={x:b+j+S,y:d+m/2,textAnchor:D,verticalAnchor:"middle"};return Tr(Tr({},M),l?{width:Math.max(l.x+l.width-M.x,0),height:m}:{})}var R=l?{width:j,height:m}:{};return a==="insideLeft"?Tr({x:b+S,y:d+m/2,textAnchor:D,verticalAnchor:"middle"},R):a==="insideRight"?Tr({x:b+j-S,y:d+m/2,textAnchor:T,verticalAnchor:"middle"},R):a==="insideTop"?Tr({x:g+h/2,y:d+N,textAnchor:"middle",verticalAnchor:A},R):a==="insideBottom"?Tr({x:x+f/2,y:d+m-N,textAnchor:"middle",verticalAnchor:C},R):a==="insideTopLeft"?Tr({x:g+S,y:d+N,textAnchor:D,verticalAnchor:A},R):a==="insideTopRight"?Tr({x:g+h-S,y:d+N,textAnchor:T,verticalAnchor:A},R):a==="insideBottomLeft"?Tr({x:x+S,y:d+m-N,textAnchor:D,verticalAnchor:C},R):a==="insideBottomRight"?Tr({x:x+f-S,y:d+m-N,textAnchor:T,verticalAnchor:C},R):a&&typeof a=="object"&&(We(a.x)||di(a.x))&&(We(a.y)||di(a.y))?Tr({x:c+la(a.x,j),y:d+la(a.y,m),textAnchor:"end",verticalAnchor:"end"},R):Tr({x:w,y:d+m/2,textAnchor:"middle",verticalAnchor:"middle"},R)},vse={angle:0,offset:5,zIndex:Mn.label,position:"middle",textBreakAll:!1};function Zi(e){var t=ys(e,vse),{viewBox:r,position:n,value:a,children:l,content:c,className:d="",textBreakAll:h,labelRef:f}=t,m=fse(),g=wM(),x=n==="center"?g:m??g,b,j,w;if(r==null?b=x:tw(r)?b=r:b=N6(r),!b||ln(a)&&ln(l)&&!v.isValidElement(c)&&typeof c!="function")return null;var _=Tr(Tr({},t),{},{viewBox:b});if(v.isValidElement(c)){var{labelRef:N}=_,C=j3(_,ase);return v.cloneElement(c,C)}if(typeof c=="function"){var{content:A}=_,E=j3(_,ise);if(j=v.createElement(c,E),v.isValidElement(j))return j}else j=mse(t);var S=Bs(t);if(tw(b)){if(n==="insideStart"||n==="insideEnd"||n==="end")return gse(t,n,j,S,b);w=xse(b,t.offset,t.position)}else w=bse(t,b);return v.createElement(ki,{zIndex:t.zIndex},v.createElement(gj,Qa({ref:f,className:cr("recharts-label",d)},S,w,{textAnchor:ese(S.textAnchor)?S.textAnchor:w.textAnchor,breakAll:h}),j))}Zi.displayName="Label";var yse=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?v.createElement(Zi,Qa({key:"label-implicit"},n)):ja(e)?v.createElement(Zi,Qa({key:"label-implicit",value:e},n)):v.isValidElement(e)?e.type===Zi?v.cloneElement(e,Tr({key:"label-implicit"},n)):v.createElement(Zi,Qa({key:"label-implicit",content:e},n)):xj(e)?v.createElement(Zi,Qa({key:"label-implicit",content:e},n)):e&&typeof e=="object"?v.createElement(Zi,Qa({},e,{key:"label-implicit"},n)):null};function wse(e){var{label:t,labelRef:r}=e,n=wM();return yse(t,n,r)||null}var pv={},gv={},k3;function jse(){return k3||(k3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(gv)),gv}var xv={},N3;function _se(){return N3||(N3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(xv)),xv}var S3;function kse(){return S3||(S3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jse(),r=_se(),n=r1();function a(l){if(n.isArrayLike(l))return t.last(r.toArray(l))}e.last=a})(pv)),pv}var bv,C3;function Nse(){return C3||(C3=1,bv=kse().last),bv}var Sse=Nse();const Cse=vs(Sse);var Ese=["valueAccessor"],Ase=["dataKey","clockWise","id","textBreakAll","zIndex"];function hm(){return hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hm.apply(null,arguments)}function E3(e,t){if(e==null)return{};var r,n,a=Tse(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Tse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ose=e=>Array.isArray(e.value)?Cse(e.value):e.value,jM=v.createContext(void 0),Pse=jM.Provider,_M=v.createContext(void 0);_M.Provider;function Dse(){return v.useContext(jM)}function Mse(){return v.useContext(_M)}function h0(e){var{valueAccessor:t=Ose}=e,r=E3(e,Ese),{dataKey:n,clockWise:a,id:l,textBreakAll:c,zIndex:d}=r,h=E3(r,Ase),f=Dse(),m=Mse(),g=f||m;return!g||!g.length?null:v.createElement(ki,{zIndex:d??Mn.label},v.createElement(ci,{className:"recharts-label-list"},g.map((x,b)=>{var j,w=ln(n)?t(x,b):kn(x&&x.payload,n),_=ln(l)?{}:{id:"".concat(l,"-").concat(b)};return v.createElement(Zi,hm({key:"label-".concat(b)},Bs(x),h,_,{fill:(j=r.fill)!==null&&j!==void 0?j:x.fill,parentViewBox:x.parentViewBox,value:w,textBreakAll:c,viewBox:x.viewBox,index:b,zIndex:0}))})))}h0.displayName="LabelList";function Rse(e){var{label:t}=e;return t?t===!0?v.createElement(h0,{key:"labelList-implicit"}):v.isValidElement(t)||xj(t)?v.createElement(h0,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(h0,hm({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var Ise={radiusAxis:{},angleAxis:{}},kM=Jn({name:"polarAxis",initialState:Ise,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:tue,removeRadiusAxis:rue,addAngleAxis:nue,removeAngleAxis:sue}=kM.actions,$se=kM.reducer,vv={exports:{}},Jt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A3;function Lse(){if(A3)return Jt;A3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),b=Symbol.for("react.client.reference");function j(w){if(typeof w=="object"&&w!==null){var _=w.$$typeof;switch(_){case e:switch(w=w.type,w){case r:case a:case n:case h:case f:case x:return w;default:switch(w=w&&w.$$typeof,w){case c:case d:case g:case m:return w;case l:return w;default:return _}}case t:return _}}}return Jt.ContextConsumer=l,Jt.ContextProvider=c,Jt.Element=e,Jt.ForwardRef=d,Jt.Fragment=r,Jt.Lazy=g,Jt.Memo=m,Jt.Portal=t,Jt.Profiler=a,Jt.StrictMode=n,Jt.Suspense=h,Jt.SuspenseList=f,Jt.isContextConsumer=function(w){return j(w)===l},Jt.isContextProvider=function(w){return j(w)===c},Jt.isElement=function(w){return typeof w=="object"&&w!==null&&w.$$typeof===e},Jt.isForwardRef=function(w){return j(w)===d},Jt.isFragment=function(w){return j(w)===r},Jt.isLazy=function(w){return j(w)===g},Jt.isMemo=function(w){return j(w)===m},Jt.isPortal=function(w){return j(w)===t},Jt.isProfiler=function(w){return j(w)===a},Jt.isStrictMode=function(w){return j(w)===n},Jt.isSuspense=function(w){return j(w)===h},Jt.isSuspenseList=function(w){return j(w)===f},Jt.isValidElementType=function(w){return typeof w=="string"||typeof w=="function"||w===r||w===a||w===n||w===h||w===f||typeof w=="object"&&w!==null&&(w.$$typeof===g||w.$$typeof===m||w.$$typeof===c||w.$$typeof===l||w.$$typeof===d||w.$$typeof===b||w.getModuleId!==void 0)},Jt.typeOf=j,Jt}var T3;function zse(){return T3||(T3=1,vv.exports=Lse()),vv.exports}var Bse=zse(),O3=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",P3=null,yv=null,NM=e=>{if(e===P3&&Array.isArray(yv))return yv;var t=[];return v.Children.forEach(e,r=>{ln(r)||(Bse.isFragment(r)?t=t.concat(NM(r.props.children)):t.push(r))}),yv=t,P3=e,t};function Use(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>O3(a)):n=[O3(t)],NM(e).forEach(a=>{var l=Cc(a,"type.displayName")||Cc(a,"type.name");l&&n.indexOf(l)!==-1&&r.push(a)}),r}var wv={},D3;function qse(){return D3||(D3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const l=r[Symbol.toStringTag];return l==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${l}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(wv)),wv}var jv,M3;function Fse(){return M3||(M3=1,jv=qse().isPlainObject),jv}var Hse=Fse();const Vse=vs(Hse);var R3,I3,$3,L3,z3;function B3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B3(Object(r),!0).forEach(function(n){Wse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wse(e,t,r){return(t=Gse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gse(e){var t=Kse(e,"string");return typeof t=="symbol"?t:t+""}function Kse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fm(){return fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fm.apply(null,arguments)}function Xd(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var q3=(e,t,r,n,a)=>{var l=r-n,c;return c=kr(R3||(R3=Xd(["M ",",",""])),e,t),c+=kr(I3||(I3=Xd(["L ",",",""])),e+r,t),c+=kr($3||($3=Xd(["L ",",",""])),e+r-l/2,t+a),c+=kr(L3||(L3=Xd(["L ",",",""])),e+r-l/2-n,t+a),c+=kr(z3||(z3=Xd(["L ",","," Z"])),e,t),c},Yse={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Xse=e=>{var t=ys(e,Yse),{x:r,y:n,upperWidth:a,lowerWidth:l,height:c,className:d}=t,{animationEasing:h,animationDuration:f,animationBegin:m,isUpdateAnimationActive:g}=t,x=v.useRef(null),[b,j]=v.useState(-1),w=v.useRef(a),_=v.useRef(l),N=v.useRef(c),C=v.useRef(r),A=v.useRef(n),E=x1(e,"trapezoid-");if(v.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var V=x.current.getTotalLength();V&&j(V)}catch{}},[]),r!==+r||n!==+n||a!==+a||l!==+l||c!==+c||a===0&&l===0||c===0)return null;var S=cr("recharts-trapezoid",d);if(!g)return v.createElement("g",null,v.createElement("path",fm({},Bs(t),{className:S,d:q3(r,n,a,l,c)})));var T=w.current,D=_.current,P=N.current,I=C.current,$=A.current,M="0px ".concat(b===-1?1:b,"px"),R="".concat(b,"px 0px"),F=L6(["strokeDasharray"],f,h);return v.createElement(g1,{animationId:E,key:E,canBegin:b>0,duration:f,easing:h,isActive:g,begin:m},V=>{var H=yn(T,a,V),L=yn(D,l,V),U=yn(P,c,V),W=yn(I,r,V),le=yn($,n,V);x.current&&(w.current=H,_.current=L,N.current=U,C.current=W,A.current=le);var ve=V>0?{transition:F,strokeDasharray:R}:{strokeDasharray:M};return v.createElement("path",fm({},Bs(t),{className:S,d:q3(W,le,H,L,U),ref:x,style:U3(U3({},ve),t.style)}))})},Jse=["option","shapeType","activeClassName"];function Qse(e,t){if(e==null)return{};var r,n,a=Zse(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Zse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function F3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F3(Object(r),!0).forEach(function(n){eae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eae(e,t,r){return(t=tae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tae(e){var t=rae(e,"string");return typeof t=="symbol"?t:t+""}function rae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nae(e,t){return mm(mm({},t),e)}function sae(e,t){return e==="symbols"}function H3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(q6,r);case"trapezoid":return v.createElement(Xse,r);case"sector":return v.createElement(V6,r);case"symbols":if(sae(t))return v.createElement(SO,r);break;case"curve":return v.createElement($6,r);default:return null}}function aae(e){return v.isValidElement(e)?e.props:e}function iae(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=Qse(e,Jse),l;if(v.isValidElement(t))l=v.cloneElement(t,mm(mm({},a),aae(t)));else if(typeof t=="function")l=t(a,a.index);else if(Vse(t)&&typeof t!="boolean"){var c=nae(t,a);l=v.createElement(H3,{shapeType:r,elementProps:c})}else{var d=a;l=v.createElement(H3,{shapeType:r,elementProps:d})}return a.isActive?v.createElement(ci,{className:n},l):l}var SM=(e,t,r)=>{var n=Dr();return(a,l)=>c=>{e==null||e(a,l,c),n(BD({activeIndex:String(l),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},CM=e=>{var t=Dr();return(r,n)=>a=>{e==null||e(r,n,a),t(kte())}},EM=(e,t,r)=>{var n=Dr();return(a,l)=>c=>{e==null||e(a,l,c),n(Nte({activeIndex:String(l),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function lae(e){var{tooltipEntrySettings:t}=e,r=Dr(),n=Qn(),a=v.useRef(null);return v.useLayoutEffect(()=>{n||(a.current===null?r(yte(t)):a.current!==t&&r(wte({prev:a.current,next:t})),a.current=t)},[t,r,n]),v.useLayoutEffect(()=>()=>{a.current&&(r(jte(a.current)),a.current=null)},[r]),null}function oae(e){var{legendPayload:t}=e,r=Dr(),n=Qn(),a=v.useRef(null);return v.useLayoutEffect(()=>{n||(a.current===null?r(eX(t)):a.current!==t&&r(tX({prev:a.current,next:t})),a.current=t)},[r,n,t]),v.useLayoutEffect(()=>()=>{a.current&&(r(rX(a.current)),a.current=null)},[r]),null}var _v,cae=()=>{var[e]=v.useState(()=>xu("uid-"));return e},dae=(_v=CI.useId)!==null&&_v!==void 0?_v:cae;function uae(e,t){var r=dae();return t||(e?"".concat(e,"-").concat(r):r)}var hae=v.createContext(void 0),fae=e=>{var{id:t,type:r,children:n}=e,a=uae("recharts-".concat(r),t);return v.createElement(hae.Provider,{value:a},n(a))},mae={cartesianItems:[],polarItems:[]},AM=Jn({name:"graphicalItems",initialState:mae,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:pr()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ra(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:pr()},removeCartesianGraphicalItem:{reducer(e,t){var r=ra(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:pr()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:pr()},removePolarGraphicalItem:{reducer(e,t){var r=ra(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:pr()}}}),{addCartesianGraphicalItem:pae,replaceCartesianGraphicalItem:gae,removeCartesianGraphicalItem:xae,addPolarGraphicalItem:aue,removePolarGraphicalItem:iue}=AM.actions,bae=AM.reducer,vae=e=>{var t=Dr(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(pae(e)):r.current!==e&&t(gae({prev:r.current,next:e})),r.current=e},[t,e]),v.useLayoutEffect(()=>()=>{r.current&&(t(xae(r.current)),r.current=null)},[t]),null},yae=v.memo(vae);function V3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function W3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(r),!0).forEach(function(n){wae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wae(e,t,r){return(t=jae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jae(e){var t=_ae(e,"string");return typeof t=="symbol"?t:t+""}function _ae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TM=0,kae={xAxis:{},yAxis:{},zAxis:{}},OM=Jn({name:"cartesianAxis",initialState:kae,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:pr()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:pr()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:pr()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:pr()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:pr()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:pr()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:pr()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:pr()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:pr()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var l=a.widthHistory||[];if(l.length===3&&l[0]===l[2]&&n===l[1]&&n!==a.width&&Math.abs(n-l[0])<=1)return;var c=[...l,n].slice(-3);e.yAxis[r]=W3(W3({},e.yAxis[r]),{},{width:n,widthHistory:c})}}}}),{addXAxis:Nae,replaceXAxis:Sae,removeXAxis:Cae,addYAxis:Eae,replaceYAxis:Aae,removeYAxis:Tae,addZAxis:lue,replaceZAxis:oue,removeZAxis:cue,updateYAxisWidth:Oae}=OM.actions,Pae=OM.reducer,Dae=de([on],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),Mae=de([Dae,xi,bi],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),PM=()=>Xe(Mae),G3=(e,t,r)=>{var n=r??e;if(!ln(n))return la(n,t,0)},Rae=(e,t,r)=>{var n={},a=e.filter(pp),l=e.filter(f=>f.stackId==null),c=a.reduce((f,m)=>(f[m.stackId]||(f[m.stackId]=[]),f[m.stackId].push(m),f),n),d=Object.entries(c).map(f=>{var[m,g]=f,x=g.map(j=>j.dataKey),b=G3(t,r,g[0].barSize);return{stackId:m,dataKeys:x,barSize:b}}),h=l.map(f=>{var m=[f.dataKey].filter(x=>x!=null),g=G3(t,r,f.barSize);return{stackId:void 0,dataKeys:m,barSize:g}});return[...d,...h]};function K3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K3(Object(r),!0).forEach(function(n){Iae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iae(e,t,r){return(t=$ae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ae(e){var t=Lae(e,"string");return typeof t=="symbol"?t:t+""}function Lae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zae(e,t,r,n,a){var l=n.length;if(!(l<1)){var c=la(e,r,0,!0),d,h=[];if(wr(n[0].barSize)){var f=!1,m=r/l,g=n.reduce((N,C)=>N+(C.barSize||0),0);g+=(l-1)*c,g>=r&&(g-=(l-1)*c,c=0),g>=r&&m>0&&(f=!0,m*=.9,g=l*m);var x=(r-g)/2>>0,b={offset:x-c,size:0};d=n.reduce((N,C)=>{var A,E={stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:b.offset+b.size+c,size:f?m:(A=C.barSize)!==null&&A!==void 0?A:0}},S=[...N,E];return b=S[S.length-1].position,S},h)}else{var j=la(t,r,0,!0);r-2*j-(l-1)*c<=0&&(c=0);var w=(r-2*j-(l-1)*c)/l;w>1&&(w>>=0);var _=wr(a)?Math.min(w,a):w;d=n.reduce((N,C,A)=>[...N,{stackId:C.stackId,dataKeys:C.dataKeys,position:{offset:j+(w+c)*A+(w-_)/2,size:_}}],h)}return d}}var Bae=(e,t,r,n,a,l,c)=>{var d=ln(c)?t:c,h=zae(r,n,a!==l?a:l,e,d);return a!==l&&h!=null&&(h=h.map(f=>Jf(Jf({},f),{},{position:Jf(Jf({},f.position),{},{offset:f.position.offset-a/2})}))),h},Uae=(e,t)=>{var r=Y1(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:l}=a;if(l)return l.find(c=>c.key===r)}}}};function qae(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&wr(e.zIndex)?e.zIndex:t}var Fae=e=>{var{chartData:t}=e,r=Dr(),n=Qn();return v.useEffect(()=>n?()=>{}:(r(l3(t)),()=>{r(l3(void 0))}),[t,r,n]),null},Y3={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},DM=Jn({name:"brush",initialState:Y3,reducers:{setBrushSettings(e,t){return t.payload==null?Y3:t.payload}}}),{setBrushSettings:due}=DM.actions,Hae=DM.reducer;function Vae(e,t,r){return(t=Wae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wae(e){var t=Gae(e,"string");return typeof t=="symbol"?t:t+""}function Gae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class bj{static create(t){return new bj(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(t)+l}default:return this.scale(t)}if(r){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+c}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}Vae(bj,"EPS",1e-4);function Kae(e){return(e%180+180)%180}var Yae=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=Kae(a),c=l*Math.PI/180,d=Math.atan(n/r),h=c>d&&c<Math.PI-d?n/Math.sin(c):r/Math.cos(c);return Math.abs(h)},Xae={dots:[],areas:[],lines:[]},MM=Jn({name:"referenceElements",initialState:Xae,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ra(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ra(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ra(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:uue,removeDot:hue,addArea:fue,removeArea:mue,addLine:pue,removeLine:gue}=MM.actions,Jae=MM.reducer,Qae=v.createContext(void 0),Zae=e=>{var{children:t}=e,[r]=v.useState("".concat(xu("recharts"),"-clip")),n=PM();if(n==null)return null;var{x:a,y:l,width:c,height:d}=n;return v.createElement(Qae.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:l,height:d,width:c}))),t)};function RM(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function eie(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Yae(n,r)}function tie(e,t,r){var n=r==="width",{x:a,y:l,width:c,height:d}=e;return t===1?{start:n?a:l,end:n?a+c:l+d}:{start:n?a+c:l+d,end:n?a:l}}function Ou(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-a)<=0}function rie(e,t){return RM(e,t+1)}function nie(e,t,r,n,a){for(var l=(n||[]).slice(),{start:c,end:d}=t,h=0,f=1,m=c,g=function(){var j=n==null?void 0:n[h];if(j===void 0)return{v:RM(n,f)};var w=h,_,N=()=>(_===void 0&&(_=r(j,w)),_),C=j.coordinate,A=h===0||Ou(e,C,N,m,d);A||(h=0,m=c,f+=1),A&&(m=C+e*(N()/2+a),h+=f)},x;f<=l.length;)if(x=g(),x)return x.v;return[]}function sie(e,t,r,n,a){var l=(n||[]).slice(),c=l.length;if(c===0)return[];for(var{start:d,end:h}=t,f=1;f<=c;f++){for(var m=(c-1)%f,g=d,x=!0,b=function(){var C=n[j],A=j,E,S=()=>(E===void 0&&(E=r(C,A)),E),T=C.coordinate,D=j===m||Ou(e,T,S,g,h);if(!D)return x=!1,1;D&&(g=T+e*(S()/2+a))},j=m;j<c&&!b();j+=f);if(x){for(var w=[],_=m;_<c;_+=f)w.push(n[_]);return w}}return[]}function X3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function En(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X3(Object(r),!0).forEach(function(n){aie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aie(e,t,r){return(t=iie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iie(e){var t=lie(e,"string");return typeof t=="symbol"?t:t+""}function lie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oie(e,t,r,n,a){for(var l=(n||[]).slice(),c=l.length,{start:d}=t,{end:h}=t,f=function(x){var b=l[x],j,w=()=>(j===void 0&&(j=r(b,x)),j);if(x===c-1){var _=e*(b.coordinate+e*w()/2-h);l[x]=b=En(En({},b),{},{tickCoord:_>0?b.coordinate-_*e:b.coordinate})}else l[x]=b=En(En({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var N=Ou(e,b.tickCoord,w,d,h);N&&(h=b.tickCoord-e*(w()/2+a),l[x]=En(En({},b),{},{isShow:!0}))}},m=c-1;m>=0;m--)f(m);return l}function cie(e,t,r,n,a,l){var c=(n||[]).slice(),d=c.length,{start:h,end:f}=t;if(l){var m=n[d-1],g=r(m,d-1),x=e*(m.coordinate+e*g/2-f);if(c[d-1]=m=En(En({},m),{},{tickCoord:x>0?m.coordinate-x*e:m.coordinate}),m.tickCoord!=null){var b=Ou(e,m.tickCoord,()=>g,h,f);b&&(f=m.tickCoord-e*(g/2+a),c[d-1]=En(En({},m),{},{isShow:!0}))}}for(var j=l?d-1:d,w=function(C){var A=c[C],E,S=()=>(E===void 0&&(E=r(A,C)),E);if(C===0){var T=e*(A.coordinate-e*S()/2-h);c[C]=A=En(En({},A),{},{tickCoord:T<0?A.coordinate-T*e:A.coordinate})}else c[C]=A=En(En({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var D=Ou(e,A.tickCoord,S,h,f);D&&(h=A.tickCoord+e*(S()/2+a),c[C]=En(En({},A),{},{isShow:!0}))}},_=0;_<j;_++)w(_);return c}function vj(e,t,r){var{tick:n,ticks:a,viewBox:l,minTickGap:c,orientation:d,interval:h,tickFormatter:f,unit:m,angle:g}=e;if(!a||!a.length||!n)return[];if(We(h)||sp.isSsr){var x;return(x=rie(a,We(h)?h:0))!==null&&x!==void 0?x:[]}var b=[],j=d==="top"||d==="bottom"?"width":"height",w=m&&j==="width"?lu(m,{fontSize:t,letterSpacing:r}):{width:0,height:0},_=(A,E)=>{var S=typeof f=="function"?f(A.value,E):A.value;return j==="width"?eie(lu(S,{fontSize:t,letterSpacing:r}),w,g):lu(S,{fontSize:t,letterSpacing:r})[j]},N=a.length>=2?Kn(a[1].coordinate-a[0].coordinate):1,C=tie(l,N,j);return h==="equidistantPreserveStart"?nie(N,C,_,a,c):h==="equidistantPreserveEnd"?sie(N,C,_,a,c):(h==="preserveStart"||h==="preserveStartEnd"?b=cie(N,C,_,a,c,h==="preserveStartEnd"):b=oie(N,C,_,a,c),b.filter(A=>A.isShow))}var die=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:l=0}=e,c=0;if(t){Array.from(t).forEach(m=>{if(m){var g=m.getBoundingClientRect();g.width>c&&(c=g.width)}});var d=r?r.getBoundingClientRect().width:0,h=a+l,f=c+h+d+(r?n:0);return Math.round(f)}return 0},uie=["axisLine","width","height","className","hide","ticks","axisType"];function hie(e,t){if(e==null)return{};var r,n,a=fie(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ao.apply(null,arguments)}function J3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J3(Object(r),!0).forEach(function(n){mie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mie(e,t,r){return(t=pie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pie(e){var t=gie(e,"string");return typeof t=="symbol"?t:t+""}function gie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ni={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Mn.axis};function xie(e){var{x:t,y:r,width:n,height:a,orientation:l,mirror:c,axisLine:d,otherSvgProps:h}=e;if(!d)return null;var f=Br(Br(Br({},h),oi(d)),{},{fill:"none"});if(l==="top"||l==="bottom"){var m=+(l==="top"&&!c||l==="bottom"&&c);f=Br(Br({},f),{},{x1:t,y1:r+m*a,x2:t+n,y2:r+m*a})}else{var g=+(l==="left"&&!c||l==="right"&&c);f=Br(Br({},f),{},{x1:t+g*n,y1:r,x2:t+g*n,y2:r+a})}return v.createElement("line",ao({},f,{className:cr("recharts-cartesian-axis-line",Cc(d,"className"))}))}function bie(e,t,r,n,a,l,c,d,h){var f,m,g,x,b,j,w=d?-1:1,_=e.tickSize||c,N=We(e.tickCoord)?e.tickCoord:e.coordinate;switch(l){case"top":f=m=e.coordinate,x=r+ +!d*a,g=x-w*_,j=g-w*h,b=N;break;case"left":g=x=e.coordinate,m=t+ +!d*n,f=m-w*_,b=f-w*h,j=N;break;case"right":g=x=e.coordinate,m=t+ +d*n,f=m+w*_,b=f+w*h,j=N;break;default:f=m=e.coordinate,x=r+ +d*a,g=x+w*_,j=g+w*h,b=N;break}return{line:{x1:f,y1:g,x2:m,y2:x},tick:{x:b,y:j}}}function vie(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function yie(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function wie(e){var{option:t,tickProps:r,value:n}=e,a,l=cr(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))a=v.cloneElement(t,Br(Br({},r),{},{className:l}));else if(typeof t=="function")a=t(Br(Br({},r),{},{className:l}));else{var c="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(c=cr(c,t==null?void 0:t.className)),a=v.createElement(gj,ao({},r,{className:c}),n)}return a}var jie=v.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:l,tickFormatter:c,unit:d,padding:h,tickTextProps:f,orientation:m,mirror:g,x,y:b,width:j,height:w,tickSize:_,tickMargin:N,fontSize:C,letterSpacing:A,getTicksConfig:E,events:S,axisType:T}=e,D=vj(Br(Br({},E),{},{ticks:r}),C,A),P=vie(m,g),I=yie(m,g),$=oi(E),M=Kw(n),R={};typeof a=="object"&&(R=a);var F=Br(Br({},$),{},{fill:"none"},R),V=D.map(U=>Br({entry:U},bie(U,x,b,j,w,m,_,g,N))),H=V.map(U=>{var{entry:W,line:le}=U;return v.createElement(ci,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},a&&v.createElement("line",ao({},F,le,{className:cr("recharts-cartesian-axis-tick-line",Cc(a,"className"))})))}),L=V.map((U,W)=>{var{entry:le,tick:ve}=U,B=Br(Br(Br(Br({textAnchor:P,verticalAnchor:I},$),{},{stroke:"none",fill:l},M),ve),{},{index:W,payload:le,visibleTicksCount:D.length,tickFormatter:c,padding:h},f);return v.createElement(ci,ao({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(le.value,"-").concat(le.coordinate,"-").concat(le.tickCoord)},t1(S,le,W)),n&&v.createElement(wie,{option:n,tickProps:B,value:"".concat(typeof c=="function"?c(le.value,W):le.value).concat(d||"")}))});return v.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(T,"-ticks")},L.length>0&&v.createElement(ki,{zIndex:Mn.label},v.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(T,"-tick-labels"),ref:t},L)),H.length>0&&v.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(T,"-tick-lines")},H))}),_ie=v.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:l,hide:c,ticks:d,axisType:h}=e,f=hie(e,uie),[m,g]=v.useState(""),[x,b]=v.useState(""),j=v.useRef(null);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var _;return die({ticks:j.current,label:(_=e.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var w=v.useCallback(_=>{if(_){var N=_.getElementsByClassName("recharts-cartesian-axis-tick-value");j.current=N;var C=N[0];if(C){var A=window.getComputedStyle(C),E=A.fontSize,S=A.letterSpacing;(E!==m||S!==x)&&(g(E),b(S))}}},[m,x]);return c||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(ki,{zIndex:e.zIndex},v.createElement(ci,{className:cr("recharts-cartesian-axis",l)},v.createElement(xie,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:oi(e)}),v.createElement(jie,{ref:w,axisType:h,events:f,fontSize:m,getTicksConfig:e,height:e.height,letterSpacing:x,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:d,unit:e.unit,width:e.width,x:e.x,y:e.y}),v.createElement(use,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},v.createElement(wse,{label:e.label,labelRef:e.labelRef}),e.children)))}),yj=v.forwardRef((e,t)=>{var r=ys(e,ni);return v.createElement(_ie,ao({},r,{ref:t}))});yj.displayName="CartesianAxis";var kie=["x1","y1","x2","y2","key"],Nie=["offset"],Sie=["xAxisId","yAxisId"],Cie=["xAxisId","yAxisId"];function Q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q3(Object(r),!0).forEach(function(n){Eie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eie(e,t,r){return(t=Aie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aie(e){var t=Tie(e,"string");return typeof t=="symbol"?t:t+""}function Tie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gl(){return Gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gl.apply(null,arguments)}function pm(e,t){if(e==null)return{};var r,n,a=Oie(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Oie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Pie=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:l,height:c,ry:d}=e;return v.createElement("rect",{x:n,y:a,ry:d,width:l,height:c,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function IM(e){var{option:t,lineItemProps:r}=e,n;if(v.isValidElement(t))n=v.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:l,y1:c,x2:d,y2:h,key:f}=r,m=pm(r,kie),g=(a=oi(m))!==null&&a!==void 0?a:{},{offset:x}=g,b=pm(g,Nie);n=v.createElement("line",Gl({},b,{x1:l,y1:c,x2:d,y2:h,fill:"none",key:f}))}return n}function Die(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:l,yAxisId:c}=e,d=pm(e,Sie),h=a.map((f,m)=>{var g=Tn(Tn({},d),{},{x1:t,y1:f,x2:t+r,y2:f,key:"line-".concat(m),index:m});return v.createElement(IM,{key:"line-".concat(m),option:n,lineItemProps:g})});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function Mie(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:l,yAxisId:c}=e,d=pm(e,Cie),h=a.map((f,m)=>{var g=Tn(Tn({},d),{},{x1:f,y1:t,x2:f,y2:t+r,key:"line-".concat(m),index:m});return v.createElement(IM,{option:n,lineItemProps:g,key:"line-".concat(m)})});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function Rie(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:l,height:c,horizontalPoints:d,horizontal:h=!0}=e;if(!h||!t||!t.length||d==null)return null;var f=d.map(g=>Math.round(g+a-a)).sort((g,x)=>g-x);a!==f[0]&&f.unshift(0);var m=f.map((g,x)=>{var b=!f[x+1],j=b?a+c-g:f[x+1]-g;if(j<=0)return null;var w=x%t.length;return v.createElement("rect",{key:"react-".concat(x),y:g,x:n,height:j,width:l,stroke:"none",fill:t[w],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}function Iie(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:l,width:c,height:d,verticalPoints:h}=e;if(!t||!r||!r.length)return null;var f=h.map(g=>Math.round(g+a-a)).sort((g,x)=>g-x);a!==f[0]&&f.unshift(0);var m=f.map((g,x)=>{var b=!f[x+1],j=b?a+c-g:f[x+1]-g;if(j<=0)return null;var w=x%r.length;return v.createElement("rect",{key:"react-".concat(x),x:g,y:l,width:j,height:d,stroke:"none",fill:r[w],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var $ie=(e,t)=>{var{xAxis:r,width:n,height:a,offset:l}=e;return x6(vj(Tn(Tn(Tn({},ni),r),{},{ticks:b6(r),viewBox:{x:0,y:0,width:n,height:a}})),l.left,l.left+l.width,t)},Lie=(e,t)=>{var{yAxis:r,width:n,height:a,offset:l}=e;return x6(vj(Tn(Tn(Tn({},ni),r),{},{ticks:b6(r),viewBox:{x:0,y:0,width:n,height:a}})),l.top,l.top+l.height,t)},zie={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Mn.grid};function $M(e){var t=C6(),r=E6(),n=S6(),a=Tn(Tn({},ys(e,zie)),{},{x:We(e.x)?e.x:n.left,y:We(e.y)?e.y:n.top,width:We(e.width)?e.width:n.width,height:We(e.height)?e.height:n.height}),{xAxisId:l,yAxisId:c,x:d,y:h,width:f,height:m,syncWithTicks:g,horizontalValues:x,verticalValues:b}=a,j=Qn(),w=Xe(I=>YC(I,"xAxis",l,j)),_=Xe(I=>YC(I,"yAxis",c,j));if(!_a(f)||!_a(m)||!We(d)||!We(h))return null;var N=a.verticalCoordinatesGenerator||$ie,C=a.horizontalCoordinatesGenerator||Lie,{horizontalPoints:A,verticalPoints:E}=a;if((!A||!A.length)&&typeof C=="function"){var S=x&&x.length,T=C({yAxis:_?Tn(Tn({},_),{},{ticks:S?x:_.ticks}):void 0,width:t??f,height:r??m,offset:n},S?!0:g);H0(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(A=T)}if((!E||!E.length)&&typeof N=="function"){var D=b&&b.length,P=N({xAxis:w?Tn(Tn({},w),{},{ticks:D?b:w.ticks}):void 0,width:t??f,height:r??m,offset:n},D?!0:g);H0(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(E=P)}return v.createElement(ki,{zIndex:a.zIndex},v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(Pie,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(Rie,Gl({},a,{horizontalPoints:A})),v.createElement(Iie,Gl({},a,{verticalPoints:E})),v.createElement(Die,Gl({},a,{offset:n,horizontalPoints:A,xAxis:w,yAxis:_})),v.createElement(Mie,Gl({},a,{offset:n,verticalPoints:E,xAxis:w,yAxis:_}))))}$M.displayName="CartesianGrid";var Bie={},LM=Jn({name:"errorBars",initialState:Bie,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(l=>l.dataKey===n.dataKey&&l.direction===n.direction?a:l))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:xue,replaceErrorBar:bue,removeErrorBar:vue}=LM.actions,Uie=LM.reducer,qie=["children"];function Fie(e,t){if(e==null)return{};var r,n,a=Hie(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Hie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Vie={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Wie=v.createContext(Vie);function Gie(e){var{children:t}=e,r=Fie(e,qie);return v.createElement(Wie.Provider,{value:r},t)}function zM(e,t){var r,n,a=Xe(f=>wi(f,e)),l=Xe(f=>ji(f,t)),c=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:rn.allowDataOverflow,d=(n=l==null?void 0:l.allowDataOverflow)!==null&&n!==void 0?n:nn.allowDataOverflow,h=c||d;return{needClip:h,needClipX:c,needClipY:d}}function Kie(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=PM(),{needClipX:l,needClipY:c,needClip:d}=zM(t,r);if(!d||!a)return null;var{x:h,y:f,width:m,height:g}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:l?h:h-m/2,y:c?f:f-g/2,width:l?m:m*2,height:c?g:g*2}))}var kv={exports:{}},Nv={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z3;function Yie(){if(Z3)return Nv;Z3=1;var e=$c();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,l=e.useEffect,c=e.useMemo,d=e.useDebugValue;return Nv.useSyncExternalStoreWithSelector=function(h,f,m,g,x){var b=a(null);if(b.current===null){var j={hasValue:!1,value:null};b.current=j}else j=b.current;b=c(function(){function _(S){if(!N){if(N=!0,C=S,S=g(S),x!==void 0&&j.hasValue){var T=j.value;if(x(T,S))return A=T}return A=S}if(T=A,r(C,S))return T;var D=g(S);return x!==void 0&&x(T,D)?(C=S,T):(C=S,A=D)}var N=!1,C,A,E=m===void 0?null:m;return[function(){return _(f())},E===null?void 0:function(){return _(E())}]},[f,m,g,x]);var w=n(h,b[0],b[1]);return l(function(){j.hasValue=!0,j.value=w},[w]),d(w),w},Nv}var eE;function Xie(){return eE||(eE=1,kv.exports=Yie()),kv.exports}Xie();function Jie(e){e()}function Qie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Jie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var tE={notify(){},get:()=>[]};function Zie(e,t){let r,n=tE,a=0,l=!1;function c(w){m();const _=n.subscribe(w);let N=!1;return()=>{N||(N=!0,_(),g())}}function d(){n.notify()}function h(){j.onStateChange&&j.onStateChange()}function f(){return l}function m(){a++,r||(r=e.subscribe(h),n=Qie())}function g(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=tE)}function x(){l||(l=!0,m())}function b(){l&&(l=!1,g())}const j={addNestedSub:c,notifyNestedSubs:d,handleChangeWrapper:h,isSubscribed:f,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>n};return j}var ele=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tle=ele(),rle=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nle=rle(),sle=()=>tle||nle?v.useLayoutEffect:v.useEffect,ale=sle();function rE(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function ile(e,t){if(rE(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!rE(e[r[a]],t[r[a]]))return!1;return!0}var Sv=Symbol.for("react-redux-context"),Cv=typeof globalThis<"u"?globalThis:{};function lle(){if(!v.createContext)return{};const e=Cv[Sv]??(Cv[Sv]=new Map);let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var ole=lle();function cle(e){const{children:t,context:r,serverState:n,store:a}=e,l=v.useMemo(()=>{const h=Zie(a);return{store:a,subscription:h,getServerState:n?()=>n:void 0}},[a,n]),c=v.useMemo(()=>a.getState(),[a]);ale(()=>{const{subscription:h}=l;return h.onStateChange=h.notifyNestedSubs,h.trySubscribe(),c!==a.getState()&&h.notifyNestedSubs(),()=>{h.tryUnsubscribe(),h.onStateChange=void 0}},[l,c]);const d=r||ole;return v.createElement(d.Provider,{value:l},t)}var dle=cle,ule=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function hle(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function wj(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(ule.has(n)){if(e[n]==null&&t[n]==null)continue;if(!ile(e[n],t[n]))return!1}else if(!hle(e[n],t[n]))return!1;return!0}function ho(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:TM}function fo(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:TM}var fle="Invariant failed";function mle(e,t){throw new Error(fle)}function rw(){return rw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rw.apply(null,arguments)}function gm(e){return v.createElement(iae,rw({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var ple=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(We(t))return t;var l=We(n)||ln(n);return l?t(n,a):(l||mle(),r)}},gle=(e,t,r)=>r,xle=(e,t)=>t,lh=de([J1,xle],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),ble=de([lh],e=>e==null?void 0:e.maxBarSize),vle=(e,t,r,n)=>n,yle=de([Wt,J1,ho,fo,gle],(e,t,r,n,a)=>t.filter(l=>e==="horizontal"?l.xAxisId===r:l.yAxisId===n).filter(l=>l.isPanorama===a).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),wle=(e,t,r)=>{var n=Wt(e),a=ho(e,t),l=fo(e,t);if(!(a==null||l==null))return n==="horizontal"?Yy(e,"yAxis",l,r):Yy(e,"xAxis",a,r)},jle=(e,t)=>{var r=Wt(e),n=ho(e,t),a=fo(e,t);if(!(n==null||a==null))return r==="horizontal"?KC(e,"xAxis",n):KC(e,"yAxis",a)},_le=de([yle,fee,jle],Rae),kle=(e,t,r)=>{var n,a,l=lh(e,t);if(l!=null){var c=ho(e,t),d=fo(e,t);if(!(c==null||d==null)){var h=Wt(e),f=FP(e),{maxBarSize:m}=l,g=ln(m)?f:m,x,b;return h==="horizontal"?(x=Rc(e,"xAxis",c,r),b=Mc(e,"xAxis",c,r)):(x=Rc(e,"yAxis",d,r),b=Mc(e,"yAxis",d,r)),(n=(a=F0(x,b,!0))!==null&&a!==void 0?a:g)!==null&&n!==void 0?n:0}}},BM=(e,t,r)=>{var n=Wt(e),a=ho(e,t),l=fo(e,t);if(!(a==null||l==null)){var c,d;return n==="horizontal"?(c=Rc(e,"xAxis",a,r),d=Mc(e,"xAxis",a,r)):(c=Rc(e,"yAxis",l,r),d=Mc(e,"yAxis",l,r)),F0(c,d)}},Nle=de([_le,FP,hee,HP,kle,BM,ble],Bae),Sle=(e,t,r)=>{var n=ho(e,t);if(n!=null)return Rc(e,"xAxis",n,r)},Cle=(e,t,r)=>{var n=fo(e,t);if(n!=null)return Rc(e,"yAxis",n,r)},Ele=(e,t,r)=>{var n=ho(e,t);if(n!=null)return Mc(e,"xAxis",n,r)},Ale=(e,t,r)=>{var n=fo(e,t);if(n!=null)return Mc(e,"yAxis",n,r)},Tle=de([Nle,lh],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Ole=de([wle,lh],Uae),Ple=de([on,h1,Sle,Cle,Ele,Ale,Tle,Wt,eee,BM,Ole,lh,vle],(e,t,r,n,a,l,c,d,h,f,m,g,x)=>{var{chartData:b,dataStartIndex:j,dataEndIndex:w}=h;if(!(g==null||c==null||t==null||d!=="horizontal"&&d!=="vertical"||r==null||n==null||a==null||l==null||f==null)){var{data:_}=g,N;if(_!=null&&_.length>0?N=_:N=b==null?void 0:b.slice(j,w+1),N!=null)return loe({layout:d,barSettings:g,pos:c,parentViewBox:t,bandSize:f,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:l,stackedData:m,displayedData:N,offset:e,cells:x,dataStartIndex:j})}}),Dle=["index"];function nw(){return nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nw.apply(null,arguments)}function Mle(e,t){if(e==null)return{};var r,n,a=Rle(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UM=v.createContext(void 0),Ile=e=>{var t=v.useContext(UM);if(t!=null)return t.stackId;if(e!=null)return nY(e)},$le=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),Lle=e=>{var t=v.useContext(UM);if(t!=null){var{stackId:r}=t;return"url(#".concat($le(r,e),")")}},zle=e=>{var{index:t}=e,r=Mle(e,Dle),n=Lle(t);return v.createElement(ci,nw({className:"recharts-bar-stack-layer",clipPath:n},r))},Ble=["onMouseEnter","onMouseLeave","onClick"],Ule=["value","background","tooltipPosition"],qle=["id"],Fle=["onMouseEnter","onClick","onMouseLeave"];function gi(){return gi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gi.apply(null,arguments)}function nE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nE(Object(r),!0).forEach(function(n){Hle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hle(e,t,r){return(t=Vle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vle(e){var t=Wle(e,"string");return typeof t=="symbol"?t:t+""}function Wle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xm(e,t){if(e==null)return{};var r,n,a=Gle(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Kle=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:l}=e;return[{inactive:l,dataKey:t,type:a,color:n,value:v6(r,t),payload:e}]},Yle=v.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:l,hide:c,unit:d,tooltipType:h,id:f}=e,m={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:v6(l,t),hide:c,type:h,color:a,unit:d,graphicalItemId:f}};return v.createElement(lae,{tooltipEntrySettings:m})});function Xle(e){var t=Xe(Ic),{data:r,dataKey:n,background:a,allOtherBarProps:l}=e,{onMouseEnter:c,onMouseLeave:d,onClick:h}=l,f=xm(l,Ble),m=SM(c,n,l.id),g=CM(d),x=EM(h,n,l.id);if(!a||r==null)return null;var b=Kw(a);return v.createElement(ki,{zIndex:qae(a,Mn.barBackground)},r.map((j,w)=>{var{value:_,background:N,tooltipPosition:C}=j,A=xm(j,Ule);if(!N)return null;var E=m(j,w),S=g(j,w),T=x(j,w),D=Pn(Pn(Pn(Pn(Pn({option:a,isActive:String(w)===t},A),{},{fill:"#eee"},N),b),t1(f,j,w)),{},{onMouseEnter:E,onMouseLeave:S,onClick:T,dataKey:n,index:w,className:"recharts-bar-background-rectangle"});return v.createElement(gm,gi({key:"background-bar-".concat(w)},D))}))}function Jle(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(l=>{var c={x:l.x,y:l.y,width:l.width,lowerWidth:l.width,upperWidth:l.width,height:l.height};return Pn(Pn({},c),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:c,fill:l.fill})});return v.createElement(Pse,{value:t?a:void 0},r)}function Qle(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:l,dataKey:c}=e,d=Xe(Ic),h=Xe(eM),f=r&&String(l)===d&&(h==null||c===h),m=f?r:t;return f?v.createElement(ki,{zIndex:Mn.activeBar},v.createElement(gm,gi({},n,{name:String(n.name)},a,{isActive:f,option:m,index:l,dataKey:c}))):v.createElement(gm,gi({},n,{name:String(n.name)},a,{isActive:f,option:m,index:l,dataKey:c}))}function Zle(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:l}=e;return v.createElement(gm,gi({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:l}))}function eoe(e){var t,{data:r,props:n}=e,a=(t=oi(n))!==null&&t!==void 0?t:{},{id:l}=a,c=xm(a,qle),{shape:d,dataKey:h,activeBar:f}=n,{onMouseEnter:m,onClick:g,onMouseLeave:x}=n,b=xm(n,Fle),j=SM(m,h,l),w=CM(x),_=EM(g,h,l);return r?v.createElement(v.Fragment,null,r.map((N,C)=>v.createElement(zle,gi({index:C,key:"rectangle-".concat(N==null?void 0:N.x,"-").concat(N==null?void 0:N.y,"-").concat(N==null?void 0:N.value,"-").concat(C),className:"recharts-bar-rectangle"},t1(b,N,C),{onMouseEnter:j(N,C),onMouseLeave:w(N,C),onClick:_(N,C)}),f?v.createElement(Qle,{shape:d,activeBar:f,baseProps:c,entry:N,index:C,dataKey:h}):v.createElement(Zle,{shape:d,baseProps:c,entry:N,index:C,dataKey:h})))):null}function toe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:h,onAnimationEnd:f,onAnimationStart:m}=t,g=r.current,x=x1(t,"recharts-bar-"),[b,j]=v.useState(!1),w=!b,_=v.useCallback(()=>{typeof f=="function"&&f(),j(!1)},[f]),N=v.useCallback(()=>{typeof m=="function"&&m(),j(!0)},[m]);return v.createElement(Jle,{showLabels:w,rects:n},v.createElement(g1,{animationId:x,begin:c,duration:d,isActive:l,easing:h,onAnimationEnd:_,onAnimationStart:N,key:x},C=>{var A=C===1?n:n==null?void 0:n.map((E,S)=>{var T=g&&g[S];if(T)return Pn(Pn({},E),{},{x:yn(T.x,E.x,C),y:yn(T.y,E.y,C),width:yn(T.width,E.width,C),height:yn(T.height,E.height,C)});if(a==="horizontal"){var D=yn(0,E.height,C),P=yn(E.stackedBarStart,E.y,C);return Pn(Pn({},E),{},{y:P,height:D})}var I=yn(0,E.width,C),$=yn(E.stackedBarStart,E.x,C);return Pn(Pn({},E),{},{width:I,x:$})});return C>0&&(r.current=A??null),A==null?null:v.createElement(ci,null,v.createElement(eoe,{props:t,data:A}))}),v.createElement(Rse,{label:t.label}),t.children)}function roe(e){var t=v.useRef(null);return v.createElement(toe,{previousRectanglesRef:t,props:e})}var qM=0,noe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:kn(e,t)}};class soe extends v.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:l,yAxisId:c,needClip:d,background:h,id:f}=this.props;if(t||r==null)return null;var m=cr("recharts-bar",a),g=f;return v.createElement(ci,{className:m,id:f},d&&v.createElement("defs",null,v.createElement(Kie,{clipPathId:g,xAxisId:l,yAxisId:c})),v.createElement(ci,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(g,")"):void 0},v.createElement(Xle,{data:r,dataKey:n,background:h,allOtherBarProps:this.props}),v.createElement(roe,this.props)))}}var aoe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:qM,xAxisId:0,yAxisId:0,zIndex:Mn.bar};function ioe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:l,activeBar:c,animationBegin:d,animationDuration:h,animationEasing:f,isAnimationActive:m}=e,{needClip:g}=zM(t,r),x=Gu(),b=Qn(),j=Use(e.children,uM),w=Xe(C=>Ple(C,e.id,b,j));if(x!=="vertical"&&x!=="horizontal")return null;var _,N=w==null?void 0:w[0];return N==null||N.height==null||N.width==null?_=0:_=x==="vertical"?N.height/2:N.width/2,v.createElement(Gie,{xAxisId:t,yAxisId:r,data:w,dataPointFormatter:noe,errorBarOffset:_},v.createElement(soe,gi({},e,{layout:x,needClip:g,data:w,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:l,activeBar:c,animationBegin:d,animationDuration:h,animationEasing:f,isAnimationActive:m})))}function loe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:l,xAxis:c,yAxis:d,xAxisTicks:h,yAxisTicks:f,stackedData:m,displayedData:g,offset:x,cells:b,parentViewBox:j,dataStartIndex:w}=e,_=t==="horizontal"?d:c,N=m?_.scale.domain():null,C=sY({numericAxis:_}),A=_.scale(C);return g.map((E,S)=>{var T,D,P,I,$,M;if(m){var R=m[S+w];if(R==null)return null;T=QK(R,N)}else T=kn(E,r),Array.isArray(T)||(T=[C,T]);var F=ple(n,qM)(T[1],S);if(t==="horizontal"){var V,[H,L]=[d.scale(T[0]),d.scale(T[1])];D=e4({axis:c,ticks:h,bandSize:l,offset:a.offset,entry:E,index:S}),P=(V=L??H)!==null&&V!==void 0?V:void 0,I=a.size;var U=H-L;if($=ia(U)?0:U,M={x:D,y:x.top,width:I,height:x.height},Math.abs(F)>0&&Math.abs($)<Math.abs(F)){var W=Kn($||F)*(Math.abs(F)-Math.abs($));P-=W,$+=W}}else{var[le,ve]=[c.scale(T[0]),c.scale(T[1])];if(D=le,P=e4({axis:d,ticks:f,bandSize:l,offset:a.offset,entry:E,index:S}),I=ve-le,$=a.size,M={x:x.left,y:P,width:x.width,height:$},Math.abs(F)>0&&Math.abs(I)<Math.abs(F)){var B=Kn(I||F)*(Math.abs(F)-Math.abs(I));I+=B}}if(D==null||P==null||I==null||$==null)return null;var G=Pn(Pn({},E),{},{stackedBarStart:A,x:D,y:P,width:I,height:$,value:m?T:T[1],payload:E,background:M,tooltipPosition:{x:D+I/2,y:P+$/2},parentViewBox:j},b&&b[S]&&b[S].props);return G}).filter(Boolean)}function ooe(e){var t=ys(e,aoe),r=Ile(t.stackId),n=Qn();return v.createElement(fae,{id:t.id,type:"bar"},a=>v.createElement(v.Fragment,null,v.createElement(oae,{legendPayload:Kle(t)}),v.createElement(Yle,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),v.createElement(yae,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),v.createElement(ki,{zIndex:t.zIndex},v.createElement(ioe,gi({},t,{id:a})))))}var bm=v.memo(ooe,wj);bm.displayName="Bar";var coe=["domain","range"],doe=["domain","range"];function sE(e,t){if(e==null)return{};var r,n,a=uoe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function aE(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function FM(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=sE(e,coe),{domain:l,range:c}=t,d=sE(t,doe);return!aE(r,l)||!aE(n,c)?!1:wj(a,d)}var hoe=["dangerouslySetInnerHTML","ticks","scale"],foe=["id","scale"];function sw(){return sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sw.apply(null,arguments)}function iE(e,t){if(e==null)return{};var r,n,a=moe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function moe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function poe(e){var t=Dr(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(Nae(e)):r.current!==e&&t(Sae({prev:r.current,next:e})),r.current=e},[e,t]),v.useLayoutEffect(()=>()=>{r.current&&(t(Cae(r.current)),r.current=null)},[t]),null}var goe=e=>{var{xAxisId:t,className:r}=e,n=Xe(h1),a=Qn(),l="xAxis",c=Xe(N=>MD(N,l,t,a)),d=Xe(N=>TD(N,t)),h=Xe(N=>dte(N,t)),f=Xe(N=>ZP(N,t));if(d==null||h==null||f==null)return null;var{dangerouslySetInnerHTML:m,ticks:g,scale:x}=e,b=iE(e,hoe),{id:j,scale:w}=f,_=iE(f,foe);return v.createElement(yj,sw({},b,_,{x:h.x,y:h.y,width:d.width,height:d.height,className:cr("recharts-".concat(l," ").concat(l),r),viewBox:n,ticks:c,axisType:l}))},xoe={allowDataOverflow:rn.allowDataOverflow,allowDecimals:rn.allowDecimals,allowDuplicatedCategory:rn.allowDuplicatedCategory,angle:rn.angle,axisLine:ni.axisLine,height:rn.height,hide:!1,includeHidden:rn.includeHidden,interval:rn.interval,minTickGap:rn.minTickGap,mirror:rn.mirror,orientation:rn.orientation,padding:rn.padding,reversed:rn.reversed,scale:rn.scale,tick:rn.tick,tickCount:rn.tickCount,tickLine:ni.tickLine,tickSize:ni.tickSize,type:rn.type,xAxisId:0},boe=e=>{var t=ys(e,xoe);return v.createElement(v.Fragment,null,v.createElement(poe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),v.createElement(goe,t))},jj=v.memo(boe,FM);jj.displayName="XAxis";var voe=["dangerouslySetInnerHTML","ticks","scale"],yoe=["id","scale"];function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aw.apply(null,arguments)}function lE(e,t){if(e==null)return{};var r,n,a=woe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function woe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function joe(e){var t=Dr(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(Eae(e)):r.current!==e&&t(Aae({prev:r.current,next:e})),r.current=e},[e,t]),v.useLayoutEffect(()=>()=>{r.current&&(t(Tae(r.current)),r.current=null)},[t]),null}var _oe=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,l=v.useRef(null),c=v.useRef(null),d=Xe(h1),h=Qn(),f=Dr(),m="yAxis",g=Xe(T=>OD(T,t)),x=Xe(T=>hte(T,t)),b=Xe(T=>MD(T,m,t,h)),j=Xe(T=>eD(T,t));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!g||xj(a)||v.isValidElement(a)||j==null)){var T=l.current;if(T){var D=T.getCalculatedWidth();Math.round(g.width)!==Math.round(D)&&f(Oae({id:t,width:D}))}}},[b,g,f,a,t,n,j]),g==null||x==null||j==null)return null;var{dangerouslySetInnerHTML:w,ticks:_,scale:N}=e,C=lE(e,voe),{id:A,scale:E}=j,S=lE(j,yoe);return v.createElement(yj,aw({},C,S,{ref:l,labelRef:c,x:x.x,y:x.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:g.width,height:g.height,className:cr("recharts-".concat(m," ").concat(m),r),viewBox:d,ticks:b,axisType:m}))},koe={allowDataOverflow:nn.allowDataOverflow,allowDecimals:nn.allowDecimals,allowDuplicatedCategory:nn.allowDuplicatedCategory,angle:nn.angle,axisLine:ni.axisLine,hide:!1,includeHidden:nn.includeHidden,interval:nn.interval,minTickGap:nn.minTickGap,mirror:nn.mirror,orientation:nn.orientation,padding:nn.padding,reversed:nn.reversed,scale:nn.scale,tick:nn.tick,tickCount:nn.tickCount,tickLine:ni.tickLine,tickSize:ni.tickSize,type:nn.type,width:nn.width,yAxisId:0},Noe=e=>{var t=ys(e,koe);return v.createElement(v.Fragment,null,v.createElement(joe,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),v.createElement(_oe,t))},HM=v.memo(Noe,FM);HM.displayName="YAxis";var Soe=(e,t)=>t,_j=de([Soe,Wt,JP,Jr,XD,_i,Sre,on],Dre),kj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},VM=Us("mouseClick"),WM=Vu();WM.startListening({actionCreator:VM,effect:(e,t)=>{var r=e.payload,n=_j(t.getState(),kj(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Ste({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var iw=Us("mouseMove"),GM=Vu(),Qf=null;GM.startListening({actionCreator:iw,effect:(e,t)=>{var r=e.payload;Qf!==null&&cancelAnimationFrame(Qf);var n=kj(r);Qf=requestAnimationFrame(()=>{var a=t.getState(),l=ij(a,a.tooltip.settings.shared);if(l==="axis"){var c=_j(a,n);(c==null?void 0:c.activeIndex)!=null?t.dispatch(qD({activeIndex:c.activeIndex,activeDataKey:void 0,activeCoordinate:c.activeCoordinate})):t.dispatch(UD())}Qf=null})}});function Coe(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var oE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},KM=Jn({name:"rootProps",initialState:oE,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:oE.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),Eoe=KM.reducer,{updateOptions:Aoe}=KM.actions,YM=Jn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:yue}=YM.actions,Toe=YM.reducer,XM=Us("keyDown"),JM=Us("focus"),Nj=Vu();Nj.startListening({actionCreator:XM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,l=e.payload;if(!(l!=="ArrowRight"&&l!=="ArrowLeft"&&l!=="Enter")){var c=lj(a,Qc(r),th(r),ah(r)),d=c==null?-1:Number(c);if(!(!Number.isFinite(d)||d<0)){var h=_i(r);if(l==="Enter"){var f=um(r,"axis","hover",String(a.index));t.dispatch(Jy({active:!a.active,activeIndex:a.index,activeCoordinate:f}));return}var m=gte(r),g=m==="left-to-right"?1:-1,x=l==="ArrowRight"?1:-1,b=d+x*g;if(!(h==null||b>=h.length||b<0)){var j=um(r,"axis","hover",String(b));t.dispatch(Jy({active:!0,activeIndex:b.toString(),activeCoordinate:j}))}}}}}});Nj.startListening({actionCreator:JM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var l="0",c=um(r,"axis","hover",String(l));t.dispatch(Jy({active:!0,activeIndex:l,activeCoordinate:c}))}}}});var Rs=Us("externalEvent"),QM=Vu(),Ev=new Map;QM.startListening({actionCreator:Rs,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,l=Ev.get(a);l!==void 0&&cancelAnimationFrame(l);var c=requestAnimationFrame(()=>{try{var d=t.getState(),h={activeCoordinate:ure(d),activeDataKey:eM(d),activeIndex:Ic(d),activeLabel:ZD(d),activeTooltipIndex:Ic(d),isTooltipActive:hre(d)};r(h,n)}finally{Ev.delete(a)}});Ev.set(a,c)}}});var Ooe=de([Xc],e=>e.tooltipItemPayloads),Poe=de([Ooe,sh,(e,t)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(d=>d.settings.graphicalItemId===n);if(a!=null){var{positions:l}=a;if(l!=null){var c=t(l,r);return c}}}),ZM=Us("touchMove"),eR=Vu();eR.startListening({actionCreator:ZM,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=ij(n,n.tooltip.settings.shared);if(a==="axis"){var l=r.touches[0];if(l==null)return;var c=_j(n,kj({clientX:l.clientX,clientY:l.clientY,currentTarget:r.currentTarget}));(c==null?void 0:c.activeIndex)!=null&&t.dispatch(qD({activeIndex:c.activeIndex,activeDataKey:void 0,activeCoordinate:c.activeCoordinate}))}else if(a==="item"){var d,h=r.touches[0];if(document.elementFromPoint==null||h==null)return;var f=document.elementFromPoint(h.clientX,h.clientY);if(!f||!f.getAttribute)return;var m=f.getAttribute(uY),g=(d=f.getAttribute(hY))!==null&&d!==void 0?d:void 0,x=Jc(n).find(w=>w.id===g);if(m==null||x==null||g==null)return;var{dataKey:b}=x,j=Poe(n,m,g);t.dispatch(BD({activeDataKey:b,activeIndex:m,activeCoordinate:j,activeGraphicalItemId:g}))}}}});var Doe=qO({brush:Hae,cartesianAxis:Pae,chartData:une,errorBars:Uie,graphicalItems:bae,layout:WK,legend:nX,options:ine,polarAxis:$se,polarOptions:Toe,referenceElements:Jae,rootProps:Eoe,tooltip:Cte,zIndex:Gre}),Moe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return xK({reducer:Doe,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([WM.middleware,GM.middleware,Nj.middleware,QM.middleware,eR.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(n6({type:"raf"}))},devTools:{serialize:{replacer:Coe},name:"recharts-".concat(r)}})};function Roe(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Qn(),l=v.useRef(null);if(a)return r;l.current==null&&(l.current=Moe(t,n));var c=n1;return v.createElement(dle,{context:c,store:l.current},r)}function Ioe(e){var{layout:t,margin:r}=e,n=Dr(),a=Qn();return v.useEffect(()=>{a||(n(FK(t)),n(qK(r)))},[n,a,t,r]),null}var $oe=v.memo(Ioe,wj);function Loe(e){var t=Dr();return v.useEffect(()=>{t(Aoe(e))},[t,e]),null}function cE(e){var{zIndex:t,isPanorama:r}=e,n=v.useRef(null),a=Dr();return v.useLayoutEffect(()=>(n.current&&a(Vre({zIndex:t,element:n.current,isPanorama:r})),()=>{a(Wre({zIndex:t,isPanorama:r}))}),[a,t,r]),v.createElement("g",{tabIndex:-1,ref:n})}function dE(e){var{children:t,isPanorama:r}=e,n=Xe(Rre);if(!n||n.length===0)return t;var a=n.filter(c=>c<0),l=n.filter(c=>c>0);return v.createElement(v.Fragment,null,a.map(c=>v.createElement(cE,{key:c,zIndex:c,isPanorama:r})),t,l.map(c=>v.createElement(cE,{key:c,zIndex:c,isPanorama:r})))}var zoe=["children"];function Boe(e,t){if(e==null)return{};var r,n,a=Uoe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Uoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vm(){return vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vm.apply(null,arguments)}var qoe={width:"100%",height:"100%",display:"block"},Foe=v.forwardRef((e,t)=>{var r=C6(),n=E6(),a=I6();if(!_a(r)||!_a(n))return null;var{children:l,otherAttributes:c,title:d,desc:h}=e,f,m;return c!=null&&(typeof c.tabIndex=="number"?f=c.tabIndex:f=a?0:void 0,typeof c.role=="string"?m=c.role:m=a?"application":void 0),v.createElement(iO,vm({},c,{title:d,desc:h,role:m,tabIndex:f,width:r,height:n,style:qoe,ref:t}),l)}),Hoe=e=>{var{children:t}=e,r=Xe(Qm);if(!r)return null;var{width:n,height:a,y:l,x:c}=r;return v.createElement(iO,{width:n,height:a,x:c,y:l},t)},uE=v.forwardRef((e,t)=>{var{children:r}=e,n=Boe(e,zoe),a=Qn();return a?v.createElement(Hoe,null,v.createElement(dE,{isPanorama:!0},r)):v.createElement(Foe,vm({ref:t},n),v.createElement(dE,{isPanorama:!1},r))});function Voe(){var e=Dr(),[t,r]=v.useState(null),n=Xe(dY);return v.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),l=a.width/t.offsetWidth;wr(l)&&l!==n&&e(VK(l))}},[t,e,n]),r}function hE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Woe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hE(Object(r),!0).forEach(function(n){Goe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Goe(e,t,r){return(t=Koe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Koe(e){var t=Yoe(e,"string");return typeof t=="symbol"?t:t+""}function Yoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},io.apply(null,arguments)}var Xoe=()=>(yne(),null);function ym(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Joe=v.forwardRef((e,t)=>{var r,n,a=v.useRef(null),[l,c]=v.useState({containerWidth:ym((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:ym((n=e.style)===null||n===void 0?void 0:n.height)}),d=v.useCallback((f,m)=>{c(g=>{var x=Math.round(f),b=Math.round(m);return g.containerWidth===x&&g.containerHeight===b?g:{containerWidth:x,containerHeight:b}})},[]),h=v.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null&&typeof ResizeObserver<"u"){var{width:m,height:g}=f.getBoundingClientRect();d(m,g);var x=j=>{var{width:w,height:_}=j[0].contentRect;d(w,_)},b=new ResizeObserver(x);b.observe(f),a.current=b}},[t,d]);return v.useEffect(()=>()=>{var f=a.current;f!=null&&f.disconnect()},[d]),v.createElement(v.Fragment,null,v.createElement(ep,{width:l.containerWidth,height:l.containerHeight}),v.createElement("div",io({ref:h},e)))}),Qoe=v.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,l]=v.useState({containerWidth:ym(r),containerHeight:ym(n)}),c=v.useCallback((h,f)=>{l(m=>{var g=Math.round(h),x=Math.round(f);return m.containerWidth===g&&m.containerHeight===x?m:{containerWidth:g,containerHeight:x}})},[]),d=v.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null){var{width:f,height:m}=h.getBoundingClientRect();c(f,m)}},[t,c]);return v.createElement(v.Fragment,null,v.createElement(ep,{width:a.containerWidth,height:a.containerHeight}),v.createElement("div",io({ref:d},e)))}),Zoe=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return v.createElement(v.Fragment,null,v.createElement(ep,{width:r,height:n}),v.createElement("div",io({ref:t},e)))}),ece=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return di(r)||di(n)?v.createElement(Qoe,io({},e,{ref:t})):v.createElement(Zoe,io({},e,{ref:t}))});function tce(e){return e===!0?Joe:ece}var rce=v.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:l,onContextMenu:c,onDoubleClick:d,onMouseDown:h,onMouseEnter:f,onMouseLeave:m,onMouseMove:g,onMouseUp:x,onTouchEnd:b,onTouchMove:j,onTouchStart:w,style:_,width:N,responsive:C,dispatchTouchEvents:A=!0}=e,E=v.useRef(null),S=Dr(),[T,D]=v.useState(null),[P,I]=v.useState(null),$=Voe(),M=f1(),R=(M==null?void 0:M.width)>0?M.width:N,F=(M==null?void 0:M.height)>0?M.height:a,V=v.useCallback(ee=>{$(ee),typeof t=="function"&&t(ee),D(ee),I(ee),ee!=null&&(E.current=ee)},[$,t,D,I]),H=v.useCallback(ee=>{S(VM(ee)),S(Rs({handler:l,reactEvent:ee}))},[S,l]),L=v.useCallback(ee=>{S(iw(ee)),S(Rs({handler:f,reactEvent:ee}))},[S,f]),U=v.useCallback(ee=>{S(UD()),S(Rs({handler:m,reactEvent:ee}))},[S,m]),W=v.useCallback(ee=>{S(iw(ee)),S(Rs({handler:g,reactEvent:ee}))},[S,g]),le=v.useCallback(()=>{S(JM())},[S]),ve=v.useCallback(ee=>{S(XM(ee.key))},[S]),B=v.useCallback(ee=>{S(Rs({handler:c,reactEvent:ee}))},[S,c]),G=v.useCallback(ee=>{S(Rs({handler:d,reactEvent:ee}))},[S,d]),ie=v.useCallback(ee=>{S(Rs({handler:h,reactEvent:ee}))},[S,h]),he=v.useCallback(ee=>{S(Rs({handler:x,reactEvent:ee}))},[S,x]),_e=v.useCallback(ee=>{S(Rs({handler:w,reactEvent:ee}))},[S,w]),Ee=v.useCallback(ee=>{A&&S(ZM(ee)),S(Rs({handler:j,reactEvent:ee}))},[S,A,j]),we=v.useCallback(ee=>{S(Rs({handler:b,reactEvent:ee}))},[S,b]),ye=tce(C);return v.createElement(lM.Provider,{value:T},v.createElement(YV.Provider,{value:P},v.createElement(ye,{width:R??(_==null?void 0:_.width),height:F??(_==null?void 0:_.height),className:cr("recharts-wrapper",n),style:Woe({position:"relative",cursor:"default",width:R,height:F},_),onClick:H,onContextMenu:B,onDoubleClick:G,onFocus:le,onKeyDown:ve,onMouseDown:ie,onMouseEnter:L,onMouseLeave:U,onMouseMove:W,onMouseUp:he,onTouchEnd:we,onTouchMove:Ee,onTouchStart:_e,ref:V},v.createElement(Xoe,null),r)))}),nce=["width","height","responsive","children","className","style","compact","title","desc"];function sce(e,t){if(e==null)return{};var r,n,a=ace(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ace(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ice=v.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:l,className:c,style:d,compact:h,title:f,desc:m}=e,g=sce(e,nce),x=oi(g);return h?v.createElement(v.Fragment,null,v.createElement(ep,{width:r,height:n}),v.createElement(uE,{otherAttributes:x,title:f,desc:m},l)):v.createElement(rce,{className:c,style:d,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(uE,{otherAttributes:x,title:f,desc:m,ref:t},v.createElement(Zae,null,l)))});function lw(){return lw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lw.apply(null,arguments)}var lce={top:5,right:5,bottom:5,left:5},oce={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:lce,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},cce=v.forwardRef(function(t,r){var n,a=ys(t.categoricalChartProps,oce),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,categoricalChartProps:f}=t,m={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return v.createElement(Roe,{preloadedState:{options:m},reduxStoreName:(n=f.id)!==null&&n!==void 0?n:l},v.createElement(Fae,{chartData:f.data}),v.createElement($oe,{layout:a.layout,margin:a.margin}),v.createElement(Loe,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),v.createElement(ice,lw({},a,{ref:r})))}),dce=["axis","item"],tR=v.forwardRef((e,t)=>v.createElement(cce,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:dce,tooltipPayloadSearcher:sne,categoricalChartProps:e,ref:t}));const uce=e=>{const[t,r]=v.useState([]),[n,a]=v.useState(!0),[l,c]=v.useState(null),d=v.useCallback(async()=>{if(!e){r([]),a(!1);return}try{a(!0);const{data:f,error:m}=await ge.from("lead_activities").select("*").eq("lead_id",e).order("created_at",{ascending:!1});if(m)throw m;r(f||[]),c(null)}catch(f){console.error("Error fetching activities:",f),c(f.message),r([])}finally{a(!1)}},[e]);return v.useEffect(()=>{d()},[d]),{activities:t,loading:n,error:l,refreshActivities:d,addActivity:async(f,m={})=>{if(!e)return{success:!1,error:"No lead ID"};try{const{data:{user:g}}=await ge.auth.getUser();if(!g)throw new Error("Not authenticated");const{data:x}=await ge.from("profiles").select("organization_id").eq("id",g.id).single();if(!(x!=null&&x.organization_id))throw new Error("No organization found");const b={lead_id:e,org_id:x.organization_id,type:f,data:m,created_by:g.id},{data:j,error:w}=await ge.from("lead_activities").insert(b).select().single();if(w)throw w;return r(_=>[j,..._]),{success:!0,activity:j}}catch(g){return console.error("Error adding activity:",g),{success:!1,error:g.message}}}}},Sj=({lead:e,onClose:t,updateLead:r,generateAiScore:n,teamMembers:a=[]})=>{const[l,c]=v.useState("overview"),[d,h]=v.useState(!1),[f,m]=v.useState(!1),[g,x]=v.useState(!1),[b,j]=v.useState(""),[w,_]=v.useState(!1),[N,C]=v.useState(null),[A,E]=v.useState("all"),[S,T]=v.useState("all"),[D,P]=v.useState(!1),[I,$]=v.useState(!1),[M,R]=v.useState(""),[F,V]=v.useState("10:00"),[H,L]=v.useState(""),[U,W]=v.useState(!1),{activities:le,loading:ve,addActivity:B}=uce(e==null?void 0:e.id),[G,ie]=v.useState({name:"",company:"",phone:"",email:"",website:"",status:"",source:"",value:"",ownerId:""});if(v.useEffect(()=>{var ae,Ne;e&&ie({name:e.name||"",company:e.company||"",phone:e.phone||"",email:e.email||"",website:e.website||"",status:e.status,source:e.source,value:((ae=e.value)==null?void 0:ae.replace(/[^0-9.]/g,""))||"",ownerId:((Ne=e.owner)==null?void 0:Ne.id)||""})},[e]),v.useEffect(()=>{const ae=Ne=>{Ne.key==="Escape"&&(f?m(!1):t())};return window.addEventListener("keydown",ae),()=>window.removeEventListener("keydown",ae)},[t,f]),!e)return null;const he=(()=>{let ae=0;return e.name&&(ae+=10),e.company&&(ae+=10),e.email&&(ae+=10),e.phone&&(ae+=10),e.value&&e.value!=="$0"&&(ae+=10),ae})(),_e=(()=>{let ae=0;if(e.status!=="New"&&(ae+=10),e.lastActivity){const Ne=(new Date().getTime()-new Date(e.lastActivity).getTime())/864e5;Ne<3?ae+=20:Ne<7?ae+=10:ae+=5}return Math.min(ae,30)})(),Ee=e.priority==="Hot"?20:e.priority==="Warm"?10:5,we=Math.round(he/50*40),ye=Math.round(_e/30*35),ee=Math.round(Ee/20*25),ke=we+ye+ee,Te=async()=>{x(!0),C(null);try{await n(e.id),h(!0)}catch(ae){console.error("AI Analysis failed",ae),C(ae.message||"  .   .")}finally{x(!1)}},J=async()=>{try{const ae={name:G.name,company:G.company,phone:G.phone,email:G.email,website:G.website,status:G.status,source:G.source,value:G.value?`${G.value}`:"0",owner:{id:G.ownerId}};await r(e.id,ae),m(!1)}catch(ae){console.error("Update failed",ae)}},Le=ae=>{const Ne=ae.replace(/\D/g,"");window.location.href=`tel:${Ne} `},$e=ae=>{const Ne=ae.replace(/\D/g,""),Ge=Ne.startsWith("0")?"972"+Ne.substring(1):Ne;window.open(`https://wa.me/${Ge}`,"_blank")},ut=async ae=>{if(e){W(!0);try{if(ae==="follow_up"&&!M){$(!0),W(!1);return}const Ne=ae==="follow_up"&&M?new Date(`${M}T${F}:00`).toISOString():null;if(!(await fetch(`/api/leads/${e.id}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:ae,followUpAt:Ne,notes:H||null})})).ok)throw new Error("Failed to update lead");R(""),V("10:00"),L(""),$(!1),P(!1),console.log(`Lead marked as ${ae}`)}catch(Ne){console.error("Quick action failed:",Ne)}finally{W(!1)}}},yt=ae=>{switch(ae){case"New":return"success";case"Discovery":return"brand";case"Negotiation":return"warning";case"Closed":return"neutral";case"Proposal":return"brand";default:return"neutral"}},Dt=ae=>{switch(ae){case"New":return" ";case"Discovery":return" ";case"Negotiation":return" ";case"Proposal":return" ";case"Closed":return"";default:return ae}},Zt=ae=>{switch(ae){case"Website":return" ";case"LinkedIn":return"";case"Facebook Ads":return"";case"Referral":return"";case"Webinar":return"";default:return ae}},dr=()=>{var ae,Ne,Ge,vt;return s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-all duration-300 relative flex flex-col justify-between group hover:shadow-md",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden rounded-2xl pointer-events-none",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-brand-500/5 rounded-full blur-3xl -mr-10 -mt-10"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-brand-500/5 rounded-full blur-2xl -ml-5 -mb-5"})]}),s.jsxs("div",{className:"relative z-10 flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 relative z-20",children:[s.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onClick:()=>h(!d),className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors cursor-help",children:s.jsx(fw,{className:"w-3.5 h-3.5 text-slate-400 dark:text-slate-500"})}),d&&s.jsxs("div",{className:"absolute top-3 right-8 w-64 bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-100 dark:border-slate-700 p-4 z-[999999] animate-in zoom-in-95 duration-200",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-900 dark:text-white mb-2",children:"  "}),s.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400 mb-3 leading-relaxed",children:"       :"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:" ( )"}),s.jsxs("span",{className:"font-bold text-brand-600",children:[we,"%"]})]}),s.jsx("div",{className:"w-full h-1 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-brand-500 rounded-full",style:{width:`${we}%`}})}),s.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:" ( )"}),s.jsxs("span",{className:"font-bold text-emerald-600",children:[ye,"%"]})]}),s.jsx("div",{className:"w-full h-1 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${ye}%`}})}),s.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"  ()"}),s.jsxs("span",{className:"font-bold text-amber-600",children:[ee,"%"]})]}),s.jsx("div",{className:"w-full h-1 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${ee}%`}})})]}),s.jsx("div",{className:"absolute top-3 -right-1.5 w-3 h-3 bg-white dark:bg-slate-800 border-t border-r border-slate-100 dark:border-slate-700 transform rotate-45"})]})]})]}),s.jsx("div",{className:`px-4 py-1 rounded-full text-[11px] font-bold tracking-wide shadow-sm text-white
                     ${ke>80?"bg-gradient-to-r from-brand-600 to-brand-500":ke>50?"bg-gradient-to-r from-amber-500 to-amber-400":"bg-gradient-to-r from-slate-500 to-slate-400"}`,children:ke>80?"HIGH INTENT":ke>50?"MEDIUM INTENT":"LOW INTENT"})]}),s.jsxs("div",{className:"relative z-0 flex items-center justify-between",children:[s.jsx("span",{className:"text-6xl font-bold text-slate-900 dark:text-white tracking-tighter drop-shadow-sm",children:ke}),s.jsxs("button",{onClick:Te,disabled:g,className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all duration-300
                        ${g?"bg-slate-100 dark:bg-slate-800 text-slate-400 cursor-wait":"bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400 hover:bg-brand-100 dark:hover:bg-brand-900/40 hover:scale-105 active:scale-95"}`,children:[s.jsx(Nr,{className:`w-4 h-4 ${g?"animate-pulse":""}`}),s.jsx("span",{className:"text-xs font-bold",children:g?"...":"  AI"})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm flex flex-col relative group",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6 pb-2 border-b border-slate-50 dark:border-slate-800/50",children:[s.jsxs("h3",{className:"text-base font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[s.jsx(x0,{className:"w-4 h-4 text-brand-500"})," "]}),s.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-1.5 text-xs font-bold text-brand-600 dark:text-brand-400 hover:text-brand-800 dark:hover:text-brand-300 transition-colors px-2 py-1 rounded hover:bg-brand-50 dark:hover:bg-brand-900/20",children:[s.jsx(zE,{className:"w-3 h-3"}),""]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-6 gap-x-8",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wider block mb-2",children:""}),s.jsx(qr,{variant:yt(e.status),className:"text-xs px-3 py-1",children:Dt(e.status)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wider block mb-2",children:" "}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-900 dark:text-white font-medium",children:[s.jsx(vc,{className:"w-3.5 h-3.5 text-slate-400"}),Zt(e.source)]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wider block mb-2",children:" "}),s.jsxs("div",{className:"flex items-center gap-2.5",children:[(ae=e.owner)!=null&&ae.avatar?s.jsx("img",{src:e.owner.avatar,className:"w-7 h-7 rounded-full border border-slate-200 dark:border-slate-700 object-cover shadow-sm",alt:""}):s.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-200 dark:bg-slate-700"}),s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:(Ne=e.owner)==null?void 0:Ne.name})]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-wider block mb-2",children:" "}),s.jsxs("span",{className:"text-sm font-medium text-slate-900 dark:text-white font-mono text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[s.jsx(wn,{className:"w-3.5 h-3.5 text-slate-400"}),e.createdAt?new Date(e.createdAt).toLocaleDateString("he-IL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"10/11/2024"]})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm",children:[s.jsxs("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(Rn,{className:"w-4 h-4 text-brand-500"})," "]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 dark:text-slate-400",children:s.jsx(ft,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:""}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white dir-ltr text-right font-mono",children:e.phone})]})]}),s.jsx("button",{onClick:()=>Le(e.phone),className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-white dark:hover:bg-slate-700 rounded-full shadow-sm opacity-0 group-hover:opacity-100 transition-all",children:s.jsx(ft,{className:"w-3.5 h-3.5"})})]}),s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 dark:text-slate-400",children:s.jsx(gs,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:""}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:e.email})]})]}),s.jsx("button",{onClick:()=>window.open(`mailto:${e.email}`),className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-white dark:hover:bg-slate-700 rounded-full shadow-sm opacity-0 group-hover:opacity-100 transition-all",children:s.jsx(ou,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500 dark:text-slate-400",children:s.jsx(vc,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:""}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:"www.spectra.com"})]})]}),s.jsx("button",{onClick:()=>window.open("https://google.com","_blank"),className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-white dark:hover:bg-slate-700 rounded-full shadow-sm opacity-0 group-hover:opacity-100 transition-all",children:s.jsx(TE,{className:"w-4 h-4"})})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm",children:[s.jsxs("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(Na,{className:"w-4 h-4 text-brand-500"})," "]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-4",children:[s.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[s.jsx("p",{className:"text-xs text-slate-500 mb-1",children:" "}),s.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:e.company})]}),s.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[s.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"  "}),s.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-white",children:(Ge=e.value)!=null&&Ge.startsWith("")||(vt=e.value)!=null&&vt.startsWith("$")?e.value.replace("$",""):`${e.value||0}`})]})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs text-slate-500 mb-2 flex items-center gap-1",children:[s.jsx(l$,{className:"w-3 h-3"}),"  "]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Software","SaaS","Enterprise"].map(st=>s.jsx("span",{className:"px-2.5 py-1 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs rounded-full border border-slate-200 dark:border-slate-700 font-medium",children:st},st)),(e.tags||[]).map(st=>s.jsx("span",{className:"px-2.5 py-1 bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300 text-xs rounded-full border border-brand-100 dark:border-brand-800",children:st},st)),s.jsxs("button",{className:"text-xs text-slate-400 hover:text-brand-600 px-2 py-1 rounded-full border border-dashed border-slate-300 hover:border-brand-300 transition-colors flex items-center gap-1",children:[s.jsx(Nn,{className:"w-3 h-3"})," "]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm",children:[s.jsxs("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(vr,{className:"w-4 h-4 text-brand-500"})," "]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>ut("follow_up"),disabled:U,className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-sm font-medium rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all shadow-sm hover:shadow-md disabled:opacity-50",children:[s.jsx(wn,{className:"w-4 h-4"}),"  "]}),s.jsxs("button",{onClick:()=>ut("deal_closed"),disabled:U,className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-emerald-500 to-green-500 text-white text-sm font-medium rounded-xl hover:from-emerald-600 hover:to-green-600 transition-all shadow-sm hover:shadow-md disabled:opacity-50",children:[s.jsx(uw,{className:"w-4 h-4"})," "]}),s.jsxs("button",{onClick:()=>ut("not_relevant"),disabled:U,className:"flex items-center gap-2 px-4 py-2.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-medium rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-all disabled:opacity-50",children:[s.jsx(du,{className:"w-4 h-4"})," "]})]})]}),I&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999]",onClick:()=>$(!1),children:s.jsxs("div",{onClick:st=>st.stopPropagation(),className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200",children:[s.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(wn,{className:"w-5 h-5 text-brand-500"}),"  "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:""}),s.jsx("input",{type:"date",value:M,min:new Date().toISOString().split("T")[0],onChange:st=>R(st.target.value),className:"w-full px-4 py-2.5 border border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:""}),s.jsx("input",{type:"time",value:F,min:M===new Date().toISOString().split("T")[0]?new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):void 0,onChange:st=>V(st.target.value),className:"w-full px-4 py-2.5 border border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:" ()"}),s.jsx("textarea",{value:H,onChange:st=>L(st.target.value),placeholder:"    ?",className:"w-full px-4 py-2.5 border border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white outline-none focus:ring-2 focus:ring-brand-500 resize-none h-20"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>$(!1),className:"flex-1 px-4 py-2.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-medium rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-all",children:""}),s.jsx("button",{onClick:()=>ut("follow_up"),disabled:!M||U,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-brand-600 to-indigo-600 text-white font-medium rounded-xl hover:from-brand-700 hover:to-indigo-700 transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:U?"...":" "})]})]})})]})},Y=ae=>{switch(ae){case"call_start":case"call_end":return ft;case"email_sent":return gs;case"note":return ps;case"follow_up":return wn;case"status_change":return Zl;case"deal_closed":return Or;case"lead_created":return Nr;default:return Xn}},Z=ae=>{switch(ae){case"call_start":return" ";case"call_end":return" ";case"email_sent":return" ";case"note":return" ";case"follow_up":return" -";case"status_change":return" ";case"deal_closed":return" ";case"not_relevant":return" ";case"lead_created":return" ";case"summary_ready":return" ";default:return ae}},fe=ae=>{const Ne=new Date(ae),vt=new Date().getTime()-Ne.getTime(),st=Math.floor(vt/(1e3*60*60*24));return st===0?`, ${Ne.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})}`:st===1?`, ${Ne.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})}`:Ne.toLocaleDateString("he-IL",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})},Ve=async()=>{if(b.trim()){_(!0);try{await B("note",{note:b}),j("")}catch(ae){console.error("Failed to add note:",ae)}finally{_(!1)}}},rt=()=>s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-4 shadow-sm",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("textarea",{value:b,onChange:ae=>j(ae.target.value),placeholder:" ...",className:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 resize-none",rows:2}),s.jsx(je,{onClick:Ve,disabled:!b.trim()||w,className:"px-4",children:w?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(Nn,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white",children:" "}),s.jsxs("span",{className:"text-xs text-slate-400",children:[le.length," "]})]}),ve&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(it,{className:"w-6 h-6 text-brand-500 animate-spin"})}),!ve&&le.length===0&&s.jsxs("div",{className:"text-center py-8 text-slate-400",children:[s.jsx(Xn,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"  "}),s.jsx("p",{className:"text-xs mt-1",children:"    "})]}),!ve&&le.length>0&&s.jsx("div",{className:"relative border-r-2 border-slate-100 dark:border-slate-800 mr-2 space-y-6 py-2",children:le.map((ae,Ne)=>{var st,mt,wt,ct,dt,Zr;const Ge=Y(ae.type),vt=Ne===0;return s.jsxs("div",{className:"relative pr-6 group",children:[s.jsx("div",{className:`absolute -right-[7px] top-1.5 w-3 h-3 rounded-full bg-white dark:bg-slate-950 border-2 ${vt?"border-brand-500":"border-slate-300 dark:border-slate-700"} group-hover:scale-110 transition-transform`}),s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx("span",{className:`text-xs font-semibold ${vt?"text-brand-600 dark:text-brand-400":"text-slate-500 dark:text-slate-400"}`,children:fe(ae.created_at)})}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-4 rounded-xl shadow-sm group-hover:border-brand-200 dark:group-hover:border-brand-800 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Ge,{className:`w-3.5 h-3.5 ${ae.type==="lead_created"?"text-amber-400":"text-slate-400"}`}),s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:Z(ae.type)})]}),((st=ae.data)==null?void 0:st.note)&&s.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed",children:ae.data.note}),((mt=ae.data)==null?void 0:mt.summary)&&s.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed",children:ae.data.summary}),((wt=ae.data)==null?void 0:wt.source)&&s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[": ",ae.data.source]}),((ct=ae.data)==null?void 0:ct.old_status)&&((dt=ae.data)==null?void 0:dt.new_status)&&s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[ae.data.old_status,"  ",ae.data.new_status]}),((Zr=ae.data)==null?void 0:Zr.duration)&&s.jsxs(qr,{variant:"neutral",className:"text-[10px] mt-2 px-2 py-0.5",children:[Math.floor(ae.data.duration/60),":",(ae.data.duration%60).toString().padStart(2,"0")," "]})]})]})]},ae.id)})})]}),pe=()=>{let ae=[...le];A==="calls"?ae=ae.filter(Ge=>Ge.type==="call_start"||Ge.type==="call_end"):A==="emails"?ae=ae.filter(Ge=>Ge.type==="email_sent"):A==="notes"&&(ae=ae.filter(Ge=>Ge.type==="note"));const Ne=new Date;if(S==="week"){const Ge=new Date(Ne.getTime()-6048e5);ae=ae.filter(vt=>new Date(vt.created_at)>=Ge)}else if(S==="month"){const Ge=new Date(Ne.getTime()-2592e6);ae=ae.filter(vt=>new Date(vt.created_at)>=Ge)}return ae},qe=()=>{const ae=pe();return s.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white dark:bg-slate-900 p-2 rounded-lg border border-slate-200 dark:border-slate-800",children:[s.jsx("div",{className:"relative flex-1",children:s.jsxs("select",{value:A,onChange:Ne=>E(Ne.target.value),className:"w-full text-xs bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md py-1.5 px-2 outline-none text-slate-700 dark:text-slate-200",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"calls",children:""}),s.jsx("option",{value:"emails",children:""}),s.jsx("option",{value:"notes",children:""})]})}),s.jsx("div",{className:"relative flex-1",children:s.jsxs("select",{value:S,onChange:Ne=>T(Ne.target.value),className:"w-full text-xs bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md py-1.5 px-2 outline-none text-slate-700 dark:text-slate-200",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"week",children:""}),s.jsx("option",{value:"month",children:""})]})})]}),ve&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(it,{className:"w-6 h-6 text-brand-500 animate-spin"})}),!ve&&ae.length===0&&s.jsxs("div",{className:"text-center py-8 text-slate-400",children:[s.jsx(Xn,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"  "}),s.jsx("p",{className:"text-xs mt-1",children:"   "})]}),!ve&&ae.length>0&&s.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl overflow-hidden shadow-sm",children:s.jsxs("table",{className:"w-full text-right text-xs",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 font-medium",children:""}),s.jsx("th",{className:"px-4 py-3 font-medium",children:""}),s.jsx("th",{className:"px-4 py-3 font-medium",children:""}),s.jsx("th",{className:"px-4 py-3 font-medium",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:ae.map(Ne=>{var Ge,vt;return s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors",children:[s.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400",children:new Date(Ne.created_at).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"})}),s.jsx("td",{className:"px-4 py-3 font-medium text-slate-900 dark:text-white",children:Z(Ne.type)}),s.jsx("td",{className:"px-4 py-3 text-slate-600 dark:text-slate-300",children:Ne.type==="call_start"||Ne.type==="call_end"?"":Ne.type==="email_sent"?"":Ne.type==="note"?"":""}),s.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 truncate max-w-[150px]",children:((Ge=Ne.data)==null?void 0:Ge.note)||((vt=Ne.data)==null?void 0:vt.summary)||"-"})]},Ne.id)})})]})})]})},nt=()=>{var Ge,vt,st,mt,wt;const ae=e.scoreDetails&&e.scoreDetails.generatedAt,Ne=ct=>ct>=80?"text-emerald-600 dark:text-emerald-400":ct>=60?"text-amber-600 dark:text-amber-400":"text-rose-600 dark:text-rose-400";return s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[!ae&&s.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white dark:from-indigo-900/20 dark:to-slate-900 border border-indigo-100 dark:border-indigo-900/50 rounded-xl p-6 shadow-sm text-center",children:[s.jsx(Nr,{className:"w-10 h-10 mx-auto mb-3 text-indigo-400"}),s.jsx("h3",{className:"font-bold text-indigo-900 dark:text-indigo-300 mb-2",children:" AI"}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"       "}),s.jsx(je,{onClick:Te,disabled:g,children:g?s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"w-4 h-4 ml-2 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nr,{className:"w-4 h-4 ml-2"}),"  "]})}),N&&s.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400 text-xs",children:N})]}),ae&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white dark:from-indigo-900/20 dark:to-slate-900 border border-indigo-100 dark:border-indigo-900/50 rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/50 rounded-lg text-indigo-600 dark:text-indigo-400",children:s.jsx(Nr,{className:"w-4 h-4"})}),s.jsx("h3",{className:"font-bold text-indigo-900 dark:text-indigo-300 text-sm",children:"  "})]}),s.jsx("div",{className:`text-3xl font-bold ${Ne(e.score||0)}`,children:e.score||0})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-4",children:[{label:"",value:(Ge=e.scoreDetails)==null?void 0:Ge.fit,icon:Rn},{label:"",value:(vt=e.scoreDetails)==null?void 0:vt.activity,icon:Pr},{label:"",value:(st=e.scoreDetails)==null?void 0:st.intent,icon:ou}].map((ct,dt)=>s.jsxs("div",{className:"text-center p-3 bg-white dark:bg-slate-800/50 rounded-lg",children:[s.jsx(ct.icon,{className:"w-4 h-4 mx-auto mb-1 text-slate-400"}),s.jsx("div",{className:`text-lg font-bold ${Ne(ct.value||0)}`,children:ct.value||0}),s.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wide",children:ct.label})]},dt))}),((mt=e.scoreDetails)==null?void 0:mt.reasoning)&&s.jsxs("div",{className:"bg-white dark:bg-slate-800/30 rounded-lg p-4 border border-indigo-100 dark:border-indigo-800",children:[s.jsx("h4",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400 mb-2",children:" AI:"}),s.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed",children:e.scoreDetails.reasoning})]}),s.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-indigo-100 dark:border-indigo-800",children:[s.jsxs("span",{className:"text-[10px] text-slate-400",children:[": ",new Date(e.scoreDetails.generatedAt).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),s.jsxs(je,{variant:"ghost",size:"sm",onClick:Te,disabled:g,className:"text-xs",children:[g?s.jsx(it,{className:"w-3 h-3 animate-spin"}):s.jsx(Ru,{className:"w-3 h-3 ml-1"}),""]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-4",children:" "}),s.jsx("div",{className:"space-y-3",children:(wt=e.scoreDetails)!=null&&wt.recommendations&&e.scoreDetails.recommendations.length>0?e.scoreDetails.recommendations.map((ct,dt)=>s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer group border border-transparent hover:border-slate-100 dark:hover:border-slate-700 transition-all",children:[s.jsx("input",{type:"checkbox",className:"mt-1 rounded border-slate-300 dark:border-slate-600 text-brand-600 focus:ring-brand-500 bg-white dark:bg-slate-800"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200 font-medium",children:ct})]},dt)):(e.score||0)>=70?["   ","   ","  "].map((ct,dt)=>s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer group border border-transparent hover:border-slate-100 dark:hover:border-slate-700 transition-all",children:[s.jsx("input",{type:"checkbox",className:"mt-1 rounded border-slate-300 dark:border-slate-600 text-brand-600 focus:ring-brand-500 bg-white dark:bg-slate-800"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200 font-medium",children:ct})]},dt)):(e.score||0)>=40?["   ","  ","  "].map((ct,dt)=>s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer group border border-transparent hover:border-slate-100 dark:hover:border-slate-700 transition-all",children:[s.jsx("input",{type:"checkbox",className:"mt-1 rounded border-slate-300 dark:border-slate-600 text-brand-600 focus:ring-brand-500 bg-white dark:bg-slate-800"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200 font-medium",children:ct})]},dt)):["    ","  ","  "].map((ct,dt)=>s.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer group border border-transparent hover:border-slate-100 dark:hover:border-slate-700 transition-all",children:[s.jsx("input",{type:"checkbox",className:"mt-1 rounded border-slate-300 dark:border-slate-600 text-brand-600 focus:ring-brand-500 bg-white dark:bg-slate-800"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200 font-medium",children:ct})]},dt))})]})]})]})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-40 transition-opacity duration-300",onClick:t}),s.jsxs("div",{className:"fixed inset-y-0 right-0 z-50 w-full md:w-[480px] lg:w-[540px] bg-white dark:bg-slate-950 shadow-2xl shadow-slate-900/20 transform transition-transform duration-300 ease-in-out animate-in slide-in-from-right flex flex-col h-full border-l border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"flex-shrink-0 bg-white dark:bg-slate-900 z-20 border-b border-slate-100 dark:border-slate-800 relative",children:[s.jsxs("div",{className:"px-6 pt-6 pb-4 flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-xl font-bold text-slate-500 dark:text-slate-400 border border-slate-200 dark:border-slate-700 shadow-sm",children:e.name.charAt(0)}),s.jsxs("div",{className:"mt-1",children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white leading-none mb-2",children:e.name}),s.jsxs("div",{className:"flex items-center text-sm text-slate-500 dark:text-slate-400",children:[s.jsx("span",{children:'"'}),s.jsx("span",{className:"mx-2 text-slate-300",children:""}),s.jsx("span",{children:e.company})]})]})]}),s.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:s.jsx(Lt,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"px-6 pb-6 flex gap-3",children:[s.jsxs(je,{className:"flex-1 justify-center py-2.5",onClick:()=>Le(e.phone),children:[s.jsx(ft,{className:"w-4 h-4 ml-2"}),""]}),s.jsxs(je,{variant:"secondary",className:"flex-1 justify-center py-2.5 text-emerald-700 border-emerald-200 hover:bg-emerald-50 dark:text-emerald-400 dark:border-emerald-900 dark:hover:bg-emerald-900/20",onClick:()=>$e(e.phone),children:[s.jsx(au,{className:"w-4 h-4 ml-2"}),""]}),s.jsx(je,{variant:"ghost",className:"px-3 border border-slate-200 dark:border-slate-700 text-slate-500",onClick:()=>m(!0),children:s.jsx(Mu,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"px-6 flex gap-8 overflow-x-auto border-t border-slate-100 dark:border-slate-800 no-scrollbar",children:[{id:"overview",label:""},{id:"activity",label:""},{id:"history",label:""},{id:"ai",label:"AI Insights",icon:Nr}].map(ae=>s.jsxs("button",{onClick:()=>c(ae.id),className:`
                    py-3 text-sm font-medium border-b-2 transition-all whitespace-nowrap flex items-center gap-1.5
                    ${l===ae.id?"border-brand-600 text-brand-600 dark:text-brand-400 dark:border-brand-400 font-bold":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 hover:border-slate-300 dark:hover:border-slate-700"}
                  `,children:[ae.icon&&s.jsx(ae.icon,{className:`w-3.5 h-3.5 ${l===ae.id?"fill-current":""}`}),ae.label]},ae.id))})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50/50 dark:bg-slate-950",children:[l==="overview"&&dr(),l==="activity"&&rt(),l==="history"&&qe(),l==="ai"&&nt()]}),f&&s.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/30 backdrop-blur-sm transition-opacity",onClick:()=>m(!1)}),s.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-sm p-6 space-y-5 animate-in zoom-in-95 duration-200",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"max-h-[60vh] overflow-y-auto space-y-4 pr-1",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:" "}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsx("input",{type:"text",value:G.name,onChange:ae=>ie({...G,name:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsx("input",{type:"text",value:G.company,onChange:ae=>ie({...G,company:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:G.status,onChange:ae=>ie({...G,status:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm appearance-none outline-none focus:ring-2 focus:ring-brand-500",children:[s.jsx("option",{value:"New",children:" "}),s.jsx("option",{value:"Discovery",children:" "}),s.jsx("option",{value:"Negotiation",children:" "}),s.jsx("option",{value:"Proposal",children:" "}),s.jsx("option",{value:"Closed",children:""})]}),s.jsx(Pt,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:G.source,onChange:ae=>ie({...G,source:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm appearance-none outline-none focus:ring-2 focus:ring-brand-500",children:[s.jsx("option",{value:"Website",children:" "}),s.jsx("option",{value:"LinkedIn",children:""}),s.jsx("option",{value:"Facebook Ads",children:""}),s.jsx("option",{value:"Referral",children:""}),s.jsx("option",{value:"Webinar",children:""})]}),s.jsx(Pt,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]})]})]}),s.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-100 dark:border-slate-800",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider pt-2",children:" "}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsx("input",{type:"tel",value:G.phone,onChange:ae=>ie({...G,phone:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 dir-ltr text-right",placeholder:"050-0000000"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsx("input",{type:"email",value:G.email,onChange:ae=>ie({...G,email:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 dir-ltr text-right",placeholder:"name@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsx("input",{type:"url",value:G.website,onChange:ae=>ie({...G,website:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 dir-ltr text-right",placeholder:"www.example.com"})]})]}),s.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-100 dark:border-slate-800",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider pt-2",children:" "}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:"   ()"}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute top-2 right-3 text-slate-400 text-sm",children:""}),s.jsx("input",{type:"number",value:G.value,onChange:ae=>ie({...G,value:ae.target.value}),className:"w-full pr-8 pl-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500",placeholder:"0"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:G.ownerId,onChange:ae=>ie({...G,ownerId:ae.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm appearance-none outline-none focus:ring-2 focus:ring-brand-500",children:a.map(ae=>s.jsx("option",{value:ae.id,children:ae.name},ae.id))}),s.jsx(Pt,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-100 dark:border-slate-800",children:[s.jsx(je,{variant:"ghost",onClick:()=>m(!1),children:""}),s.jsxs(je,{onClick:J,children:[s.jsx(ol,{className:"w-4 h-4 ml-2"})," "]})]})]})]})]})]})},rR=(e,t,r,n)=>{const[a,l]=v.useState([]),[c,d]=v.useState(!0),[h,f]=v.useState(null),m=async()=>{try{d(!0);let w=ge.from("leads").select(`
                    *,
                    owner:owner_id (
                        id,
                        full_name,
                        avatar_url,
                        role
                    )
                `).order("created_at",{ascending:!1});t&&(w=w.eq("organization_id",t)),r&&!(n==="manager"||n==="sales_manager"||n==="admin"||n==="super_admin"||n==="platform_admin")&&(w=w.eq("owner_id",r));const{data:N,error:C}=await w;if(C)throw C;const A=(N||[]).map(E=>({id:E.id,name:E.name,company:E.company||"",phone:E.phone||"",email:E.email||"",status:E.status||"New",priority:E.priority||"Warm",value:E.value?`$${E.value.toLocaleString()}`:"$0",owner:E.owner?{id:E.owner.id,name:E.owner.full_name,avatar:E.owner.avatar_url||"https://ui-avatars.com/api/?name=User",role:E.owner.role,type:E.owner.role==="platform_admin"?"super_admin":E.owner.role||"rep"}:void 0,source:E.source,lastActivity:E.last_activity_at||E.created_at,tags:E.tags||[],createdAt:E.created_at,score:E.score||0,scoreDetails:E.score_details||null}));l(A)}catch(w){console.error("Error fetching leads:",w),f(w.message)}finally{d(!1)}},g=async w=>{var _,N;try{d(!0);const{data:{session:C},error:A}=await ge.auth.getSession();if(A||!C)throw new Error("No active session");const{data:E,error:S}=await ge.from("profiles").select("organization_id").eq("id",C.user.id).single();if(S||!(E!=null&&E.organization_id))throw new Error("Could not fetch user organization details.");const T=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;let D=(_=w.owner)==null?void 0:_.id;if(!D||!T.test(D))try{const M=await(await fetch(`/api/org/next-assignee?organizationId=${E.organization_id}`)).json();M.success&&M.autoDistribute&&((N=M.assignee)!=null&&N.id)?(D=M.assignee.id,console.log("[useLeads] Auto-assigned to:",M.assignee.name)):D=C.user.id}catch($){console.warn("[useLeads] Auto-distribute failed, using current user:",$),D=C.user.id}const P={name:w.name,company:w.company,status:w.status||"New",source:w.source,phone:w.phone,email:w.email,value:w.value?parseFloat(w.value.replace(/[^0-9.]/g,"")):0,tags:w.tags,owner_id:D,organization_id:E.organization_id},{error:I}=await ge.from("leads").insert([P]);if(I)throw I;return await m(),{success:!0}}catch(C){throw console.error("Error saving lead:",C),C}finally{d(!1)}},x=async w=>{try{if(l(C=>C.filter(A=>A.id!==w)),!(await(await fetch(`/api/leads/${w}`,{method:"DELETE"})).json()).success)throw await m(),new Error("Delete failed");return{success:!0}}catch(_){throw console.error("Error deleting lead:",_),_}},b=async(w,_)=>{var C;const N=[...a];l(A=>A.map(E=>E.id===w?{...E,..._}:E));try{const A={};_.name!==void 0&&(A.name=_.name),_.company!==void 0&&(A.company=_.company),_.phone!==void 0&&(A.phone=_.phone),_.email!==void 0&&(A.email=_.email),_.status!==void 0&&(A.status=_.status),_.priority!==void 0&&(A.priority=_.priority),_.value!==void 0&&(A.value=typeof _.value=="string"?parseFloat(_.value.replace(/[^0-9.]/g,"")):_.value),_.tags!==void 0&&(A.tags=_.tags),_.source!==void 0&&(A.source=_.source),_.website!==void 0&&(A.website=_.website),(C=_.owner)!=null&&C.id&&(A.owner_id=_.owner.id);const{error:E}=await ge.from("leads").update(A).eq("id",w);if(E)throw console.error("DB Update Error:",E),E;if(E)throw E;return{success:!0}}catch(A){throw console.error("Error updating lead:",A),l(N),A}};return v.useEffect(()=>{m()},[t]),{leads:a,loading:c,error:h,refreshLeads:m,addLead:g,deleteLead:x,updateLead:b,generateAiScore:async w=>{try{const _=await fetch(`/api/leads/${w}/ai-score`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!_.ok){const C=await _.json().catch(()=>({}));throw new Error(C.error||`Server error: ${_.status}`)}const N=await _.json();return l(C=>C.map(A=>A.id===w?{...A,score:N.score,scoreDetails:N.scoreDetails}:A)),N}catch(_){throw console.error("Failed to generate AI score:",_),_}}}},nR=(e,t)=>{const[r,n]=v.useState([]),[a,l]=v.useState(!0),[c,d]=v.useState(null),h=async()=>{try{l(!0);let g=ge.from("tasks").select(`
                    *,
                    type,
                    priority,
                    owner_id,
                    lead:lead_id (
                        id,
                        name
                    )
                `).order("due_date",{ascending:!0});e&&(g=g.eq("organization_id",e)),t&&(g=g.eq("owner_id",t));const{data:x,error:b}=await g;if(b)throw b;const j=(x||[]).map(w=>{var N;let _="";try{_=new Date(w.due_date).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})}catch{_="12:00"}return{id:w.id,title:w.title,leadName:((N=w.lead)==null?void 0:N.name)||"",dueDate:_,dueTime:w.due_time?w.due_time.substring(0,5):"10:00",rawDate:w.due_date,completed:w.completed,type:w.type,priority:w.priority,ai_reason:w.ai_reason,ownerId:w.owner_id}});n(j)}catch(g){console.error("Error fetching tasks:",g),d(g.message)}finally{l(!1)}},f=async(g,x)=>{const b=x!==void 0?!x:!0;n(j=>j.map(w=>w.id===g?{...w,completed:b}:w));try{const{error:j}=await ge.from("tasks").update({completed:b}).eq("id",g);j&&(console.error("Error toggling task:",j),n(w=>w.map(_=>_.id===g?{..._,completed:!b}:_)))}catch(j){console.error("Error toggling task:",j),n(w=>w.map(_=>_.id===g?{..._,completed:!b}:_))}},m=async(g,x,b)=>{try{const{data:{user:j},error:w}=await ge.auth.getUser();let _=j;if(!_){const{data:{session:A},error:E}=await ge.auth.getSession();A!=null&&A.user?(console.log("Recovered user from session:",A.user.id),_=A.user):console.error("Auth Check Failed:",{userError:w,sessionError:E})}if(!_)throw new Error("No user logged in. Please refresh or log in again.");console.log("Adding task for user:",_.id,{title:g,leadId:x,dueDate:b});const{error:N,data:C}=await ge.from("tasks").insert({title:g,lead_id:x,due_date:b||new Date,owner_id:_.id,completed:!1}).select();if(C&&console.log("Task added successfully:",C),N)throw console.error("Supabase Error adding task:",N),N;h()}catch(j){console.error("Error adding task:",j)}};return v.useEffect(()=>{h()},[e,t]),{tasks:r,loading:a,error:c,toggleTask:f,addTask:m,refreshTasks:h}},sR=({isOpen:e,onClose:t,title:r,children:n})=>{const[a,l]=v.useState(!1);return v.useEffect(()=>(l(!0),e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),!a||!e?null:Dm.createPortal(s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-md border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-200 relative",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-slate-800",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:r}),s.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400 transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-4",children:n})]})}),document.body)},aR=({isOpen:e,onClose:t,onAdd:r})=>{const[n,a]=v.useState(""),[l,c]=v.useState(new Date),[d,h]=v.useState("");Ur.useEffect(()=>{if(e){const g=new Date;g.setHours(12,0,0,0),c(g),a(""),h("")}},[e]);const f=g=>{if(g.preventDefault(),!n.trim())return;if(!l){console.error("[AddTask] No date selected!");return}if(console.log("[AddTask] Submitting:",{title:n.trim(),dueDate:l==null?void 0:l.toISOString(),rawDate:l,isValidDate:l&&!isNaN(l.getTime())}),isNaN(l.getTime())){console.error("[AddTask] Invalid date!");return}const x=d.trim()?`${n.trim()} | ${d.trim()}`:n.trim();r(x,void 0,l),a(""),h(""),t()},m=[" ","  ","  ","  "];return s.jsx(sR,{isOpen:e,onClose:t,title:"",children:s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-14 h-14 mx-auto bg-gradient-to-br from-brand-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg shadow-brand-500/25 mb-4",children:s.jsx(RE,{className:"w-7 h-7 text-white"})}),s.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"    "})]}),s.jsxs("form",{onSubmit:f,className:"space-y-5",children:[s.jsx("div",{children:s.jsx(zT,{value:l,onChange:c,minDate:new Date,label:" ",showTime:!0})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-200 mb-2",children:"  ?"}),s.jsx("input",{type:"text",value:n,onChange:g=>a(g.target.value),className:"w-full rounded-xl border-2 border-slate-200 dark:border-slate-700 p-3.5 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-right placeholder:text-slate-400",placeholder:"  ...",autoFocus:!0}),s.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:m.map((g,x)=>s.jsx("button",{type:"button",onClick:()=>a(g),className:"text-xs px-3 py-1.5 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-brand-50 hover:text-brand-600 dark:hover:bg-brand-900/30 dark:hover:text-brand-400 transition-colors border border-transparent hover:border-brand-200",children:g},x))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-200 mb-2 flex items-center gap-2",children:[s.jsx(Nr,{className:"w-4 h-4 text-amber-500"})," ()"]}),s.jsx("textarea",{value:d,onChange:g=>h(g.target.value),rows:3,className:"w-full rounded-xl border-2 border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-right placeholder:text-slate-400 resize-none",placeholder:" ?  ?  ..."})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(je,{type:"submit",className:"flex-1 py-3 bg-gradient-to-r from-brand-600 to-brand-500 hover:from-brand-700 hover:to-brand-600 shadow-lg shadow-brand-500/25 font-semibold",disabled:!n.trim(),children:[s.jsx(Ct,{className:"w-4 h-4 ml-2"})," "]}),s.jsx(je,{variant:"ghost",onClick:t,type:"button",className:"px-6 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200",children:""})]})]}),s.jsx("div",{className:"absolute -top-2 -right-2 w-20 h-20 bg-gradient-to-br from-brand-500/10 to-purple-500/10 rounded-full blur-2xl pointer-events-none"})]})})},hce=({onStartCall:e,isDarkMode:t,onNavigate:r,userName:n,centerType:a="sales"})=>{var Dt,Zt,dr,Y;const c=(()=>{const Z=new Date().getHours();return Z>=5&&Z<12?" ":Z>=12&&Z<18?" ":Z>=18&&Z<22?" ":" "})(),[d,h]=v.useState("day"),[f,m]=v.useState(" "),[g,x]=v.useState(!1),[b,j]=v.useState(null);qw();const{leads:w}=rR(),{tasks:_=[],toggleTask:N,addTask:C,loading:A}=nR(),[E,S]=v.useState("day"),T=Ur.useMemo(()=>{const Z=new Date,fe=new Date(Z.getFullYear(),Z.getMonth(),Z.getDate()),Ve=new Date(fe);Ve.setDate(Ve.getDate()+1);const rt=new Date(fe);rt.setDate(rt.getDate()-rt.getDay());const pe=new Date(rt);pe.setDate(pe.getDate()+7);const qe=new Date(Z.getFullYear(),Z.getMonth(),1),nt=new Date(Z.getFullYear(),Z.getMonth()+1,1);return _.filter(Ne=>{if(!Ne.rawDate)return E==="day";const Ge=new Date(Ne.rawDate),vt=!Ne.completed&&Ge<fe;if(E==="overdue")return vt;if(vt)return!1;switch(E){case"day":return Ge>=fe&&Ge<Ve;case"week":return Ge>=rt&&Ge<pe;case"month":return Ge>=qe&&Ge<nt;default:return!1}}).sort((Ne,Ge)=>Ne.completed!==Ge.completed?Ne.completed?1:-1:!Ne.rawDate||!Ge.rawDate?0:new Date(Ne.rawDate).getTime()-new Date(Ge.rawDate).getTime())},[_,E]),D=Ur.useMemo(()=>{const Z=new Date,fe=new Date(Z.getFullYear(),Z.getMonth(),Z.getDate());return _.filter(Ve=>!Ve.rawDate||Ve.completed?!1:new Date(Ve.rawDate)<fe).length},[_]),[P,I]=v.useState(null),[$,M]=v.useState(!0),[R,F]=v.useState(null),[V,H]=v.useState(!0);v.useEffect(()=>{(async()=>{M(!0);try{const Ve=await(await fetch(`/api/stats/daily?range=${d}`)).json();Ve.success&&I(Ve.stats)}catch(fe){console.error("[Dashboard] Stats fetch error:",fe)}finally{M(!1)}})()},[d]),v.useEffect(()=>{(async()=>{try{const Ve=await(await fetch("/api/coaching/daily")).json();Ve.success&&Ve.coaching&&F(Ve.coaching)}catch(fe){console.error("[Dashboard] Coaching fetch error:",fe)}finally{H(!1)}})()},[]);const[L,U]=v.useState([]),[W,le]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const Ve=await(await fetch("/api/stats/weekly-performance")).json();Ve.success&&Ve.data&&U(Ve.data)}catch(fe){console.error("[Dashboard] Weekly performance fetch error:",fe)}finally{le(!1)}})()},[]);const ve=v.useRef(null);v.useEffect(()=>{function Z(fe){ve.current&&!ve.current.contains(fe.target)&&x(!1)}return document.addEventListener("mousedown",Z),()=>{document.removeEventListener("mousedown",Z)}},[]);const B=Z=>{h(Z)},G=Z=>{m(Z),x(!1)},ie=Z=>{const fe=w.find(Ve=>Ve.name===Z);j(fe||{id:`temp-${Date.now()}`,name:Z,company:" ",phone:"",email:"",status:"New",priority:"Warm",value:"$0",tags:[]})},he=t?"#6366f1":"#4f46e5",_e=t?"#10b981":"#059669",Ee=[" "," ","",""],we=Z=>Z.includes("")?s.jsx(sl,{className:"w-4 h-4 text-slate-300 dark:text-slate-600"}):Z.includes("")?s.jsx(wn,{className:"w-4 h-4 text-slate-300 dark:text-slate-600"}):Z.includes("")?s.jsx(Ct,{className:"w-4 h-4 text-slate-300 dark:text-slate-600"}):s.jsx(ft,{className:"w-4 h-4 text-slate-300 dark:text-slate-600"}),ye=Z=>{const fe=Math.floor(Z/60),Ve=Z%60;return`${fe}:${Ve.toString().padStart(2,"0")}`},ee=d==="day"?"":d==="week"?"":"",ke=[{id:"calls",label:`"  ${ee}`,value:P?String(P.calls.total):"0",target:d==="day"?10:d==="week"?50:200,trend:P?`${P.calls.answered} `:"...",subtext:P&&P.calls.total>0?`${Math.round(P.calls.answered/P.calls.total*100)}% `:"",color:"bg-indigo-500"},{id:"answered",label:" ",value:P?String(P.calls.answered):"0",target:d==="day"?8:d==="week"?40:150,trend:"",subtext:' " ',color:"bg-emerald-500"},{id:"newLeads",label:" ",value:P?String(P.newLeads):"0",target:d==="day"?5:d==="week"?25:100,trend:ee,subtext:" ",color:"bg-purple-500"},{id:"avgTime",label:"  ",value:P?ye(P.avgCallTime):"0:00",target:300,trend:"",subtext:"",color:"bg-amber-500"}],Te=(P==null?void 0:P.qualityScore)||0,J=[...ke].reverse(),[Le,$e]=v.useState(!1),ut=new Date().toISOString().split("T")[0],yt=_.filter(Z=>{const fe=Z.rawDate&&Z.rawDate.startsWith(ut);return d==="day"&&!fe?!1:f===" "||f===" "||f===""?!0:f===""?Z.title.includes(""):!0}).map(Z=>{const Ve=(Z.rawDate?new Date(Z.rawDate):new Date).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"});return{id:Z.id,time:Ve,leadName:Z.leadName,outcome:Z.title,status:Z.completed?"Completed":"Scheduled",originalTask:Z}}).sort((Z,fe)=>Z.time.localeCompare(fe.time));return s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 lg:p-10 bg-transparent",dir:"rtl",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4 animate-slide-up",children:[s.jsxs("div",{className:"text-right flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight flex items-center gap-2",children:[c,", ",n||""," "]}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-1",children:"     !"})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-amber-50 to-amber-100 dark:from-amber-900/30 dark:to-amber-800/30 border border-amber-200/60 dark:border-amber-700/50 rounded-xl px-3 py-2",children:[s.jsx(sl,{className:"w-4 h-4 text-amber-500"}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-300 block",children:" "}),s.jsx("span",{className:"text-lg font-bold text-amber-700 dark:text-amber-200",children:Te})]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 relative z-20",children:[s.jsx("div",{className:"flex items-center bg-slate-100 dark:bg-slate-800 p-1 rounded-lg w-full sm:w-auto",children:[{id:"day",label:""},{id:"week",label:""},{id:"month",label:""}].map(Z=>s.jsx("button",{onClick:()=>B(Z.id),className:`
                    flex-1 sm:flex-none px-4 py-1.5 text-xs font-medium rounded-md transition-all
                    ${d===Z.id?"bg-brand-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}
                  `,children:Z.label},Z.id))}),s.jsxs(je,{onClick:e,className:"w-full sm:w-auto shadow-lg shadow-brand-500/25 hover:shadow-brand-500/40 hover:-translate-y-0.5 transition-all py-2.5 px-5",children:[s.jsx(ft,{className:"w-4 h-4 ml-2"}),"  "]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-10",children:J.map((Z,fe)=>s.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-2xl p-5 shadow-card hover:shadow-card-hover border border-slate-200 dark:border-slate-800 transition-all duration-300 relative overflow-hidden",children:[s.jsx("div",{className:"absolute -right-10 -top-10 w-24 h-24 bg-brand-500/5 rounded-full blur-2xl group-hover:bg-brand-500/10 transition-colors"}),s.jsxs("div",{className:"flex flex-col h-full justify-between relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:Z.label}),we(Z.label)]}),s.jsx("div",{className:"mb-4",children:s.jsx("span",{className:"text-3xl font-bold text-slate-900 dark:text-white tracking-tight font-mono",children:Z.value})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-brand-500 to-brand-400 rounded-full transition-all duration-1000 ease-out",style:{width:`${Math.min(parseInt(Z.value)/(Z.target||100)*100,100)}%`}})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[11px] text-slate-400 font-medium",children:Z.subtext}),Z.trend&&s.jsx("span",{className:"text-[11px] font-bold flex items-center text-brand-600 dark:text-brand-400",children:Z.trend})]})]})]})]},fe))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 md:gap-8 mb-10",children:[s.jsxs("div",{className:"lg:col-span-8 bg-white dark:bg-slate-900 rounded-2xl shadow-card border border-slate-100 dark:border-slate-800 flex flex-col min-h-[420px] overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-5 border-b border-slate-50 dark:border-slate-800 flex items-center justify-between bg-slate-50/30 dark:bg-slate-800/20",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("h2",{className:"font-bold text-slate-900 dark:text-white flex items-center gap-2 text-base",children:['" ',d==="day"?"":d==="week"?" ":" "]}),s.jsxs(qr,{variant:"neutral",className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm",children:[yt.length," "]})]}),s.jsxs("div",{className:"relative w-full sm:w-auto",ref:ve,children:[s.jsxs("button",{onClick:()=>x(!g),className:"w-full sm:w-40 flex items-center justify-between px-3 py-1.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg text-xs font-medium text-slate-700 dark:text-slate-200 hover:border-brand-300 dark:hover:border-brand-700 transition-colors shadow-sm",children:[s.jsx("span",{className:"truncate",children:f}),s.jsx(Pt,{className:`w-3 h-3 text-slate-400 transition-transform ${g?"rotate-180":""}`})]}),g&&s.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-20 py-1.5 animate-in fade-in zoom-in-95 duration-200 text-right",children:Ee.map(Z=>s.jsxs("button",{onClick:()=>G(Z),className:`
                        w-full text-right px-4 py-2 text-xs flex items-center justify-between transition-colors
                        ${f===Z?"bg-brand-50/50 dark:bg-brand-900/10 text-brand-600 dark:text-brand-400 font-medium":"text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800"}
                      `,children:[Z,f===Z&&s.jsx(Or,{className:"w-3 h-3"})]},Z))})]})]}),s.jsx("div",{className:"overflow-x-auto flex-1",children:s.jsxs("table",{className:"w-full text-right border-collapse",children:[s.jsx("thead",{className:"bg-slate-50/80 dark:bg-slate-800/50 text-[11px] text-slate-500 uppercase tracking-wider border-b border-slate-100 dark:border-slate-800 sticky top-0 z-10 backdrop-blur-sm",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 font-semibold w-24",children:""}),s.jsx("th",{className:"px-6 py-3 font-semibold",children:a==="support"?" / ":""}),s.jsx("th",{className:"px-6 py-3 font-semibold",children:" / "}),s.jsx("th",{className:"px-6 py-3 font-semibold",children:""}),s.jsx("th",{className:"px-6 py-3 font-semibold w-24",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800/50",children:yt.map((Z,fe)=>s.jsxs("tr",{className:"group hover:bg-brand-50/30 dark:hover:bg-brand-900/10 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 align-middle",children:s.jsx("span",{className:"font-mono text-sm text-slate-600 dark:text-slate-400 font-medium bg-slate-50 dark:bg-slate-800 px-2 py-1 rounded-md",children:Z.time})}),s.jsxs("td",{className:"px-6 py-4 align-middle",children:[s.jsx("div",{className:"font-bold text-slate-900 dark:text-white text-sm group-hover:text-brand-700 transition-colors",children:Z.leadName}),s.jsx("div",{className:"text-xs text-slate-400",children:'",  "'})]}),s.jsx("td",{className:"px-6 py-4 align-middle",children:s.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:Z.outcome})}),s.jsx("td",{className:"px-6 py-4 align-middle",children:Z.status==="In Progress"?s.jsxs("div",{className:"flex items-center gap-1.5 text-brand-600 dark:text-brand-400 font-bold text-xs animate-pulse",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-brand-500"})," "]}):Z.status==="Scheduled"?s.jsx("span",{className:"text-xs font-medium text-slate-500",children:""}):s.jsxs("div",{className:"flex items-center gap-1.5 text-emerald-600 dark:text-emerald-400 text-xs font-medium",children:[s.jsx(Ct,{className:"w-3.5 h-3.5"}),""]})}),s.jsx("td",{className:"px-6 py-4 align-middle",children:Z.status==="In Progress"?s.jsx(je,{size:"sm",onClick:e,className:"h-8 px-4 shadow-lg shadow-brand-500/20 text-xs",children:" "}):Z.status==="Scheduled"?s.jsxs("button",{onClick:e,className:"h-8 px-3 rounded-lg border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 text-xs hover:bg-white dark:hover:bg-slate-800 hover:border-brand-300 hover:text-brand-600 transition-all flex items-center gap-1.5 bg-slate-50 dark:bg-slate-900",children:[s.jsx(ft,{className:"w-3 h-3"})," "]}):s.jsx("button",{onClick:()=>ie(Z.leadName),className:"text-xs text-slate-400 hover:text-brand-600 underline decoration-slate-300 hover:decoration-brand-300 transition-all",children:""})})]},Z.id))})]})})]}),s.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#1e1b4b] to-[#312e81] rounded-2xl shadow-xl shadow-indigo-900/20 p-6 text-white relative overflow-hidden min-h-[260px] flex flex-col border border-white/5",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-500/20 rounded-full -mr-20 -mt-20 blur-3xl mix-blend-overlay"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-purple-500/20 rounded-full -ml-10 -mb-10 blur-3xl mix-blend-overlay"}),s.jsxs("div",{className:"relative z-10 flex-1 flex flex-col",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[s.jsx("div",{className:"p-2.5 bg-white/10 rounded-xl backdrop-blur-md border border-white/10 shadow-lg",children:s.jsx(su,{className:"w-5 h-5 text-yellow-300 fill-yellow-300/20"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg leading-tight",children:" "}),s.jsx("p",{className:"text-xs text-indigo-200 opacity-80",children:V?" ...":"   "})]})]}),s.jsx("div",{className:"space-y-3 flex-1",children:V?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-white/30 border-t-yellow-400 rounded-full"})}):((Dt=R==null?void 0:R.dailyFocus)==null?void 0:Dt.length)>0?R.dailyFocus.map((Z,fe)=>s.jsxs("div",{className:"group flex items-start gap-3 bg-white/5 hover:bg-white/10 transition-all duration-300 backdrop-blur-sm rounded-xl p-3.5 border border-white/5 hover:border-white/20 cursor-default hover:translate-x-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400 mt-2 shadow-[0_0_8px_rgba(250,204,21,0.6)]"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm leading-relaxed font-medium text-indigo-50/90 group-hover:text-white",children:Z.text}),Z.why&&s.jsx("p",{className:"text-xs text-indigo-300/60 mt-1",children:Z.why})]})]},fe)):s.jsx("div",{className:"text-center text-indigo-200/60 py-4 text-sm",children:"   "})})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm flex-1 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-amber-400 to-amber-200"}),s.jsxs("h3",{className:"font-bold text-slate-900 dark:text-white mb-4 text-sm flex items-center gap-2",children:[s.jsx(vr,{className:"w-4 h-4 text-amber-500"}),((Zt=R==null?void 0:R.goldenTip)==null?void 0:Zt.title)||" "]}),s.jsxs("div",{className:"relative z-10",children:[V?s.jsxs("div",{className:"flex items-center gap-2 py-4",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-slate-200 border-t-amber-500 rounded-full"}),s.jsx("span",{className:"text-sm text-slate-400",children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed font-medium italic",children:['"',((dr=R==null?void 0:R.goldenTip)==null?void 0:dr.content)||"         .",'"']}),((Y=R==null?void 0:R.goldenTip)==null?void 0:Y.example)&&s.jsxs("div",{className:"mt-3 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-100 dark:border-amber-800/30",children:[s.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300 font-medium",children:" :"}),s.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1",children:R.goldenTip.example})]})]}),s.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center",children:s.jsx("span",{className:"text-[10px] text-white font-bold",children:"AI"})}),s.jsx("span",{className:"text-xs text-slate-400",children:"AI Coach Analysis"})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 md:gap-8",children:[s.jsxs("div",{className:"lg:col-span-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-card p-5 flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center",children:s.jsx(Or,{className:"w-4 h-4 text-white"})}),s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white text-base",children:""})]}),s.jsx(je,{variant:"ghost",size:"sm",className:"text-xs h-7 px-2.5 bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400 hover:bg-brand-100 dark:hover:bg-brand-900/40 font-medium rounded-lg",onClick:()=>r==null?void 0:r("tasks"),children:" "})]}),s.jsx("div",{className:"flex gap-1 p-1 bg-slate-100 dark:bg-slate-800 rounded-lg mb-4",children:["day","week","month","overdue"].map(Z=>s.jsxs("button",{onClick:()=>S(Z),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all relative ${E===Z?Z==="overdue"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 shadow-sm":"bg-white dark:bg-slate-700 text-brand-600 dark:text-brand-400 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[Z==="day"?"":Z==="week"?"":Z==="month"?"":"",Z==="overdue"&&D>0&&s.jsx("span",{className:"absolute -top-2 -left-1 min-w-[18px] h-[18px] px-1 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center shadow-sm",children:D})]},Z))}),s.jsx("div",{className:"space-y-2 flex-1 overflow-y-auto max-h-[280px] scrollbar-thin",children:A?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-slate-200 border-t-brand-500 rounded-full"})}):T.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-3",children:s.jsx(Or,{className:"w-6 h-6 text-slate-400"})}),s.jsxs("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium",children:["  ",E==="day"?"":E==="week"?"":""]}),s.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"  !"})]}):T.map(Z=>s.jsxs("div",{className:`
                    group flex items-start gap-3 p-3 rounded-xl transition-all cursor-pointer border
                    ${Z.completed?"bg-slate-50 dark:bg-slate-800/50 border-slate-100 dark:border-slate-700/50":"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700/50 border-slate-100 dark:border-slate-700 hover:border-brand-200 dark:hover:border-brand-800 shadow-sm hover:shadow-md"}
                  `,onClick:()=>N(Z.id,Z.completed),children:[s.jsx("div",{className:"mt-0.5 flex-shrink-0",children:s.jsx("div",{className:`
                      w-5 h-5 rounded-lg border-2 flex items-center justify-center transition-all
                      ${Z.completed?"bg-emerald-500 border-emerald-500":"border-slate-300 dark:border-slate-600 group-hover:border-brand-500 group-hover:bg-brand-50 dark:group-hover:bg-brand-900/20"}
                    `,children:Z.completed&&s.jsx(Or,{className:"w-3 h-3 text-white"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`text-sm font-semibold leading-tight transition-colors ${Z.completed?"text-slate-400 dark:text-slate-500 line-through":"text-slate-800 dark:text-slate-200 group-hover:text-brand-600"}`,children:Z.title}),s.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[s.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 px-2 py-0.5 bg-slate-100 dark:bg-slate-700 rounded-md font-medium",children:Z.leadName}),s.jsxs("span",{className:"text-[11px] text-slate-400 dark:text-slate-500 flex items-center gap-1",children:[s.jsx(Pr,{className:"w-3 h-3"}),Z.dueDate]})]})]})]},Z.id))}),s.jsx(je,{variant:"secondary",size:"sm",className:"w-full mt-4 border-dashed border-2 text-slate-500 hover:text-brand-600 hover:border-brand-300 hover:bg-brand-50/50 dark:hover:bg-brand-900/10 py-2.5 font-medium",onClick:()=>$e(!0),children:"+   "}),s.jsx(aR,{isOpen:Le,onClose:()=>$e(!1),onAdd:C})]}),s.jsxs("div",{className:"lg:col-span-8 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-card p-6 flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white text-base",children:" "}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:W?" ...":`" ${L.reduce((Z,fe)=>Z+fe.calls,0)}  `})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-brand-500 rounded-full"}),s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:'" '})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-emerald-500 rounded-full"}),s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:" "})]})]})]}),W?s.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[200px]",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-3 border-slate-200 border-t-brand-500 rounded-full"}),s.jsx("span",{className:"text-sm text-slate-400",children:" ..."})]})}):L.length>0?s.jsx("div",{style:{width:"100%",height:260},children:s.jsx(k6,{width:"100%",height:"100%",children:s.jsxs(tR,{data:L,barGap:8,barCategoryGap:"20%",children:[s.jsx(jj,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:t?"#94a3b8":"#64748b",fontSize:12,fontWeight:600},dy:10}),s.jsx(dM,{cursor:{fill:t?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.03)",radius:8},content:({active:Z,payload:fe})=>{if(Z&&fe&&fe.length){const Ve=fe[0].payload;return s.jsxs("div",{className:`px-4 py-3 rounded-xl shadow-lg border ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[s.jsxs("p",{className:`font-bold text-sm mb-2 ${t?"text-white":"text-slate-900"}`,children:[" ",Ve.name]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-xs flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-brand-500 rounded-full"}),s.jsxs("span",{className:t?"text-slate-300":"text-slate-600",children:[": ",Ve.calls]})]}),s.jsxs("p",{className:"text-xs flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),s.jsxs("span",{className:t?"text-slate-300":"text-slate-600",children:[": ",Ve.successful]})]}),Ve.calls>0&&s.jsxs("p",{className:"text-xs font-medium text-amber-500 mt-1",children:[Ve.rate,"% "]})]})]})}return null}}),s.jsx(bm,{dataKey:"calls",radius:[8,8,0,0],barSize:32,fill:he,name:" "}),s.jsx(bm,{dataKey:"successful",radius:[8,8,0,0],barSize:32,fill:_e,name:""})]})})}):s.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[200px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ft,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"   "})]})})]})]}),s.jsx(Sj,{lead:b,onClose:()=>j(null)})]})},iR=v.createContext(null),lR=()=>{const e=v.useContext(iR);if(!e)throw new Error("useDashboardCustomization must be used within DashboardCustomizationProvider");return e},fce=({orgId:e,children:t})=>{const[r,n]=v.useState([]),[a,l]=v.useState(["calls","conversions","avgDuration","aiScore"]),[c,d]=v.useState(!0),h=v.useRef(null),f=v.useRef(r),m=v.useRef(a);f.current=r,m.current=a,v.useEffect(()=>{x()},[e]);const g=v.useCallback(async()=>{const{data:{session:C}}=await ge.auth.getSession();return C!=null&&C.access_token?{Authorization:`Bearer ${C.access_token}`,"Content-Type":"application/json"}:null},[]),x=async()=>{try{const C=await g();if(!C){d(!1);return}const A=e?`?organizationId=${e}`:"",S=await(await fetch(`/api/dashboard/layout${A}`,{headers:C})).json();S.success&&(n(S.hidden_widgets||[]),l(S.kpi_selection||["calls","conversions","avgDuration","aiScore"]))}catch(C){console.error("[DashboardCustomization] Load error:",C)}finally{d(!1)}},b=v.useCallback(async(C,A)=>{try{const E=await g();if(!E)return;await fetch("/api/dashboard/layout",{method:"PUT",headers:E,body:JSON.stringify({organizationId:e,hidden_widgets:C,kpi_selection:A})})}catch(E){console.error("[DashboardCustomization] Save error:",E)}},[e,g]),j=v.useCallback((C,A)=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{b(C,A)},500)},[b]),w=v.useCallback(C=>{const A=f.current.includes(C)?f.current.filter(E=>E!==C):[...f.current,C];n(A),j(A,m.current)},[j]),_=v.useCallback(C=>{l(C),j(f.current,C)},[j]),N=v.useCallback(async()=>{try{const C=await g();if(!C)return;const A=e?`?organizationId=${e}`:"";await fetch(`/api/dashboard/layout${A}`,{method:"DELETE",headers:C}),n([]),l(["calls","conversions","avgDuration","aiScore"])}catch(C){console.error("[DashboardCustomization] Reset error:",C)}},[e,g]);return s.jsx(iR.Provider,{value:{hiddenWidgets:r,kpiSelection:a,loading:c,toggleWidgetVisibility:w,updateKPISelection:_,resetToDefaults:N},children:t})},mce=[{id:"kpis",label:"  (KPIs)"},{id:"live-activity",label:" "},{id:"goal-progress",label:" "},{id:"ai-insights",label:" AI"},{id:"pipeline",label:" "},{id:"team-performance",label:" "},{id:"attention-queue",label:"  "}],pce=[{id:"calls",label:" "},{id:"conversions",label:"  ()"},{id:"avgDuration",label:" "},{id:"aiScore",label:" AI"}],gce=()=>{const[e,t]=v.useState(!1),{hiddenWidgets:r,kpiSelection:n,toggleWidgetVisibility:a,updateKPISelection:l,resetToDefaults:c}=lR();return s.jsxs(s.Fragment,{children:[s.jsxs(je,{variant:"secondary",size:"sm",onClick:()=>t(!0),className:"flex items-center gap-2",children:[s.jsx(Iu,{className:"w-4 h-4"}),""]}),s.jsx(sR,{isOpen:e,onClose:()=>t(!1),title:"   Dashboard",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-3 text-slate-900 dark:text-white",children:" "}),s.jsx("div",{className:"space-y-1",children:mce.map(d=>{const h=r.includes(d.id);return s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 p-2.5 rounded-lg transition-colors",children:[s.jsx("input",{type:"checkbox",checked:!h,onChange:()=>a(d.id),className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"}),s.jsx("span",{className:`text-sm ${h?"text-slate-400":"text-slate-700 dark:text-slate-200"}`,children:d.label})]},d.id)})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-3 text-slate-900 dark:text-white",children:"  (4 )"}),s.jsx("div",{className:"space-y-1",children:pce.map(d=>{const h=n.includes(d.id);return s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 p-2.5 rounded-lg transition-colors",children:[s.jsx("input",{type:"checkbox",checked:h,disabled:!h&&n.length>=4,onChange:()=>{const f=h?n.filter(m=>m!==d.id):[...n,d.id];l(f)},className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:d.label})]},d.id)})})]}),s.jsx("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700",children:s.jsxs(je,{variant:"secondary",onClick:()=>{confirm("      ?      .")&&(c(),t(!1))},className:"flex items-center gap-2 text-rose-600 hover:text-rose-700 hover:bg-rose-50 dark:hover:bg-rose-900/20",children:[s.jsx(Ru,{className:"w-4 h-4"}),"   "]})})]})})]})},xce=({teamProgress:e,loading:t})=>{const r=[{label:"",current:e.calls.current,target:e.calls.target,percentage:e.calls.percentage,icon:vr,barColor:"#6366f1"},{label:"",current:e.meetings.current,target:e.meetings.target,percentage:e.meetings.percentage,icon:Lc,barColor:"#2563eb"},{label:"",current:e.deals.current,target:e.deals.target,percentage:e.deals.percentage,icon:sl,barColor:"#059669"}];return s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden h-full",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[s.jsx("div",{className:"px-5 py-4",style:{borderBottom:"1px solid #f1f5f9"},children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(vr,{className:"w-4 h-4",style:{color:"#6366f1"},strokeWidth:1.5}),s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#1e293b"},children:" "})]})}),s.jsx("div",{className:"px-5 py-4 space-y-5",children:t?s.jsxs("div",{className:"flex items-center justify-center py-6 gap-2",children:[s.jsx("div",{className:"w-4 h-4 rounded-full animate-spin",style:{border:"2px solid #e5e7eb",borderTopColor:"#6366f1"}}),s.jsx("span",{className:"text-[13px]",style:{color:"#94a3b8"},children:"..."})]}):r.map((n,a)=>{const l=n.percentage>=100,c=l?"#059669":n.barColor;return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-[13px] font-medium",style:{color:"#475569"},children:n.label}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-[15px] font-bold",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums"},children:n.current}),s.jsxs("span",{className:"text-[11px]",style:{color:"#94a3b8"},children:["/ ",n.target]})]})]}),s.jsx("div",{className:"h-1 rounded-full overflow-hidden",style:{background:"#e5e7eb"},children:s.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${Math.min(100,n.percentage)}%`,backgroundColor:c}})}),s.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[s.jsx("span",{className:"text-[11px]",style:{color:"#94a3b8"},children:l?s.jsxs("span",{className:"flex items-center gap-1",style:{color:"#059669"},children:[s.jsx(Ct,{className:"w-3 h-3"})," "]}):` ${n.target-n.current}`}),s.jsxs("span",{className:"text-[12px] font-bold",style:{color:c,fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:[n.percentage,"%"]})]})]},a)})})]})},bce=({insights:e,loading:t})=>{const r=a=>({AlertTriangle:_n,TrendingUp:Lc,TrendingDown:Jd,Target:vr,Lightbulb:su})[a]||su,n=a=>{switch(a){case"warning":return{iconColor:"#d97706",dotColor:"#f59e0b",bgHover:"#fffbeb"};case"opportunity":return{iconColor:"#059669",dotColor:"#10b981",bgHover:"#ecfdf5"};case"success":return{iconColor:"#2563eb",dotColor:"#3b82f6",bgHover:"#eff6ff"};default:return{iconColor:"#64748b",dotColor:"#94a3b8",bgHover:"#f8fafc"}}};return s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[s.jsxs("div",{className:"px-5 py-4 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(si,{className:"w-4 h-4",style:{color:"#2563eb"},strokeWidth:1.5}),s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#1e293b"},children:""})]}),e.length>0&&s.jsx("span",{className:"text-[11px] font-semibold px-2 py-0.5 rounded-full",style:{background:"#f1f5f9",color:"#64748b"},children:e.length})]}),s.jsx("div",{className:"px-5 py-4",children:t?s.jsxs("div",{className:"flex items-center justify-center py-6 gap-2",children:[s.jsx("div",{className:"w-4 h-4 rounded-full animate-spin",style:{border:"2px solid #e5e7eb",borderTopColor:"#2563eb"}}),s.jsx("span",{className:"text-[13px]",style:{color:"#94a3b8"},children:"..."})]}):e.length===0?s.jsxs("div",{className:"text-center py-10",children:[s.jsx("div",{className:"w-12 h-12 rounded-full mx-auto mb-4 flex items-center justify-center",style:{background:"#d1fae5"},children:s.jsx(su,{className:"w-5 h-5",style:{color:"#059669"},strokeWidth:1.5})}),s.jsx("p",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "}),s.jsx("p",{className:"text-[13px] mt-2 leading-relaxed",style:{color:"#64748b"},children:"    "})]}):s.jsx("div",{className:"space-y-2",children:e.map((a,l)=>{const c=r(a.icon),d=n(a.type);return s.jsx("div",{className:"p-3 rounded-md transition-colors cursor-default hover:bg-[#f8fafc]",style:{border:"1px solid transparent"},onMouseEnter:h=>h.currentTarget.style.borderColor="#e5e7eb",onMouseLeave:h=>h.currentTarget.style.borderColor="transparent",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(c,{className:"w-4 h-4 mt-0.5 shrink-0",style:{color:d.iconColor},strokeWidth:1.5}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-[13px] font-semibold leading-snug",style:{color:"#1e293b"},children:a.title}),s.jsx("p",{className:"text-[12px] mt-0.5 leading-relaxed",style:{color:"#64748b"},children:a.description}),s.jsxs("button",{className:"text-[12px] font-medium mt-1.5 hover:underline",style:{color:d.iconColor},children:[a.action," "]})]})]})},l)})})})]})},vce=({activities:e,loading:t})=>{const[r,n]=v.useState(new Date);v.useEffect(()=>{const h=setInterval(()=>n(new Date),1e3);return()=>clearInterval(h)},[]);const a=h=>{const f=Math.floor((r.getTime()-new Date(h).getTime())/1e3);if(f<60)return` ${f} `;const m=Math.floor(f/60);return m<60?` ${m} `:` ${Math.floor(m/60)} `},l=h=>{if(!h)return"";const f=Math.floor(h/60),m=h%60;return`${f}:${m.toString().padStart(2,"0")}`},c=h=>{switch(h){case"in_call":return{icon:ft,color:"#059669",dotColor:"#10b981"};case"call_ended":return{icon:uw,color:"#2563eb",dotColor:"#3b82f6"};default:return{icon:Pr,color:"#94a3b8",dotColor:"#cbd5e1"}}},d=e.filter(h=>h.action==="in_call").length;return s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[s.jsxs("div",{className:"px-5 py-4 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(si,{className:"w-4 h-4",style:{color:"#059669"},strokeWidth:1.5}),s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#1e293b"},children:"  "})]}),d>0&&s.jsxs("span",{className:"text-[11px] font-semibold px-2 py-0.5 rounded-full flex items-center gap-1.5",style:{background:"#ecfdf5",color:"#059669"},children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full animate-pulse",style:{background:"#10b981"}}),d," "]})]}),s.jsx("div",{className:"max-h-72 overflow-y-auto",children:t?s.jsxs("div",{className:"flex items-center justify-center py-8 gap-2",children:[s.jsx("div",{className:"w-4 h-4 rounded-full animate-spin",style:{border:"2px solid #e5e7eb",borderTopColor:"#059669"}}),s.jsx("span",{className:"text-[13px]",style:{color:"#94a3b8"},children:"..."})]}):e.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Pr,{className:"w-6 h-6 mx-auto mb-2",style:{color:"#d1d5db"},strokeWidth:1.5}),s.jsx("p",{className:"text-[13px] font-medium",style:{color:"#64748b"},children:"  "}),s.jsx("p",{className:"text-[12px] mt-0.5",style:{color:"#94a3b8"},children:"  "})]}):e.map(h=>{const f=c(h.action),m=f.icon,g=h.action==="in_call";return s.jsxs("div",{className:"flex items-center gap-3 px-5 py-3 hover:bg-[#fafbfc] transition-colors",style:{borderBottom:"1px solid #f8fafc"},children:[s.jsxs("div",{className:"relative shrink-0",children:[s.jsx("img",{src:h.agentAvatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(h.agentName)}&background=random&size=32`,alt:"",className:"w-8 h-8 rounded-full"}),g&&s.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full",style:{background:"#10b981",border:"2px solid white"}})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[13px] font-medium truncate",style:{color:"#1e293b"},children:h.agentName}),s.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[s.jsx(m,{className:"w-3 h-3",style:{color:f.color}}),s.jsxs("span",{className:"text-[12px]",style:{color:"#64748b"},children:[h.action==="in_call"&&` ${h.duration?l(h.duration):""}`,h.action==="call_ended"&&" ",h.action==="idle"&&""]}),h.quality!==void 0&&s.jsxs("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded",style:{background:h.quality>=80?"#ecfdf5":h.quality>=60?"#fffbeb":"#fef2f2",color:h.quality>=80?"#059669":h.quality>=60?"#d97706":"#dc2626"},children:[h.quality,"%"]})]})]}),s.jsx("span",{className:"text-[10px] whitespace-nowrap shrink-0",style:{color:"#94a3b8"},children:a(h.timestamp)})]},h.id)})})]})};function yce(e){const t=new Date(e);return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`}const wce=({callSid:e,ws:t,onClose:r})=>{const[n,a]=v.useState([]),[l,c]=v.useState([]),[d,h]=v.useState(null),[f,m]=v.useState(""),[g,x]=v.useState({}),[b,j]=v.useState(!1),[w,_]=v.useState(!0),N=v.useRef(null),[C,A]=v.useState(!1);v.useEffect(()=>{requestAnimationFrame(()=>A(!0))},[]);const E=()=>{A(!1),setTimeout(r,200)},S=v.useCallback(I=>{try{const $=JSON.parse(I.data);if($.callSid&&$.callSid!==e)return;switch($.type){case"listen_status":j($.listening);break;case"transcript_history":a($.history||[]);break;case"coaching_history":if($.history&&$.history.length>0){c($.history);const M=$.history[$.history.length-1];M.score!==void 0&&h(M.score),M.stage&&m(M.stage),M.score_breakdown&&x(M.score_breakdown)}break;case"live_transcript":$.isFinal&&a(M=>{const R=M[M.length-1];if(R&&R.role===$.role&&$.timestamp-R.timestamp<3e3){const F=[...M];return F[F.length-1]={...R,text:$.text},F}return[...M,{role:$.role,text:$.text,timestamp:$.timestamp}]});break;case"live_coaching":c(M=>[...M,{...$,timestamp:Date.now()}]),$.score!==void 0&&h($.score),$.stage&&m($.stage),$.score_breakdown&&x($.score_breakdown);break}}catch{}},[e]);v.useEffect(()=>(t.addEventListener("message",S),t.readyState===1&&t.send(JSON.stringify({type:"start_listening",callSid:e})),()=>{t.removeEventListener("message",S),t.readyState===1&&t.send(JSON.stringify({type:"stop_listening"}))}),[t,e,S]),v.useEffect(()=>{var I;(I=N.current)==null||I.scrollIntoView({behavior:"smooth"})},[n]);const T=I=>I>=75?"text-emerald-600 dark:text-emerald-400":I>=50?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400",D=I=>I>=75?"bg-emerald-500":I>=50?"bg-amber-500":"bg-red-500",P={discovery:" ",presentation:" ",objection_handling:" ",closing:"",rapport:" ",engagement:""};return s.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",style:{opacity:C?1:0},onClick:E}),s.jsxs("div",{className:"relative w-full max-w-lg bg-white dark:bg-slate-900 border-l border-slate-200 dark:border-slate-800 shadow-2xl flex flex-col transition-transform duration-200 ease-out",style:{transform:C?"translateX(0)":"translateX(100%)"},children:[s.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between bg-gradient-to-l from-indigo-50 dark:from-indigo-950/20 to-transparent",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-9 h-9 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:s.jsx(PE,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[" ",b&&s.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-medium text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-2 py-0.5 rounded-full",children:[s.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),"LIVE"]})]}),s.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-0.5",children:f&&`: ${f}`})]})]}),s.jsx("button",{onClick:E,className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400 transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),d!==null&&s.jsxs("div",{className:"px-5 py-3 border-b border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/30",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-2xl font-bold ${T(d)}`,children:d}),s.jsx("span",{className:"text-xs text-slate-400",children:"/100"})]}),s.jsx("span",{className:"text-xs text-slate-500 font-medium",children:f})]}),s.jsx("div",{className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${D(d)}`,style:{width:`${d}%`}})}),Object.keys(g).length>0&&s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2.5",children:Object.entries(g).map(([I,$])=>{const M=Number($)||0;return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-[10px] text-slate-400 mb-0.5",children:P[I]||I}),s.jsx("div",{className:`text-xs font-bold ${M<40?"text-red-500":M<60?"text-amber-500":"text-emerald-500"}`,children:M})]},I)})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-2 border-b border-slate-100 dark:border-slate-800 sticky top-0 bg-white dark:bg-slate-900 z-10",children:[s.jsx("span",{className:"text-xs font-bold text-slate-500",children:" "}),s.jsx("button",{onClick:()=>_(!w),className:`text-[10px] px-2 py-1 rounded-full transition-colors ${w?"bg-indigo-100 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400":"bg-slate-100 text-slate-500 dark:bg-slate-800"}`,children:w?" ":" "})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[n.length===0&&s.jsxs("div",{className:"text-center py-10",children:[s.jsx(Av,{className:"w-8 h-8 text-slate-300 dark:text-slate-600 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-slate-400",children:" ..."})]}),n.map((I,$)=>s.jsx("div",{className:`flex ${I.role==="agent"?"justify-start":"justify-end"}`,children:s.jsxs("div",{className:`max-w-[85%] rounded-xl px-3.5 py-2 ${I.role==="agent"?"bg-indigo-50 dark:bg-indigo-950/30 text-indigo-900 dark:text-indigo-200":"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[I.role==="agent"?s.jsx(XL,{className:"w-3 h-3 text-indigo-500"}):s.jsx(Rn,{className:"w-3 h-3 text-slate-400"}),s.jsx("span",{className:"text-[10px] font-bold opacity-60",children:I.role==="agent"?"":""}),s.jsx("span",{className:"text-[10px] opacity-40 mr-auto",children:yce(I.timestamp)})]}),s.jsx("p",{className:"text-xs leading-relaxed",children:I.text})]})},$)),w&&l.length>0&&s.jsx(s.Fragment,{children:l.slice(-3).map((I,$)=>s.jsxs("div",{className:"mx-4 p-2.5 rounded-lg border border-amber-200 dark:border-amber-900/50 bg-amber-50 dark:bg-amber-950/20",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[s.jsx(Xn,{className:"w-3 h-3 text-amber-600"}),s.jsx("span",{className:"text-[10px] font-bold text-amber-700 dark:text-amber-400",children:" AI"}),I.severity==="warning"&&s.jsx(_n,{className:"w-3 h-3 text-amber-500"})]}),s.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-300 leading-relaxed",children:I.message}),I.suggested_reply&&s.jsxs("div",{className:"mt-1.5 p-2 bg-white dark:bg-slate-900 rounded border border-amber-200 dark:border-amber-800",children:[s.jsx("span",{className:"text-[10px] text-amber-600 font-medium",children:" :"}),s.jsx("p",{className:"text-xs text-slate-700 dark:text-slate-300 mt-0.5",children:I.suggested_reply})]})]},`coaching-${$}`))}),s.jsx("div",{ref:N})]})]}),s.jsx("div",{className:"px-5 py-3 border-t border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/30",children:s.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[b?s.jsx(Av,{className:"w-4 h-4 text-emerald-500"}):s.jsx(r7,{className:"w-4 h-4"}),s.jsx("span",{children:b?"   ":" ..."})]}),s.jsxs("span",{children:[n.length," "]})]})})]})]})},jce={critical:{bg:"bg-red-50 dark:bg-red-950/30",border:"border-red-200 dark:border-red-900/50",text:"text-red-700 dark:text-red-400",badge:"bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-400",pulse:"animate-pulse",dot:"bg-red-500",label:""},high:{bg:"bg-orange-50 dark:bg-orange-950/30",border:"border-orange-200 dark:border-orange-900/50",text:"text-orange-700 dark:text-orange-400",badge:"bg-orange-100 dark:bg-orange-900/40 text-orange-700 dark:text-orange-400",pulse:"",dot:"bg-orange-500",label:""},medium:{bg:"bg-amber-50 dark:bg-amber-950/30",border:"border-amber-200 dark:border-amber-900/50",text:"text-amber-700 dark:text-amber-400",badge:"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-400",pulse:"",dot:"bg-amber-500",label:""},low:{bg:"bg-slate-50 dark:bg-slate-800/50",border:"border-slate-200 dark:border-slate-700",text:"text-slate-600 dark:text-slate-400",badge:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400",pulse:"",dot:"bg-slate-400",label:""}},_ce={critical_score:jm,low_score:Jd,declining_score:Jd,unhandled_objections:E2,competitor_mentioned:LL,customer_frustration:e$,weak_discovery:si,weak_objection_handling:E2,weak_closing:Jd,stuck_stage:Pr,long_struggling_call:aL,golden_moment:Nr,lost_momentum:al,negative_tone:c$,score_downtrend:Jd};function kce(e){const t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().padStart(2,"0")}`}const Nce=({orgId:e})=>{const[t,r]=v.useState([]),[n,a]=v.useState([]),[l,c]=v.useState(!1),[d,h]=v.useState(!1),[f,m]=v.useState(null),[g,x]=v.useState(!1),b=v.useRef(null),j=v.useRef(null),w=v.useCallback(async()=>{if(e)try{const{data:{session:S}}=await ge.auth.getSession(),T=S==null?void 0:S.access_token;if(!T){console.error("[Manager WS] No auth token");return}const D=window.location.protocol==="https:"?"wss:":"ws:",P=new WebSocket(`${D}//${window.location.host}/ws/manager?orgId=${e}&token=${encodeURIComponent(T)}`);b.current=P,P.onopen=()=>{c(!0),P.send(JSON.stringify({type:"get_alerts"})),P.send(JSON.stringify({type:"get_active_calls"}))},P.onmessage=I=>{try{const $=JSON.parse(I.data);switch($.type){case"monitor_connected":r($.activeAlerts||[]);break;case"attention_alert":r(M=>{const R=M.findIndex(F=>F.id===$.alert.id);if(R>=0){const F=[...M];return F[R]=$.alert,F}return[$.alert,...M]});break;case"attention_resolved":case"attention_ended":r(M=>M.filter(R=>R.callSid!==$.callSid)),$.type==="attention_ended"&&a(M=>M.filter(R=>R.callSid!==$.callSid));break;case"attention_dismissed":r(M=>M.filter(R=>R.callSid!==$.callSid));break;case"alerts_list":r($.alerts||[]);break;case"active_calls":a($.calls||[]);break;case"call_update":a(M=>{const R=M.findIndex(F=>F.callSid===$.callSid);if(R>=0){const F=[...M];return F[R]={...F[R],lastScore:$.score,currentStage:$.stage,alertLevel:$.alertLevel},F}return[...M,{callSid:$.callSid,agentName:$.agentName,agentId:"",leadName:"",currentStage:$.stage,lastScore:$.score,alertLevel:$.alertLevel,duration:0}]});break}}catch{}},P.onclose=()=>{c(!1),j.current=setTimeout(w,3e3)},P.onerror=()=>P.close()}catch(S){console.error("[Manager WS] Connection error:",S)}},[e]);v.useEffect(()=>(w(),()=>{b.current&&b.current.close(),j.current&&clearTimeout(j.current)}),[w]),v.useEffect(()=>{if(!b.current||b.current.readyState!==1)return;const S=setInterval(()=>{var T;(T=b.current)==null||T.send(JSON.stringify({type:"get_active_calls"}))},15e3);return()=>clearInterval(S)},[l]);const _=S=>{b.current&&b.current.readyState===1&&b.current.send(JSON.stringify({type:"dismiss_alert",callSid:S}))},N=S=>{m(S)},C=t.filter(S=>S.severity==="critical").length,A=t.filter(S=>S.severity==="high").length,E=t.length;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[s.jsxs("button",{onClick:()=>h(!d),className:"w-full px-5 py-4 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center relative ${E>0?"bg-amber-50 dark:bg-amber-950/30":"bg-slate-50 dark:bg-slate-800"}`,children:[s.jsx(_n,{className:`w-5 h-5 ${E>0?"text-amber-600 dark:text-amber-400":"text-slate-400 dark:text-slate-500"}`}),C>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-amber-500 rounded-full animate-ping opacity-75"})]}),s.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"  "}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[E>0&&s.jsx("span",{className:"text-xs font-bold bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 px-2 py-0.5 rounded-full",children:E}),l?s.jsx(o7,{className:"w-3 h-3 text-emerald-500"}):s.jsx(i7,{className:"w-3 h-3 text-slate-400"})]})]}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 transition-transform ${d?"rotate-180":""}`})]}),!d&&s.jsx("div",{className:"px-5 pb-4",children:E>0?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`text-2xl font-bold ${C>0?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"}`,children:E}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"  "}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[C>0&&s.jsxs("span",{className:"text-[10px] font-bold text-red-600 bg-red-50 dark:bg-red-900/20 px-1.5 py-0.5 rounded",children:[C," "]}),A>0&&s.jsxs("span",{className:"text-[10px] font-bold text-orange-600 bg-orange-50 dark:bg-orange-900/20 px-1.5 py-0.5 rounded",children:[A," "]})]})]})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:n.length}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:n.length>0?"  -  ":"   "})]})}),d&&s.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-800",children:[E>0?s.jsx("div",{className:"p-3 space-y-2",children:t.map(S=>{const T=jce[S.severity];return s.jsxs("div",{className:`rounded-lg border p-3 ${T.bg} ${T.border} ${T.pulse} transition-all`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${T.dot} shrink-0`}),s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:S.agentName}),s.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${T.badge}`,children:T.label})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{onClick:()=>N(S.callSid),className:"p-1.5 rounded-lg bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-200 dark:hover:bg-indigo-800/40 transition-colors",title:" ",children:s.jsx(PE,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>_(S.callSid),className:"p-1.5 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-400 transition-colors",title:" ",children:s.jsx(Lt,{className:"w-3.5 h-3.5"})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 mb-2 text-[11px] text-slate-500 dark:text-slate-400",children:[s.jsxs("span",{children:[" : ",s.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:S.leadName})]}),s.jsx("span",{children:"|"}),s.jsxs("span",{children:[": ",s.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:S.stage||" "})]}),s.jsx("span",{children:"|"}),s.jsxs("span",{children:[": ",s.jsx("strong",{className:`${S.score<40?"text-red-600":S.score<60?"text-orange-600":"text-slate-700 dark:text-slate-300"}`,children:S.score})]}),s.jsx("span",{children:"|"}),s.jsx("span",{children:kce(S.callDuration)})]}),s.jsx("div",{className:"space-y-1",children:S.reasons.map((D,P)=>{const I=_ce[D.type]||_n;return s.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[s.jsx(I,{className:`w-3 h-3 shrink-0 ${T.text}`}),s.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:D.text})]},P)})})]},S.id)})}):s.jsxs("div",{className:"p-4 text-center",children:[s.jsx("p",{className:"text-sm text-emerald-600 dark:text-emerald-400 font-medium mb-1",children:" "}),s.jsx("p",{className:"text-xs text-slate-400",children:"    "})]}),n.length>0&&s.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-800 px-3 pb-3",children:[s.jsxs("button",{onClick:()=>x(!g),className:"w-full flex items-center justify-between py-2.5 text-xs text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 transition-colors",children:[s.jsxs("span",{className:"font-medium",children:["  (",n.length,")"]}),s.jsx(Pt,{className:`w-3 h-3 transition-transform ${g?"rotate-180":""}`})]}),g&&s.jsx("div",{className:"space-y-1.5",children:n.map(S=>s.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-slate-50 dark:bg-slate-800/50 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${S.alertLevel==="critical"?"bg-red-500 animate-pulse":S.alertLevel==="high"?"bg-orange-500":S.alertLevel==="medium"?"bg-amber-500":"bg-emerald-500"}`}),s.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:S.agentName}),S.lastScore!=null&&s.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${S.lastScore<40?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":S.lastScore<60?"bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400":"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400"}`,children:S.lastScore})]}),s.jsx("button",{onClick:()=>N(S.callSid),className:"p-1 rounded text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",title:" ",children:s.jsx(wm,{className:"w-3.5 h-3.5"})})]},S.callSid))})]})]})]}),f&&b.current&&s.jsx(wce,{callSid:f,ws:b.current,onClose:()=>m(null)})]})},Sce=e=>s.jsx(fce,{orgId:e.orgId,children:s.jsx(Tce,{...e})}),fE=e=>{if(e&&(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")))return e},oR="dashboard_cache",Cce=6e4,Ece=e=>{try{const t=sessionStorage.getItem(`${oR}_${e}`);if(!t)return null;const{data:r,ts:n}=JSON.parse(t);return Date.now()-n>Cce?null:r}catch{return null}},Ace=(e,t)=>{try{sessionStorage.setItem(`${oR}_${e}`,JSON.stringify({data:t,ts:Date.now()}))}catch{}},va=({className:e="",style:t})=>s.jsx("div",{className:`animate-pulse rounded ${e}`,style:{background:"#e5e7eb",...t}}),mE=()=>s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[0,1,2,3].map(e=>s.jsxs("div",{className:"bg-white rounded-lg p-5",style:{border:"1px solid #e5e7eb"},children:[s.jsx(va,{className:"w-5 h-5 rounded mb-4"}),s.jsx(va,{className:"w-20 h-12 rounded mb-2"}),s.jsx(va,{className:"w-24 h-4 rounded"})]},e))}),Gs=({lines:e=3})=>s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb"},children:[s.jsxs("div",{className:"px-5 py-4 flex items-center gap-2.5",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsx(va,{className:"w-4 h-4 rounded"}),s.jsx(va,{className:"w-28 h-4 rounded"})]}),s.jsx("div",{className:"p-5 space-y-3",children:Array.from({length:e}).map((t,r)=>s.jsx(va,{className:"w-full h-4 rounded",style:{opacity:1-r*.15}},r))})]}),Tce=({isDarkMode:e,orgId:t,onNavigate:r,userName:n,centerType:a="sales"})=>{var dr;const{hiddenWidgets:l}=lR(),[c,d]=v.useState(""),[h,f]=v.useState("all"),[m,g]=v.useState(!1),[x,b]=v.useState(!1),[j,w]=v.useState([]),[_,N]=v.useState([]),[C,A]=v.useState([]),[E,S]=v.useState([]),[T,D]=v.useState([]),[P,I]=v.useState([]),[$,M]=v.useState([]),[R,F]=v.useState([]),[V,H]=v.useState(null),[L,U]=v.useState([]),[W,le]=v.useState({pipeline:!1,team:!1,attention:!1}),ve=Y=>le(Z=>({...Z,[Y]:!Z[Y]})),[B,G]=v.useState(!1),[ie,he]=v.useState(!1),[_e,Ee]=v.useState(!1),[we,ye]=v.useState(!0),ke=(()=>{const Y=new Date().getHours();return Y>=5&&Y<12?" ":Y>=12&&Y<18?" ":Y>=18&&Y<22?" ":" "})(),Te=Y=>{switch(Y){case"":return"day";case"":return"day";case"":case"7  ":return"week";case"30  ":return"month";case" ":return"month";default:return"day"}},J=Y=>{switch(Y){case"":return 1;case"":return 2;case"":case"7  ":return 7;case"30  ":case" ":return 30;default:return 7}},Le=Math.max(...E.length?E.map(Y=>Y.value):[0])*1.1||1e3;v.useEffect(()=>{if(!t){ye(!1);return}const Y=Ece(t);Y&&(Y.teamMembers&&w(Y.teamMembers),Y.kpis&&(A(Y.kpis),G(!0)),Y.insights&&F(Y.insights),Y.goalProgress&&H(Y.goalProgress),Y.liveActivity&&U(Y.liveActivity),Y.funnelData&&S(Y.funnelData),Y.teamPerformance&&N(Y.teamPerformance),Y.attentionQueue&&D(Y.attentionQueue),Y.topDeals&&I(Y.topDeals),he(!0),Ee(!0),ye(!1)),(async()=>{var fe,Ve,rt,pe,qe,nt,ae,Ne,Ge,vt;try{const{data:{session:st}}=await ge.auth.getSession(),mt={Authorization:`Bearer ${st==null?void 0:st.access_token}`,"Content-Type":"application/json"},wt=Te(c),ct=h!=="all"?`&userId=${h}`:"",dt=`?range=${wt}&organizationId=${t}${ct}`,Zr=J(c),ws=await Promise.allSettled([ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",t),fetch(`/api/panel/stats${dt}`,{headers:mt})]),[dn,Ae]=ws.map(be=>be.status==="fulfilled"?be.value:null);let tt=[];dn&&"data"in dn&&dn.data&&(tt=dn.data.map(be=>({id:be.id,name:be.full_name,avatar:be.avatar_url,role:be.role})),w(tt));let pt=[];if(Ae&&"json"in Ae){const be=await Ae.json();if(be.success){const Oe=be.stats;a==="support"?pt=[{label:" ",value:((fe=Oe.leadsContacted)==null?void 0:fe.current)||0,subtext:`: ${((Ve=Oe.leadsContacted)==null?void 0:Ve.target)||0}`,trend:"+0%",trendDirection:"neutral",icon:Ct},{label:" ",value:((rt=Oe.appointments)==null?void 0:rt.current)||0,subtext:" ",trend:"0",trendDirection:"neutral",icon:Kr},{label:" -SLA",value:`${((pe=Oe.closedDeals)==null?void 0:pe.percentage)||0}%`,subtext:"",trend:"0%",trendDirection:"neutral",icon:sl},{label:"  ",value:Oe.qualityScore||0,subtext:"",trend:"0",trendDirection:"neutral",icon:vr}]:pt=[{label:'" ',value:((qe=Oe.leadsContacted)==null?void 0:qe.current)||0,subtext:`: ${((nt=Oe.leadsContacted)==null?void 0:nt.target)||0}`,trend:"+0%",trendDirection:"neutral",icon:ft},{label:" ",value:((ae=Oe.appointments)==null?void 0:ae.current)||0,subtext:`: ${((Ne=Oe.appointments)==null?void 0:Ne.target)||0}`,trend:"+0%",trendDirection:"neutral",icon:wn},{label:"  ()",value:`${((Ge=Oe.closedDeals)==null?void 0:Ge.percentage)||0}%`,subtext:"30  ",trend:"0%",trendDirection:"neutral",icon:vr},{label:"  ",value:Oe.qualityScore||0,subtext:"",trend:"0",trendDirection:"neutral",icon:sl}],A(pt)}}G(!0),ye(!1);const te=await Promise.allSettled([fetch(`/api/panel/daily-insights?organizationId=${t}`,{headers:mt}),fetch(`/api/panel/goal-progress?organizationId=${t}`,{headers:mt}),fetch(`/api/panel/live-activity?limit=10&organizationId=${t}`,{headers:mt})]),[ze,Pe,gt]=te.map(be=>be.status==="fulfilled"?be.value:null);let et=[],Et=null,Ot=[];if(ze&&"json"in ze){const be=await ze.json();be.success&&(et=be.insights||[],F(et))}if(Pe&&"json"in Pe){const be=await Pe.json();be.success&&(Et=be.teamProgress,H(Et))}if(gt&&"json"in gt){const be=await gt.json();be.success&&(Ot=be.activities||[],U(Ot))}he(!0);const er=await Promise.allSettled([fetch(`/api/pipeline/funnel${dt}`,{headers:mt}),fetch(`/api/panel/at-risk-leads?limit=5&organizationId=${t}${ct}`,{headers:mt}),fetch(`/api/panel/top-deals?limit=5&organizationId=${t}${ct}`,{headers:mt}),fetch(`/api/panel/quality-trend?days=${Zr}&organizationId=${t}${ct}`,{headers:mt}),fetch(`/api/analytics/team-performance?organizationId=${t}&range=${wt}`,{headers:mt})]),[un,ur,Sr,Ut,Ye]=er.map(be=>be.status==="fulfilled"?be.value:null);let Gt=[],hr=[],X=[],Se=[];if(un&&"json"in un){const be=await un.json();be.success&&(Gt=(be.funnel||[]).map(Oe=>({name:Oe.label,value:Oe.totalValue||0,count:Oe.count,color:Oe.color})),S(Gt))}if(ur&&"json"in ur){const be=await ur.json();be.success&&(hr=be.leads||[],D(hr))}if(Sr&&"json"in Sr){const be=await Sr.json();be.success&&(X=be.deals||[],I(X))}if(Ut&&"json"in Ut){const be=await Ut.json();be.success&&M(be.trend||[])}if(Ye&&"json"in Ye){const be=await Ye.json();if(be.success){const Oe=Array.isArray(be.performance)?be.performance:((vt=be.performance)==null?void 0:vt.performance)||[];Se=Oe,N(Oe)}}Ee(!0),Ace(t,{teamMembers:tt,kpis:pt,insights:et,goalProgress:Et,liveActivity:Ot,funnelData:Gt,teamPerformance:Se,attentionQueue:hr,topDeals:X})}catch(st){console.error("Error fetching dashboard data:",st),ye(!1),G(!0),he(!0),Ee(!0)}})()},[t,c,h]);const $e=()=>{let Y="data:text/csv;charset=utf-8,";Y+="  - "+c+`

`,Y+=` 
,,,
`,C.forEach(fe=>{Y+=`${fe.label},${fe.value},${fe.goal||"-"},${fe.change||"-"}%
`}),Y+=`
 
,
`,E.forEach(fe=>{Y+=`${fe.name},${fe.value}
`}),Y+=`
 
,,,
`,P.forEach(fe=>{Y+=`${fe.name},${fe.value},${fe.owner},${fe.stage}
`}),Y+=`

,
`,j.forEach(fe=>{Y+=`${fe.name||fe.full_name},${fe.role}
`});const Z=document.createElement("a");Z.setAttribute("href",encodeURI(Y)),Z.setAttribute("download",`sales_report_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)};if(we&&C.length===0)return s.jsx("div",{className:"flex-1 overflow-y-auto",style:{background:"#fafbfc"},children:s.jsxs("div",{className:"max-w-[1440px] mx-auto px-6 lg:px-10 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsx(va,{className:"w-48 h-7 rounded mb-2"}),s.jsx(va,{className:"w-64 h-4 rounded"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(va,{className:"w-[130px] h-9 rounded"}),s.jsx(va,{className:"w-[130px] h-9 rounded"})]})]}),s.jsx(mE,{}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-5 mb-8",children:[s.jsx("div",{className:"lg:col-span-7",children:s.jsx(Gs,{lines:4})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsx(Gs,{lines:3})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5",children:[s.jsx(Gs,{lines:3}),s.jsx(Gs,{lines:3}),s.jsx(Gs,{lines:3})]})]})});const ut=[{icon:ft,color:"#6366f1"},{icon:wn,color:"#2563eb"},{icon:vr,color:"#059669"},{icon:sl,color:"#94a3b8"}],yt=Y=>{if(!Y)return!1;const Z=Y.replace(/[+\-%]/g,"").trim();return Z!=="0"&&Z!==""},Dt=Y=>Y==="up"?s.jsx(ou,{className:"w-3 h-3"}):Y==="down"?s.jsx(NE,{className:"w-3 h-3"}):s.jsx(Zl,{className:"w-3 h-3"}),Zt=Y=>Y==="up"?"#059669":Y==="down"?"#dc2626":"#94a3b8";return s.jsx("div",{className:"flex-1 overflow-y-auto",style:{background:"#fafbfc"},children:s.jsxs("div",{className:"max-w-[1440px] mx-auto px-6 lg:px-10 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-[22px] font-semibold leading-tight",style:{color:"#0f172a"},children:[ke,", ",n||""]}),s.jsx("p",{className:"text-[13px] mt-1",style:{color:"#64748b"},children:a==="support"?"      ":"     "})]}),s.jsxs("div",{className:"flex items-center gap-2 relative z-20",children:[s.jsx(gce,{}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{className:"hidden sm:inline-flex items-center justify-between gap-2 h-9 px-3 bg-white rounded-md text-[13px] font-medium hover:bg-[#f8fafc] transition-all min-w-[130px]",style:{border:"1px solid #e2e8f0",color:"#475569"},onClick:()=>{b(!x),g(!1)},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Kr,{className:"w-[14px] h-[14px]",style:{color:"#94a3b8"}}),s.jsx("span",{className:"truncate max-w-[80px]",children:h==="all"?" ":(dr=j.find(Y=>Y.id===h))==null?void 0:dr.name})]}),s.jsx(Pt,{className:`w-3 h-3 transition-transform ${x?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),x&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>b(!1)}),s.jsxs("div",{className:"absolute top-full left-0 mt-1.5 w-52 bg-white rounded-lg z-20 py-1 overflow-hidden",style:{border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:[s.jsxs("button",{onClick:()=>{f("all"),b(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] transition-colors flex items-center justify-between",style:{background:h==="all"?"#e0f2fe":"transparent",color:h==="all"?"#0284c7":"#475569"},children:[s.jsx("span",{children:" "}),h==="all"&&s.jsx(Ct,{className:"w-3.5 h-3.5"})]}),s.jsx("div",{style:{height:"1px",background:"#f1f5f9",margin:"2px 0"}}),s.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:j.map(Y=>s.jsxs("button",{onClick:()=>{f(Y.id),b(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] transition-colors flex items-center justify-between hover:bg-[#f1f5f9]",style:{background:h===Y.id?"#e0f2fe":"transparent",color:h===Y.id?"#0284c7":"#475569"},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:fE(Y.avatar)||"https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y",className:"w-5 h-5 rounded-full object-cover",alt:""}),s.jsx("span",{className:"truncate",children:Y.name})]}),h===Y.id&&s.jsx(Ct,{className:"w-3.5 h-3.5"})]},Y.id))})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{className:"inline-flex items-center justify-between gap-2 h-9 px-3 bg-white rounded-md text-[13px] font-medium hover:bg-[#f8fafc] transition-all min-w-[130px]",style:{border:"1px solid #e2e8f0",color:"#475569"},onClick:()=>{g(!m),b(!1)},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(wn,{className:"w-[14px] h-[14px]",style:{color:"#94a3b8"}}),s.jsx("span",{children:c})]}),s.jsx(Pt,{className:`w-3 h-3 transition-transform ${m?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),m&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>g(!1)}),s.jsx("div",{className:"absolute top-full left-0 mt-1.5 w-44 bg-white rounded-lg z-20 py-1",style:{border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:["","","7  ","30  "," "].map(Y=>s.jsxs("button",{onClick:()=>{d(Y),g(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] transition-colors flex items-center justify-between hover:bg-[#f1f5f9]",style:{background:c===Y?"#e0f2fe":"transparent",color:c===Y?"#0284c7":"#475569",fontWeight:c===Y?500:400},children:[s.jsx("span",{children:Y}),c===Y&&s.jsx(Ct,{className:"w-3.5 h-3.5"})]},Y))})]})]}),s.jsxs("button",{onClick:$e,className:"h-9 px-3 bg-white rounded-md text-[13px] font-medium hover:bg-[#f8fafc] transition-all inline-flex items-center gap-1.5",style:{border:"1px solid #e2e8f0",color:"#475569"},title:" ",children:[s.jsx(Du,{className:"w-[14px] h-[14px]"}),s.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),!l.includes("kpis")&&(B?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:C.map((Y,Z)=>{const fe=ut[Z]||ut[0],Ve=Y.icon||fe.icon;return s.jsxs("div",{className:"bg-white rounded-lg p-5 hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all duration-200 cursor-default",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03), 0 1px 3px rgba(0,0,0,0.02)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(Ve,{className:"w-[18px] h-[18px]",style:{color:fe.color,opacity:.6},strokeWidth:1.5}),yt(Y.trend)&&s.jsxs("span",{className:"text-[11px] font-semibold flex items-center gap-0.5",style:{color:Zt(Y.trendDirection||"neutral")},children:[Dt(Y.trendDirection||"neutral"),Y.trend]})]}),s.jsx("div",{className:"text-[48px] font-bold leading-none",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:Y.value}),s.jsx("div",{className:"text-[13px] font-medium mt-2",style:{color:"#64748b"},children:Y.label})]},Z)})}):s.jsx(mE,{})),ie?s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-5 mb-8",children:[s.jsxs("div",{className:"lg:col-span-7 space-y-5",children:[!l.includes("ai-insights")&&s.jsx(bce,{insights:R,loading:!1}),!l.includes("live-activity")&&s.jsx(vce,{activities:L,loading:!1})]}),s.jsx("div",{className:"lg:col-span-3",children:!l.includes("goal-progress")&&s.jsx(xce,{teamProgress:V||{calls:{current:0,target:10,percentage:0},meetings:{current:0,target:3,percentage:0},deals:{current:0,target:1,percentage:0}},loading:!1})})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-5 mb-8",children:[s.jsxs("div",{className:"lg:col-span-7 space-y-5",children:[s.jsx(Gs,{lines:4}),s.jsx(Gs,{lines:3})]}),s.jsx("div",{className:"lg:col-span-3",children:s.jsx(Gs,{lines:4})})]}),_e?s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5",children:[!l.includes("pipeline")&&s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[s.jsxs("button",{onClick:()=>ve("pipeline"),className:"w-full px-5 py-4 flex items-center justify-between hover:bg-[#f8fafc] transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(hc,{className:"w-4 h-4",style:{color:"#6366f1"},strokeWidth:1.5}),s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#1e293b"},children:" "})]}),s.jsx(Pt,{className:`w-4 h-4 transition-transform ${W.pipeline?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),!W.pipeline&&s.jsxs("div",{className:"px-5 pb-4",children:[s.jsxs("span",{className:"text-[36px] font-bold ltr",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:["",E.reduce((Y,Z)=>Y+(Z.value||0),0).toLocaleString()]}),s.jsx("p",{className:"text-[12px] mt-0.5",style:{color:"#94a3b8"},children:'" '})]}),W.pipeline&&s.jsx("div",{className:"px-5 pb-5 space-y-3 pt-4",style:{borderTop:"1px solid #f1f5f9"},children:E.length===0?s.jsx("p",{className:"text-[13px] text-center py-4",style:{color:"#94a3b8"},children:"  "}):E.map((Y,Z)=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"w-16 text-[12px] font-medium truncate text-right shrink-0",style:{color:"#64748b"},children:Y.name}),s.jsx("div",{className:"flex-1 h-1.5 rounded-full overflow-hidden",style:{background:"#e5e7eb"},children:s.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${Y.value/Le*100}%`,backgroundColor:"#6366f1",opacity:.6+Z*.1}})}),s.jsxs("span",{className:"text-[12px] font-semibold w-14 text-left shrink-0 ltr",style:{color:"#334155",fontVariantNumeric:"tabular-nums"},children:["",(Y.value/1e3).toLocaleString(),"k"]})]},Z))})]}),!l.includes("team-performance")&&s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[s.jsxs("button",{onClick:()=>ve("team"),className:"w-full px-5 py-4 flex items-center justify-between hover:bg-[#f8fafc] transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(Kr,{className:"w-4 h-4",style:{color:"#059669"},strokeWidth:1.5}),s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#1e293b"},children:" "})]}),s.jsx(Pt,{className:`w-4 h-4 transition-transform ${W.team?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),!W.team&&s.jsxs("div",{className:"px-5 pb-4",children:[s.jsx("span",{className:"text-[36px] font-bold",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:j.length}),s.jsx("p",{className:"text-[12px] mt-0.5",style:{color:"#94a3b8"},children:" "})]}),W.team&&s.jsx("div",{style:{borderTop:"1px solid #f1f5f9"},children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-right border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{style:{background:"#f8fafc"},children:[s.jsx("th",{className:"py-2 px-3 text-[11px] font-medium uppercase",style:{color:"#64748b",letterSpacing:"0.05em"},children:""}),s.jsx("th",{className:"py-2 px-2 text-[11px] font-medium uppercase text-center",style:{color:"#64748b",letterSpacing:"0.05em"},children:""}),s.jsx("th",{className:"py-2 px-3 text-[11px] font-medium uppercase text-left",style:{color:"#64748b",letterSpacing:"0.05em"},children:""})]})}),s.jsx("tbody",{children:_.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:3,className:"text-center py-8 text-[13px]",style:{color:"#94a3b8"},children:"  "})}):_.slice(0,5).map(Y=>s.jsxs("tr",{className:"hover:bg-[#fafbfc] transition-colors",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsx("td",{className:"py-2.5 px-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:fE(Y.avatar)||`https://ui-avatars.com/api/?name=${encodeURIComponent(Y.name)}&background=random&size=24`,alt:"",className:"w-6 h-6 rounded-full"}),s.jsx("span",{className:"text-[13px] font-medium truncate max-w-[80px]",style:{color:"#334155"},children:Y.name})]})}),s.jsx("td",{className:"py-2.5 px-2 text-center text-[13px] font-semibold",style:{color:"#334155",fontVariantNumeric:"tabular-nums"},children:Y.calls||0}),s.jsxs("td",{className:"py-2.5 px-3 text-left text-[13px] font-semibold ltr",style:{color:"#059669",fontVariantNumeric:"tabular-nums"},children:["",(Y.revenue||0).toLocaleString()]})]},Y.id))})]})})})]}),!l.includes("attention-queue")&&s.jsx(Nce,{orgId:t})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5",children:[s.jsx(Gs,{lines:3}),s.jsx(Gs,{lines:3}),s.jsx(Gs,{lines:3})]})]})})},Oce=({leads:e,onSelectLead:t,selectedIds:r,onToggleSelect:n,onToggleSelectAll:a,sortConfig:l,onSort:c,onUpdateLead:d,onDeleteLead:h,statuses:f=[]})=>{const[m,g]=Ur.useState(null),x=e.length>0&&r.length===e.length;Ur.useEffect(()=>{const _=()=>g(null);return m&&window.addEventListener("click",_),()=>window.removeEventListener("click",_)},[m]);const b=_=>{switch(_){case"Website":return" ";case"LinkedIn":return"";case"Facebook Ads":return"";case"Referral":return"";case"Webinar":return"";default:return _}},j=({columnKey:_})=>l.key!==_?s.jsx("div",{className:"w-3 h-3"}):l.direction==="asc"?s.jsx(XI,{className:"w-3 h-3 text-brand-600"}):s.jsx(FI,{className:"w-3 h-3 text-brand-600"}),w=_=>{if(!_)return"-";const N=new Date(_);return!isNaN(N.getTime())&&(_.includes("T")||_.includes("-"))?new Intl.DateTimeFormat("he-IL",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(N):_};return s.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm overflow-hidden",style:{minHeight:"400px"},children:s.jsx("div",{className:"overflow-visible",children:s.jsxs("table",{className:"w-full text-right border-collapse",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-xs text-slate-500 font-semibold uppercase border-b border-slate-100 dark:border-slate-800 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 w-12",children:s.jsx("input",{type:"checkbox",checked:x,onChange:a,className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500 cursor-pointer"})}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group",onClick:()=>c("name"),children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[" ",s.jsx(j,{columnKey:"name"})]})}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group",onClick:()=>c("status"),children:s.jsxs("div",{className:"flex items-center gap-1.5",children:["",s.jsx(j,{columnKey:"status"})]})}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group",onClick:()=>c("lastActivity"),children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[" ",s.jsx(j,{columnKey:"lastActivity"})]})}),s.jsx("th",{className:"px-6 py-4",children:" "}),s.jsx("th",{className:"px-4 py-4 w-10"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:e.map(_=>{var C,A;const N=f.find(E=>E.id===_.status);return s.jsxs("tr",{onClick:E=>{E.target.closest('input[type="checkbox"]')||E.target.closest("button")||t(_)},className:`
                    group cursor-pointer transition-colors
                    ${r.includes(_.id)?"bg-brand-50/50 dark:bg-brand-900/10":"hover:bg-slate-50 dark:hover:bg-slate-800/30"}
                  `,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>n(_.id),className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500 cursor-pointer"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-bold text-slate-900 dark:text-white text-sm",children:_.name}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mt-0.5",children:_.phone})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[s.jsx(Na,{className:"w-3.5 h-3.5 text-slate-400"}),_.company]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border border-transparent",style:{backgroundColor:N?`${N.color}20`:"#f1f5f9",color:N?N.color:"#64748b"},children:N?N.label:_.status})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[(C=_.owner)!=null&&C.avatar?s.jsx("img",{src:_.owner.avatar,alt:"",className:"w-6 h-6 rounded-full border border-white dark:border-slate-700"}):s.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 dark:bg-slate-700"}),s.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-300 truncate max-w-[80px]",children:(A=_.owner)==null?void 0:A.name})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded",children:b(_.source)})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"flex items-center gap-1.5",children:s.jsxs("div",{className:"relative w-8 h-8 flex items-center justify-center",children:[s.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 32 32",children:[s.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",strokeWidth:"3",className:"stroke-slate-100 dark:stroke-slate-800"}),s.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",strokeWidth:"3",className:`${(_.score||0)>80?"stroke-emerald-500":(_.score||0)>50?"stroke-amber-500":"stroke-rose-500"}`,strokeDasharray:"75.4",strokeDashoffset:75.4-75.4*(_.score||0)/100,strokeLinecap:"round"})]}),s.jsx("span",{className:"absolute text-[10px] font-bold text-slate-700 dark:text-slate-300",children:_.score})]})})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:w(_.lastActivity)})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-600 dark:text-slate-300",children:[s.jsx(S9,{className:"w-3.5 h-3.5 text-brand-500"}),_.nextStep]})}),s.jsxs("td",{className:"px-4 py-4 text-left relative",children:[s.jsx("button",{onClick:E=>{E.stopPropagation(),g(m===_.id?null:_.id)},className:`p-1.5 rounded-lg transition-colors ${m===_.id?"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white":"text-slate-400 hover:text-brand-600 hover:bg-brand-50 dark:hover:bg-brand-900/20"}`,children:s.jsx(pw,{className:"w-4 h-4"})}),m===_.id&&s.jsxs("div",{className:"absolute left-8 top-8 w-40 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-100 text-right",children:[s.jsx("button",{onClick:E=>{E.stopPropagation(),t(_),g(null)},className:"w-full text-right px-4 py-2.5 text-sm hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 block",children:""}),h&&s.jsx("button",{onClick:E=>{E.stopPropagation(),confirm("  ?")&&h(_.id),g(null)},className:"w-full text-right px-4 py-2.5 text-sm hover:bg-rose-50 dark:hover:bg-rose-900/10 text-rose-600 block",children:""})]})]})]},_.id)})})]})})})},Pce=({leads:e,onSelectLead:t,onUpdateLead:r,onDeleteLead:n,onAddLead:a,statuses:l})=>{const[c,d]=v.useState(null),[h,f]=v.useState(null),[m,g]=v.useState(null),x=(w,_)=>{d(_),w.dataTransfer.effectAllowed="move"},b=w=>{w.preventDefault(),w.dataTransfer.dropEffect="move"},j=(w,_)=>{if(w.preventDefault(),!c)return;const N=e.find(C=>C.id===c);N&&N.status!==_&&r(c,{status:_}),d(null)};return s.jsx("div",{className:"flex items-start gap-4 h-full overflow-x-auto pb-4",onClick:()=>{f(null),g(null)},children:l.map(w=>{const _=e.filter(N=>N.status===w.id);return s.jsxs("div",{className:"w-72 flex-shrink-0 flex flex-col h-full bg-slate-100/50 dark:bg-slate-900/50 rounded-xl p-3 border border-slate-200/60 dark:border-slate-800/60",onDragOver:b,onDrop:N=>j(N,w.id),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 px-1 relative",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:w.color}}),s.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:w.label}),s.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["(",_.length,")"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:N=>{N.stopPropagation(),g(m===w.id?null:w.id),f(null)},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-200/50 dark:hover:bg-slate-800 rounded transition-colors",children:s.jsx(S2,{className:"w-4 h-4"})}),m===w.id&&s.jsx("div",{className:"absolute top-full left-0 mt-1 w-40 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-xl z-30 overflow-hidden animate-in fade-in zoom-in-95 duration-100",children:s.jsxs("button",{onClick:N=>{N.stopPropagation(),a&&a(w.id),g(null)},className:"w-full text-right px-3 py-2 text-xs hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-2 text-slate-700 dark:text-slate-200",children:[s.jsx(Nn,{className:"w-3.5 h-3.5"}),"   "]})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0 pr-1 pl-1 custom-scrollbar",children:_.map(N=>{var C;return s.jsxs("div",{draggable:!0,onDragStart:A=>x(A,N.id),className:`bg-white dark:bg-slate-900 p-3.5 rounded-lg border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md cursor-grab active:cursor-grabbing transition-all group relative ${c===N.id?"opacity-40 scale-95":"opacity-100"}`,children:[s.jsxs("div",{className:"absolute top-2 left-2 z-10",children:[s.jsx("button",{onClick:A=>{A.stopPropagation(),f(h===N.id?null:N.id),g(null)},className:`p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-opacity ${h===N.id?"opacity-100 bg-slate-100 dark:bg-slate-800":"opacity-0 group-hover:opacity-100"}`,children:s.jsx(S2,{className:"w-4 h-4 text-slate-400"})}),h===N.id&&s.jsxs("div",{className:"absolute top-full left-0 mt-1 w-32 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg z-20 overflow-hidden animate-in fade-in zoom-in-95 duration-100",children:[s.jsxs("button",{onClick:A=>{A.stopPropagation(),t(N),f(null)},className:"w-full text-right px-3 py-2 text-xs hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-2 text-slate-700 dark:text-slate-200",children:[s.jsx(PL,{className:"w-3 h-3"})," "]}),n&&s.jsxs("button",{onClick:A=>{A.stopPropagation(),n(N.id),f(null)},className:"w-full text-right px-3 py-2 text-xs hover:bg-rose-50 dark:hover:bg-rose-900/20 text-rose-600 flex items-center gap-2",children:[s.jsx(sa,{className:"w-3 h-3"})," "]})]})]}),s.jsxs("div",{onClick:()=>t(N),children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-tight",children:N.company||""}),N.priority==="Hot"&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-rose-500 shadow-sm shadow-rose-500/50",title:""})]}),s.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm mb-3 group-hover:text-brand-600 transition-colors line-clamp-2",children:N.name}),s.jsxs("div",{className:"flex items-center justify-between mt-auto pt-3 border-t border-slate-50 dark:border-slate-800",children:[s.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 font-mono tracking-tight",children:N.value}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-[10px] font-bold ${N.score&&N.score>80?"text-emerald-600":"text-slate-400"}`,children:N.score}),((C=N.owner)==null?void 0:C.avatar)&&s.jsx("img",{src:N.owner.avatar,className:"w-5 h-5 rounded-full border border-white dark:border-slate-800",alt:""})]})]})]})]},N.id)})}),s.jsxs("button",{onClick:()=>a&&a(w.id),className:"mt-3 flex items-center justify-center gap-2 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-800 rounded-lg transition-colors border border-dashed border-transparent hover:border-slate-300 dark:hover:border-slate-700",children:[s.jsx(Nn,{className:"w-3.5 h-3.5"})," "]})]},w.id)})})},Dce=({isOpen:e,onClose:t,onSave:r,initialData:n,teamMembers:a=[]})=>{const[l,c]=v.useState({name:"",company:"",status:"New",source:"Website",ownerId:"",phone:"",email:"",website:"",value:"",tags:[],notes:""}),[d,h]=v.useState({}),[f,m]=v.useState(!1);v.useEffect(()=>{var w;e&&(c({name:(n==null?void 0:n.name)||"",company:(n==null?void 0:n.company)||"",status:(n==null?void 0:n.status)||"New",source:(n==null?void 0:n.source)||"Website",ownerId:((w=n==null?void 0:n.owner)==null?void 0:w.id)||(a.length>0?a[0].id:""),phone:(n==null?void 0:n.phone)||"",email:(n==null?void 0:n.email)||"",website:(n==null?void 0:n.website)||"",value:n!=null&&n.value?String(n.value).replace(/[^0-9.]/g,""):"",tags:(n==null?void 0:n.tags)||["SaaS"],notes:(n==null?void 0:n.notes)||""}),h({}))},[e,n]);const g=(w,_)=>{c(N=>({...N,[w]:_})),d[w]&&h(N=>{const C={...N};return delete C[w],C})},x=()=>{const w=prompt("  :");w&&!l.tags.includes(w)&&g("tags",[...l.tags,w])},b=w=>{g("tags",l.tags.filter(_=>_!==w))},j=async()=>{const w={};if(l.name.trim()||(w.name="   "),l.status||(w.status="  "),Object.keys(w).length>0){h(w);return}m(!0);const _={name:l.name,company:l.company,status:l.status,source:l.source,phone:l.phone,email:l.email,value:l.value?`${l.value}`:"0",tags:l.tags,owner:a.find(N=>N.id===l.ownerId)};m(!0);try{await r(_),t()}catch(N){console.error(N)}finally{m(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[60] transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:t}),s.jsxs("div",{className:`fixed inset-y-0 right-0 z-[70] w-full md:w-[520px] bg-slate-50 dark:bg-slate-950 shadow-2xl transform transition-transform duration-300 ease-in-out flex flex-col ${e?"translate-x-0":"translate-x-full"}`,children:[s.jsxs("div",{className:"flex-shrink-0 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 px-6 py-5 flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400 flex items-center justify-center border border-brand-100 dark:border-brand-800",children:s.jsx(Rn,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white leading-tight",children:l.name||" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-0.5",children:"   "})]})]}),s.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[s.jsx(Rn,{className:"w-3.5 h-3.5"}),"  "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:["  ",s.jsx("span",{className:"text-rose-500",children:"*"})]}),s.jsx("input",{type:"text",value:l.name,onChange:w=>g("name",w.target.value),className:`w-full px-3 py-2 bg-white dark:bg-slate-950 border rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all ${d.name?"border-rose-300 focus:ring-rose-200":"border-slate-200 dark:border-slate-700"}`,placeholder:":  "}),d.name&&s.jsxs("p",{className:"text-xs text-rose-500 mt-1 flex items-center gap-1",children:[s.jsx(cu,{className:"w-3 h-3"})," ",d.name]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(Na,{className:"absolute top-2.5 right-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",value:l.company,onChange:w=>g("company",w.target.value),className:"w-full pr-9 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all",placeholder:"  "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:[" ",s.jsx("span",{className:"text-rose-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:l.status,onChange:w=>g("status",w.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none appearance-none",children:[s.jsx("option",{value:"New",children:" "}),s.jsx("option",{value:"Discovery",children:" "}),s.jsx("option",{value:"Negotiation",children:'"'}),s.jsx("option",{value:"Proposal",children:" "}),s.jsx("option",{value:"Closed",children:""})]}),s.jsx(Pt,{className:"absolute top-3 left-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:l.source,onChange:w=>g("source",w.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none appearance-none",children:[s.jsx("option",{value:"Website",children:" "}),s.jsx("option",{value:"LinkedIn",children:""}),s.jsx("option",{value:"Facebook Ads",children:""}),s.jsx("option",{value:"Referral",children:""}),s.jsx("option",{value:"Webinar",children:""})]}),s.jsx(Pt,{className:"absolute top-3 left-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" (Owner)"}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:l.ownerId,onChange:w=>g("ownerId",w.target.value),className:"w-full pr-3 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none appearance-none",children:a.map(w=>s.jsx("option",{value:w.id,children:w.name},w.id))}),s.jsx(Pt,{className:"absolute top-3 left-3 w-4 h-4 text-slate-400 pointer-events-none"})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[s.jsx(ft,{className:"w-3.5 h-3.5"}),"  "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(ft,{className:"absolute top-2.5 right-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"tel",value:l.phone,onChange:w=>g("phone",w.target.value),className:"w-full pr-9 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all dir-ltr text-right",placeholder:"050-0000000"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute top-2.5 right-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"email",value:l.email,onChange:w=>g("email",w.target.value),className:"w-full pr-9 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all dir-ltr text-right",placeholder:"name@example.com"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(vc,{className:"absolute top-2.5 right-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"url",value:l.website,onChange:w=>g("website",w.target.value),className:"w-full pr-9 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all dir-ltr text-right",placeholder:"https://..."})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[s.jsx(ZI,{className:"w-3.5 h-3.5"}),"  "]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute top-2 right-3 text-slate-400 text-sm",children:""}),s.jsx("input",{type:"number",value:l.value,onChange:w=>g("value",w.target.value),className:"w-full pr-7 pl-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all",placeholder:"0.00"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"  ()"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[l.tags.map(w=>s.jsxs("span",{className:"flex items-center gap-1 bg-brand-50 dark:bg-brand-900/30 text-brand-700 dark:text-brand-300 px-2 py-1 rounded text-xs border border-brand-100 dark:border-brand-800",children:[w,s.jsx("button",{onClick:()=>b(w),className:"hover:text-brand-900",children:s.jsx(Lt,{className:"w-3 h-3"})})]},w)),s.jsxs("button",{onClick:x,className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-2 py-1 rounded text-xs hover:bg-slate-200 transition-colors",children:[s.jsx(Nn,{className:"w-3 h-3"}),"  "]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsx("textarea",{value:l.notes,onChange:w=>g("notes",w.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 outline-none transition-all h-24 resize-none",placeholder:"    ..."})]})]})]})]}),s.jsxs("div",{className:"flex-shrink-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 p-4 flex justify-between items-center gap-4",children:[s.jsx(je,{variant:"ghost",onClick:t,className:"text-slate-500",children:""}),s.jsxs(je,{onClick:j,disabled:f,className:"w-full md:w-auto px-8",children:[f?"...":" ",!f&&s.jsx(Or,{className:"w-4 h-4 ml-2"})]})]})]})]})},Mce={name:" ",company:"",phone:"",email:"",status:"",source:"",value:" "},Rce=["New","Discovery","Negotiation","Proposal","Closed"],Ice=["Website","LinkedIn","Facebook Ads","Referral","Webinar"],$ce={" ":"New",:"New",new:"New"," ":"Discovery",discovery:"Discovery"," ":"Negotiation",negotiation:"Negotiation"," ":"Proposal",proposal:"Proposal",:"Closed",closed:"Closed"},Lce={" ":"Website",:"Website",website:"Website",:"LinkedIn",linkedin:"LinkedIn",:"Facebook Ads","facebook ads":"Facebook Ads",facebook:"Facebook Ads",:"Referral",referral:"Referral",:"Webinar",webinar:"Webinar"},zce=({isOpen:e,onClose:t,onImport:r,teamMembers:n})=>{const[a,l]=v.useState(null),[c,d]=v.useState([]),[h,f]=v.useState([]),[m,g]=v.useState(!1),[x,b]=v.useState("upload"),j=v.useRef(null),w=S=>{var D;const T=(D=S.target.files)==null?void 0:D[0];T&&(l(T),_(T))},_=S=>{const T=new FileReader;T.onload=D=>{var H;const I=((H=D.target)==null?void 0:H.result).split(`
`).filter(L=>L.trim());if(I.length<2){f(["     "]);return}const $=I[0].split(",").map(L=>L.trim().toLowerCase().replace(/['"]/g,"")),M={:"name"," ":"name",:"company",:"phone",:"email",:"status",:"source",:"value"," ":"value"},R=$.map(L=>M[L]||L);if(!R.includes("name")){f(['  "" .      .']);return}const F=[],V=[];for(let L=1;L<I.length;L++){const U=N(I[L]);if(U.length===0)continue;const W={};if(R.forEach((le,ve)=>{var G;const B=((G=U[ve])==null?void 0:G.trim().replace(/^["']|["']$/g,""))||"";switch(le){case"name":W.name=B;break;case"company":W.company=B;break;case"phone":W.phone=B;break;case"email":W.email=B;break;case"status":const ie=$ce[B.toLowerCase()]||B;W.status=Rce.includes(ie)?ie:"New";break;case"source":const he=Lce[B.toLowerCase()]||B;W.source=Ice.includes(he)?he:"Website";break;case"value":W.value=B.replace(/[^\d.]/g,"")?`${B.replace(/[^\d.]/g,"")}`:"0";break}}),!W.name){V.push(` ${L+1}:  `);continue}W.status||(W.status="New"),W.source||(W.source="Website"),F.push(W)}if(F.length===0){f(["    "]);return}f(V),d(F),b("preview")},T.readAsText(S)},N=S=>{const T=[];let D="",P=!1;for(let I=0;I<S.length;I++){const $=S[I];$==='"'?P=!P:$===","&&!P?(T.push(D),D=""):D+=$}return T.push(D),T},C=async()=>{g(!0);try{await r(c),b("success")}catch{f(["  .  ."])}finally{g(!1)}},A=()=>{l(null),d([]),f([]),b("upload"),t()},E=()=>{const S=`,,,,,, 
 , ",050-1234567,email@example.com, , ,5000
`,T=new Blob(["\uFEFF"+S],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a");D.href=URL.createObjectURL(T),D.download="leads_template.csv",D.click()};return e?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[60]",onClick:A}),s.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-lg p-6 animate-in zoom-in-95 duration-200",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"   CSV"}),s.jsx("button",{onClick:A,className:"text-slate-400 hover:text-slate-600 p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),x==="upload"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{onClick:()=>{var S;return(S=j.current)==null?void 0:S.click()},className:"border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl p-8 text-center cursor-pointer hover:border-brand-400 hover:bg-brand-50/50 dark:hover:bg-brand-900/10 transition-colors",children:[s.jsx(qE,{className:"w-10 h-10 text-slate-400 mx-auto mb-3"}),s.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"     CSV"}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:" 1000   "}),s.jsx("input",{ref:j,type:"file",accept:".csv",onChange:w,className:"hidden"})]}),s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"  :"}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:"     .  :"}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Object.entries(Mce).map(([S,T])=>s.jsx("span",{className:"text-xs bg-white dark:bg-slate-700 px-2 py-1 rounded border border-slate-200 dark:border-slate-600",children:T},S))}),s.jsxs(je,{variant:"secondary",size:"sm",onClick:E,children:[s.jsx(Du,{className:"w-3.5 h-3.5 ml-1"}),"  "]})]}),h.length>0&&s.jsxs("div",{className:"bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-800 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-rose-600 dark:text-rose-400 mb-1",children:[s.jsx(cu,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-bold",children:""})]}),h.map((S,T)=>s.jsx("p",{className:"text-xs text-rose-600 dark:text-rose-400",children:S},T))]})]}),x==="preview"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-brand-50 dark:bg-brand-900/20 rounded-lg",children:[s.jsx(ps,{className:"w-5 h-5 text-brand-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-brand-700 dark:text-brand-300",children:a==null?void 0:a.name}),s.jsxs("p",{className:"text-xs text-brand-600 dark:text-brand-400",children:[c.length,"  "]})]})]}),s.jsxs("div",{className:"max-h-60 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg",children:[s.jsxs("table",{className:"w-full text-xs text-right",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 font-medium text-slate-600",children:""}),s.jsx("th",{className:"px-3 py-2 font-medium text-slate-600",children:""}),s.jsx("th",{className:"px-3 py-2 font-medium text-slate-600",children:""}),s.jsx("th",{className:"px-3 py-2 font-medium text-slate-600",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:c.slice(0,10).map((S,T)=>s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[s.jsx("td",{className:"px-3 py-2 text-slate-900 dark:text-white",children:S.name}),s.jsx("td",{className:"px-3 py-2 text-slate-500",children:S.phone||"-"}),s.jsx("td",{className:"px-3 py-2 text-slate-500",children:S.status}),s.jsx("td",{className:"px-3 py-2 text-slate-500",children:S.source})]},T))})]}),c.length>10&&s.jsxs("p",{className:"text-xs text-slate-400 text-center py-2",children:[" ",c.length-10,"  ..."]})]}),h.length>0&&s.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:[s.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 font-medium mb-1",children:[" (",h.length,"):"]}),h.slice(0,3).map((S,T)=>s.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:S},T)),h.length>3&&s.jsxs("p",{className:"text-xs text-amber-500",children:[" ",h.length-3,"..."]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[s.jsx(je,{variant:"ghost",onClick:()=>{b("upload"),l(null),d([]),f([])},children:""}),s.jsx(je,{onClick:C,disabled:m,children:m?"...":` ${c.length} `})]})]}),x==="success"&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Or,{className:"w-8 h-8 text-emerald-600"})}),s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"  !"}),s.jsxs("p",{className:"text-sm text-slate-500 mb-6",children:[c.length,"   "]}),s.jsx(je,{onClick:A,children:""})]})]})})]}):null},Bce=({isOpen:e,onClose:t,onAssign:r,teamMembers:n,selectedCount:a})=>{const[l,c]=v.useState(null),[d,h]=v.useState("");if(!e)return null;const f=n.filter(g=>g.name.toLowerCase().includes(d.toLowerCase())),m=()=>{l&&(r(l),t())};return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity",onClick:t}),s.jsxs("div",{className:"relative w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200 border border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[s.jsx(Kr,{className:"w-5 h-5 text-brand-600"})," "]}),s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[" ",a,"    "]})]}),s.jsx("button",{onClick:t,className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsx("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800",children:s.jsxs("div",{className:"relative",children:[s.jsx(na,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:d,onChange:g=>h(g.target.value),className:"w-full pr-10 pl-4 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm focus:ring-2 focus:ring-brand-500 outline-none"})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 max-h-[400px]",children:[f.map(g=>s.jsxs("button",{onClick:()=>c(g.id),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all border ${l===g.id?"bg-brand-50 dark:bg-brand-900/20 border-brand-200 dark:border-brand-800":"bg-transparent border-transparent hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:g.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(g.name)}`,alt:g.name,className:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 object-cover border border-slate-200 dark:border-slate-700"}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:`font-medium text-sm ${l===g.id?"text-brand-700 dark:text-brand-300":"text-slate-900 dark:text-white"}`,children:g.name}),s.jsx("p",{className:"text-xs text-slate-500 capitalize",children:g.role})]})]}),l===g.id&&s.jsx("div",{className:"w-6 h-6 bg-brand-500 rounded-full flex items-center justify-center",children:s.jsx(Or,{className:"w-3.5 h-3.5 text-white"})})]},g.id)),f.length===0&&s.jsx("div",{className:"text-center py-8 text-slate-500",children:"  "})]}),s.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:t,children:""}),s.jsx(je,{className:"flex-1",onClick:m,disabled:!l,children:" "})]})]})]})},Uce=({isOpen:e,onClose:t,organizationId:r})=>{const[n,a]=v.useState(!1),[l,c]=v.useState(!0),[d,h]=v.useState(!1);v.useEffect(()=>{if(!e||!r)return;(async()=>{c(!0);try{const x=await(await fetch(`/api/org/distribution-settings?organizationId=${r}`)).json();x.success&&x.settings&&a(x.settings.auto_distribute||!1)}catch(g){console.error("Failed to fetch distribution settings:",g)}finally{c(!1)}})()},[e,r]);const f=async()=>{h(!0);try{(await(await fetch("/api/org/distribution-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:r,auto_distribute:n,distribution_method:"round_robin"})})).json()).success?t():alert("  ")}catch(m){console.error("Failed to save settings:",m),alert("  ")}finally{h(!1)}};return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:t}),s.jsxs("div",{className:"relative w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-200",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-brand-100 dark:bg-brand-900/30 rounded-xl",children:s.jsx(Iu,{className:"w-5 h-5 text-brand-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("p",{className:"text-xs text-slate-500",children:"  "})]})]}),s.jsx("button",{onClick:t,className:"p-1.5 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsx("div",{className:"p-6",children:l?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(it,{className:"w-6 h-6 text-brand-500 animate-spin"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-emerald-100 dark:bg-emerald-900/30 rounded-lg",children:s.jsx(Ru,{className:"w-4 h-4 text-emerald-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-900 dark:text-white text-sm",children:" "}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"     "})]})]}),s.jsx("button",{onClick:()=>a(!n),className:`relative w-11 h-6 rounded-full transition-colors flex-shrink-0 ${n?"bg-brand-500":"bg-slate-300 dark:bg-slate-600"}`,children:s.jsx("div",{className:`absolute top-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-all duration-200 flex items-center justify-center ${n?"left-0.5":"left-[22px]"}`,children:n&&s.jsx(Or,{className:"w-3 h-3 text-brand-500"})})})]}),n&&s.jsx("div",{className:"p-4 bg-brand-50 dark:bg-brand-900/20 rounded-xl border border-brand-100 dark:border-brand-800/50",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Kr,{className:"w-5 h-5 text-brand-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-brand-800 dark:text-brand-200 text-sm",children:"Round Robin "}),s.jsx("p",{className:"text-xs text-brand-600 dark:text-brand-300 mt-1",children:"        .          ."})]})]})})]})}),s.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:t,children:""}),s.jsxs(je,{className:"flex-1",onClick:f,disabled:l||d,children:[d?s.jsx(it,{className:"w-4 h-4 animate-spin ml-2"}):null,""]})]})]})]}):null},qce=({isDarkMode:e,orgId:t,user:r})=>{var rt;const{leads:n,refreshLeads:a,addLead:l,deleteLead:c,updateLead:d,generateAiScore:h}=rR(void 0,t,r==null?void 0:r.id,r==null?void 0:r.role),{settings:f}=Iw(t),[m,g]=v.useState(()=>typeof window<"u"&&localStorage.getItem("leadsViewMode")||"list");Ur.useEffect(()=>{localStorage.setItem("leadsViewMode",m)},[m]);const[x,b]=v.useState(null),j=n.find(pe=>pe.id===x)||null,[w,_]=v.useState([]),[N,C]=v.useState(""),[A,E]=v.useState({key:"lastActivity",direction:"asc"}),[S,T]=v.useState(!1),[D,P]=v.useState(void 0),[I,$]=v.useState(!1),[M,R]=v.useState(!1),[F,V]=v.useState(!1),H=pe=>{P(pe?{status:pe}:void 0),T(!0)},[L,U]=v.useState(null),[W,le]=v.useState([]),[ve,B]=v.useState([]),[G,ie]=v.useState("all"),[he,_e]=v.useState([]);Ur.useEffect(()=>{(async()=>{if(!t)return;const{data:qe}=await ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",t);qe&&_e(qe.map(nt=>({id:nt.id,name:nt.full_name,avatar:nt.avatar_url||"https://ui-avatars.com/api/?name="+nt.full_name,role:nt.role})))})()},[t]);const Ee=n.filter(pe=>{var Ge,vt,st;const qe=W.length===0||W.includes(pe.status),nt=G==="all"||((Ge=pe.owner)==null?void 0:Ge.id)===G,ae=N.toLowerCase(),Ne=!N||pe.name.toLowerCase().includes(ae)||((vt=pe.company)==null?void 0:vt.toLowerCase().includes(ae))||((st=pe.phone)==null?void 0:st.includes(ae));return qe&&nt&&Ne}),we=(r==null?void 0:r.type)==="manager"||(r==null?void 0:r.type)==="admin"||(r==null?void 0:r.type)==="super_admin",ye=(pe="")=>pe?pe.includes("T")||pe.includes("-")?new Date(pe).getTime():pe.includes("")?parseInt(pe.replace(/\D/g,""))||1:pe.includes("")||pe.includes("")?(parseInt(pe.replace(/\D/g,""))||1)*60:pe.includes("")?0:pe.includes("")?720:pe.includes("")?1440:pe.includes("")?2880:pe.includes("")?10080:999999:999999,ee=[...Ee].sort((pe,qe)=>{const{key:nt,direction:ae}=A;let Ne=0;if(nt==="lastActivity"){const Ge=ye(pe.lastActivity),vt=ye(qe.lastActivity);Ne=Ge-vt}else nt==="name"?Ne=pe.name.localeCompare(qe.name):nt==="status"?Ne=pe.status.localeCompare(qe.status):Ne=String(pe[nt]||"").localeCompare(String(qe[nt]||""));return ae==="asc"?Ne:-Ne}),ke=pe=>{E(qe=>({key:pe,direction:qe.key===pe&&qe.direction==="asc"?"desc":"asc"}))},Te=pe=>{_(qe=>qe.includes(pe)?qe.filter(nt=>nt!==pe):[...qe,pe])},J=()=>{w.length===ee.length?_([]):_(ee.map(pe=>pe.id))},Le=()=>{L==="status"?U(null):(B([...W]),U("status"))},$e=pe=>{B(qe=>qe.includes(pe)?qe.filter(nt=>nt!==pe):[...qe,pe])},ut=()=>{le(ve),U(null)},yt=()=>{B([])},Dt=()=>{U(L==="owner"?null:"owner")},Zt=pe=>{ie(pe),U(null)},dr=()=>{le([]),ie("all"),E({key:"lastActivity",direction:"asc"}),C(""),U(null)},Y=(f==null?void 0:f.pipeline_statuses)||[{id:"New",label:" ",color:"#3B82F6"},{id:"Discovery",label:" ",color:"#8B5CF6"},{id:"Proposal",label:" ",color:"#10B981"},{id:"Negotiation",label:" / ",color:"#EC4899"},{id:"Follow Up",label:"",color:"#F59E0B"},{id:"Closed",label:" - ",color:"#059669"}],Z=async pe=>{try{await l(pe),console.log("SAVE_LEAD_SUCCESS")}catch(qe){console.error("SAVE_LEAD_FAIL",qe),alert("Failed to save lead: "+qe.message)}},fe=async pe=>{for(const qe of pe)try{await l(qe)}catch(nt){console.error("Import failed for lead:",qe.name,nt)}a()},Ve=async pe=>{if(w.length!==0)try{const{error:qe}=await ge.from("leads").update({owner_id:pe}).in("id",w);if(qe)throw qe;a(),_([]),R(!1)}catch(qe){alert("Failed to assign leads: "+qe.message),console.error(qe)}};return s.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col h-full bg-slate-50 dark:bg-slate-950 relative",children:[s.jsxs("div",{className:"px-6 py-6 md:py-8 flex flex-col md:flex-row md:items-center justify-between gap-4 flex-shrink-0",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:""}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-1",children:"    ."})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[we&&s.jsx("button",{onClick:()=>V(!0),className:"p-2 rounded-lg bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 transition-colors",title:"  ",children:s.jsx(Iu,{className:"w-4 h-4"})}),s.jsxs(je,{variant:"secondary",className:"hidden sm:flex",onClick:()=>$(!0),children:[s.jsx(qE,{className:"w-4 h-4 ml-2"}),""]}),s.jsxs(je,{onClick:()=>T(!0),children:[s.jsx(Nn,{className:"w-4 h-4 ml-2"})," "]})]})]}),s.jsx("div",{className:"px-6 pb-6 flex flex-col gap-4 flex-shrink-0",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto flex-1 relative z-20",children:[s.jsxs("div",{className:"relative w-full max-w-sm",children:[s.jsx(na,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",value:N,onChange:pe=>C(pe.target.value),placeholder:"  ,   ...",className:"w-full pr-10 pl-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none transition-all"})]}),s.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[we&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:Dt,className:`flex items-center gap-2 px-3 py-2 border rounded-lg text-sm transition-colors ${L==="owner"||G!=="all"?"bg-brand-50 border-brand-200 text-brand-600 dark:bg-brand-900/20 dark:border-brand-800 dark:text-brand-400":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-300 hover:border-brand-300"}`,children:[s.jsx(gw,{className:"w-3.5 h-3.5"}),G==="all"?"":((rt=he.find(pe=>pe.id===G))==null?void 0:rt.name)||"Unknown",s.jsx(Pt,{className:`w-3 h-3 opacity-50 transition-transform ${L==="owner"?"rotate-180":""}`})]}),L==="owner"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(null)}),s.jsxs("div",{className:"absolute top-full left-0 mt-2 w-56 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-20 overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-200",children:[s.jsxs("div",{className:"p-1.5 max-h-64 overflow-y-auto",children:[s.jsxs("button",{onClick:()=>Zt("all"),className:`w-full text-right px-3 py-2 rounded-lg text-sm flex items-center justify-between group transition-colors ${G==="all"?"bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-200"}`,children:[s.jsx("span",{children:" "}),G==="all"&&s.jsx("div",{className:"w-2 h-2 bg-brand-600 rounded-full"})]}),he.map(pe=>s.jsxs("button",{onClick:()=>Zt(pe.id),className:`w-full text-right px-3 py-2 rounded-lg text-sm flex items-center justify-between group transition-colors ${G===pe.id?"bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:pe.avatar,className:"w-5 h-5 rounded-full",alt:""}),s.jsx("span",{children:pe.name})]}),G===pe.id&&s.jsx("div",{className:"w-2 h-2 bg-brand-600 rounded-full"})]},pe.id))]}),s.jsx("div",{className:"p-2 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50",children:s.jsx("button",{onClick:()=>Zt("all"),className:"text-xs text-slate-500 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 px-2 py-1",children:""})})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:Le,className:`flex items-center gap-2 px-3 py-2 border rounded-lg text-sm transition-colors ${L==="status"||W.length>0?"bg-brand-50 border-brand-200 text-brand-600 dark:bg-brand-900/20 dark:border-brand-800 dark:text-brand-400":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-300 hover:border-brand-300"}`,children:[W.length>0?`  ${W.length} `:"",s.jsx(Pt,{className:`w-3 h-3 opacity-50 transition-transform ${L==="status"?"rotate-180":""}`})]}),L==="status"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(null)}),s.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-20 overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-200",children:[s.jsx("div",{className:"p-1.5 space-y-0.5 max-h-72 overflow-y-auto",children:Y.map(pe=>{const qe=ve.includes(pe.id);return s.jsxs("label",{className:`flex items-center justify-between px-3 py-2.5 rounded-lg cursor-pointer transition-colors ${qe?"bg-slate-50 dark:bg-slate-800/60":"hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-all ${qe?"bg-brand-600 border-brand-600 text-white":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800"}`,children:qe&&s.jsx(Or,{className:"w-3 h-3"})}),s.jsx("span",{className:`text-sm ${qe?"font-medium text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300"}`,children:pe.label})]}),s.jsx("input",{type:"checkbox",className:"hidden",checked:qe,onChange:()=>$e(pe.id)})]},pe.id)})}),s.jsxs("div",{className:"p-3 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex justify-between items-center",children:[s.jsx("button",{onClick:yt,className:"text-xs font-medium text-slate-500 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 px-2 py-1",children:""}),s.jsx(je,{size:"sm",onClick:ut,className:"h-7 text-xs",children:""})]})]})]})]}),s.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-700 mx-1"}),s.jsx("button",{onClick:dr,className:"text-sm text-brand-600 dark:text-brand-400 font-medium hover:underline disabled:opacity-50 disabled:no-underline",disabled:W.length===0&&G==="all"&&A.key==="lastActivity"&&A.direction==="asc",children:" "})]})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 dark:bg-slate-800 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>g("list"),className:`p-1.5 rounded-md transition-all ${m==="list"?"bg-white dark:bg-slate-700 text-brand-600 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700"}`,title:" ",children:s.jsx(b$,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>g("kanban"),className:`p-1.5 rounded-md transition-all ${m==="kanban"?"bg-white dark:bg-slate-700 text-brand-600 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700"}`,title:" ",children:s.jsx(g$,{className:"w-4 h-4"})})]})]})}),w.length>0&&s.jsxs("div",{className:"absolute top-[140px] left-1/2 -translate-x-1/2 z-20 bg-slate-900 text-white px-6 py-3 rounded-xl shadow-lg flex items-center gap-6 animate-in slide-in-from-top-2 fade-in duration-200",children:[s.jsxs("span",{className:"font-medium text-sm border-l border-slate-700 pl-4 ml-2",children:[w.length," "]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 text-sm text-slate-300 hover:text-white px-2 py-1 rounded hover:bg-white/10 transition-colors",children:[s.jsx(hu,{className:"w-4 h-4"})," "]}),s.jsxs("button",{className:"flex items-center gap-2 text-sm text-slate-300 hover:text-white px-2 py-1 rounded hover:bg-white/10 transition-colors",children:[s.jsx(GI,{className:"w-4 h-4"})," "]}),s.jsxs("button",{onClick:async()=>{if(confirm(`     ${w.length} ?`)){for(const pe of w)await c(pe);_([])}},className:"flex items-center gap-2 text-sm text-rose-300 hover:text-rose-100 px-2 py-1 rounded hover:bg-rose-500/20 transition-colors",children:[s.jsx(sa,{className:"w-4 h-4"}),""]})]}),s.jsx("button",{onClick:()=>_([]),className:"text-xs text-slate-500 hover:text-white underline mr-2",children:""})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-6 min-h-0",children:ee.length>0?m==="list"?s.jsx(Oce,{leads:ee,onSelectLead:pe=>b(pe.id),selectedIds:w,onToggleSelect:Te,onToggleSelectAll:J,sortConfig:A,onSort:ke,onUpdateLead:(pe,qe)=>d(pe,qe),onDeleteLead:pe=>c(pe),statuses:Y}):s.jsx(Pce,{leads:ee,onSelectLead:pe=>b(pe.id),onUpdateLead:(pe,qe)=>d(pe,qe),onAddLead:H,statuses:Y,onDeleteLead:pe=>{confirm("      ?")&&c(pe)}}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-white dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800 border-dashed",children:[s.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mb-4",children:s.jsx(na,{className:"w-8 h-8 text-slate-400"})}),s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:"  "}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm max-w-xs mx-auto mb-4",children:"           ."}),s.jsxs(je,{variant:"secondary",onClick:dr,children:[s.jsx(Ru,{className:"w-4 h-4 ml-2"})," "]})]})}),s.jsx(Sj,{lead:j,onClose:()=>b(null),updateLead:d,generateAiScore:h,teamMembers:he}),s.jsx(Dce,{isOpen:S,onClose:()=>T(!1),onSave:Z,initialData:D,teamMembers:he}),s.jsx(zce,{isOpen:I,onClose:()=>$(!1),onImport:fe,teamMembers:he}),s.jsx(Bce,{isOpen:M,onClose:()=>R(!1),onAssign:Ve,teamMembers:he,selectedCount:w.length}),t&&s.jsx(Uce,{isOpen:F,onClose:()=>V(!1),organizationId:t})]})},pE=["linear-gradient(90deg, #3b82f6 0%, #2563eb 100%)","linear-gradient(90deg, #8b5cf6 0%, #7c3aed 100%)","linear-gradient(90deg, #06b6d4 0%, #0891b2 100%)","linear-gradient(90deg, #f59e0b 0%, #d97706 100%)","linear-gradient(90deg, #10b981 0%, #059669 100%)"],cR="pipeline_cache",Fce=6e4,Hce=e=>{try{const t=sessionStorage.getItem(`${cR}_${e}`);if(!t)return null;const{data:r,ts:n}=JSON.parse(t);return Date.now()-n>Fce?null:r}catch{return null}},Vce=(e,t)=>{try{sessionStorage.setItem(`${cR}_${e}`,JSON.stringify({data:t,ts:Date.now()}))}catch{}},Is=({className:e="",style:t})=>s.jsx("div",{className:`animate-pulse rounded ${e}`,style:{background:"#e5e7eb",...t}}),gE=()=>s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[0,1,2,3].map(e=>s.jsxs("div",{className:"bg-white rounded-lg p-5",style:{border:"1px solid #e5e7eb"},children:[s.jsx(Is,{className:"w-5 h-5 rounded mb-4"}),s.jsx(Is,{className:"w-20 h-12 rounded mb-2"}),s.jsx(Is,{className:"w-24 h-4 rounded"})]},e))}),Ji=({lines:e=4})=>s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb"},children:[s.jsxs("div",{className:"px-5 py-4 flex items-center gap-2.5",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsx(Is,{className:"w-4 h-4 rounded"}),s.jsx(Is,{className:"w-28 h-4 rounded"})]}),s.jsx("div",{className:"p-5 space-y-4",children:Array.from({length:e}).map((t,r)=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx(Is,{className:"w-20 h-3 rounded"}),s.jsx(Is,{className:"w-12 h-3 rounded"})]}),s.jsx(Is,{className:"w-full h-7 rounded-md",style:{opacity:1-r*.12}})]},r))})]}),Wce=({isDarkMode:e,currentUser:t})=>{var we,ye,ee,ke,Te,J,Le,$e,ut,yt,Dt,Zt,dr;const[r,n]=v.useState(null),[a,l]=v.useState("month"),[c,d]=v.useState("all"),[h,f]=v.useState(!1),[m,g]=v.useState(!1),[x,b]=v.useState("leads"),[j,w]=v.useState([]),[_,N]=v.useState([]),[C,A]=v.useState([]),[E,S]=v.useState(null),[T,D]=v.useState([]),[P,I]=v.useState([]),[$,M]=v.useState(!1),[R,F]=v.useState(!1),[V,H]=v.useState(!1),[L,U]=v.useState(!0),le=((t==null?void 0:t.type)||"manager")==="rep";v.useEffect(()=>{(async()=>{if(le||!(t!=null&&t.organization_id))return;const{data:Z}=await ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",t.organization_id);Z&&w(Z.map(fe=>({id:fe.id,name:fe.full_name,avatar:fe.avatar_url,role:fe.role})))})()},[t==null?void 0:t.organization_id,le]),v.useEffect(()=>{if(!(t!=null&&t.organization_id)){U(!1),M(!0),F(!0),H(!0);return}const Y=Hce(t.organization_id);Y&&(Y.stats&&S(Y.stats),Y.funnelData&&N(Y.funnelData),Y.sourcesData&&A(Y.sourcesData),Y.atRiskLeads&&D(Y.atRiskLeads),Y.unassignedLeads&&I(Y.unassignedLeads),M(!0),F(!0),H(!0),U(!1)),(async()=>{try{let fe="";le&&(t!=null&&t.id)?fe=t.id:!le&&c!=="all"&&(fe=c);const Ve=fe?`&userId=${fe}`:"",rt=`&range=${a===""?"day":a===""?"week":"month"}`,pe=t!=null&&t.organization_id?`&organizationId=${t.organization_id}`:"",{data:{session:qe}}=await ge.auth.getSession(),nt={Authorization:`Bearer ${qe==null?void 0:qe.access_token}`},Ne=await(await fetch(`/api/panel/stats?${rt.substring(1)}${Ve}${pe}`,{headers:nt})).json();Ne.success&&S(Ne.stats),M(!0),U(!1);const[Ge,vt]=await Promise.all([fetch(`/api/pipeline/funnel?${rt.substring(1)}${Ve}${pe}`,{headers:nt}),fetch(`/api/pipeline/sources?${rt.substring(1)}${Ve}${pe}`,{headers:nt})]),[st,mt]=await Promise.all([Ge.json(),vt.json()]);st.success&&N(st.funnel),mt.success&&A(mt.sources),F(!0);const[wt,ct]=await Promise.all([fetch(`/api/panel/at-risk-leads?limit=5${Ve}${pe}`,{headers:nt}),le?Promise.resolve({json:()=>({success:!0,leads:[]})}):fetch(`/api/pipeline/unassigned?limit=5${pe}`,{headers:nt})]),[dt,Zr]=await Promise.all([wt.json(),ct.json()]);dt.success&&D(dt.leads),Zr.success&&I(Zr.leads),H(!0),Vce(t.organization_id,{stats:Ne.success?Ne.stats:null,funnelData:st.success?st.funnel:[],sourcesData:mt.success?mt.sources:[],atRiskLeads:dt.success?dt.leads:[],unassignedLeads:Zr.success?Zr.leads:[]})}catch(fe){console.error("Error fetching pipeline data:",fe),U(!1),M(!0),F(!0),H(!0)}})()},[a,c,t==null?void 0:t.organization_id,t==null?void 0:t.id,le]);const ve=C.reduce((Y,Z)=>Y+Z[x],0),B=C.length>0?Math.max(...C.map(Y=>Y[x])):1,G=_.length>0?Math.max(..._.map(Y=>Y.count),1):1,ie=[{icon:ft,color:"#6366f1"},{icon:hu,color:"#059669"},{icon:wn,color:"#2563eb"},{icon:Lc,color:"#d97706"}],he=[{label:'" ',value:((we=E==null?void 0:E.leadsContacted)==null?void 0:we.current)||0,change:(ye=E==null?void 0:E.leadsContacted)==null?void 0:ye.change,positive:!0},{label:" ",value:((ee=E==null?void 0:E.newLeads)==null?void 0:ee.current)||0,change:(ke=E==null?void 0:E.newLeads)==null?void 0:ke.change,positive:!0},{label:"",value:((Te=E==null?void 0:E.appointments)==null?void 0:Te.current)||0,change:(J=E==null?void 0:E.appointments)==null?void 0:J.change,positive:!0},{label:"",value:((Le=E==null?void 0:E.closedDeals)==null?void 0:Le.current)||0,change:($e=E==null?void 0:E.closedDeals)==null?void 0:$e.change,positive:!0}],_e=Y=>{if(!Y)return!1;const Z=Y.replace(/[+\-%]/g,"").trim();return Z!=="0"&&Z!==""},Ee={Website:" ",Unknown:" ",Webinar:"",LinkedIn:"",Facebook:"",Referral:"",Instagram:""};return L&&!E?s.jsx("div",{className:"flex-1 overflow-y-auto font-sans",style:{background:"#fafbfc"},children:s.jsxs("div",{style:{maxWidth:1440,margin:"0 auto",padding:"32px 40px"},children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsx(Is,{className:"w-40 h-7 rounded mb-2"}),s.jsx(Is,{className:"w-56 h-4 rounded"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Is,{className:"w-[140px] h-9 rounded"}),s.jsx(Is,{className:"w-[130px] h-9 rounded"})]})]}),s.jsx(gE,{}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-10 gap-6 mb-8",children:[s.jsx("div",{className:"xl:col-span-7",children:s.jsx(Ji,{lines:5})}),s.jsx("div",{className:"xl:col-span-3",children:s.jsx(Ji,{lines:4})})]}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[s.jsx(Ji,{lines:3}),s.jsx(Ji,{lines:3})]})]})}):s.jsx("div",{className:"flex-1 overflow-y-auto font-sans",style:{background:"#fafbfc"},children:s.jsxs("div",{style:{maxWidth:1440,margin:"0 auto",padding:"32px 40px"},children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-[24px] font-bold",style:{color:"#0f172a",letterSpacing:"-0.5px"},children:le?" ":" & "}),s.jsx("p",{className:"text-[13px] mt-1",style:{color:"#64748b"},children:le?"   ":"    "})]}),s.jsxs("div",{className:"flex items-center gap-2 relative z-20",children:[!le&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>{g(!m),f(!1)},className:"hidden sm:flex items-center gap-2 px-3 py-2 rounded-md text-[13px] font-medium transition-colors hover:bg-white",style:{background:"#fff",border:"1px solid #e5e7eb",color:"#334155",minWidth:140},children:[s.jsx(Kr,{className:"w-3.5 h-3.5",style:{color:"#94a3b8"}}),s.jsx("span",{className:"truncate max-w-[100px]",children:c==="all"?" ":((ut=j.find(Y=>Y.id===c))==null?void 0:ut.name)||" "}),s.jsx(Pt,{className:`w-3 h-3 mr-auto transition-transform ${m?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),m&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>g(!1)}),s.jsxs("div",{className:"absolute top-full left-0 mt-1.5 w-56 bg-white rounded-lg z-20 py-1 overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 4px 16px rgba(0,0,0,0.08)"},children:[s.jsxs("button",{onClick:()=>{d("all"),g(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] hover:bg-[#f8fafc] transition-colors flex items-center justify-between",style:{color:c==="all"?"#2563eb":"#334155",fontWeight:c==="all"?600:400},children:[s.jsx("span",{children:" "}),c==="all"&&s.jsx(Ct,{className:"w-3.5 h-3.5",style:{color:"#2563eb"}})]}),s.jsx("div",{style:{height:1,background:"#f1f5f9",margin:"2px 0"}}),s.jsx("div",{className:"max-h-[240px] overflow-y-auto",children:j.map(Y=>s.jsxs("button",{onClick:()=>{d(Y.id),g(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] hover:bg-[#f8fafc] transition-colors flex items-center justify-between",style:{color:c===Y.id?"#2563eb":"#334155",fontWeight:c===Y.id?600:400},children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx("img",{src:Y.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(Y.name)}&size=24`,className:"w-5 h-5 rounded-full",alt:""}),s.jsx("span",{className:"truncate",children:Y.name})]}),c===Y.id&&s.jsx(Ct,{className:"w-3.5 h-3.5",style:{color:"#2563eb"}})]},Y.id))})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>{f(!h),g(!1)},className:"flex items-center gap-2 px-3 py-2 rounded-md text-[13px] font-medium transition-colors hover:bg-white",style:{background:"#fff",border:"1px solid #e5e7eb",color:"#334155",minWidth:130},children:[s.jsx(wn,{className:"w-3.5 h-3.5",style:{color:"#94a3b8"}}),s.jsx("span",{children:a==="month"?"":a==="week"?"":a===""?"":a}),s.jsx(Pt,{className:`w-3 h-3 mr-auto transition-transform ${h?"rotate-180":""}`,style:{color:"#94a3b8"}})]}),h&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),s.jsx("div",{className:"absolute top-full left-0 mt-1.5 w-44 bg-white rounded-lg z-20 py-1",style:{border:"1px solid #e5e7eb",boxShadow:"0 4px 16px rgba(0,0,0,0.08)"},children:[{key:"",label:""},{key:"week",label:""},{key:"month",label:""}].map(Y=>s.jsxs("button",{onClick:()=>{l(Y.key),f(!1)},className:"w-full text-right px-3.5 py-2 text-[13px] hover:bg-[#f8fafc] transition-colors flex items-center justify-between",style:{color:a===Y.key?"#2563eb":"#334155",fontWeight:a===Y.key?600:400},children:[s.jsx("span",{children:Y.label}),a===Y.key&&s.jsx(Ct,{className:"w-3.5 h-3.5",style:{color:"#2563eb"}})]},Y.key))})]})]})]})]}),$?s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:he.map((Y,Z)=>{const fe=ie[Z]||ie[0],Ve=fe.icon;return s.jsxs("div",{className:"bg-white rounded-lg p-5 hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all duration-200 cursor-default",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03), 0 1px 3px rgba(0,0,0,0.02)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx(Ve,{className:"w-[18px] h-[18px]",style:{color:fe.color,opacity:.6},strokeWidth:1.5}),_e(Y.change)&&s.jsxs("span",{className:"text-[11px] font-semibold flex items-center gap-0.5",style:{color:Y.positive?"#059669":"#dc2626"},children:[Y.positive?s.jsx(ou,{className:"w-3 h-3"}):s.jsx(NE,{className:"w-3 h-3"}),Y.change]})]}),s.jsx("div",{className:"text-[48px] font-bold leading-none",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:Y.value}),s.jsx("div",{className:"text-[13px] font-medium mt-2",style:{color:"#64748b"},children:Y.label})]},Z)})}):s.jsx(gE,{}),R?s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-10 gap-6 mb-8",children:[s.jsxs("div",{className:"xl:col-span-7 bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:[s.jsx("div",{className:"px-6 py-5 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(hc,{className:"w-4 h-4",style:{color:"#6366f1"},strokeWidth:1.5}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "}),s.jsxs("p",{className:"text-[12px]",style:{color:"#94a3b8"},children:["    ",le?" ":" "]})]})]})}),s.jsx("div",{className:"px-6 py-6 space-y-6",children:_.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(hc,{className:"w-8 h-8 mx-auto mb-3",style:{color:"#d1d5db"},strokeWidth:1.5}),s.jsx("p",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:"  "}),s.jsx("p",{className:"text-[13px] mt-1",style:{color:"#94a3b8"},children:"    "})]}):_.map((Y,Z)=>{const fe=G>0?Math.max(Y.count/G*100,3):3,Ve=pE[Z%pE.length];return s.jsxs("div",{className:"group",children:[s.jsxs("div",{className:"flex items-baseline justify-between mb-2.5",children:[s.jsx("span",{className:"text-[14px] font-medium",style:{color:"#1e293b"},children:Y.label}),s.jsxs("div",{className:"flex items-baseline gap-3",children:[s.jsx("span",{className:"text-[18px] font-bold",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums",fontFeatureSettings:'"tnum" 1'},children:Y.count}),s.jsxs("span",{className:"text-[12px] font-semibold",style:{color:"#64748b"},children:[Y.percentage||Math.round(Y.count/(G||1)*100),"%"]})]})]}),s.jsx("div",{className:"h-7 rounded-md overflow-hidden",style:{background:"#f1f5f9"},children:s.jsx("div",{className:"h-full rounded-md transition-all duration-700 group-hover:brightness-110",style:{width:`${fe}%`,background:Ve}})}),Z<_.length-1&&s.jsx("div",{className:"mt-4",style:{height:1,background:"#e5e7eb",opacity:.5}})]},Y.id)})})]}),s.jsxs("div",{className:"xl:col-span-3 bg-white rounded-lg overflow-hidden flex flex-col",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:[s.jsx("div",{className:"px-5 py-4 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(vr,{className:"w-4 h-4",style:{color:"#2563eb"},strokeWidth:1.5}),s.jsx("h2",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "})]})}),s.jsxs("div",{className:"px-5 pt-3 flex gap-1",style:{borderBottom:"1px solid #e5e7eb"},children:[s.jsx("button",{onClick:()=>b("leads"),className:"px-4 py-2 text-[13px] font-medium transition-colors",style:{color:x==="leads"?"#2563eb":"#64748b",borderBottom:x==="leads"?"2px solid #2563eb":"2px solid transparent",fontWeight:x==="leads"?600:500,marginBottom:-1},children:""}),s.jsx("button",{onClick:()=>b("revenue"),className:"px-4 py-2 text-[13px] font-medium transition-colors",style:{color:x==="revenue"?"#2563eb":"#64748b",borderBottom:x==="revenue"?"2px solid #2563eb":"2px solid transparent",fontWeight:x==="revenue"?600:500,marginBottom:-1},children:""})]}),s.jsx("div",{className:"px-5 py-5 flex-1 space-y-5",children:C.length===0?s.jsxs("div",{className:"text-center py-10",children:[s.jsx(vr,{className:"w-6 h-6 mx-auto mb-2",style:{color:"#d1d5db"},strokeWidth:1.5}),s.jsx("p",{className:"text-[13px] font-medium",style:{color:"#64748b"},children:"  "})]}):C.slice(0,5).map((Y,Z)=>{const fe=Y[x],Ve=ve>0?Math.round(fe/ve*100):0,rt=B>0?Math.max(fe/B*100,5):0;return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-[13px] font-medium",style:{color:"#1e293b"},children:Ee[Y.name]||Y.name}),s.jsxs("div",{className:"flex items-baseline gap-1.5",children:[s.jsx("span",{className:"text-[16px] font-bold",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums"},children:x==="revenue"?`${fe.toLocaleString("he-IL")}`:fe}),s.jsxs("span",{className:"text-[11px] font-semibold",style:{color:"#64748b"},children:["(",Ve,"%)"]})]})]}),s.jsx("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"#f1f5f9"},children:s.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${rt}%`,background:"linear-gradient(90deg, #3b82f6, #2563eb)"}})})]},Z)})}),C.length>0&&s.jsx("div",{className:"px-5 pb-5 pt-3",style:{borderTop:"1px solid #f1f5f9"},children:s.jsxs("p",{className:"text-[12px] text-center",style:{color:"#64748b"},children:['": ',s.jsx("span",{className:"font-bold",style:{color:"#0f172a"},children:x==="revenue"?`${ve.toLocaleString("he-IL")}`:ve})," ",x==="leads"?"":""]})})]})]}):s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-10 gap-6 mb-8",children:[s.jsx("div",{className:"xl:col-span-7",children:s.jsx(Ji,{lines:5})}),s.jsx("div",{className:"xl:col-span-3",children:s.jsx(Ji,{lines:4})})]}),V?s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:[s.jsx("div",{className:"px-6 py-4 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(q$,{className:"w-4 h-4",style:{color:"#d97706"},strokeWidth:1.5}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "}),T.length>0&&s.jsxs("p",{className:"text-[12px]",style:{color:"#d97706"},children:["    ",T.length," "]})]})]})}),s.jsx("div",{className:"px-6",children:T.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-12 h-12 rounded-full mx-auto mb-3 flex items-center justify-center",style:{background:"#d1fae5"},children:s.jsx(Ct,{className:"w-5 h-5",style:{color:"#059669"}})}),s.jsx("p",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:"  "}),s.jsx("p",{className:"text-[13px] mt-1",style:{color:"#94a3b8"},children:"   "})]}):T.map((Y,Z)=>s.jsxs("div",{onClick:()=>n(Y),className:"py-4 cursor-pointer group hover:bg-[#fafbfc] -mx-6 px-6 transition-colors",style:{borderBottom:Z<T.length-1?"1px solid #f1f5f9":"none"},children:[s.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#0f172a"},children:Y.name}),s.jsx("span",{className:"text-[11px] font-semibold uppercase px-2 py-1 rounded",style:{background:"#fef3c7",color:"#92400e",border:"1px solid #fde68a",letterSpacing:"0.3px"},children:typeof Y.timeSinceActivity=="string"?Y.timeSinceActivity:" "})]}),s.jsxs("p",{className:"text-[12px] flex items-center gap-1",style:{color:"#64748b"},children:[s.jsx(Pr,{className:"w-3 h-3"}),"    "]}),s.jsxs("span",{className:"text-[12px] font-medium flex items-center gap-1 mt-1.5 opacity-0 group-hover:opacity-100 transition-opacity",style:{color:"#2563eb"},children:[" ",s.jsx(Zl,{className:"w-3 h-3",style:{transform:"rotate(180deg)"}})]})]},Y.id))})]}),le?s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:[s.jsxs("div",{className:"px-6 py-4 flex items-center gap-2.5",style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsx(hc,{className:"w-4 h-4",style:{color:"#2563eb"},strokeWidth:1.5}),s.jsx("h2",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "})]}),s.jsx("div",{className:"p-5 grid grid-cols-2 gap-3",children:[{label:" ",value:((yt=E==null?void 0:E.newLeads)==null?void 0:yt.current)||0},{label:" ",value:((Dt=E==null?void 0:E.closedDeals)==null?void 0:Dt.current)||0},{label:"",value:((Zt=E==null?void 0:E.leadsContacted)==null?void 0:Zt.current)||0},{label:"",value:((dr=E==null?void 0:E.appointments)==null?void 0:dr.current)||0}].map((Y,Z)=>s.jsxs("div",{className:"rounded-md p-4 text-center hover:bg-white transition-all",style:{background:"#f8fafc",border:"1px solid #e5e7eb"},children:[s.jsx("div",{className:"text-[12px] font-medium mb-2",style:{color:"#64748b"},children:Y.label}),s.jsx("div",{className:"text-[28px] font-bold",style:{color:"#0f172a",fontVariantNumeric:"tabular-nums"},children:Y.value})]},Z))})]}):s.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",style:{border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:[s.jsx("div",{className:"px-6 py-4 flex items-center justify-between",style:{borderBottom:"1px solid #f1f5f9"},children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(hu,{className:"w-4 h-4",style:{color:"#d97706"},strokeWidth:1.5}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:"  "}),P.length>0&&s.jsxs("p",{className:"text-[12px]",style:{color:"#d97706"},children:["   ",P.length," "]})]})]})}),s.jsx("div",{className:"px-6",children:P.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-12 h-12 rounded-full mx-auto mb-3 flex items-center justify-center",style:{background:"#d1fae5"},children:s.jsx(Ct,{className:"w-5 h-5",style:{color:"#059669"}})}),s.jsx("p",{className:"text-[15px] font-semibold",style:{color:"#0f172a"},children:" "}),s.jsx("p",{className:"text-[13px] mt-1",style:{color:"#94a3b8"},children:"   "})]}):P.map((Y,Z)=>s.jsxs("div",{onClick:()=>n(Y),className:"py-4 cursor-pointer group hover:bg-[#fafbfc] -mx-6 px-6 transition-colors flex items-center justify-between",style:{borderBottom:Z<P.length-1?"1px solid #f1f5f9":"none"},children:[s.jsx("h3",{className:"text-[14px] font-semibold",style:{color:"#0f172a"},children:Y.name}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-[11px] font-semibold px-2.5 py-1 rounded",style:{background:"#f1f5f9",color:"#475569",border:"1px solid #cbd5e1"},children:Ee[Y.source||""]||Y.source||" "}),s.jsxs("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[12px] font-medium flex items-center gap-1",style:{color:"#2563eb"},children:[" ",s.jsx(Zl,{className:"w-3 h-3",style:{transform:"rotate(180deg)"}})]})]})]},Y.id))})]})]}):s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[s.jsx(Ji,{lines:3}),s.jsx(Ji,{lines:3})]}),s.jsx(Sj,{lead:r,onClose:()=>n(null)})]})})},Gce=({orgId:e})=>{const{settings:t,loading:r,updateSettings:n}=Iw(e),[a,l]=v.useState([]),[c,d]=v.useState(!1),[h,f]=v.useState(!1),[m,g]=v.useState(null),[x,b]=v.useState(null),j=v.useRef(null);v.useEffect(()=>{const S=T=>{j.current&&!j.current.contains(T.target)&&g(null)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),v.useEffect(()=>{t!=null&&t.pipeline_statuses&&l(t.pipeline_statuses)},[t]);const w=()=>{const S={id:`status_${Date.now()}`,label:" ",color:"#94a3b8"};l([...a,S]),f(!0)},_=(S,T)=>{const D=[...a];D[S]={...D[S],...T},l(D),f(!0),T.color&&g(null)},N=S=>{if(a.length<=1){alert("     .");return}if(confirm("  ?              .")){const T=a.filter((D,P)=>P!==S);l(T),f(!0)}},C=(S,T)=>{if(T==="up"&&S===0||T==="down"&&S===a.length-1)return;const D=[...a],P=T==="up"?S-1:S+1;[D[S],D[P]]=[D[P],D[S]],l(D),f(!0)},A=async()=>{if(!t||!n)return;if(!e){b(":    (OrgID is missing).");return}d(!0),b(null);const S=await n({pipeline_statuses:a});d(!1),S!=null&&S.success?f(!1):(b("  .  ."),console.error(S==null?void 0:S.error))},E=["#64748B","#94A3B8","#EF4444","#F87171","#F97316","#FB923C","#F59E0B","#FBBF24","#84CC16","#A3E635","#10B981","#34D399","#06B6D4","#22D3EE","#3B82F6","#60A5FA","#6366F1","#818CF8","#8B5CF6","#A78BFA","#D946EF","#E879F9","#EC4899","#F472B6","#F43F5E","#FB7185"];return r?s.jsx("div",{className:"p-8 text-center text-slate-500",children:" ..."}):s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 pb-10",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"      .       ."})]}),h&&s.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in",children:[s.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-400 font-medium",children:"   "}),s.jsxs(je,{onClick:A,disabled:c,children:[c?s.jsx(yw,{className:"w-4 h-4 animate-spin ml-2"}):s.jsx(ol,{className:"w-4 h-4 ml-2"})," "]})]})]}),x&&s.jsx("div",{className:"mb-4 p-3 bg-rose-50 border border-rose-200 text-rose-600 rounded-lg text-sm",children:x}),s.jsxs("div",{className:"space-y-3",children:[a.map((S,T)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 group hover:border-brand-200 dark:hover:border-brand-800 transition-colors",children:[s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsx("button",{onClick:()=>C(T,"up"),disabled:T===0,className:"text-slate-400 hover:text-brand-600 disabled:opacity-30 disabled:hover:text-slate-400",children:s.jsx(eo,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>C(T,"down"),disabled:T===a.length-1,className:"text-slate-400 hover:text-brand-600 disabled:opacity-30 disabled:hover:text-slate-400",children:s.jsx(Pt,{className:"w-4 h-4"})})]}),s.jsx(xw,{className:"w-5 h-5 text-slate-300 dark:text-slate-600"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{onClick:()=>g(m===T?null:T),className:"w-8 h-8 rounded-full cursor-pointer border-2 border-white dark:border-slate-800 shadow-sm ring-1 ring-slate-100 dark:ring-slate-700 hover:scale-105 transition-transform",style:{backgroundColor:S.color}}),m===T&&s.jsxs("div",{ref:j,className:"absolute top-full right-0 mt-2 p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl shadow-xl z-20 w-64 animate-in fade-in zoom-in-95 duration-200",children:[s.jsx("p",{className:"text-xs font-bold text-slate-500 mb-2",children:"  /"}),s.jsx("div",{className:"grid grid-cols-6 gap-2",children:E.map(D=>s.jsx("button",{onClick:()=>_(T,{color:D}),className:"w-7 h-7 rounded-full border border-slate-100 dark:border-slate-700 hover:scale-110 transition-transform relative",style:{backgroundColor:D},children:S.color===D&&s.jsx(Or,{className:"w-4 h-4 text-white absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 drop-shadow-md"})},D))})]})]}),s.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("input",{type:"text",value:S.label,onChange:D=>_(T,{label:D.target.value}),className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-md px-3 py-1.5 text-sm font-medium focus:ring-2 focus:ring-brand-500 outline-none",placeholder:"  ()"}),s.jsx("input",{type:"text",value:S.id,readOnly:!0,onChange:D=>_(T,{id:D.target.value}),className:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-md px-3 py-1.5 text-xs font-mono text-slate-500 focus:ring-2 focus:ring-brand-500 outline-none",placeholder:"Technical ID (English)"})]}),s.jsx("button",{onClick:()=>N(T),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-all",title:" ",children:s.jsx(sa,{className:"w-4 h-4"})})]},S.id||T)),s.jsxs("button",{onClick:w,className:"w-full py-4 flex items-center justify-center gap-2 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl text-slate-500 hover:text-brand-600 hover:border-brand-200 dark:hover:border-brand-800/50 hover:bg-brand-50/50 dark:hover:bg-brand-900/10 transition-all group",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center group-hover:bg-brand-100 dark:group-hover:bg-brand-900/30 transition-colors",children:s.jsx(Nn,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-medium",children:"  "})]})]})]}),s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-800 p-4 rounded-lg flex gap-3",children:[s.jsx(Ct,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[s.jsx("p",{className:"font-bold mb-1",children:"  "}),s.jsx("p",{children:"      (5-8)    .         (   )."})]})]})]})},Kce=()=>{const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,l]=v.useState(!0),[c,d]=v.useState(null),[h,f]=v.useState(!1),[m,g]=v.useState(null),[x,b]=v.useState(""),[j,w]=v.useState(""),[_,N]=v.useState(""),[C,A]=v.useState(!1);v.useEffect(()=>{(async()=>{var R;const{data:{session:$}}=await ge.auth.getSession();if(!((R=$==null?void 0:$.user)!=null&&R.id))return;const{data:M}=await ge.from("profiles").select("organization_id").eq("id",$.user.id).single();M!=null&&M.organization_id&&d(M.organization_id)})()},[]),v.useEffect(()=>{if(!c)return;(async()=>{l(!0);const{data:{session:$}}=await ge.auth.getSession();if(!$){l(!1);return}try{const M={Authorization:`Bearer ${$.access_token}`},[R,F]=await Promise.all([fetch(`/api/campaigns?organizationId=${c}`,{headers:M}),fetch(`/api/leads/sources?organizationId=${c}`,{headers:M})]),V=await R.json(),H=await F.json();V.success&&t(V.campaigns||[]),H.success&&n(H.sources||[])}catch(M){console.error("[CampaignSettings] Fetch error:",M)}finally{l(!1)}})()},[c]);const E=()=>{g(null),b(""),w(""),N(""),f(!0)},S=I=>{g(I),b(I.name),w(I.source_filter),N(I.description||""),f(!0)},T=async()=>{if(!c||!x||!j)return;A(!0);const{data:{session:I}}=await ge.auth.getSession();if(!I){A(!1);return}try{const $={"Content-Type":"application/json",Authorization:`Bearer ${I.access_token}`};if(m){const R=await(await fetch(`/api/campaigns/${m.id}`,{method:"PUT",headers:$,body:JSON.stringify({name:x,sourceFilter:j,description:_})})).json();R.success&&t(F=>F.map(V=>V.id===m.id?R.campaign:V))}else{const R=await(await fetch("/api/campaigns",{method:"POST",headers:$,body:JSON.stringify({organizationId:c,name:x,sourceFilter:j,description:_})})).json();R.success&&t(F=>[R.campaign,...F])}f(!1)}catch($){console.error("[CampaignSettings] Save error:",$)}finally{A(!1)}},D=async I=>{if(!confirm("   ?"))return;const{data:{session:$}}=await ge.auth.getSession();if($)try{(await(await fetch(`/api/campaigns/${I}`,{method:"DELETE",headers:{Authorization:`Bearer ${$.access_token}`}})).json()).success&&t(F=>F.filter(V=>V.id!==I))}catch(M){console.error("[CampaignSettings] Delete error:",M)}},P={Website:" ",Google:"",Facebook:"",LinkedIn:"",Instagram:"",Webinar:"",Referral:"","Landing Page":" "};return s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"     "})]}),s.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors",children:[s.jsx(Nn,{className:"w-4 h-4"})," "]})]}),a?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(it,{className:"w-6 h-6 animate-spin text-brand-500"})}):e.length===0?s.jsxs("div",{className:"text-center py-12 text-slate-400",children:[s.jsx("p",{children:"  "}),s.jsx("p",{className:"text-sm mt-1",children:'  " "  '})]}):s.jsx("div",{className:"space-y-3",children:e.map(I=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-slate-900 dark:text-white",children:I.name}),s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[": ",P[I.source_filter]||I.source_filter,I.description&&`  ${I.description}`]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>S(I),className:"p-2 text-slate-400 hover:text-brand-500 transition-colors",children:s.jsx(zE,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>D(I.id),className:"p-2 text-slate-400 hover:text-rose-500 transition-colors",children:s.jsx(sa,{className:"w-4 h-4"})})]})]},I.id))}),h&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl w-full max-w-md p-6 shadow-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:m?" ":" "}),s.jsx("button",{onClick:()=>f(!1),className:"text-slate-400 hover:text-slate-600",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:" "}),s.jsx("input",{type:"text",value:x,onChange:I=>b(I.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:":   "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:" "}),s.jsxs("select",{value:j,onChange:I=>w(I.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white",children:[s.jsx("option",{value:"",children:" ..."}),r.map(I=>s.jsx("option",{value:I,children:P[I]||I},I)),!r.includes("Website")&&s.jsx("option",{value:"Website",children:" "}),!r.includes("Google")&&s.jsx("option",{value:"Google",children:""}),!r.includes("Facebook")&&s.jsx("option",{value:"Facebook",children:""}),!r.includes("Landing Page")&&s.jsx("option",{value:"Landing Page",children:" "})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:" ()"}),s.jsx("textarea",{value:_,onChange:I=>N(I.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white resize-none",rows:2,placeholder:"   "})]}),s.jsxs("button",{onClick:T,disabled:!x||!j||C,className:"w-full flex items-center justify-center gap-2 py-2.5 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[C?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(ol,{className:"w-4 h-4"}),m?" ":" "]})]})]})})]})},Yce=({user:e})=>{const[t,r]=v.useState(!0),[n,a]=v.useState(!1),[l,c]=v.useState({transcription:!0,aiInsights:!0,language:"auto",aiModel:"standard",shortTips:!1,coachingWeights:{discovery:70,objections:50,closing:85}}),[d,h]=v.useState([]),[f,m]=v.useState(null),[g,x]=v.useState(""),[b,j]=v.useState("");v.useEffect(()=>{const E=async()=>{const S=e.organization_id||"org1",{data:{session:T}}=await ge.auth.getSession();if(T)try{const P=await(await fetch(`/api/settings/calls?organizationId=${S}`,{headers:{Authorization:`Bearer ${T.access_token}`}})).json();P.success&&P.settings&&(P.settings.calls_config&&c(P.settings.calls_config),P.settings.stages_config&&h(P.settings.stages_config),P.settings.twilio_phone_number&&j(P.settings.twilio_phone_number))}catch(D){console.error("Failed to load settings:",D)}finally{r(!1)}};e.organization_id&&E()},[e.organization_id]);const w=async()=>{a(!0);const E=e.organization_id||"org1",{data:{session:S}}=await ge.auth.getSession();if(!S){a(!1);return}try{const T={organizationId:E,settings:{calls_config:l,stages_config:d,twilio_phone_number:b}};(await(await fetch("/api/settings/calls",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S.access_token}`},body:JSON.stringify(T)})).json()).success&&console.log("Settings Saved!")}catch(T){console.error("Failed to save:",T)}finally{setTimeout(()=>a(!1),500)}},_=()=>{h([...d," "])},N=E=>{const S=[...d];S.splice(E,1),h(S)},C=E=>{m(E),x(d[E])},A=E=>{const S=[...d];S[E]=g,h(S),m(null)};return t?s.jsx("div",{className:"p-8 text-center text-slate-500",children:" ..."}):s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 relative pb-16",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2",children:[s.jsx(si,{className:"w-5 h-5 text-brand-500"}),"   "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white block",children:"   "}),s.jsx("span",{className:"text-xs text-slate-500",children:"      "})]}),s.jsx("div",{onClick:()=>c({...l,transcription:!l.transcription}),className:`w-10 h-5 rounded-full relative cursor-pointer transition-colors ${l.transcription?"bg-brand-600":"bg-slate-300 dark:bg-slate-700"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${l.transcription?"right-1":"left-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between py-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white block",children:"  AI  "}),s.jsx("span",{className:"text-xs text-slate-500",children:" ,     "})]}),s.jsx("div",{onClick:()=>c({...l,aiInsights:!l.aiInsights}),className:`w-10 h-5 rounded-full relative cursor-pointer transition-colors ${l.aiInsights?"bg-brand-600":"bg-slate-300 dark:bg-slate-700"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${l.aiInsights?"right-1":"left-1"}`})})]}),s.jsxs("div",{className:"pt-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"   "}),s.jsxs("select",{value:l.language,onChange:E=>c({...l,language:E.target.value}),className:"w-full md:w-64 px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{value:"auto",children:"  (Auto-detect)"}),s.jsx("option",{value:"he",children:" (Hebrew)"}),s.jsx("option",{value:"en",children:" (English)"})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2",children:[s.jsx(si,{className:"w-5 h-5 text-blue-500"}),"  "]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"   (Caller ID)"}),s.jsx("input",{type:"text",value:b,onChange:E=>j(E.target.value),placeholder:"+972500000000",className:"w-full md:w-64 px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none font-mono"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"      .        ."})]})})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2",children:[s.jsx(CL,{className:"w-5 h-5 text-purple-500"}),"   (AI Coach)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:" AI"}),s.jsxs("select",{value:l.aiModel,onChange:E=>c({...l,aiModel:E.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none mb-4",children:[s.jsx("option",{value:"standard",children:"   (Standard v2)"}),s.jsx("option",{value:"pro",children:"   (Sales Pro)"}),s.jsx("option",{value:"advanced",children:"  - Claude 3.5 (Advanced)"})]}),s.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white block",children:"   "}),s.jsx("span",{className:"text-xs text-slate-500",children:"     "})]}),s.jsx("div",{onClick:()=>c({...l,shortTips:!l.shortTips}),className:`w-10 h-5 rounded-full relative cursor-pointer transition-colors ${l.shortTips?"bg-brand-600":"bg-slate-300 dark:bg-slate-700"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${l.shortTips?"right-1":"left-1"}`})})]})]}),s.jsxs("div",{className:"space-y-4 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-lg",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"  ()"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"   "}),s.jsxs("span",{className:"text-xs font-bold text-brand-600",children:[l.coachingWeights.discovery,"%"]})]}),s.jsx("input",{type:"range",min:"0",max:"100",value:l.coachingWeights.discovery,onChange:E=>c({...l,coachingWeights:{...l.coachingWeights,discovery:parseInt(E.target.value)}}),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-brand-600"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"   "}),s.jsxs("span",{className:"text-xs font-bold text-brand-600",children:[l.coachingWeights.objections,"%"]})]}),s.jsx("input",{type:"range",min:"0",max:"100",value:l.coachingWeights.objections,onChange:E=>c({...l,coachingWeights:{...l.coachingWeights,objections:parseInt(E.target.value)}}),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-brand-600"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"  "}),s.jsxs("span",{className:"text-xs font-bold text-brand-600",children:[l.coachingWeights.closing,"%"]})]}),s.jsx("input",{type:"range",min:"0",max:"100",value:l.coachingWeights.closing,onChange:E=>c({...l,coachingWeights:{...l.coachingWeights,closing:parseInt(E.target.value)}}),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-brand-600"})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:"  "}),s.jsxs(je,{size:"sm",variant:"ghost",className:"text-xs border border-dashed border-slate-300",onClick:_,children:[s.jsx(Nn,{className:"w-3 h-3 ml-1"}),"  "]})]}),s.jsx("div",{className:"space-y-2",children:d.map((E,S)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-lg group hover:border-brand-200 transition-colors",children:[s.jsx(xw,{className:"w-4 h-4 text-slate-300 cursor-move"}),s.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-xs font-bold text-slate-500",children:S+1}),f===S?s.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[s.jsx("input",{type:"text",value:g,onChange:T=>x(T.target.value),className:"flex-1 bg-slate-50 dark:bg-slate-800 px-2 py-1 rounded border border-brand-300 outline-none text-sm",autoFocus:!0}),s.jsx("button",{onClick:()=>A(S),className:"p-1 text-emerald-500 hover:bg-emerald-50 rounded",children:s.jsx(Or,{className:"w-4 h-4"})})]}):s.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-200 font-medium",children:E}),s.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>C(S),className:"p-1.5 text-slate-400 hover:text-slate-600",children:s.jsx(Mu,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>N(S),className:"p-1.5 text-slate-400 hover:text-rose-500",children:s.jsx(sa,{className:"w-3.5 h-3.5"})})]})]},S))})]}),s.jsx("div",{className:"fixed bottom-8 left-8 z-20",children:s.jsxs(je,{onClick:w,disabled:n,className:"shadow-xl rounded-full px-6 py-4 h-auto flex items-center gap-2",children:[n?s.jsx(it,{className:"w-5 h-5 animate-spin"}):s.jsx(ol,{className:"w-5 h-5"}),n?" ...":" "]})})]})},Xce=({webhookUrl:e,apiKey:t})=>{const[r,n]=v.useState(null),[a,l]=v.useState("fields"),c=(b,j)=>{navigator.clipboard.writeText(b),n(j),setTimeout(()=>n(null),2e3)},d=`${e}?apiKey=${t}`,h=[{name:"name",type:"string",required:!0,description:" ",example:'" "'},{name:"phone",type:"string",required:!0,description:" ",example:'"0501234567"'},{name:"email",type:"string",required:!1,description:" ",example:'"email@example.com"'},{name:"company",type:"string",required:!1,description:" /",example:'" "'},{name:"source",type:"string",required:!1,description:"  ",example:'"Facebook Ads", "Google", ""'},{name:"status",type:"string",required:!1,description:" ",example:'"New", "Contacted", "Qualified"'},{name:"priority",type:"string",required:!1,description:" ",example:'"Hot", "Warm", "Cold"'},{name:"value",type:"number",required:!1,description:"   ()",example:"5000"},{name:"tags",type:"array",required:!1,description:" ",example:'["VIP", "-"]'}],f={minimal:{title:"  ()",description:"  ",code:`{
  "name": " ",
  "phone": "0501234567"
}`},full:{title:" ",description:"  ",code:`{
  "name": " ",
  "phone": "0501234567",
  "email": "israel@example.com",
  "company": " ",
  "source": "Facebook Ads",
  "status": "New",
  "priority": "Hot",
  "value": 15000,
  "tags": ["VIP", "-", "B2B"]
}`},facebook:{title:"Facebook Lead Ads",description:"    ",code:`{
  "name": "{{full_name}}",
  "phone": "{{phone_number}}",
  "email": "{{email}}",
  "source": "Facebook Lead Ad",
  "tags": ["", "{{ad_name}}"]
}`},elementor:{title:"WordPress / Elementor",description:"  Elementor",code:`{
  "name": "{{form.name}}",
  "phone": "{{form.phone}}",
  "email": "{{form.email}}",
  "source": " -   ",
  "tags": ["", ""]
}`},google:{title:"Google Ads Lead Form",description:" -Google Lead Form Extensions",code:`{
  "name": "{{lead.user_column_data.FULL_NAME}}",
  "phone": "{{lead.user_column_data.PHONE_NUMBER}}",
  "email": "{{lead.user_column_data.EMAIL}}",
  "source": "Google Ads",
  "tags": ["", "{{lead.campaign_id}}"]
}`}},m=[{name:"Zapier",icon:s.jsx(al,{className:"w-5 h-5"}),color:"bg-orange-500",steps:[" Zap ","   (Facebook Lead Ads, Google Sheets, ')",' Action: "Webhooks by Zapier"  "POST"',"  -URL  ",' "JSON" ',"     "]},{name:"Make (Integromat)",icon:s.jsx(Nr,{className:"w-5 h-5"}),color:"bg-purple-500",steps:[" Scenario ","     (Facebook, Google ')","  HTTP  Make a request","URL:     ","Method: POST","Body type: JSON","    "]},{name:"WordPress / Elementor",icon:s.jsx(vc,{className:"w-5 h-5"}),color:"bg-blue-500",steps:["   -Elementor"," -Actions After Submit",' "Webhook"',"  -URL ","Advanced:    "]},{name:"  (cURL)",icon:s.jsx(R9,{className:"w-5 h-5"}),color:"bg-slate-700",code:`curl -X POST "${d}" \\
  -H "Content-Type: application/json" \\
  -d '{
    "name": " ",
    "phone": "0501234567",
    "source": "API Test"
  }'`}],g=({id:b,title:j,children:w})=>{const _=a===b;return s.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden",children:[s.jsxs("button",{onClick:()=>l(_?null:b),className:"w-full px-5 py-4 flex items-center justify-between bg-slate-50 dark:bg-slate-800/50 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:j}),_?s.jsx(eo,{className:"w-5 h-5 text-slate-400"}):s.jsx(Pt,{className:"w-5 h-5 text-slate-400"})]}),_&&s.jsx("div",{className:"p-5 bg-white dark:bg-slate-900",children:w})]})},x=({code:b,label:j})=>s.jsxs("div",{className:"relative",children:[s.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg text-sm overflow-x-auto font-mono",dir:"ltr",children:b}),s.jsx("button",{onClick:()=>c(b,j),className:"absolute top-2 left-2 p-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:r===j?s.jsx(Or,{className:"w-4 h-4 text-green-400"}):s.jsx(p0,{className:"w-4 h-4 text-slate-300"})})]});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-3 bg-brand-100 dark:bg-brand-900/30 rounded-xl",children:s.jsx(a9,{className:"w-6 h-6 text-brand-600 dark:text-brand-400"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"  Webhook"}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"      "})]})]}),s.jsx("div",{className:"p-4 bg-gradient-to-r from-brand-50 to-purple-50 dark:from-brand-900/20 dark:to-purple-900/20 rounded-xl border border-brand-100 dark:border-brand-800",children:s.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:" :"}),s.jsx("code",{className:"text-xs text-slate-600 dark:text-slate-400 break-all",dir:"ltr",children:d})]}),s.jsxs("button",{onClick:()=>c(d,"url"),className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors text-sm font-medium",children:[r==="url"?s.jsx(Or,{className:"w-4 h-4"}):s.jsx(p0,{className:"w-4 h-4"}),""]})]})}),s.jsxs(g,{id:"fields",title:"  ",children:[s.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(h$,{className:"w-5 h-5 text-blue-500 shrink-0 mt-0.5"}),s.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[s.jsx("strong",{children:" :"}),"  ",s.jsx("code",{className:"bg-blue-100 dark:bg-blue-800 px-1 rounded",children:"name"})," -",s.jsx("code",{className:"bg-blue-100 dark:bg-blue-800 px-1 rounded",children:"phone"}),"   .      ."]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[s.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-600 dark:text-slate-300",children:""}),s.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-600 dark:text-slate-300",children:""}),s.jsx("th",{className:"text-center py-3 px-4 font-semibold text-slate-600 dark:text-slate-300",children:""}),s.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-600 dark:text-slate-300",children:""}),s.jsx("th",{className:"text-right py-3 px-4 font-semibold text-slate-600 dark:text-slate-300",children:""})]})}),s.jsx("tbody",{children:h.map((b,j)=>s.jsxs("tr",{className:j%2===0?"bg-slate-50 dark:bg-slate-800/30":"",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("code",{className:"bg-slate-200 dark:bg-slate-700 px-2 py-0.5 rounded text-brand-600 dark:text-brand-400 font-mono text-xs",children:b.name})}),s.jsx("td",{className:"py-3 px-4 text-slate-500 dark:text-slate-400",children:b.type}),s.jsx("td",{className:"py-3 px-4 text-center",children:b.required?s.jsx(Ct,{className:"w-5 h-5 text-green-500 mx-auto"}):s.jsx("span",{className:"text-slate-400",children:""})}),s.jsx("td",{className:"py-3 px-4 text-slate-700 dark:text-slate-300",children:b.description}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("code",{className:"text-xs text-slate-500 dark:text-slate-400",dir:"ltr",children:b.example})})]},b.name))})]})})]}),s.jsx(g,{id:"examples",title:"  ",children:s.jsx("div",{className:"grid gap-4",children:Object.entries(f).map(([b,j])=>s.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700",children:[s.jsx("h4",{className:"font-bold text-slate-900 dark:text-white",children:j.title}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:j.description})]}),s.jsx("div",{className:"p-4",children:s.jsx(x,{code:j.code,label:b})})]},b))})}),s.jsx(g,{id:"integrations",title:"  ",children:s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:m.map(b=>s.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden",children:[s.jsxs("div",{className:`px-4 py-3 ${b.color} text-white flex items-center gap-2`,children:[b.icon,s.jsx("span",{className:"font-bold",children:b.name})]}),s.jsx("div",{className:"p-4",children:b.steps?s.jsx("ol",{className:"space-y-2",children:b.steps.map((j,w)=>s.jsxs("li",{className:"flex gap-2 text-sm text-slate-700 dark:text-slate-300",children:[s.jsx("span",{className:"w-5 h-5 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center text-xs font-bold text-slate-600 dark:text-slate-400 shrink-0",children:w+1}),j]},w))}):b.code?s.jsx(x,{code:b.code,label:b.name}):null})]},b.name))})}),s.jsx(g,{id:"tips",title:"  ",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-100 dark:border-green-800",children:s.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:[s.jsx("strong",{children:"  -source:"}),"      (Facebook, Google, ) -        ."]})}),s.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-100 dark:border-yellow-800",children:s.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[s.jsx("strong",{children:"  -tags:"}),'    . : ["-", "B2B", "-"]']})}),s.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-800",children:s.jsxs("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:[s.jsx("strong",{children:"  :"}),'  priority: "Hot"      .']})}),s.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:s.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[s.jsx("strong",{children:"  :"}),"        ,   -value  -pipeline."]})})]})}),s.jsx("div",{className:"p-4 bg-slate-100 dark:bg-slate-800 rounded-xl text-center",children:s.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"  ?     "})})]})},Jce=()=>typeof window>"u"?"":window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"https://salescoach-7yul.onrender.com":window.location.origin,Qce=()=>{const[e,t]=v.useState([]),[r,n]=v.useState(!0),[a,l]=v.useState(null),[c,d]=v.useState(null),[h,f]=v.useState(!1),[m,g]=v.useState(""),[x,b]=v.useState(!1),[j,w]=v.useState(null),[_,N]=v.useState(!1),[C,A]=v.useState(!1),[E,S]=v.useState(null),[T,D]=v.useState(!1);v.useEffect(()=>{(async()=>{var le;const{data:{session:U}}=await ge.auth.getSession();if(!((le=U==null?void 0:U.user)!=null&&le.id))return;d(U.user.id);const{data:W}=await ge.from("profiles").select("organization_id").eq("id",U.user.id).single();W!=null&&W.organization_id&&l(W.organization_id)})()},[]),v.useEffect(()=>{if(!a)return;(async()=>{n(!0);try{const W=await(await fetch(`/api/settings/api-keys?organizationId=${a}`)).json();W.success&&t(W.keys||[])}catch(U){console.error("[WebhookSettings] Fetch error:",U)}finally{n(!1)}})()},[a]);const P=async()=>{if(a){b(!0);try{const U=await(await fetch("/api/settings/api-keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:a,name:m||"Default Key",userId:c})})).json();U.success&&U.key&&(t(W=>[{...U.key,key_prefix:U.key.key_prefix},...W]),w(U.key.key),f(!1),g(""))}catch(L){console.error("[WebhookSettings] Create error:",L)}finally{b(!1)}}},I=async L=>{if(confirm("   ?"))try{(await(await fetch(`/api/settings/api-keys/${L}?organizationId=${a}`,{method:"DELETE"})).json()).success&&t(le=>le.filter(ve=>ve.id!==L))}catch(U){console.error("[WebhookSettings] Revoke error:",U)}},$=L=>{navigator.clipboard.writeText(L),N(!0),setTimeout(()=>N(!1),2e3)},M=e.find(L=>L.is_active),R=`${Jce()}/api/leads/webhook`,F=j?`${R}?apiKey=${j}`:`${R}?apiKey=YOUR_API_KEY`,V=!!j,H=async()=>{if(!j&&!M){alert("   API ");return}let L=j;if(!L){const U=prompt("  ,     -API   (     ):");if(!U)return;L=U}A(!0),S(null);try{let U=`${R}?apiKey=${L}`;typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(U=`http://localhost:5050/api/leads/webhook?apiKey=${L}`),(await fetch(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:" ",phone:"0500000000",email:"test@example.com",source:"Test Connection",tags:["Test","Webhook"]})})).ok?S("success"):S("error")}catch{S("error")}finally{A(!1)}};return s.jsxs("div",{className:"space-y-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-r from-brand-600 to-indigo-600 p-6 text-white text-center",children:[s.jsx(s7,{className:"w-12 h-12 mx-auto mb-3 opacity-90"}),s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  (Quick Connect)"}),s.jsx("p",{className:"opacity-90 max-w-lg mx-auto",children:"      .         ."})]}),s.jsxs("div",{className:"p-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2 text-center",children:"   (Magic Link)"}),s.jsxs("div",{className:`relative flex items-center bg-slate-50 dark:bg-slate-800 border-2 rounded-xl overflow-hidden transition-colors ${V?"border-brand-500 shadow-brand-100":"border-slate-200 dark:border-slate-700 dashed border-dashed"}`,children:[s.jsx("div",{className:"px-4 py-3 bg-slate-100 dark:bg-slate-700 border-l border-slate-200 dark:border-slate-600 text-slate-500",children:s.jsx(vc,{className:"w-5 h-5"})}),s.jsx("code",{className:"flex-1 px-4 py-3 text-sm font-mono text-slate-600 dark:text-slate-300 dir-ltr text-left overflow-x-auto whitespace-nowrap",children:F}),s.jsx("button",{onClick:()=>$(F),className:"px-6 py-3 bg-white dark:bg-slate-600 hover:bg-slate-50 dark:hover:bg-slate-500 text-brand-600 dark:text-white font-bold transition-colors border-r border-slate-200 dark:border-slate-600 h-full",children:_?"!":""})]}),!V&&s.jsx("div",{className:"text-center mt-3",children:s.jsxs("p",{className:"text-sm text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 py-2 px-4 rounded-lg inline-block",children:[s.jsx(_n,{className:"w-3.5 h-3.5 inline-block ml-1"})," :   ,   .",s.jsx("button",{onClick:()=>f(!0),className:"underline hover:text-amber-800 font-bold mx-1",children:"  "}),"    !"]})}),V&&s.jsx("p",{className:"text-center mt-3 text-sm text-emerald-600 dark:text-emerald-400 font-medium",children:" !    .    (    )."})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:H,className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all font-medium text-slate-700 dark:text-slate-300",children:[C?s.jsx(it,{className:"w-5 h-5 animate-spin"}):s.jsx(yw,{className:"w-5 h-5"}),"  (Test)"]}),s.jsxs("a",{href:"https://zapier.com/apps/webhook/integrations",target:"_blank",className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-orange-50 text-orange-700 hover:bg-orange-100 transition-all font-medium border border-orange-200",children:[s.jsx(al,{className:"w-5 h-5"})," -Zapier/Make"]})]}),E&&s.jsxs("div",{className:`mt-4 p-4 rounded-xl flex items-center gap-3 animate-in fade-in slide-in-from-top-2 ${E==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-rose-50 text-rose-800 border border-rose-200"}`,children:[E==="success"?s.jsx(Or,{className:"w-5 h-5"}):s.jsx(_n,{className:"w-5 h-5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:E==="success"?" !":" "}),s.jsx("p",{className:"text-sm opacity-90",children:E==="success"?"    .   .":"     ."})]})]})]})]}),s.jsx("div",{className:"grid grid-cols-2md:grid-cols-4 gap-4",children:[{name:"Wordpress / Elementor",icon:"W",color:"bg-blue-600"},{name:"Wix Automations",icon:"X",color:"bg-yellow-500"},{name:"Facebook Lead Ads",icon:"F",color:"bg-blue-500"},{name:"Google Ads",icon:"G",color:"bg-green-500"}].map(L=>s.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 flex items-center gap-3 shadow-sm",children:[s.jsx("div",{className:`w-8 h-8 rounded-lg ${L.color} text-white flex items-center justify-center font-bold text-sm`,children:L.icon}),s.jsxs("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[L.name,s.jsx("span",{className:"block text-[10px] text-slate-400 font-normal",children:"   -Webhook"})]})]},L.name))}),s.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",children:s.jsx(Xce,{webhookUrl:R,apiKey:j||"YOUR_API_KEY"})}),s.jsx("div",{className:"text-center",children:s.jsxs("button",{onClick:()=>D(!T),className:"text-slate-400 hover:text-slate-600 text-sm flex items-center justify-center gap-2 mx-auto transition-colors",children:[T?"  ":"  API  ",s.jsx(DE,{className:"w-3 h-3"})]})}),T&&s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-xl p-6 border border-slate-200 dark:border-slate-700 animate-in fade-in slide-in-from-top-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-300",children:"  API"}),s.jsx("button",{onClick:()=>f(!0),className:"bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 px-3 py-1.5 rounded-lg text-sm border border-slate-200 dark:border-slate-600 transition-colors shadow-sm",children:"+  "})]}),h&&s.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 mb-6",children:[s.jsx("h4",{className:"font-bold text-sm mb-3",children:"  "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{value:m,onChange:L=>g(L.target.value),placeholder:"  (:   )",className:"flex-1 px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-sm bg-transparent"}),s.jsx("button",{onClick:P,disabled:x,className:"bg-brand-600 text-white px-4 py-2 rounded-lg text-sm font-medium",children:x?"...":""}),s.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-slate-500 text-sm",children:""})]})]}),e.length===0?s.jsx("p",{className:"text-center text-slate-400 text-sm py-4",children:"  "}):s.jsx("div",{className:"space-y-3",children:e.map(L=>s.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${L.is_active?"bg-emerald-500":"bg-slate-300"}`}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-bold text-slate-800 dark:text-slate-200",children:L.name}),s.jsxs("p",{className:"text-slate-400 font-mono text-xs",children:[L.key_prefix,"****"]})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[s.jsxs("span",{children:[L.usage_count," "]}),s.jsx("button",{onClick:()=>I(L.id),className:"text-rose-500 hover:text-rose-700",children:""})]})]},L.id))})]})]})},Zce=({user:e})=>{const[t,r]=v.useState(!0),[n,a]=v.useState(!1),[l,c]=v.useState("sales"),[d,h]=v.useState("product"),[f,m]=v.useState(""),[g,x]=v.useState([]),[b,j]=v.useState([]),[w,_]=v.useState(null),[N,C]=v.useState(null),A=e.organization_id||"org1";v.useEffect(()=>{E()},[l,A]);const E=async()=>{r(!0);try{const I=await(await fetch(`/api/knowledge?organizationId=${A}&domain=${l}`)).json();I.success&&I.knowledge.forEach($=>{$.knowledge_type==="product_info"?m($.content.description||""):$.knowledge_type==="objections"?x(M=>[...M,{...$.content,id:$.id}]):$.knowledge_type==="competitors"&&j(M=>[...M,{...$.content,id:$.id}])})}catch(P){console.error("Failed to load knowledge:",P)}finally{r(!1)}},S=async()=>{a(!0);try{await fetch("/api/knowledge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:A,domain:l,knowledge_type:"product_info",title:"Product Information",content:{description:f}})})}catch(P){console.error("Failed to save:",P)}finally{a(!1)}},T=async P=>{try{await fetch("/api/knowledge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:P.id,organizationId:A,domain:l,knowledge_type:"objections",title:P.objection_text,content:P})}),_(null),E()}catch(I){console.error("Failed to save objection:",I)}},D=async P=>{try{await fetch(`/api/knowledge/${P}?organizationId=${A}`,{method:"DELETE"}),E()}catch(I){console.error("Failed to delete:",I)}};return t?s.jsx("div",{className:"p-8 text-center",children:"  ..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:[s.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 mb-3 block",children:"  (Domain)"}),s.jsx("div",{className:"flex gap-2",children:[{value:"sales",label:" ",desc:"  "},{value:"support",label:" ",desc:"  "},{value:"success",label:" Success",desc:" "}].map(P=>s.jsxs("button",{onClick:()=>c(P.value),className:`flex-1 p-4 rounded-lg border-2 transition-all ${l===P.value?"border-brand-500 bg-brand-50 dark:bg-brand-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"}`,children:[s.jsx("div",{className:"font-bold text-sm",children:P.label}),s.jsx("div",{className:"text-xs text-slate-500 mt-1",children:P.desc})]},P.value))})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800",children:[s.jsx("div",{className:"flex border-b border-slate-200 dark:border-slate-800",children:[{id:"product",label:"  ",icon:Pu},{id:"objections",label:" ",icon:vr},{id:"competitors",label:"",icon:km}].map(P=>s.jsxs("button",{onClick:()=>h(P.id),className:`flex items-center gap-2 px-6 py-4 text-sm font-medium transition-colors border-b-2 ${d===P.id?"border-brand-500 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[s.jsx(P.icon,{className:"w-4 h-4"}),P.label]},P.id))}),s.jsxs("div",{className:"p-6",children:[d==="product"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-600",children:"  /  -      "}),s.jsx("textarea",{value:f,onChange:P=>m(P.target.value),placeholder:":  AI Coach  ...  :  , feedback  ...",className:"w-full h-64 px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none resize-none"}),s.jsxs(je,{onClick:S,disabled:n,children:[n?s.jsx(it,{className:"w-4 h-4 animate-spin ml-2"}):s.jsx(ol,{className:"w-4 h-4 ml-2"}),""]})]}),d==="objections"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{className:"text-sm text-slate-600",children:"   "}),s.jsxs(je,{size:"sm",onClick:()=>_({}),children:[s.jsx(Nn,{className:"w-4 h-4 ml-1"}),"  "]})]}),s.jsx("div",{className:"space-y-2",children:g.map((P,I)=>s.jsx("div",{className:"p-4 border border-slate-200 dark:border-slate-700 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-bold text-sm",children:P.objection_text}),s.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[": ",P.response]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>_(P),className:"p-1 text-slate-400 hover:text-blue-500",children:s.jsx(Mu,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>D(P.id),className:"p-1 text-slate-400 hover:text-red-500",children:s.jsx(sa,{className:"w-4 h-4"})})]})]})},I))}),w&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 max-w-lg w-full mx-4",children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:w.id?" ":" "}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{placeholder:' (: " ")',value:w.objection_text||"",onChange:P=>_({...w,objection_text:P.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"}),s.jsx("textarea",{placeholder:" ...",value:w.response||"",onChange:P=>_({...w,response:P.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg h-24"}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(je,{variant:"ghost",onClick:()=>_(null),children:""}),s.jsx(je,{onClick:()=>T(w),children:""})]})]})]})})]}),d==="competitors"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-600",children:" Battle Cards  "}),s.jsxs(je,{size:"sm",onClick:()=>C({}),children:[s.jsx(Nn,{className:"w-4 h-4 ml-1"}),"  "]}),s.jsx("div",{className:"text-slate-500 text-center py-8",children:":  "})]})]})]})]})},f0={id:"u1",name:" ",role:" ",avatar:"https://picsum.photos/100/100",type:"rep"},Zf=[f0,{id:"u3",name:" ",role:" ",avatar:"https://picsum.photos/id/1012/100/100",type:"rep"},{id:"u4",name:" ",role:" ",avatar:"https://picsum.photos/id/1025/100/100",type:"rep"},{id:"u5",name:" ",role:" ",avatar:"https://picsum.photos/id/1027/100/100",type:"rep"}],m0=[{id:"l1",name:" ",company:" ",phone:"050-1234567",email:"m.ross@spectra.com",status:"New",priority:"Hot",value:"45,000",owner:f0,source:"Website",score:92,lastActivity:" 10 ",nextStep:"  ",tags:["SaaS","High Intent"],createdAt:"10/11/2024"},{id:"l2",name:" ",company:" ",phone:"052-9876543",email:"anat@tech-adv.co.il",status:"Discovery",priority:"Warm",value:"120,000",owner:Zf[1],source:"LinkedIn",score:78,lastActivity:"",nextStep:" ",tags:["Enterprise"],createdAt:"08/11/2024"},{id:"l3",name:" ",company:" ",phone:"054-1112223",email:"yossi@barak-inv.com",status:"Negotiation",priority:"Hot",value:"85,000",owner:Zf[2],source:"Referral",score:88,lastActivity:" 3 ",nextStep:"  ",tags:["Finance"],createdAt:"01/11/2024"},{id:"l4",name:" ",company:"- ",phone:"053-3334445",email:"dana@startup.io",status:"Proposal",priority:"Warm",value:"60,000",owner:f0,source:"Webinar",score:65,lastActivity:" ",nextStep:"  ",tags:["Startup"],createdAt:"05/11/2024"},{id:"l5",name:" ",company:" ",phone:"050-5556667",email:"avi@logistics.com",status:"Closed",priority:"Cold",value:"30,000",owner:Zf[1],source:"Cold Call",score:45,lastActivity:" ",nextStep:" - ",tags:[],createdAt:"20/10/2024"},{id:"l6",name:" ",company:' " ',phone:"052-2223334",email:"ronit@law.co.il",status:"New",priority:"Hot",value:"25,000",owner:f0,source:"Facebook Ads",score:85,lastActivity:"",nextStep:" ",tags:["Legal","SMB"],createdAt:"11/11/2024"},{id:"l7",name:" ",company:" ",phone:"054-9998887",email:"guy@cyber.io",status:"Discovery",priority:"Warm",value:"150,000",owner:Zf[2],source:"Partner",score:72,lastActivity:" 5 ",nextStep:" ",tags:["Cyber","Global"],createdAt:"09/11/2024"}];({...m0[3]},{...m0[6]}),{...m0[2]};m0.filter(e=>e.priority==="Hot").slice(0,3);const ede=[{id:"srv1",name:"Telephony (Voice)",status:"operational",latency:"24ms",lastCheck:""},{id:"srv2",name:"Transcription (Soniox)",status:"operational",latency:"120ms",lastCheck:" "},{id:"srv3",name:"AI Coach (LLM)",status:"operational",latency:"450ms",lastCheck:" "},{id:"srv4",name:"CRM Sync (Webhooks)",status:"degraded",latency:"High",lastCheck:" 5 "}],tde=({user:e,isDarkMode:t,toggleTheme:r})=>{const n=e.type==="rep",[a,l]=v.useState(!0);return s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:" "}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsxs("div",{className:"relative group cursor-pointer",children:[s.jsx("img",{src:e.avatar,alt:"Avatar",className:"w-24 h-24 rounded-full object-cover border-4 border-slate-50 dark:border-slate-800"}),!n&&s.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(u9,{className:"w-6 h-6 text-white"})})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:e.name}),s.jsx("p",{className:"text-xs text-slate-500",children:e.role})]})]}),s.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-6 w-full",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:" "}),s.jsx("input",{type:"text",defaultValue:e.name,disabled:n,className:`w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none ${n?"opacity-70 cursor-not-allowed":"focus:ring-2 focus:ring-brand-500"}`})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:""}),s.jsx("input",{type:"email",defaultValue:e.email||"sara@company.com",disabled:n,className:`w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none ${n?"opacity-70 cursor-not-allowed":"focus:ring-2 focus:ring-brand-500"}`})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:""}),s.jsx("input",{type:"tel",defaultValue:"050-1234567",disabled:n,className:`w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none ${n?"opacity-70 cursor-not-allowed":"focus:ring-2 focus:ring-brand-500"}`})]}),!n&&s.jsx("div",{className:"md:col-span-2 flex justify-end mt-2",children:s.jsx(je,{children:" "})})]})]})]}),!n&&s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:"  "}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:s.jsx(b0,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-xs text-slate-500",children:"   3 "})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx("div",{className:"flex items-center gap-4",children:s.jsx(je,{variant:"secondary",children:" "})})})]}),s.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-800 my-6"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:" - (2FA)"}),s.jsx("p",{className:"text-xs text-slate-500",children:"    "})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(qr,{variant:"success",children:""}),s.jsx("div",{className:"w-10 h-5 bg-brand-600 rounded-full relative cursor-pointer",children:s.jsx("div",{className:"absolute right-1 top-1 w-3 h-3 bg-white rounded-full shadow-sm"})})]})]}),s.jsxs("div",{className:"mt-6 bg-slate-50 dark:bg-slate-800/50 p-3 rounded-lg text-xs text-slate-500 flex justify-between",children:[s.jsx("span",{children:" : , 09:30"}),s.jsx("span",{children:"IP: 213.57.120.44 (Tel Aviv)"})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:" "}),!n&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[s.jsx(vc,{className:"w-3.5 h-3.5"}),"  "]}),s.jsxs("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{children:" (Hebrew)"}),s.jsx("option",{children:"English"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[s.jsx(Pr,{className:"w-3.5 h-3.5"}),"   (Timezone)"]}),s.jsxs("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{children:"Jerusalem (GMT+2)"}),s.jsx("option",{children:"London (GMT+0)"}),s.jsx("option",{children:"New York (GMT-5)"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx($E,{className:"w-4 h-4 text-slate-400"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"   "})]}),s.jsx("div",{onClick:r,className:`w-10 h-5 rounded-full relative cursor-pointer transition-colors ${t?"bg-brand-600":"bg-slate-300 dark:bg-slate-700"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${t?"right-1":"left-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ai,{className:"w-4 h-4 text-slate-400"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"     "})]}),s.jsx("div",{onClick:()=>l(!a),className:`w-10 h-5 rounded-full relative cursor-pointer transition-colors ${a?"bg-brand-600":"bg-slate-300 dark:bg-slate-700"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${a?"right-1":"left-1"}`})})]})]})]})]})},rde=({userId:e,userName:t,onClose:r})=>{var x;const[n,a]=v.useState({numbers:[],active_index:0,auto_rotate:!0}),[l,c]=v.useState(!0),[d,h]=v.useState("");v.useEffect(()=>{(async()=>{const{data:{session:j}}=await ge.auth.getSession();if(j)try{const _=await(await fetch(`/api/users/phone-config?userId=${e}&organizationId=current`,{headers:{Authorization:`Bearer ${j.access_token}`}})).json();_.success&&_.config&&a(_.config)}catch(w){console.error(w)}finally{c(!1)}})()},[e]);const f=async()=>{try{const{data:{session:b}}=await ge.auth.getSession();if(!b)return;await fetch("/api/users/phone-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.access_token}`},body:JSON.stringify({userId:e,organizationId:"current",config:n})}),r()}catch(b){console.error(b)}},m=()=>{if(!d)return;const b={...n,numbers:[...n.numbers||[],{number:d,label:"Secondary",consecutive_failures:0}]};a(b),h("")},g=b=>{const j={...n,numbers:n.numbers.filter((w,_)=>_!==b)};a(j)};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-md p-6 border border-slate-200 dark:border-slate-800",children:[s.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:["  - ",t]}),s.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"    ."}),l?s.jsx("div",{className:"py-8 text-center text-slate-500",children:" ..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between bg-slate-50 dark:bg-slate-800 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${n.auto_rotate?"bg-brand-100 text-brand-600":"bg-slate-200 text-slate-500"}`,children:s.jsx(si,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Anti-Spam Protection"}),s.jsx("p",{className:"text-xs text-slate-500",children:"     "})]})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"sr-only peer",checked:n.auto_rotate,onChange:b=>a({...n,auto_rotate:b.target.checked})}),s.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-brand-300 dark:peer-focus:ring-brand-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-brand-600"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:" "}),(!n.numbers||n.numbers.length===0)&&s.jsx("p",{className:"text-sm text-slate-400 italic",children:"    (  )"}),(x=n.numbers)==null?void 0:x.map((b,j)=>s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${j===n.active_index?"border-brand-500 bg-brand-50 dark:bg-brand-900/20":"border-slate-200 dark:border-slate-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-xs font-bold w-6 h-6 flex items-center justify-center bg-white dark:bg-slate-800 rounded-full border border-slate-200 dark:border-slate-700",children:j+1}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-mono font-medium text-slate-900 dark:text-white",children:b.number}),b.consecutive_failures>0&&s.jsxs("span",{className:"text-[10px] text-rose-500",children:["(",b.consecutive_failures," )"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>a({...n,active_index:j}),title:" ",className:`p-1.5 rounded hover:bg-white dark:hover:bg-slate-800 ${j===n.active_index?"text-brand-600":"text-slate-400 hover:text-brand-600"}`,children:s.jsx(Rn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>g(j),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-800 text-slate-400 hover:text-rose-500",children:s.jsx(Lt,{className:"w-4 h-4"})})]})]},j)),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsx("input",{type:"text",placeholder:"+972...",value:d,onChange:b=>h(b.target.value),className:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none"}),s.jsx(je,{onClick:m,disabled:!d,variant:"secondary",size:"sm",children:""})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[s.jsx(je,{variant:"ghost",onClick:r,children:""}),s.jsx(je,{onClick:f,disabled:l,children:" "})]})]})})},nde=({members:e})=>{const[t,r]=v.useState("users"),[n,a]=v.useState(null),l=e.length>0?e:[{id:"1",name:" ",email:"sara@company.com",role:"rep",team:" ",status:"active",lastLogin:" "},{id:"2",name:" ",email:"david@company.com",role:"manager",team:"",status:"active",lastLogin:""}];return s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:e.length||12}),s.jsx("p",{className:"text-xs text-slate-500",children:" "})]}),s.jsx(Kr,{className:"w-8 h-8 text-brand-100 dark:text-brand-900/50"})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"3"}),s.jsx("p",{className:"text-xs text-slate-500",children:" "})]}),s.jsx(gs,{className:"w-8 h-8 text-amber-100 dark:text-amber-900/50"})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"4"}),s.jsx("p",{className:"text-xs text-slate-500",children:""})]}),s.jsx(Kr,{className:"w-8 h-8 text-blue-100 dark:text-blue-900/50"})]})]}),s.jsxs("div",{className:"flex gap-4 border-b border-slate-200 dark:border-slate-800",children:[s.jsx("button",{onClick:()=>r("users"),className:`pb-2 text-sm font-medium transition-colors border-b-2 ${t==="users"?"border-brand-600 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:""}),s.jsx("button",{onClick:()=>r("roles"),className:`pb-2 text-sm font-medium transition-colors border-b-2 ${t==="roles"?"border-brand-600 text-brand-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:" "})]}),t==="users"?s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:" ...",className:"pl-4 pr-9 py-1.5 text-sm bg-slate-50 dark:bg-slate-800 border-none rounded-lg w-64 outline-none focus:ring-1 focus:ring-brand-500"}),s.jsx(Kr,{className:"w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2"})]}),s.jsxs(je,{size:"sm",children:[s.jsx(Nn,{className:"w-4 h-4 ml-1.5"}),"  "]})]}),s.jsxs("table",{className:"w-full text-right text-sm",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-slate-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:" "}),s.jsx("th",{className:"px-6 py-3 font-medium"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:l.map(c=>s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors cursor-pointer group",children:[s.jsx("td",{className:"px-6 py-3 font-medium text-slate-900 dark:text-white",children:c.name}),s.jsx("td",{className:"px-6 py-3 text-slate-500",children:c.email}),s.jsx("td",{className:"px-6 py-3",children:s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300",children:c.role})}),s.jsx("td",{className:"px-6 py-3 text-slate-500",children:c.team}),s.jsx("td",{className:"px-6 py-3",children:s.jsx(qr,{variant:c.status==="active"?"success":"warning",children:c.status==="active"||!c.status?"":""})}),s.jsx("td",{className:"px-6 py-3 text-slate-500 font-mono text-xs",children:c.last_sign_in_at?new Date(c.last_sign_in_at).toLocaleDateString("he-IL"):c.lastLogin||"-"}),s.jsxs("td",{className:"px-6 py-3 text-left",children:[s.jsx("button",{className:"text-slate-400 hover:text-brand-600 p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors opacity-0 group-hover:opacity-100",children:s.jsx(pw,{className:"w-4 h-4"})}),s.jsx("button",{onClick:d=>{d.stopPropagation(),a({id:c.id,name:c.name})},title:" ",className:"text-slate-400 hover:text-emerald-600 p-1.5 rounded-lg hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors opacity-0 group-hover:opacity-100 mx-1",children:s.jsx(ft,{className:"w-4 h-4"})})]})]},c.id))})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["  (Admin)","  (Manager)","  (Rep)"].map((c,d)=>s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm hover:border-brand-300 transition-colors",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("div",{className:"p-2 bg-brand-50 dark:bg-brand-900/20 rounded-lg text-brand-600 dark:text-brand-400",children:s.jsx(_m,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{title:"",className:"p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded text-slate-400 hover:text-slate-600",children:s.jsx(p0,{className:"w-4 h-4"})}),s.jsx("button",{title:"",className:"p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded text-slate-400 hover:text-slate-600",children:s.jsx(Mu,{className:"w-4 h-4"})})]})]}),s.jsx("h4",{className:"font-bold text-slate-900 dark:text-white mb-1",children:c}),s.jsx("p",{className:"text-xs text-slate-500 mb-4 h-8",children:d===0?"     .":"      ."}),s.jsxs("div",{className:"flex gap-2 text-xs text-slate-500 bg-slate-50 dark:bg-slate-800/50 p-2 rounded",children:[s.jsx(Ct,{className:"w-3.5 h-3.5 text-emerald-500"}),s.jsx("span",{children:" -CRM"}),s.jsx("span",{className:"text-slate-300",children:"|"}),s.jsx(Ct,{className:"w-3.5 h-3.5 text-emerald-500"}),s.jsx("span",{children:""})]})]},d))}),n&&s.jsx(rde,{userId:n.id,userName:n.name,onClose:()=>a(null)})]})},sde=()=>{const e=[{title:"",items:[{name:"Twilio Voice",status:"connected",type:"Voice Provider"}]},{title:" ",items:[{name:"Soniox AI",status:"connected",type:"Transcription Engine"}]},{title:"CRM & Webhooks",items:[{name:"Salesforce",status:"disconnected",type:"CRM Sync"},{name:"HubSpot",status:"connected",type:"CRM Sync"}]},{title:"",items:[{name:"Slack",status:"connected",type:"Notifications"},{name:"Zoom",status:"disconnected",type:"Video"}]}];return s.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400 px-4 py-2 rounded-lg border border-emerald-100 dark:border-emerald-900/20 text-sm font-medium w-fit",children:[s.jsx(Ct,{className:"w-4 h-4"})," -4  "]}),s.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:e.map((t,r)=>s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 border-b border-slate-200 dark:border-slate-800 pb-2",children:t.title}),s.jsx("div",{className:"space-y-4",children:t.items.map((n,a)=>s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-4 shadow-sm flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n.status==="connected"?"bg-brand-50 dark:bg-brand-900/20 text-brand-600":"bg-slate-100 dark:bg-slate-800 text-slate-400"}`,children:s.jsx(vw,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:n.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${n.status==="connected"?"bg-emerald-500":"bg-slate-300"}`}),s.jsx("span",{className:"text-xs text-slate-500",children:n.status==="connected"?"":" "})]})]})]}),s.jsx(je,{variant:n.status==="connected"?"secondary":"primary",size:"sm",children:n.status==="connected"?"":""})]},a))})]},r))})]})},ade=()=>s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:" "}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{icon:ai,title:" ",desc:"Push notifications ",active:!0},{icon:gs,title:" ",desc:"   ",active:!0},{icon:UE,title:" SMS",desc:"",active:!1,disabled:!0}].map((e,t)=>s.jsxs("div",{className:`border rounded-lg p-4 flex items-start justify-between ${e.active?"border-brand-200 bg-brand-50/50 dark:bg-brand-900/10 dark:border-brand-800":"border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 opacity-70"}`,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx(e.icon,{className:`w-5 h-5 ${e.active?"text-brand-600":"text-slate-400"}`}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:e.title}),s.jsx("p",{className:"text-xs text-slate-500",children:e.desc})]})]}),!e.disabled&&s.jsx("div",{className:`w-9 h-5 rounded-full relative cursor-pointer ${e.active?"bg-brand-600":"bg-slate-300 dark:bg-slate-600"}`,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-all ${e.active?"right-1":"left-1"}`})})]},t))})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:" "}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3",children:""}),s.jsx("div",{className:"space-y-2",children:["   ",'  (Score > 80)  " AI',"    4 "].map((e,t)=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 dark:hover:bg-slate-800/50 rounded-lg cursor-pointer transition-colors",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:e})]},t))})]}),s.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-800 pt-4",children:[s.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3",children:" "}),s.jsx("div",{className:"space-y-2",children:["      -60","    ","     "].map((e,t)=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 dark:hover:bg-slate-800/50 rounded-lg cursor-pointer transition-colors",children:[s.jsx("input",{type:"checkbox",defaultChecked:t===0,className:"w-4 h-4 rounded border-slate-300 text-brand-600 focus:ring-brand-500"}),s.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:e})]},t))})]})]}),s.jsx("div",{className:"mt-8 flex justify-end",children:s.jsx(je,{children:"  "})})]})]}),ide=()=>s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsxs("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2",children:[s.jsx(_m,{className:"w-5 h-5 text-emerald-500"}),"  "]}),s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white block",children:"  - (2FA)"}),s.jsx("span",{className:"text-xs text-slate-500",children:"        "})]}),s.jsx("div",{className:"w-10 h-5 bg-brand-600 rounded-full relative cursor-pointer",children:s.jsx("div",{className:"absolute right-1 top-1 w-3 h-3 bg-white rounded-full shadow-sm"})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:" "}),s.jsxs("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{children:" ( 8 )"}),s.jsx("option",{children:" ( )"}),s.jsx("option",{children:" (  )"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"  (Session Timeout)"}),s.jsxs("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{children:"30 "}),s.jsx("option",{children:"60 "}),s.jsx("option",{children:"4 "})]})]})]}),s.jsxs("div",{className:"pt-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"IP Allowlist ( )"}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[s.jsxs("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 rounded text-xs border border-slate-200 dark:border-slate-700 flex items-center gap-1",children:["213.57.120.* ",s.jsx("button",{children:s.jsx(du,{className:"w-3 h-3 text-slate-400 hover:text-rose-500"})})]}),s.jsxs("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 rounded text-xs border border-slate-200 dark:border-slate-700 flex items-center gap-1",children:["84.110.20.* ",s.jsx("button",{children:s.jsx(du,{className:"w-3 h-3 text-slate-400 hover:text-rose-500"})})]})]}),s.jsx(je,{size:"sm",variant:"secondary",className:"text-xs h-7 border-dashed",children:"+   IP"})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-6",children:"  "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:" "}),s.jsxs("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:[s.jsx("option",{children:"  6 "}),s.jsx("option",{children:"  12 "}),s.jsx("option",{children:" "})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"  (Transcripts)"}),s.jsx("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:s.jsx("option",{children:"  24 "})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"  CRM"}),s.jsx("select",{className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none",children:s.jsx("option",{children:" "})})]})]}),s.jsxs("p",{className:"text-xs text-slate-400 flex items-center gap-1.5 bg-slate-50 dark:bg-slate-800/50 p-2 rounded",children:[s.jsx(_n,{className:"w-3.5 h-3.5"})," :         ."]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-rose-100 dark:border-rose-900/30 p-6 shadow-sm",children:[s.jsx("h3",{className:"text-base font-bold text-rose-600 dark:text-rose-400 mb-4",children:" "}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(je,{variant:"secondary",className:"border-rose-200 text-rose-600 hover:bg-rose-50 hover:border-rose-300 dark:border-rose-900 dark:text-rose-400 dark:hover:bg-rose-900/20",children:[s.jsx(Du,{className:"w-4 h-4 ml-2"}),"   (CSV)"]}),s.jsxs(je,{variant:"danger",className:"bg-white border border-rose-200 text-rose-600 hover:bg-rose-600 hover:text-white dark:bg-slate-900 dark:border-rose-900",children:[s.jsx(sa,{className:"w-4 h-4 ml-2"}),"  "]})]})]})]}),lde=({usage:e})=>s.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-xl shadow-lg p-6 text-white relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-20 -mt-20 blur-3xl"}),s.jsxs("div",{className:"relative z-10 flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"text-2xl font-bold",children:" Pro Team"}),s.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-400/30 border border-indigo-300/30 text-xs font-medium",children:""})]}),s.jsx("p",{className:"text-indigo-100 text-sm mb-6",children:"   ."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{className:"px-4 py-2 bg-white text-indigo-700 rounded-lg text-sm font-bold hover:bg-indigo-50 transition-colors",children:" -Enterprise"}),s.jsx("button",{className:"px-4 py-2 bg-indigo-700/50 border border-indigo-400/30 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors",children:" "})]})]}),s.jsxs("div",{className:"text-left bg-white/10 p-4 rounded-lg backdrop-blur-sm border border-white/10 min-w-[200px]",children:[s.jsx("p",{className:"text-xs text-indigo-200 uppercase tracking-wider mb-1",children:" "}),s.jsx("p",{className:"text-xl font-bold mb-4",children:"1,200"}),s.jsx("p",{className:"text-xs text-indigo-200 uppercase tracking-wider mb-1",children:" "}),s.jsx("p",{className:"text-sm font-medium",children:"10 , 2025"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm",children:[s.jsx("p",{className:"text-xs text-slate-500 mb-1",children:" (Seats)"}),s.jsxs("div",{className:"flex justify-between items-end mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:e.users}),s.jsx("span",{className:"text-xs font-medium text-slate-400",children:" 20"})]}),s.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-brand-500 w-[60%]"})})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm",children:[s.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"  "}),s.jsxs("div",{className:"flex justify-between items-end mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:Math.round(e.minutes)}),s.jsx("span",{className:"text-xs font-medium text-slate-400",children:" 2,000"})]}),s.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-emerald-500 w-[42%]"})})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm",children:[s.jsx("p",{className:"text-xs text-slate-500 mb-1",children:" "}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[s.jsx("div",{className:"w-10 h-6 bg-slate-800 rounded text-white text-[8px] flex items-center justify-center tracking-widest",children:"VISA"}),s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"**** 4242"})]}),s.jsx("button",{className:"text-xs text-brand-600 dark:text-brand-400 font-medium hover:underline mt-2",children:"  "})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[s.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-sm",children:" "}),s.jsx("button",{className:"text-xs text-brand-600 dark:text-brand-400 hover:underline",children:" "})]}),s.jsxs("table",{className:"w-full text-right text-sm",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-slate-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium",children:""}),s.jsx("th",{className:"px-6 py-3 font-medium"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:[{date:"10/11/2024",period:"Nov 2024",amount:"1,200",status:"paid"},{date:"10/10/2024",period:"Oct 2024",amount:"1,200",status:"paid"},{date:"10/09/2024",period:"Sep 2024",amount:"1,200",status:"paid"}].map((t,r)=>s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[s.jsx("td",{className:"px-6 py-3 text-slate-700 dark:text-slate-300",children:t.date}),s.jsx("td",{className:"px-6 py-3 text-slate-500",children:t.period}),s.jsx("td",{className:"px-6 py-3 font-medium text-slate-900 dark:text-white",children:t.amount}),s.jsx("td",{className:"px-6 py-3",children:s.jsx(qr,{variant:"success",className:"text-[10px] uppercase",children:""})}),s.jsx("td",{className:"px-6 py-3 text-left",children:s.jsxs("button",{className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 flex items-center gap-1 text-xs",children:[s.jsx(Du,{className:"w-3.5 h-3.5"})," PDF"]})})]},r))})]})]})]}),xE=({setCategory:e,stats:t})=>{const[r,n]=v.useState(ede),[a,l]=v.useState(!1);return Ur.useEffect(()=>{(async()=>{try{const d=await fetch("/api/system/health");if(d.ok){const h=await d.json();h.success&&Array.isArray(h.health)&&h.health.length>0&&n(h.health)}}catch(d){console.warn("System Health Check Failed - Using cached data:",d)}})()},[]),s.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]"}),s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white uppercase tracking-wide",children:" "})]}),s.jsxs("a",{href:"#",className:"text-xs text-brand-600 dark:text-brand-400 font-medium hover:underline flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 ml-1"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map(c=>s.jsxs("div",{className:"flex flex-col gap-2 p-3 rounded-lg border border-slate-100 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-800/20",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 truncate pr-2",children:c.name}),c.status==="operational"&&s.jsx(Ct,{className:"w-4 h-4 text-emerald-500"}),c.status==="degraded"&&s.jsx(_n,{className:"w-4 h-4 text-amber-500"}),c.status==="down"&&s.jsx(du,{className:"w-4 h-4 text-rose-500"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded uppercase font-bold tracking-wider
                     ${c.status==="operational"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":""}
                     ${c.status==="degraded"?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":""}
                     ${c.status==="down"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400":""}
                   `,children:c.status==="operational"?"":c.status==="degraded"?"":""}),s.jsx("span",{className:"text-[10px] text-slate-400 tabular-nums",children:c.latency})]})]},c.id))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[s.jsxs("div",{onClick:()=>e("profile"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 flex items-center justify-center text-indigo-600 dark:text-indigo-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(H$,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"  , ,   ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("team"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center text-blue-600 dark:text-blue-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(Kr,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:" "}),s.jsxs("span",{className:"text-xs bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-2 py-0.5 rounded-full",children:[t.users," "]})]}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:" ,      ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("calls"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center text-emerald-600 dark:text-emerald-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(ft,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:" "}),s.jsxs("div",{className:"flex gap-2 mb-6 h-10 items-start",children:[s.jsx(qr,{variant:"success",className:"text-[10px]",children:" "}),s.jsx(qr,{variant:"brand",className:"text-[10px]",children:"AI Coach "})]}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("pipeline"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-teal-50 dark:bg-teal-900/20 flex items-center justify-center text-teal-600 dark:text-teal-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(ME,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"  ,    ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("knowledge"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center text-orange-600 dark:text-orange-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(Pu,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:" "}),s.jsxs("span",{className:"text-xs bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-2 py-0.5 rounded-full",children:[t.knowledge," "]})]}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"   ,      ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("campaigns"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-50 dark:bg-pink-900/20 flex items-center justify-center text-pink-600 dark:text-pink-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(vr,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:""}),s.jsxs("span",{className:"text-xs bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-2 py-0.5 rounded-full",children:[t.campaigns," "]})]}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"  ,      ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("integrations"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center text-purple-600 dark:text-purple-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(vw,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:""}),s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:[t.activeIntegrations,"  .   API -Webhooks."]}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("notifications"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-50 dark:bg-amber-900/20 flex items-center justify-center text-amber-600 dark:text-amber-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(ai,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:""}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"    ,   ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("security"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-rose-50 dark:bg-rose-900/20 flex items-center justify-center text-rose-600 dark:text-rose-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(_m,{className:"w-5 h-5"})}),s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white mb-2",children:" "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:"  - (2FA),    ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]}),s.jsxs("div",{onClick:()=>e("billing"),className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-md transition-all cursor-pointer group hover:border-brand-200 dark:hover:border-brand-800",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-teal-50 dark:bg-teal-900/20 flex items-center justify-center text-teal-600 dark:text-teal-400 mb-4 group-hover:scale-110 transition-transform duration-300",children:s.jsx(g0,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white",children:" "}),s.jsxs("span",{className:"text-xs bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 px-2 py-0.5 rounded-full",children:[t.leads," "]})]}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed h-10",children:" ,     ."}),s.jsxs("span",{className:"text-xs font-bold text-brand-600 dark:text-brand-400 flex items-center",children:["  ",s.jsx(ls,{className:"w-3 h-3 mr-1"})]})]})]})]})},ode=({isDarkMode:e,user:t,onLogout:r,toggleTheme:n})=>{const a=[{id:"overview",label:" ",icon:si},{id:"profile",label:" ",icon:Rn},{id:"team",label:" ",icon:Kr},{id:"calls",label:" ",icon:ft},{id:"pipeline",label:" ",icon:ME},{id:"campaigns",label:"",icon:vr},{id:"knowledge",label:" ",icon:Pu},{id:"webhooks",label:"Webhooks",icon:DE},{id:"integrations",label:"",icon:vw},{id:"notifications",label:"",icon:ai},{id:"security",label:" ",icon:_m},{id:"billing",label:"",icon:g0}],l=t.type==="rep"?a.filter(T=>T.id==="profile"):a,[c,d]=v.useState(t.type==="rep"?"profile":"overview"),h=()=>{switch(c){case"overview":return s.jsx(xE,{setCategory:d,stats:S});case"profile":return s.jsx(tde,{user:t,isDarkMode:e,toggleTheme:n});case"team":return s.jsx(nde,{members:g});case"calls":return s.jsx(Yce,{user:t});case"pipeline":return s.jsx(Gce,{orgId:t.organization_id});case"campaigns":return s.jsx(Kce,{});case"knowledge":return s.jsx(Zce,{user:t});case"webhooks":return s.jsx(Qce,{});case"integrations":return s.jsx(sde,{});case"notifications":return s.jsx(ade,{});case"security":return s.jsx(ide,{});case"billing":return s.jsx(lde,{usage:{users:S.users,minutes:b}});default:return s.jsx(xE,{setCategory:d,stats:S})}},m=(()=>{switch(c){case"overview":return{title:" ",desc:"   , ,    ."};case"profile":return{title:" ",desc:"   ,    ."};case"team":return{title:" ",desc:"  ,    ."};case"calls":return{title:" ",desc:"   ,      ."};case"pipeline":return{title:" ",desc:"   -Pipeline,    ."};case"campaigns":return{title:"",desc:"      ( , , )."};case"knowledge":return{title:" ",desc:"     -       ."};case"webhooks":return{title:"Webhooks & API",desc:"  ,  ,   ."};case"integrations":return{title:"",desc:"      (CRM,  )."};case"notifications":return{title:"",desc:"      ."};case"security":return{title:" ",desc:"   ,    ."};case"billing":return{title:"",desc:"  ,    ."};default:return{title:"",desc:""}}})(),[g,x]=v.useState([]),[b,j]=v.useState(0),[w,_]=v.useState(0),[N,C]=v.useState(0),[A,E]=v.useState(0);Ur.useEffect(()=>{(async()=>{const{data:D}=await ge.from("profiles").select("id, full_name, email, role, avatar_url");if(D&&x(D.map(P=>({id:P.id,name:P.full_name||"User",email:P.email||"",role:P.role||"rep",avatar_url:P.avatar_url}))),t.role==="manager"){const{data:P}=await ge.from("calls").select("duration");if(P){const R=P.reduce((F,V)=>F+(V.duration||0),0);j(R/60)}const{count:I}=await ge.from("leads").select("*",{count:"exact",head:!0});_(I||0);const{count:$}=await ge.from("campaigns").select("*",{count:"exact",head:!0});C($||0);const{count:M}=await ge.from("organization_knowledge").select("*",{count:"exact",head:!0});E(M||0)}else{const{count:P}=await ge.from("leads").select("*",{count:"exact",head:!0});_(P||0)}})()},[t.role]);const S={users:g.length||1,activeIntegrations:4,leads:w,campaigns:N,knowledge:A};return s.jsxs("div",{className:"flex flex-1 h-full bg-slate-50 dark:bg-slate-950 overflow-hidden",children:[s.jsxs("div",{className:"w-64 flex-shrink-0 bg-white dark:bg-slate-900 border-e border-slate-200 dark:border-slate-800 hidden lg:flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800",children:[s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"  "})]}),s.jsx("div",{className:"p-3 space-y-1 flex-1 overflow-y-auto",children:l.map(T=>s.jsxs("button",{onClick:()=>d(T.id),className:`
                w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all
                ${c===T.id?"bg-brand-50 text-brand-700 dark:bg-brand-900/20 dark:text-brand-300":"text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-200"}
              `,children:[s.jsx(T.icon,{className:`w-4 h-4 ${c===T.id?"text-brand-600":"opacity-70"}`}),T.label]},T.id))}),s.jsx("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800",children:s.jsxs("button",{onClick:r,className:"flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/10 rounded-lg transition-colors",children:[s.jsx(bw,{className:"w-4 h-4"}),""]})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 lg:p-10",children:[s.jsx("div",{className:"flex items-center justify-between mb-8 animate-in fade-in duration-300",children:s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-3 mb-1",children:s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.title})}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:m.desc})]})}),h()]})]})},cde=({type:e})=>{switch(e){case"call":return s.jsx(ft,{className:"w-3.5 h-3.5"});case"email":return s.jsx(gs,{className:"w-3.5 h-3.5"});case"proposal":return s.jsx(ps,{className:"w-3.5 h-3.5"});case"file":return s.jsx(ps,{className:"w-3.5 h-3.5"});case"whatsapp":return s.jsx(Xn,{className:"w-3.5 h-3.5"});case"meeting":return s.jsx(dw,{className:"w-3.5 h-3.5"});default:return s.jsx(ww,{className:"w-3.5 h-3.5"})}},dR=({type:e})=>{switch(e){case"call":return s.jsx("span",{children:" "});case"email":return s.jsx("span",{children:""});case"proposal":return s.jsx("span",{children:" "});case"whatsapp":return s.jsx("span",{children:" "});case"meeting":return s.jsx("span",{children:""});case"file":return s.jsx("span",{children:""});default:return s.jsx("span",{children:""})}},e0=({task:e,onClick:t})=>s.jsxs("div",{onClick:t,className:"flex items-center justify-between p-4 rounded-xl border border-transparent bg-white dark:bg-slate-900 shadow-sm hover:shadow-md hover:border-brand-200 dark:hover:border-slate-700 transition-all cursor-pointer group relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[s.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-200 ${e.status==="completed"?"bg-emerald-500 border-emerald-500 text-white":"border-slate-300 dark:border-slate-600 hover:border-brand-500 bg-slate-50 dark:bg-slate-800"}`,onClick:r=>{r.stopPropagation()},children:e.status==="completed"&&s.jsx(ww,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:`text-sm font-bold ${e.status==="completed"?"text-slate-400 line-through":"text-slate-900 dark:text-white"}`,children:e.title}),e.priority==="high"&&s.jsx("span",{className:"flex h-2 w-2 rounded-full bg-rose-500 ring-2 ring-rose-100 dark:ring-rose-900/50",title:" "})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[s.jsxs("span",{className:`flex items-center gap-1.5 text-xs font-medium px-2 py-0.5 rounded-md ${e.type==="call"?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400":e.type==="email"?"bg-purple-50 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"}`,children:[s.jsx(cde,{type:e.type}),s.jsx("span",{className:"text-[10px]",children:s.jsx(dR,{type:e.type})})]}),s.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[s.jsx(Pr,{className:"w-3 h-3"})," ",e.dueTime]}),e.leadName&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-slate-300 text-[10px]",children:""}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 font-medium",children:e.leadName})]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-all duration-200 transform translate-x-2 group-hover:translate-x-0",children:[s.jsx("button",{className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-slate-400 hover:text-brand-600 transition-colors",children:s.jsx(tL,{className:"w-4 h-4"})}),s.jsx("button",{className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-slate-400 hover:text-rose-600 transition-colors",children:s.jsx(sa,{className:"w-4 h-4"})})]})]}),dde=({tasks:e,onSelectTask:t,activeTab:r,setActiveTab:n,filterProps:a,stats:l})=>{const c=new Date,d=c.toISOString().split("T")[0],h=new Date(c);h.setDate(c.getDate()+7);const f=h.toISOString().split("T")[0],m=P=>P?new Date(P).toISOString().split("T")[0]:"",g=e.filter(P=>P.status==="overdue"||P.status==="open"&&m(P.dueDate)<d),x=e.filter(P=>m(P.dueDate)===d),b=x.filter(P=>P.status==="completed").length;let j=e;r==="today"?j=x:r==="week"&&(j=e.filter(P=>{const I=m(P.dueDate);return I>=d&&I<=f}));const w=j.filter(P=>P.dueTime&&parseInt(P.dueTime)<12),_=j.filter(P=>P.dueTime&&parseInt(P.dueTime)>=12&&parseInt(P.dueTime)<15),N=j.filter(P=>P.dueTime&&parseInt(P.dueTime)>=15),C=r==="today"?g.filter(P=>P.status!=="completed"):[],A=e.filter(P=>P.aiReason&&P.status!=="completed").slice(0,2),{filterType:E,setFilterType:S,isFilterOpen:T,setIsFilterOpen:D}=a;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-10 px-4 md:px-6",children:[s.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl p-4 md:p-5 shadow-card hover:shadow-card-hover border border-slate-100 dark:border-slate-800 transition-all duration-300 relative overflow-hidden",children:[s.jsx("div",{className:"absolute -right-10 -top-10 w-24 h-24 bg-blue-500/5 rounded-full blur-2xl group-hover:bg-blue-500/10 transition-colors"}),s.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[s.jsx("span",{className:"text-xs md:text-sm font-medium text-slate-500 dark:text-slate-400",children:" "}),s.jsx("div",{className:"p-1 md:p-1.5 rounded-lg bg-blue-50 text-blue-600 dark:bg-blue-900/20",children:s.jsx(RE,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})})]}),s.jsx("div",{className:"mb-2 md:mb-3 relative z-10",children:s.jsx("span",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight font-mono",children:e.filter(P=>P.status==="open").length})}),s.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden relative z-10",children:s.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${e.filter(P=>P.status==="open").length/(e.length||1)*100}%`}})})]}),s.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl p-4 md:p-5 shadow-card hover:shadow-card-hover border border-slate-100 dark:border-slate-800 transition-all duration-300 relative overflow-hidden",children:[s.jsx("div",{className:"absolute -right-10 -top-10 w-24 h-24 bg-rose-500/5 rounded-full blur-2xl group-hover:bg-rose-500/10 transition-colors"}),s.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[s.jsx("span",{className:"text-xs md:text-sm font-medium text-slate-500 dark:text-slate-400",children:" "}),s.jsx("div",{className:"p-1 md:p-1.5 rounded-lg bg-rose-50 text-rose-600 dark:bg-rose-900/20",children:s.jsx(cu,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})})]}),s.jsxs("div",{className:"mb-2 md:mb-3 relative z-10 flex items-end gap-2",children:[s.jsx("span",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight font-mono",children:g.length}),g.length>0&&s.jsx(qr,{variant:"danger",className:"mb-1 text-[10px]",children:""})]}),s.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden relative z-10",children:s.jsx("div",{className:"h-full bg-rose-500 rounded-full",style:{width:`${g.length/(e.length||1)*100}%`}})})]}),s.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl p-4 md:p-5 shadow-card hover:shadow-card-hover border border-slate-100 dark:border-slate-800 transition-all duration-300 relative overflow-hidden",children:[s.jsx("div",{className:"absolute -right-10 -top-10 w-24 h-24 bg-emerald-500/5 rounded-full blur-2xl group-hover:bg-emerald-500/10 transition-colors"}),s.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[s.jsx("span",{className:"text-xs md:text-sm font-medium text-slate-500 dark:text-slate-400",children:" "}),s.jsx("div",{className:"p-1 md:p-1.5 rounded-lg bg-emerald-50 text-emerald-600 dark:bg-emerald-900/20",children:s.jsx(Ct,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})})]}),s.jsx("div",{className:"mb-2 md:mb-3 relative z-10",children:s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight font-mono",children:b}),s.jsxs("span",{className:"text-xs md:text-sm text-slate-400 font-medium",children:["/ ",x.length]})]})}),s.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden relative z-10",children:s.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-1000",style:{width:`${b/(x.length||1)*100}%`}})})]})]}),s.jsx("div",{className:"flex-1 overflow-visible lg:overflow-hidden px-4 md:px-6 pb-4 md:pb-6 min-h-0",children:s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-8 lg:grid-cols-12 lg:h-full",children:[s.jsxs("div",{className:"lg:col-span-8 flex flex-col bg-white/50 dark:bg-slate-900/50 rounded-2xl border border-slate-200/60 dark:border-slate-800/60 shadow-sm lg:h-full overflow-hidden backdrop-blur-sm order-2 lg:order-1",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 dark:border-slate-800 px-4 md:px-6 pt-4 pb-0 bg-white dark:bg-slate-900 rounded-t-2xl",children:[s.jsx("div",{className:"flex gap-6 overflow-x-auto no-scrollbar",children:[{id:"today",label:""},{id:"week",label:""},{id:"all",label:" "}].map(P=>s.jsx("button",{onClick:()=>n(P.id),className:`
                       pb-4 text-sm font-medium border-b-2 transition-all whitespace-nowrap
                       ${r===P.id?"border-brand-600 text-brand-600 dark:border-brand-400 dark:text-brand-400":"border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}
                     `,children:P.label},P.id))}),s.jsxs("div",{className:"relative mb-2 hidden sm:block",children:[s.jsxs(je,{variant:"ghost",size:"sm",className:`text-xs ${E!=="all"?"text-brand-600 bg-brand-50":""}`,onClick:()=>D(!T),children:[s.jsx(gw,{className:"w-3.5 h-3.5 ml-1.5"}),E!=="all"?s.jsx(dR,{type:E}):""]}),T&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>D(!1)}),s.jsxs("div",{className:"absolute left-0 mt-2 w-40 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-40 py-1",children:[s.jsx("button",{onClick:()=>{S("all"),D(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:""}),s.jsx("button",{onClick:()=>{S("call"),D(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:""}),s.jsx("button",{onClick:()=>{S("email"),D(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:""}),s.jsx("button",{onClick:()=>{S("proposal"),D(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:" "}),s.jsx("button",{onClick:()=>{S("meeting"),D(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:""})]})]})]})]}),s.jsxs("div",{className:"flex-1 lg:overflow-y-auto p-4 md:p-6 space-y-6 md:space-y-8 bg-slate-50/30 dark:bg-slate-950/30",children:[C.length>0&&s.jsxs("div",{className:"animate-in fade-in slide-in-from-top-4 duration-300",children:[s.jsxs("h3",{className:"text-xs font-bold text-rose-600 dark:text-rose-400 uppercase tracking-wider mb-4 flex items-center gap-2 pl-2 border-l-2 border-rose-500",children:[" (",C.length,")"]}),s.jsx("div",{className:"space-y-3",children:C.map(P=>s.jsx(e0,{task:P,onClick:()=>t(P)},P.id))})]}),w.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 pl-2 border-l-2 border-slate-200 dark:border-slate-700",children:" (08:00 - 12:00)"}),s.jsx("div",{className:"space-y-3",children:w.map(P=>s.jsx(e0,{task:P,onClick:()=>t(P)},P.id))})]}),_.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 pl-2 border-l-2 border-slate-200 dark:border-slate-700",children:" (12:00 - 15:00)"}),s.jsx("div",{className:"space-y-3",children:_.map(P=>s.jsx(e0,{task:P,onClick:()=>t(P)},P.id))})]}),N.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 pl-2 border-l-2 border-slate-200 dark:border-slate-700",children:"  (15:00 - 18:00)"}),s.jsx("div",{className:"space-y-3",children:N.map(P=>s.jsx(e0,{task:P,onClick:()=>t(P)},P.id))})]}),s.jsx("div",{className:"pt-4 text-center",children:s.jsx(je,{variant:"ghost",size:"sm",className:"text-slate-400 hover:text-brand-600",children:"  "})})]})]}),s.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-4 md:gap-6 lg:h-full lg:overflow-y-auto pb-4 order-1 lg:order-2",children:[s.jsxs("div",{className:"bg-gradient-to-br from-[#1e1b4b] to-[#312e81] rounded-2xl shadow-xl shadow-indigo-900/20 p-6 text-white relative overflow-hidden flex-shrink-0 border border-white/5",children:[s.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-indigo-500/20 rounded-full -mr-10 -mt-10 blur-3xl mix-blend-overlay"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-purple-500/20 rounded-full -ml-5 -mb-5 blur-3xl mix-blend-overlay"}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[s.jsx("div",{className:"p-2 bg-white/10 rounded-xl backdrop-blur-md border border-white/10 shadow-lg",children:s.jsx(Nr,{className:"w-5 h-5 text-yellow-300 fill-yellow-300/20"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg leading-tight",children:" "}),s.jsx("p",{className:"text-xs text-indigo-200 opacity-80",children:'   " -AI'})]})]}),s.jsx("div",{className:"space-y-4",children:A.map((P,I)=>s.jsxs("div",{className:"group bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/5 hover:border-white/20 transition-all duration-300 cursor-pointer shadow-lg hover:-translate-y-1",onClick:()=>t(P),children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(qr,{variant:"danger",className:"text-[10px] bg-rose-600 text-white border-none shadow-md shadow-rose-900/20",children:" "})}),s.jsx("span",{className:"text-xs text-indigo-200 font-mono bg-black/20 px-2 py-0.5 rounded-md",children:P.dueTime})]}),s.jsx("p",{className:"text-sm font-bold mb-1.5 truncate text-white",children:P.title}),s.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[s.jsx("div",{className:"w-0.5 h-full bg-indigo-400/50 rounded-full self-stretch"}),s.jsxs("p",{className:"text-xs text-indigo-100 opacity-80 leading-relaxed",children:['"',P.aiReason,'"']})]}),s.jsxs("button",{className:"w-full py-2 bg-white text-indigo-900 rounded-lg text-xs font-bold hover:bg-indigo-50 transition-colors flex items-center justify-center gap-2 shadow-sm",children:[s.jsx(Kl,{className:"w-3 h-3 fill-current"}),"  "]})]},P.id))})]})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm p-6",children:[s.jsxs("h3",{className:"font-bold text-slate-900 dark:text-white text-sm mb-5 flex items-center gap-2",children:[s.jsx(dw,{className:"w-4 h-4 text-brand-500"})," "]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"",count:l.calls,icon:ft,color:"text-blue-600 bg-blue-50 dark:bg-blue-900/20"},{label:"",count:l.emails,icon:gs,color:"text-purple-600 bg-purple-50 dark:bg-purple-900/20"},{label:" ",count:l.proposals,icon:ps,color:"text-pink-600 bg-pink-50 dark:bg-pink-900/20"},{label:"",count:l.meetings,icon:Kr,color:"text-amber-600 bg-amber-50 dark:bg-amber-900/20"}].map((P,I)=>s.jsxs("div",{className:"flex flex-col items-center justify-center p-4 rounded-xl border border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/20 hover:bg-slate-100 dark:hover:bg-slate-800/40 transition-colors group cursor-default",children:[s.jsx("div",{className:`p-2.5 rounded-xl mb-2 ${P.color} group-hover:scale-110 transition-transform duration-300`,children:s.jsx(P.icon,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-xl font-bold text-slate-900 dark:text-white",children:P.count}),s.jsx("span",{className:"text-xs text-slate-500 font-medium",children:P.label})]},I))})]})]})]})})]})},ude=({isDarkMode:e,currentUser:t})=>{const[r,n]=v.useState("today"),[a,l]=v.useState("all"),[c,d]=v.useState(!1),f=((t==null?void 0:t.type)||"manager")==="rep",[m,g]=v.useState("all"),[x,b]=v.useState(!1),[j,w]=v.useState([]);v.useEffect(()=>{(async()=>{if(f||!(t!=null&&t.organization_id))return;const{data:F}=await ge.from("profiles").select("id, full_name, avatar_url").eq("organization_id",t.organization_id);F&&w(F.map(V=>({id:V.id,name:V.full_name,avatar:V.avatar_url})))})()},[t,f]);const _=f?t.id:m==="all"?void 0:m,{tasks:N,loading:C,addTask:A,toggleTask:E}=nR(t.organization_id,_),T=N.map(R=>{const F=R.rawDate?new Date(R.rawDate):new Date;return{id:R.id,title:R.title,type:R.type||"admin",dueDate:F.toISOString().split("T")[0],dueTime:R.dueTime||"12:00",leadName:R.leadName,status:R.completed?"completed":new Date(R.dueDate)<new Date?"overdue":"open",priority:R.priority||"medium",ownerId:R.ownerId||t.id,aiReason:R.ai_reason}}),D=a==="all"?T:T.filter(R=>R.type===a),P={calls:T.filter(R=>R.type==="call").length,emails:T.filter(R=>R.type==="email").length,proposals:T.filter(R=>R.type==="proposal").length,meetings:T.filter(R=>R.type==="meeting").length},[I,$]=v.useState(!1),M=()=>{$(!0)};return s.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col h-full bg-slate-50 dark:bg-slate-950 relative",children:[s.jsxs("div",{className:"px-6 py-6 md:py-8 flex flex-col md:flex-row md:items-center justify-between gap-4 flex-shrink-0",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:f?" ":"  "}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-1",children:f?"   .":"    ."})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[!f&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>b(!x),className:"flex items-center gap-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 text-sm rounded-xl px-4 py-2.5 hover:border-brand-400 transition-all shadow-sm",children:[s.jsx(gw,{className:"w-4 h-4 text-brand-600"}),s.jsx("span",{className:"font-medium",children:""}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 transition-transform ${x?"rotate-180":""}`})]}),x&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>b(!1)}),s.jsxs("div",{className:"absolute left-0 mt-2 w-52 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-xl z-40 py-2 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[s.jsxs("button",{onClick:()=>{g("all"),b(!1)},className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm transition-colors ${m==="all"?"bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-400 font-semibold":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"}`,children:[m==="all"&&s.jsx("span",{className:"w-2 h-2 rounded-full bg-brand-600"}),s.jsx("span",{className:m!=="all"?"mr-5":"",children:" "})]}),s.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-800 my-1"}),j.map(R=>s.jsxs("button",{onClick:()=>{g(R.id),b(!1)},className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm transition-colors ${m===R.id?"bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-400 font-semibold":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"}`,children:[m===R.id&&s.jsx("span",{className:"w-2 h-2 rounded-full bg-brand-600"}),s.jsx("img",{src:R.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(R.name||"U")}&background=random&size=24`,alt:"",className:"w-6 h-6 rounded-full object-cover"}),s.jsx("span",{className:(m!==R.id,""),children:R.name})]},R.id)),m!=="all"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-800 my-1"}),s.jsx("button",{onClick:()=>{g("all"),b(!1)},className:"w-full text-center px-4 py-2.5 text-sm text-brand-600 hover:text-brand-700 font-medium hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:""})]})]})]})]}),s.jsxs(je,{onClick:M,children:[s.jsx(Nn,{className:"w-4 h-4 ml-2"})," "]})]})]}),s.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col min-h-0",children:[C?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("span",{className:"text-slate-400",children:" ..."})}):s.jsx(dde,{tasks:D,onSelectTask:R=>E(R.id,R.status==="completed"),activeTab:r,setActiveTab:n,filterProps:{filterType:a,setFilterType:l,isFilterOpen:c,setIsFilterOpen:d},stats:P}),s.jsx(aR,{isOpen:I,onClose:()=>$(!1),onAdd:A})]})]})},hde=({targetData:e,user:t,onClose:r,onSave:n})=>{const[a,l]=Ur.useState(null);if(Ur.useEffect(()=>{e&&l({calls:e.calls.target,connectedCalls:e.connectedCalls.target,talkTime:e.talkTime.target,conversion:15,quality:80,deals:e.deals.target*20,revenue:e.revenue.target})},[e]),!e||!t||!a)return null;const c=(h,f)=>{l(m=>({...m,[h]:Number(f)}))},d=()=>{n(a)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-40",onClick:r}),s.jsxs("div",{className:"fixed inset-y-0 left-0 z-50 w-full md:w-[480px] bg-white dark:bg-slate-950 shadow-2xl border-r border-slate-200 dark:border-slate-800 transform transition-transform duration-300 ease-in-out flex flex-col",children:[s.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex justify-between items-start bg-slate-50/50 dark:bg-slate-900/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:t.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=random`,alt:"",className:"w-12 h-12 rounded-full border-2 border-slate-200 dark:border-slate-700"}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-white leading-tight",children:["  ",t.name]}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"    "})]})]}),s.jsx("button",{onClick:r,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 dark:border-slate-800 pb-2",children:[s.jsx(si,{className:"w-4 h-4 text-brand-500"}),s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white uppercase",children:" (Activity)"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.calls,onChange:h=>c("calls",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.connectedCalls,onChange:h=>c("connectedCalls",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"   ()"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.talkTime,onChange:h=>c("talkTime",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 dark:border-slate-800 pb-2",children:[s.jsx(sl,{className:"w-4 h-4 text-purple-500"}),s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white uppercase",children:" (Quality)"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"  ( )"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.conversion,onChange:h=>c("conversion",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:"%"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.quality,onChange:h=>c("quality",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 dark:border-slate-800 pb-2",children:[s.jsx(dw,{className:"w-4 h-4 text-emerald-500"}),s.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white uppercase",children:" (Outcome)"})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.deals,onChange:h=>c("deals",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:a.revenue,onChange:h=>c("revenue",h.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 pointer-events-none",children:""})]})]})]})]}),s.jsxs("div",{className:"bg-brand-50 dark:bg-brand-900/10 p-4 rounded-xl border border-brand-100 dark:border-brand-900/30 flex gap-3",children:[s.jsx(vr,{className:"w-5 h-5 text-brand-600 dark:text-brand-400 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-brand-800 dark:text-brand-200 leading-relaxed",children:"             .     ."})]})]}),s.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-950 flex flex-col gap-3",children:[s.jsxs(je,{onClick:d,className:"w-full justify-center",children:[s.jsx(ol,{className:"w-4 h-4 ml-2"})," "]}),s.jsxs("button",{className:"text-xs text-slate-500 hover:text-slate-800 dark:hover:text-slate-300 flex items-center justify-center gap-1.5 py-2",children:[s.jsx(Ru,{className:"w-3 h-3"}),"   "]})]})]})]})},fde=({isDarkMode:e,orgId:t})=>{var I;const[r,n]=v.useState("day"),[a,l]=v.useState("all"),[c,d]=v.useState(""),[h,f]=v.useState(!1),[m,g]=v.useState(null),[x,b]=v.useState([]),[j,w]=v.useState({}),[_,N]=v.useState(!0);Ur.useEffect(()=>{C()},[r,a,t]);const C=async()=>{if(t)try{N(!0);const{data:$,error:M}=await ge.from("profiles").select("id, full_name, avatar_url, role, organization_id").eq("organization_id",t);$&&b($.map(H=>({id:H.id,name:H.full_name,avatar:H.avatar_url,role:H.role,organization_id:H.organization_id})));const{data:R,error:F}=await ge.from("user_targets").select("*").eq("period",r);if(F)throw F;const V={};R==null||R.forEach(H=>{V[H.user_id]||(V[H.user_id]={}),V[H.user_id][H.target_type]=H.target_value}),w(V)}catch($){console.error("Error fetching data:",$)}finally{N(!1)}},A=async $=>{if(!m)return;const M=Object.keys($).map(R=>{var F;return{user_id:m,organization_id:((F=x.find(V=>V.id===m))==null?void 0:F.organization_id)||t,target_type:R,target_value:$[R],period:r}});try{const{error:R}=await ge.from("user_targets").upsert(M,{onConflict:"user_id, organization_id, target_type, period"});if(R)throw R;C(),g(null)}catch(R){console.error("Error saving targets:",R),alert("Error saving targets")}},E=$=>{const M=j[$];return{userId:$,calls:{target:(M==null?void 0:M.calls)||40,current:0},connectedCalls:{target:(M==null?void 0:M.connectedCalls)||15,current:0},talkTime:{target:(M==null?void 0:M.talkTime)||120,current:0},deals:{target:((M==null?void 0:M.deals)||5)/20,current:0},revenue:{target:(M==null?void 0:M.revenue)||5e4,current:0}}},S=m?E(m):null,T=x.find($=>$.id===m),D=({current:$,target:M,colorClass:R="bg-brand-600"})=>{const F=Math.min($/M*100,100);return s.jsx("div",{className:"w-24 h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden mt-1.5",children:s.jsx("div",{className:`h-full rounded-full ${R}`,style:{width:`${F}%`}})})},P=x.filter($=>{const M=a==="all"||$.id===a,R=c===""||$.name.toLowerCase().includes(c.toLowerCase());return M&&R});return s.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col h-full bg-slate-50 dark:bg-slate-950 relative",children:[s.jsxs("div",{className:"px-6 py-6 md:py-8 flex flex-col md:flex-row md:items-center justify-between gap-4 flex-shrink-0",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:" "}),s.jsx(qr,{variant:"brand",className:"text-xs",children:"Manager Only"})]}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"  ,     ."})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>n("day"),className:`px-4 py-1.5 text-xs font-medium rounded-md transition-all ${r==="day"?"bg-brand-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:""}),s.jsx("button",{onClick:()=>n("week"),className:`px-4 py-1.5 text-xs font-medium rounded-md transition-all ${r==="week"?"bg-brand-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:""}),s.jsx("button",{onClick:()=>n("month"),className:`px-4 py-1.5 text-xs font-medium rounded-md transition-all ${r==="month"?"bg-brand-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:""})]}),s.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-700 mx-1"}),s.jsxs("div",{className:"relative",children:[s.jsxs(je,{variant:"secondary",className:"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 min-w-[140px] justify-between items-center",onClick:()=>f(!h),children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Kr,{className:"w-4 h-4 ml-2"}),s.jsx("span",{className:"text-sm",children:a==="all"?" ":(I=x.find($=>$.id===a))==null?void 0:I.name})]}),s.jsx(Pt,{className:"w-3.5 h-3.5 mr-2 opacity-50"})]}),h&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),s.jsxs("div",{className:"absolute top-full left-0 mt-2 w-56 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-20 py-1 overflow-hidden",children:[s.jsx("button",{onClick:()=>{l("all"),f(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:" "}),x.map($=>s.jsx("button",{onClick:()=>{l($.id),f(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",children:$.name},$.id))]})]})]}),s.jsxs("div",{className:"relative w-64 hidden xl:block",children:[s.jsx(na,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:c,onChange:$=>d($.target.value),className:"w-full pr-9 pl-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg text-sm outline-none focus:ring-1 focus:ring-brand-500"})]})]})]}),s.jsx("div",{className:"flex-1 overflow-auto px-6 pb-6",children:s.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm overflow-hidden",children:s.jsxs("table",{className:"w-full text-right",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-xs text-slate-500 font-semibold uppercase border-b border-slate-100 dark:border-slate-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4",children:" "}),s.jsx("th",{className:"px-6 py-4",children:" "}),s.jsx("th",{className:"px-6 py-4",children:""}),s.jsx("th",{className:"px-6 py-4",children:" ()"}),s.jsx("th",{className:"px-6 py-4",children:" "}),s.jsx("th",{className:"px-6 py-4 w-16"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:P.map($=>{const M=E($.id),R=M.calls.target,F=M.calls.current,V=M.connectedCalls.target,H=M.connectedCalls.current,L=M.deals.target,U=M.deals.current;return M.revenue.target,M.revenue.current,s.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors",onClick:()=>g($.id),children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:$.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent($.name)}&background=random`,className:"w-9 h-9 rounded-full border border-slate-200 dark:border-slate-700 object-cover",alt:""}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm",children:$.name}),s.jsx("p",{className:"text-xs text-slate-500",children:$.role})]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:F}),s.jsxs("span",{className:"text-xs text-slate-400",children:["/ ",R]})]}),s.jsx(D,{current:F,target:R})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:H}),s.jsxs("span",{className:"text-xs text-slate-400",children:["/ ",V]})]}),s.jsx(D,{current:H,target:V,colorClass:"bg-indigo-500"})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[M.talkTime.current,"  ",s.jsxs("span",{className:"text-slate-400 font-normal",children:["/ ",M.talkTime.target]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:U}),s.jsxs("span",{className:"text-xs text-slate-400",children:["/ ",L]})]}),s.jsx(D,{current:U,target:L,colorClass:"bg-emerald-500"})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:["",(M.revenue.current/1e3).toFixed(0),"k ",s.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:["/ ",(M.revenue.target/1e3).toFixed(0),"k"]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs(qr,{variant:M.productivityScore>90?"success":M.productivityScore>75?"warning":"danger",children:[M.productivityScore,"%"]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("button",{onClick:W=>{W.stopPropagation(),g($.id)},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-slate-400 hover:text-brand-600 transition-colors",children:s.jsx(Mu,{className:"w-4 h-4"})})})]},$.id)})})]})})}),s.jsx(hde,{targetData:S,user:T,onClose:()=>g(null),onSave:A})]})},mde=({isDarkMode:e,onStartCall:t,currentUser:r})=>{const[n,a]=v.useState("day"),[l,c]=v.useState(null),[d,h]=v.useState([]),[f,m]=v.useState([]),[g,x]=v.useState([]),[b,j]=v.useState(!0);v.useEffect(()=>{(async()=>{j(!0);try{const A=r!=null&&r.id?`&userId=${r.id}`:"",E=r!=null&&r.organization_id?`&organizationId=${r.organization_id}`:"",[S,T,D,P]=await Promise.all([fetch(`/api/panel/stats?range=${n}${A}${E}`),fetch(`/api/panel/hot-leads?limit=5${A}${E}`),fetch(`/api/panel/at-risk-leads?hours=48&limit=5${A}${E}`),fetch(`/api/panel/lead-queue?limit=10${A}${E}`)]),[I,$,M,R]=await Promise.all([S.json(),T.json(),D.json(),P.json()]);I.success&&c(I.stats),$.success&&h($.leads),M.success&&m(M.leads),R.success&&x(R.leads)}catch(A){console.error("[Panel] Error fetching data:",A)}finally{j(!1)}})()},[n,r==null?void 0:r.id,r==null?void 0:r.organization_id]);const w=({title:C,current:A,target:E,percentage:S,icon:T,color:D})=>s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:C}),s.jsx("div",{className:`w-10 h-10 rounded-xl ${D} flex items-center justify-center`,children:s.jsx(T,{className:"w-5 h-5 text-white"})})]}),s.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:A}),s.jsxs("span",{className:"text-sm text-slate-400",children:["/ ",E]})]}),s.jsx("div",{className:"w-full h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${D}`,style:{width:`${S}%`}})}),s.jsxs("span",{className:"text-xs text-slate-400 mt-1 block",children:[S,"%"]})]}),_=[{name:"",value:(l==null?void 0:l.leadsContacted.current)||0,fill:"#6366f1"},{name:" ",value:(l==null?void 0:l.newLeads.current)||0,fill:"#8b5cf6"},{name:"",value:(l==null?void 0:l.appointments.current)||0,fill:"#06b6d4"},{name:"",value:(l==null?void 0:l.closedDeals.current)||0,fill:"#10b981"}],N=C=>{t&&t(C.phone,C.id)};return s.jsxs("div",{className:"flex-1 overflow-auto h-full bg-slate-50 dark:bg-slate-950 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("span",{className:"text-2xl",children:""})]}),s.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["  ",n==="day"?"":n==="week"?"":""]})]}),s.jsx("div",{className:"flex items-center bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-1 rounded-lg",children:["day","week","month"].map(C=>s.jsx("button",{onClick:()=>a(C),className:`px-4 py-1.5 text-xs font-medium rounded-md transition-all ${n===C?"bg-brand-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:C==="day"?"":C==="week"?"":""},C))})]}),b?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(C=>s.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 h-32 animate-pulse"},C))}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsx(w,{title:"  ",current:(l==null?void 0:l.leadsContacted.current)||0,target:(l==null?void 0:l.leadsContacted.target)||15,percentage:(l==null?void 0:l.leadsContacted.percentage)||0,icon:ft,color:"bg-gradient-to-br from-indigo-500 to-purple-600"}),s.jsx(w,{title:"  ",current:(l==null?void 0:l.newLeads.current)||0,target:(l==null?void 0:l.newLeads.target)||12,percentage:(l==null?void 0:l.newLeads.percentage)||0,icon:Kr,color:"bg-gradient-to-br from-purple-500 to-pink-600"}),s.jsx(w,{title:" ",current:(l==null?void 0:l.appointments.current)||0,target:(l==null?void 0:l.appointments.target)||5,percentage:(l==null?void 0:l.appointments.percentage)||0,icon:wn,color:"bg-gradient-to-br from-cyan-500 to-blue-600"}),s.jsx(w,{title:" ",current:(l==null?void 0:l.closedDeals.current)||0,target:(l==null?void 0:l.closedDeals.target)||2,percentage:(l==null?void 0:l.closedDeals.percentage)||0,icon:vr,color:"bg-gradient-to-br from-emerald-500 to-green-600"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 lg:gap-6",children:[s.jsxs("div",{className:"lg:col-span-4 space-y-4 lg:space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(uu,{className:"w-5 h-5 text-orange-500"}),s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white",children:"  "})]}),s.jsx("div",{className:"space-y-3",children:d.length===0?s.jsx("p",{className:"text-sm text-slate-400 text-center py-4",children:"   "}):d.map(C=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-xl hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors cursor-pointer group",onClick:()=>N(C),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center text-white font-bold text-sm",children:C.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-900 dark:text-white text-sm",children:C.name}),s.jsx("p",{className:"text-xs text-slate-500",children:C.company})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(qr,{variant:"warning",className:"text-xs",children:[C.score," "]}),s.jsx(je,{size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity bg-green-500 hover:bg-green-600",onClick:A=>{A.stopPropagation(),N(C)},children:s.jsx(ft,{className:"w-3 h-3"})})]})]},C.id))})]}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(_n,{className:"w-5 h-5 text-red-500"}),s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white",children:"  "}),f.length>0&&s.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-xs rounded-full font-bold",children:f.length})]}),s.jsx("div",{className:"space-y-3",children:f.length===0?s.jsx("p",{className:"text-sm text-slate-400 text-center py-4",children:"   "}):f.map(C=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/10 rounded-xl hover:bg-red-100 dark:hover:bg-red-900/20 transition-colors cursor-pointer group",onClick:()=>N(C),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-slate-600 dark:text-slate-300 font-bold text-sm",children:C.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-900 dark:text-white text-sm",children:C.name}),s.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[s.jsx(Pr,{className:"w-3 h-3"}),"   ",C.timeSinceActivity]})]})]}),s.jsx(je,{size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity bg-orange-500 hover:bg-orange-600",onClick:A=>{A.stopPropagation(),N(C)},children:s.jsx(ft,{className:"w-3 h-3"})})]},C.id))})]})]}),s.jsx("div",{className:"lg:col-span-5",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-4 md:p-5 shadow-sm h-full",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kr,{className:"w-5 h-5 text-brand-500"}),s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("span",{className:"text-xs text-slate-400",children:g.length})]}),g.length>0&&s.jsxs(je,{className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",onClick:()=>N(g[0]),children:[s.jsx(Kl,{className:"w-4 h-4 ml-2"}),"  "]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-right min-w-[500px]",children:[s.jsx("thead",{className:"text-xs text-slate-500 uppercase border-b border-slate-100 dark:border-slate-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"pb-3 font-semibold",children:" "}),s.jsx("th",{className:"pb-3 font-semibold",children:""}),s.jsx("th",{className:"pb-3 font-semibold",children:" "}),s.jsx("th",{className:"pb-3 font-semibold",children:" "}),s.jsx("th",{className:"pb-3 w-20"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:g.map((C,A)=>s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[s.jsx("td",{className:"py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-xs ${C.priority==="Hot"?"bg-gradient-to-br from-orange-400 to-red-500":C.priority==="Warm"?"bg-gradient-to-br from-amber-400 to-orange-500":"bg-gradient-to-br from-blue-400 to-indigo-500"}`,children:C.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-900 dark:text-white text-sm",children:C.name}),s.jsx("p",{className:"text-xs text-slate-500",children:C.company})]})]})}),s.jsx("td",{className:"py-3",children:s.jsx(qr,{variant:C.status==="New"?"success":C.status==="Discovery"?"brand":C.status==="Proposal"?"warning":"secondary",children:C.status})}),s.jsx("td",{className:"py-3 text-sm text-slate-500",children:C.lastActivity?new Date(C.lastActivity).toLocaleDateString("he-IL"):""}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-center gap-1",children:[s.jsx(ft,{className:"w-3 h-3"}),C.nextStep]})}),s.jsx("td",{className:"py-3",children:s.jsx(je,{size:"sm",variant:"ghost",className:"hover:bg-green-100 hover:text-green-600 dark:hover:bg-green-900/30",onClick:()=>N(C),children:s.jsx(ft,{className:"w-4 h-4"})})})]},C.id))})]})})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-4 md:p-5 shadow-sm h-full",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Lc,{className:"w-5 h-5 text-emerald-500"}),s.jsx("h2",{className:"font-bold text-slate-900 dark:text-white",children:"  "})]}),s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:(l==null?void 0:l.leadsContacted.current)||0}),s.jsx("p",{className:"text-xs text-slate-500",children:" "})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold text-emerald-500",children:[l!=null&&l.closedDeals.current?Math.round((l==null?void 0:l.closedDeals.current)/(l==null?void 0:l.leadsContacted.current)*100):0,"%"]}),s.jsx("p",{className:"text-xs text-slate-500",children:" "})]})]}),s.jsx("div",{className:"h-48",children:s.jsx(k6,{width:"100%",height:"100%",minWidth:1,children:s.jsxs(tR,{data:_,layout:"vertical",children:[s.jsx($M,{strokeDasharray:"3 3",stroke:e?"#334155":"#e2e8f0"}),s.jsx(jj,{type:"number",tick:{fill:e?"#94a3b8":"#64748b",fontSize:10}}),s.jsx(HM,{type:"category",dataKey:"name",tick:{fill:e?"#94a3b8":"#64748b",fontSize:9},width:55,tickFormatter:C=>C.length>8?C.slice(0,6)+"":C}),s.jsx(dM,{contentStyle:{backgroundColor:e?"#1e293b":"#fff",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0,0,0,0.1)"}}),s.jsx(bm,{dataKey:"value",radius:[0,4,4,0]})]})})})]})})]})]})},pde=({isDarkMode:e,currentUser:t})=>{const[r,n]=v.useState([]),[a,l]=v.useState(null),[c,d]=v.useState(""),[h,f]=v.useState([]),[m,g]=v.useState(!1),[x,b]=v.useState(!0),[j,w]=v.useState(""),[_,N]=v.useState(0),[C,A]=v.useState(!1),E=v.useRef(null),S=v.useRef(null);v.useEffect(()=>{S.current=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleT0jUY292p2PbDArQJPY88mtbzAWOnHT+ei0cDAKM2LQ/++3dDAHLVnN/vK8djEFJ1DE/vXHfDcEIkq+/fjQhD8GG0K1/tn/kEkJF0Cw/dD+l1EUR7j9xf+fXh9esy78vv+mZyZYq0L7tv+uc0o=")},[]);const T=v.useCallback(async()=>{if(!(t!=null&&t.organization_id)||!(t!=null&&t.id)){b(!1);return}try{const{data:M,error:R}=await ge.from("profiles").select("id, full_name, email, avatar_url, role").eq("organization_id",t.organization_id).neq("id",t.id);if(R)throw R;if(!M)return;const V=(await Promise.all(M.map(async L=>{const{count:U}=await ge.from("messages").select("*",{count:"exact",head:!0}).eq("sender_id",L.id).eq("recipient_id",t.id).eq("is_read",!1),{data:W}=await ge.from("messages").select("content, created_at").or(`and(sender_id.eq.${t.id},recipient_id.eq.${L.id}),and(sender_id.eq.${L.id},recipient_id.eq.${t.id})`).order("created_at",{ascending:!1}).limit(1).single();return{...L,status:"offline",unreadCount:U||0,lastMessageTime:(W==null?void 0:W.created_at)||null,lastMessageContent:(W==null?void 0:W.content)||null}}))).sort((L,U)=>L.unreadCount>0&&U.unreadCount===0?-1:L.unreadCount===0&&U.unreadCount>0?1:L.lastMessageTime&&U.lastMessageTime?new Date(U.lastMessageTime).getTime()-new Date(L.lastMessageTime).getTime():L.lastMessageTime?-1:U.lastMessageTime?1:L.full_name.localeCompare(U.full_name));n(V);const H=V.reduce((L,U)=>L+U.unreadCount,0);N(H),V.length>0&&!a&&l(V[0].id)}catch(M){console.error("Error fetching team:",M)}finally{b(!1)}},[t==null?void 0:t.organization_id,t==null?void 0:t.id,a]);v.useEffect(()=>{b(!0),T()},[T]),v.useEffect(()=>{if(!(t!=null&&t.id))return;const M=ge.channel(`global-chat-${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`recipient_id=eq.${t.id}`},R=>{const F=R.new;if(S.current&&S.current.play().catch(()=>{}),n(V=>V.map(L=>L.id===F.sender_id?{...L,unreadCount:L.id===a?L.unreadCount:L.unreadCount+1,lastMessageTime:F.created_at,lastMessageContent:F.content}:L).sort((L,U)=>L.unreadCount>0&&U.unreadCount===0?-1:L.unreadCount===0&&U.unreadCount>0?1:L.lastMessageTime&&U.lastMessageTime?new Date(U.lastMessageTime).getTime()-new Date(L.lastMessageTime).getTime():0)),F.sender_id!==a&&N(V=>V+1),F.sender_id===a){const V={id:F.id,senderId:F.sender_id,text:F.content,timestamp:new Date(F.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isRead:!1};f(H=>[...H,V]),ge.from("messages").update({is_read:!0}).eq("id",F.id)}}).subscribe();return()=>{ge.removeChannel(M)}},[t==null?void 0:t.id,a]);const D=r.find(M=>M.id===a);v.useEffect(()=>{if(!(t!=null&&t.id)||!a)return;(async()=>{g(!0);try{const{data:R,error:F}=await ge.from("messages").select("*").or(`and(sender_id.eq.${t.id},recipient_id.eq.${a}),and(sender_id.eq.${a},recipient_id.eq.${t.id})`).order("created_at",{ascending:!0});if(F)throw F;if(R){const V=R.map(L=>({id:L.id,senderId:L.sender_id,text:L.content,timestamp:new Date(L.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isRead:L.is_read,context:L.context_type?{type:L.context_type,id:L.context_id||"",label:L.context_label||"Context"}:void 0}));f(V);const H=R.filter(L=>L.sender_id===a&&!L.is_read).map(L=>L.id);H.length>0&&(await ge.from("messages").update({is_read:!0}).in("id",H),n(L=>L.map(U=>U.id===a?{...U,unreadCount:0}:U)),N(L=>Math.max(0,L-H.length)))}}catch(R){console.error("Error fetching messages:",R)}finally{g(!1)}})()},[a,t==null?void 0:t.id]),v.useEffect(()=>{E.current&&E.current.scrollIntoView({behavior:"smooth"})},[h]);const P=async()=>{if(!c.trim()||!(t!=null&&t.id)||!a)return;const M=Date.now().toString(),R=c;d("");const F={id:M,senderId:t.id,text:R,timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isRead:!1};f(V=>[...V,F]),n(V=>V.map(L=>L.id===a?{...L,lastMessageTime:new Date().toISOString(),lastMessageContent:R}:L).sort((L,U)=>L.unreadCount>0&&U.unreadCount===0?-1:L.unreadCount===0&&U.unreadCount>0?1:L.lastMessageTime&&U.lastMessageTime?new Date(U.lastMessageTime).getTime()-new Date(L.lastMessageTime).getTime():0));try{await ge.from("messages").insert({sender_id:t.id,recipient_id:a,content:R,organization_id:t.organization_id})}catch(V){console.error("Error sending message:",V)}},I=r.filter(M=>M.full_name.toLowerCase().includes(j.toLowerCase())),$=M=>{if(!M)return"";const R=new Date(M),V=new Date().getTime()-R.getTime(),H=Math.floor(V/6e4),L=Math.floor(V/36e5),U=Math.floor(V/864e5);return H<1?"":H<60?` ${H} '`:L<24?` ${L} '`:U<7?` ${U} `:R.toLocaleDateString("he-IL")};return s.jsxs("div",{className:"flex flex-1 h-full bg-slate-50 dark:bg-slate-950 overflow-hidden",children:[s.jsxs("div",{className:"hidden md:flex w-80 flex-shrink-0 bg-white dark:bg-slate-900 border-e border-slate-200 dark:border-slate-800 flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"' "}),_>0&&s.jsxs("div",{className:"flex items-center gap-2 bg-brand-100 dark:bg-brand-900/30 text-brand-700 dark:text-brand-300 px-2.5 py-1 rounded-full text-xs font-bold animate-pulse",children:[s.jsx(t9,{className:"w-3.5 h-3.5"}),s.jsxs("span",{children:[_," "]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(na,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:j,onChange:M=>w(M.target.value),className:"w-full pr-9 pl-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-1 focus:ring-brand-500"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:x?s.jsx("div",{className:"flex items-center justify-center h-32 text-slate-400",children:s.jsx(it,{className:"w-6 h-6 animate-spin"})}):I.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-slate-400 text-sm",children:[s.jsx(Xn,{className:"w-8 h-8 mb-2 opacity-50"}),s.jsx("p",{children:"  "})]}):I.map(M=>{const R=a===M.id,F=M.unreadCount>0;return s.jsxs("div",{onClick:()=>l(M.id),className:`flex items-center gap-3 p-4 cursor-pointer transition-all border-b border-slate-50 dark:border-slate-800/50 hover:bg-slate-50 dark:hover:bg-slate-800/50 ${R?"bg-brand-50/50 dark:bg-brand-900/10 border-r-4 border-r-brand-500":"border-r-4 border-r-transparent"} ${F?"bg-amber-50/30 dark:bg-amber-900/10":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:M.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(M.full_name)}&background=6366f1&color=fff`,alt:M.full_name,className:"w-11 h-11 rounded-full border-2 border-slate-200 dark:border-slate-700"}),F&&s.jsx("span",{className:"absolute -top-1 -left-1 min-w-[20px] h-5 bg-rose-500 text-white text-xs font-bold rounded-full flex items-center justify-center px-1 animate-bounce",children:M.unreadCount}),s.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 border-2 border-white dark:border-slate-900 rounded-full ${M.role==="manager"||M.role==="sales_manager"?"bg-amber-500":"bg-emerald-500"}`})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-baseline mb-0.5",children:[s.jsx("h3",{className:`text-sm font-bold truncate ${F?"text-slate-900 dark:text-white":R?"text-brand-900 dark:text-white":"text-slate-900 dark:text-slate-200"}`,children:M.full_name}),M.lastMessageTime&&s.jsx("span",{className:`text-[10px] ${F?"text-brand-600 font-bold":"text-slate-400"}`,children:$(M.lastMessageTime)})]}),s.jsx("p",{className:`text-xs truncate pr-1 ${F?"text-slate-700 dark:text-slate-300 font-medium":"text-slate-500 dark:text-slate-400"}`,children:M.lastMessageContent||(M.role==="manager"||M.role==="sales_manager"?" ":" ")})]})]},M.id)})})]}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-slate-50/30 dark:bg-slate-950",children:[s.jsxs("div",{className:"h-16 px-4 md:px-6 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex items-center justify-between shadow-sm z-10",children:[s.jsxs("div",{className:"md:hidden relative flex-1",children:[s.jsxs("button",{onClick:()=>A(!C),className:"flex items-center gap-3 w-full",children:[D?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:D.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(D.full_name)}&background=6366f1&color=fff`,alt:D.full_name,className:"w-9 h-9 rounded-full border-2 border-slate-200 dark:border-slate-700"}),s.jsxs("div",{className:"flex-1 text-right",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 dark:text-white",children:D.full_name}),s.jsx("span",{className:"text-[10px] text-slate-500",children:D.role==="manager"||D.role==="sales_manager"?"":""})]})]}):s.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[s.jsx(Kr,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:"  "})]}),s.jsx(Pt,{className:`w-4 h-4 text-slate-400 transition-transform ${C?"rotate-180":""}`})]}),C&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-20",onClick:()=>A(!1)}),s.jsx("div",{className:"absolute top-full right-0 left-0 mt-2 max-h-72 overflow-y-auto bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-xl z-30 animate-in fade-in slide-in-from-top-2 duration-200",children:I.map(M=>s.jsxs("button",{onClick:()=>{l(M.id),A(!1)},className:`w-full flex items-center gap-3 p-3 text-right hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors ${a===M.id?"bg-brand-50 dark:bg-brand-900/20":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:M.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(M.full_name)}&background=6366f1&color=fff`,alt:M.full_name,className:"w-9 h-9 rounded-full border border-slate-200 dark:border-slate-700"}),M.unreadCount>0&&s.jsx("span",{className:"absolute -top-1 -left-1 min-w-[18px] h-[18px] bg-rose-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1",children:M.unreadCount})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:M.full_name}),s.jsx("p",{className:"text-xs text-slate-500 truncate",children:M.lastMessageContent||" "})]})]},M.id))})]})]}),D?s.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[s.jsx("img",{src:D.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(D.full_name)}&background=6366f1&color=fff`,alt:D.full_name,className:"w-10 h-10 rounded-full border-2 border-slate-200 dark:border-slate-700"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("h2",{className:"text-base font-bold text-slate-900 dark:text-white",children:D.full_name}),s.jsx("span",{className:"text-xs text-slate-500",children:D.role==="manager"||D.role==="sales_manager"?" ":" "})]})]}):s.jsx("div",{className:"hidden md:block"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:s.jsx(ft,{className:"w-4 h-4"})}),s.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:s.jsx(pw,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-4",children:[m?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx(it,{className:"w-8 h-8 animate-spin text-brand-500"})}):h.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[s.jsx(Xn,{className:"w-12 h-12 mb-2 opacity-50"}),s.jsx("p",{children:"  .  ! "})]}):h.map((M,R)=>{const F=M.senderId===(t==null?void 0:t.id);return s.jsx("div",{className:`flex ${F?"justify-start":"justify-end"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:s.jsxs("div",{className:`max-w-[85%] md:max-w-[70%] flex flex-col ${F?"items-start":"items-end"}`,children:[s.jsx("div",{className:`
                                px-4 py-3 rounded-2xl text-sm shadow-sm relative leading-relaxed
                                ${F?"bg-brand-600 text-white rounded-tr-none":"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-200 rounded-tl-none"}
                            `,children:M.text}),s.jsxs("span",{className:"text-[10px] text-slate-400 mt-1 px-1 flex items-center gap-1",children:[M.timestamp,F&&(M.isRead?s.jsx(CE,{className:"w-3 h-3 text-brand-500"}):s.jsx(Or,{className:"w-3 h-3"}))]})]})},R)}),s.jsx("div",{ref:E})]}),s.jsx("div",{className:"p-4 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-end gap-2 bg-slate-50 dark:bg-slate-800/50 p-2 rounded-xl border border-slate-200 dark:border-slate-800",children:[s.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors mb-0.5",children:s.jsx(LE,{className:"w-4 h-4"})}),s.jsx("textarea",{value:c,onChange:M=>d(M.target.value),onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),P())},placeholder:" ...",className:"flex-1 bg-transparent border-none outline-none text-sm px-2 py-2.5 text-slate-900 dark:text-white placeholder-slate-400 resize-none max-h-32",rows:1}),s.jsx("button",{onClick:P,disabled:!c.trim(),className:"p-2.5 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm mb-0.5",children:s.jsx(yc,{className:"w-4 h-4 ml-0.5"})})]})})]})]})},gde=({currentUser:e,isOpen:t,onClose:r,activeContext:n,orgId:a})=>{var T;const[l,c]=v.useState([]),[d,h]=v.useState(""),[f,m]=v.useState(!1),[g,x]=v.useState(!1),[b,j]=v.useState(null),[w,_]=v.useState(!1),N=v.useRef(null);v.useEffect(()=>{(async()=>{if(!a||!(e!=null&&e.id)){console.log("[Chat] Missing orgId or currentUser:",{orgId:a,currentUser:e});return}try{const{data:P}=await ge.from("profiles").select("role").eq("id",e.id).single(),I=["sales_manager","manager","admin"].includes((P==null?void 0:P.role)||"");console.log("[Chat] Current user role:",P==null?void 0:P.role,"isManager:",I);let $;I?$=ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",a).eq("role","rep").limit(1):$=ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",a).in("role",["sales_manager","manager","admin"]).neq("id",e.id).limit(1);const{data:M,error:R}=await $;if(console.log("[Chat] Found chat partner:",M,"error:",R),M&&M.length>0&&!R)j(M[0]);else{const{data:F}=await ge.from("profiles").select("id, full_name, avatar_url, role").eq("organization_id",a).neq("id",e.id).limit(1);console.log("[Chat] Fallback partner:",F),F&&F.length>0?j(F[0]):_(!0)}}catch(P){console.error("[Chat] Failed to fetch chat partner:",P),_(!0)}})()},[a,e==null?void 0:e.id]),v.useEffect(()=>{(async()=>{if(!(!t||!(b!=null&&b.id)||!(e!=null&&e.id))){m(!0);try{const{data:P,error:I}=await ge.from("messages").select("*").or(`and(sender_id.eq.${e.id},recipient_id.eq.${b.id}),and(sender_id.eq.${b.id},recipient_id.eq.${e.id})`).order("created_at",{ascending:!0});if(I)throw I;c(P||[]);const $=(P||[]).filter(M=>M.recipient_id===e.id&&!M.is_read).map(M=>M.id);$.length>0&&await ge.from("messages").update({is_read:!0}).in("id",$)}catch(P){console.error("Failed to fetch messages:",P)}finally{m(!1)}}})()},[t,b==null?void 0:b.id,e==null?void 0:e.id]),v.useEffect(()=>{if(!t||!(b!=null&&b.id)||!(e!=null&&e.id))return;const D=ge.channel("chat-messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`recipient_id=eq.${e.id}`},P=>{const I=P.new;I.sender_id===b.id&&(c($=>[...$,I]),ge.from("messages").update({is_read:!0}).eq("id",I.id))}).subscribe();return()=>{ge.removeChannel(D)}},[t,b==null?void 0:b.id,e==null?void 0:e.id]),v.useEffect(()=>{t&&N.current&&N.current.scrollIntoView({behavior:"smooth"})},[l,t]);const C=async()=>{if(!d.trim()||!(b!=null&&b.id)||!(e!=null&&e.id)||!a)return;x(!0);const D=d.trim();h("");try{const P={sender_id:e.id,recipient_id:b.id,content:D,organization_id:a,is_read:!1,context_type:(n==null?void 0:n.type)||null,context_id:(n==null?void 0:n.id)||null,context_label:(n==null?void 0:n.label)||null},{data:I,error:$}=await ge.from("messages").insert(P).select().single();if($)throw $;I&&c(M=>[...M,I])}catch(P){console.error("Failed to send message:",P),h(D)}finally{x(!1)}},A=D=>new Date(D).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"}),E=D=>{const P=new Date(D),I=new Date,$=new Date(I);return $.setDate($.getDate()-1),P.toDateString()===I.toDateString()?"":P.toDateString()===$.toDateString()?"":P.toLocaleDateString("he-IL",{day:"numeric",month:"short"})},S=[];return l.forEach(D=>{const P=new Date(D.created_at).toDateString(),I=S.find($=>$.date===P);I?I.messages.push(D):S.push({date:P,messages:[D]})}),s.jsxs(s.Fragment,{children:[t&&s.jsx("div",{className:"fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-40 transition-opacity",onClick:r}),s.jsxs("div",{className:`fixed inset-y-0 right-0 z-50 w-full md:w-[400px] bg-white dark:bg-slate-950 shadow-2xl border-l border-slate-200 dark:border-slate-800 transform transition-transform duration-300 ease-in-out flex flex-col ${t?"translate-x-0":"translate-x-full"}`,children:[s.jsxs("div",{className:"px-5 py-4 border-b border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[b!=null&&b.avatar_url?s.jsx("img",{src:b.avatar_url,alt:b.full_name,className:"w-10 h-10 rounded-full border border-slate-200 dark:border-slate-700"}):s.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 flex items-center justify-center text-brand-600 font-bold text-sm",children:((T=b==null?void 0:b.full_name)==null?void 0:T.charAt(0))||"M"}),s.jsx("span",{className:"absolute bottom-0 left-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full"})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-base font-bold text-slate-900 dark:text-white leading-tight",children:(b==null?void 0:b.full_name)||" "}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"   "})]})]}),s.jsx("button",{onClick:r,className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50/50 dark:bg-slate-900/50",children:[n&&s.jsx("div",{className:"sticky top-0 z-10 -mx-4 -mt-4 mb-4 px-4 py-3 bg-brand-50/95 dark:bg-brand-900/40 backdrop-blur-sm border-b border-brand-100 dark:border-brand-800/50 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full shadow-sm text-brand-600 dark:text-brand-400",children:s.jsx(ft,{className:"w-3.5 h-3.5"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-bold text-brand-900 dark:text-brand-100",children:[" : ",n.label]}),s.jsx("p",{className:"text-[10px] text-brand-700 dark:text-brand-300",children:n.subLabel})]})]})}),f?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(it,{className:"w-6 h-6 animate-spin text-brand-500"})}):w?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center px-4",children:[s.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(Xn,{className:"w-8 h-8 text-amber-500"})}),s.jsx("p",{className:"text-sm font-bold text-slate-700 mb-2",children:"   "}),s.jsx("p",{className:"text-xs text-slate-400 max-w-[250px]",children:"  ',           ."})]}):l.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[s.jsx(Xn,{className:"w-12 h-12 text-slate-300 mb-3"}),s.jsx("p",{className:"text-sm text-slate-500",children:"  "}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"   "})]}):S.map(D=>s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center justify-center my-4",children:s.jsx("div",{className:"px-3 py-1 bg-white dark:bg-slate-800 rounded-full border border-slate-200 dark:border-slate-700 text-xs text-slate-500",children:E(D.messages[0].created_at)})}),D.messages.map(P=>{const I=P.sender_id===e.id;return s.jsx("div",{className:`flex ${I?"justify-start":"justify-end"} mb-3`,children:s.jsxs("div",{className:`max-w-[85%] flex flex-col ${I?"items-start":"items-end"}`,children:[P.context_label&&s.jsxs("div",{className:`mb-1 px-3 py-1.5 rounded-lg border text-xs flex items-center gap-2 w-fit ${I?"bg-white border-brand-100 text-brand-700":"bg-white border-slate-200 text-slate-600"}`,children:[s.jsx(Xn,{className:"w-3 h-3"}),": ",P.context_label]}),s.jsx("div",{className:`
                              px-4 py-2.5 rounded-2xl text-sm shadow-sm relative
                              ${I?"bg-brand-600 text-white rounded-tr-none":"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 text-slate-800 dark:text-slate-200 rounded-tl-none"}
                           `,children:P.content}),s.jsxs("span",{className:"text-[10px] text-slate-400 mt-1 px-1 flex items-center gap-1",children:[A(P.created_at),I&&(P.is_read?s.jsx(CE,{className:"w-3 h-3 text-brand-500"}):s.jsx(Or,{className:"w-3 h-3"}))]})]})},P.id)})]},D.date)),s.jsx("div",{ref:N})]}),s.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800",children:s.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 dark:bg-slate-800/50 p-1.5 rounded-xl border border-slate-200 dark:border-slate-800",children:[s.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors",children:s.jsx(LE,{className:"w-4 h-4"})}),s.jsx("input",{type:"text",value:d,onChange:D=>h(D.target.value),onKeyDown:D=>D.key==="Enter"&&!g&&C(),placeholder:"  ...",disabled:g,className:"flex-1 bg-transparent border-none outline-none text-sm px-2 text-slate-900 dark:text-white placeholder-slate-400 disabled:opacity-50"}),s.jsx("button",{onClick:C,disabled:!d.trim()||g,className:"p-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm",children:g?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(yc,{className:"w-4 h-4 ml-0.5"})})]})})]})]})},bE=[{level:1,name:"Rookie",color:"border-slate-300",ring:"ring-slate-200",icon:km,bg:"bg-slate-100 dark:bg-slate-800"},{level:5,name:"Pro",color:"border-emerald-400",ring:"ring-emerald-200",icon:Ct,bg:"bg-emerald-50 dark:bg-emerald-900/20"},{level:10,name:"Elite",color:"border-blue-500",ring:"ring-blue-300",icon:IE,bg:"bg-blue-50 dark:bg-blue-900/20"},{level:20,name:"Master",color:"border-purple-500",ring:"ring-purple-300",icon:mw,bg:"bg-purple-50 dark:bg-purple-900/20"},{level:50,name:"Legend",color:"border-amber-400",ring:"ring-amber-200",icon:jw,bg:"bg-amber-50 dark:bg-amber-900/20"}],vE=[{level:2,name:"Objection Pack: ",icon:"",locked:!0},{level:3,name:" ",icon:"",locked:!0},{level:4,name:"AI Boost",icon:"",locked:!0},{level:5,name:"Shadow Mode",icon:"",locked:!0}],yE={calls:{label:"",color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-50 dark:bg-blue-900/20"},followup:{label:"",color:"text-purple-600 dark:text-purple-400",bg:"bg-purple-50 dark:bg-purple-900/20"},quality:{label:"",color:"text-emerald-600 dark:text-emerald-400",bg:"bg-emerald-50 dark:bg-emerald-900/20"}},xde=e=>Array.from({length:14},(t,r)=>Math.max(0,Math.min(100,e+(Math.random()-.5)*40))),bde=(e,t,r)=>{const n=Math.min(e*12,40),a=r>0?t/r*40:20;return Math.round(n+a+20)},vde=e=>Math.min(e*4+3,21),yde=e=>e>=70?{color:"#059669",ringColor:"text-emerald-500",bg:"bg-emerald-50 dark:bg-emerald-900/20",border:"border-emerald-100 dark:border-emerald-800/30",label:" ",plan:" !      .",cta:"  ",ctaIcon:ft,accent:"emerald",gradientFrom:"from-emerald-50 dark:from-emerald-900/30"}:e>=40?{color:"#d97706",ringColor:"text-amber-500",bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-100 dark:border-amber-800/30",label:" ",plan:" .    .",cta:" ",ctaIcon:Xn,accent:"amber",gradientFrom:"from-amber-50 dark:from-amber-900/30"}:{color:"#e11d48",ringColor:"text-rose-500",bg:"bg-rose-50 dark:bg-rose-900/20",border:"border-rose-100 dark:border-rose-800/30",label:" ",plan:"  .     .",cta:" ",ctaIcon:Kl,accent:"rose",gradientFrom:"from-rose-50 dark:from-rose-900/30"},wde=({data:e,color:t,height:r=32})=>{const n=Math.max(...e,100),a=Math.min(...e,0),l=n-a||1,c=100,d=e.map((h,f)=>{const m=f/(e.length-1)*c,g=r-(h-a)/l*r;return`${m},${g}`}).join(" ");return s.jsx("div",{className:"relative w-full overflow-hidden",style:{height:r},children:s.jsxs("svg",{className:"w-full h-full overflow-visible",preserveAspectRatio:"none",viewBox:`0 0 ${c} ${r}`,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:`gradient-${t}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:t,stopOpacity:"0.1"}),s.jsx("stop",{offset:"100%",stopColor:t,stopOpacity:"0"})]})}),s.jsx("path",{d:`M0,${r} ${d} L${c},${r} Z`,fill:`url(#gradient-${t})`}),s.jsx("polyline",{fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke",points:d})]})})},jde=({label:e,cause:t,value:r})=>{const n=a=>a>=70?"bg-emerald-500":a>=40?"bg-amber-400":"bg-rose-400";return s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsx("span",{className:"text-[11px] font-medium text-slate-600 dark:text-slate-400",children:e}),s.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:t})]}),s.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-700/50 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${n(r)}`,style:{width:`${r}%`}})})]})},_de=["","","","",""],kde=({userId:e,orgId:t})=>{var S;const[r,n]=v.useState(null),[a,l]=v.useState([]),[c,d]=v.useState(!0),[h]=v.useState(()=>xde(75));if(v.useEffect(()=>{(async()=>{if(!(!e||!t))try{let{data:D}=await ge.from("user_gamification").select("*").eq("user_id",e).single();if(!D){const{data:$}=await ge.from("user_gamification").insert({user_id:e,organization_id:t}).select().single();D=$}n(D||{xp_total:0,level:1,current_streak:0});const P=new Date().toISOString().split("T")[0];let{data:I}=await ge.from("daily_missions").select("*").eq("user_id",e).eq("date",P);if(!I||I.length===0){await ge.rpc("create_daily_missions",{p_user_id:e,p_org_id:t});const{data:$}=await ge.from("daily_missions").select("*").eq("user_id",e).eq("date",P);I=$}l(I||[])}catch(D){console.error("Gamification fetch error:",D)}finally{d(!1)}})()},[e,t]),c)return s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-50 text-slate-400",children:s.jsx(it,{className:"w-8 h-8 animate-spin"})});const f=a.filter(T=>T.completed).length,m=bde((r==null?void 0:r.current_streak)||0,f,a.length),g=vde(f),x=yde(m),b=[0,100,300,600,1e3,2e3],j=b[((r==null?void 0:r.level)||1)-1]||0,w=b[(r==null?void 0:r.level)||1]||2e3,_=(((r==null?void 0:r.xp_total)||0)-j)/(w-j)*100,N=w-((r==null?void 0:r.xp_total)||0),C=[{label:" ",cause:((r==null?void 0:r.current_streak)||0)>2?" ":" ",value:((r==null?void 0:r.current_streak)||0)>2?85:45},{label:"",cause:f>=2?"SLA ":"  ",value:f>=2?92:35},{label:" ",cause:g>14?" ":"",value:g/21*100}],A=(r==null?void 0:r.level)||1,E=bE.reduce((T,D)=>D.level<=A?D:T,bE[0]);return s.jsx("div",{className:"w-full h-full overflow-y-auto bg-slate-50/50 dark:bg-slate-950 transition-colors",dir:"rtl",children:s.jsxs("div",{className:"max-w-[1240px] mx-auto p-5 md:p-6 space-y-5",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-5",children:[s.jsxs("div",{className:"col-span-12 md:col-span-4 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm p-5 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-amber-500 opacity-80"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:`relative w-20 h-20 rounded-full border-4 ${E.color} ${E.ring} shadow-lg p-0.5 flex items-center justify-center bg-white dark:bg-slate-800 z-10 hover:scale-105 transition-transform duration-300`,children:[s.jsx("div",{className:`w-full h-full rounded-full ${E.bg} flex items-center justify-center`,children:s.jsx(E.icon,{className:`w-8 h-8 ${E.color.replace("border","text")}`})}),s.jsxs("div",{className:"absolute -bottom-1 -right-1 bg-slate-900 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-md border border-white",children:["LVL ",A]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white tracking-tight",children:_de[A-1]}),s.jsx(mw,{className:"w-3.5 h-3.5 text-amber-500 fill-amber-500 animate-pulse"})]}),s.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:[N," XP   ( ",(S=vE[A])==null?void 0:S.name,")"]}),s.jsxs("div",{className:"h-2 w-full bg-slate-100 dark:bg-slate-700/50 rounded-full overflow-hidden border border-slate-100 dark:border-slate-700/50 relative",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-amber-500 opacity-20 bg-[length:20px_20px] animate-[pulse_2s_ease-in-out_infinite]"}),s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-amber-500 rounded-full transition-all duration-700 shadow-[0_0_10px_rgba(168,85,247,0.4)]",style:{width:`${_}%`}})]})]})]})]}),s.jsxs("div",{className:"col-span-12 md:col-span-8 flex items-center justify-between bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm px-6 py-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight mb-1",children:" , ! "}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"      .  ."})]}),s.jsx("div",{className:"hidden md:flex flex-col items-end gap-1",children:s.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 dark:bg-slate-800 px-3 py-1 rounded-lg border border-slate-100 dark:border-slate-700",children:[s.jsx(Pr,{className:"w-3.5 h-3.5 text-slate-400"}),s.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300",children:new Date().toLocaleDateString("he-IL",{weekday:"long",day:"numeric",month:"long"})})]})})]})]}),s.jsxs("div",{className:"grid grid-cols-12 gap-5",children:[s.jsxs("div",{className:"col-span-12 lg:col-span-8 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col relative",children:[s.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-gradient-to-br ${x.gradientFrom||x.bg.replace("bg-","from-")} to-transparent opacity-30 blur-3xl rounded-full pointer-events-none -mr-20 -mt-20`}),s.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8 items-center border-b border-slate-100 dark:border-slate-800 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"relative w-32 h-32 shrink-0 group cursor-pointer hover:scale-105 transition-transform duration-300",children:[s.jsxs("svg",{className:"w-full h-full -rotate-90 drop-shadow-xl",viewBox:"0 0 100 100",children:[s.jsx("circle",{cx:"50",cy:"50",r:"42",fill:"none",className:"stroke-slate-100 dark:stroke-slate-800",strokeWidth:"8"}),s.jsx("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"currentColor",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${m*2.64} 264`,className:`transition-all duration-1000 ${x.ringColor}`})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsx("span",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter drop-shadow-sm",children:m}),s.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest mt-0.5 ${x.ringColor}`,children:"Readiness"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${x.bg} ${x.ringColor} border ${x.border} shadow-sm`,children:[s.jsx(si,{className:"w-3.5 h-3.5"}),x.label]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 font-medium",children:" :"}),s.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:g}),s.jsx("span",{className:"text-xs text-slate-400",children:"/ 21"})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 font-medium",children:" :"}),s.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:(r==null?void 0:r.current_streak)||0}),s.jsx(uu,{className:"w-3.5 h-3.5 text-orange-500 fill-orange-500 animate-pulse"})]})]})]})]}),s.jsxs("div",{className:"space-y-4 pl-4 border-r border-slate-100/50 dark:border-slate-800/50",children:[s.jsxs("p",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[s.jsx(hc,{className:"w-3.5 h-3.5"})," "]}),s.jsx("div",{className:"space-y-4",children:C.map((T,D)=>s.jsx(jde,{...T},D))})]})]}),s.jsxs("div",{className:`px-6 py-5 bg-gradient-to-b ${x.bg} relative overflow-hidden flex-1 flex flex-col justify-center`,children:[s.jsxs("div",{className:"relative z-10 flex items-center justify-between gap-6",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-300 uppercase tracking-widest mb-1.5 flex items-center gap-1.5",children:[s.jsx(al,{className:"w-3.5 h-3.5"})," "]}),s.jsx("h3",{className:"text-base font-bold text-slate-800 dark:text-white leading-snug max-w-sm",children:x.plan})]}),s.jsxs("button",{className:"hidden md:flex shrink-0 items-center gap-2 px-6 py-2.5 bg-slate-900 dark:bg-slate-800 text-white text-sm font-bold rounded-xl shadow-lg hover:bg-slate-800 dark:hover:bg-slate-700 hover:shadow-xl transition-all hover:-translate-y-0.5 active:translate-y-0 duration-200 group border border-slate-700 dark:border-slate-600",children:[s.jsx(x.ctaIcon,{className:"w-4 h-4 text-emerald-400 group-hover:text-emerald-300 transition-colors"}),x.cta]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-15 pointer-events-none mix-blend-multiply",children:s.jsx(wde,{data:h,color:x.color,height:64})})]})]}),s.jsxs("div",{className:"col-span-12 lg:col-span-4 flex flex-col gap-5",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm p-5 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400 border border-indigo-100 dark:border-indigo-800/30",children:s.jsx(vr,{className:"w-4.5 h-4.5"})}),s.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-base",children:" "})]}),s.jsxs("span",{className:"text-xs font-bold bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-slate-500 dark:text-slate-400",children:[f,"/",a.length]})]}),s.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto pr-1 -mr-1 custom-scrollbar",children:a.length===0?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-slate-400",children:" !   "})}):a.map((T,D)=>{const P=D===0&&!T.completed,I=yE[T.mission_type]||yE.calls;return s.jsxs("div",{className:`group relative p-3 rounded-xl border transition-all duration-200 hover:-translate-y-0.5 hover:shadow-md ${T.completed?"bg-slate-50 dark:bg-slate-900/50 border-slate-100 dark:border-slate-800 opacity-60":P?"bg-gradient-to-r from-blue-50/80 to-white dark:from-blue-900/20 dark:to-slate-800 border-blue-200 dark:border-blue-800/50 shadow-sm ring-1 ring-blue-100 dark:ring-blue-900/30":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:border-blue-200 dark:hover:border-blue-700"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[P&&s.jsx("span",{className:"text-[9px] font-black bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-200 px-1.5 py-0.5 rounded tracking-wide shadow-sm",children:"FOCUS"}),s.jsx("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded ${I.bg} ${I.color}`,children:I.label})]}),s.jsxs("span",{className:`text-[10px] font-black ${T.completed?"text-emerald-500":"text-slate-300 dark:text-slate-600 group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors"}`,children:["+",T.xp_reward," XP"]})]}),s.jsx("h4",{className:`text-sm font-bold mb-2 ${T.completed?"text-slate-500 dark:text-slate-500 line-through":"text-slate-800 dark:text-slate-100"}`,children:T.title}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${T.completed?"bg-emerald-500":P?"bg-blue-600":"bg-slate-300 dark:bg-slate-600 group-hover:bg-blue-400 transition-colors"}`,style:{width:`${Math.min(T.progress/T.target*100,100)}%`}})}),s.jsxs("span",{className:"text-[10px] font-bold text-slate-400 dark:text-slate-500",children:[T.progress,"/",T.target]})]}),!T.completed&&s.jsx("button",{className:"absolute bottom-3 left-3 px-3 py-1 bg-slate-900 dark:bg-white dark:text-slate-900 text-white text-[10px] font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-all shadow-md active:scale-95",children:""})]},T.id)})})]}),s.jsxs("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 text-white rounded-2xl shadow-lg p-4 relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-10",children:s.jsx(b0,{className:"w-16 h-16"})}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-xs font-bold text-indigo-200 uppercase tracking-widest",children:" "}),s.jsx(ou,{className:"w-3.5 h-3.5 text-indigo-300"})]}),s.jsx("div",{className:"flex gap-2",children:vE.slice(0,3).map((T,D)=>s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-lg border border-white/10 bg-white/5 backdrop-blur-sm ${T.locked?"text-slate-500 grayscale":"text-white shadow-lg shadow-white/10"}`,title:T.name,children:T.icon},D))})]})]})]})]})]})})},Nde=["","","","","","",""],Sde=["","","","","","","","","","","",""],Cde=({value:e,onChange:t,minDate:r,placeholder:n=" "})=>{const[a,l]=v.useState(!1),[c,d]=v.useState(()=>e?new Date(e):new Date),[h,f]=v.useState({top:0,right:0,width:0,maxHeight:500}),m=v.useRef(null),g=v.useRef(null);v.useEffect(()=>{if(a&&m.current){const M=m.current.getBoundingClientRect(),R=window.innerHeight-M.bottom,F=M.top,V=380,H=R<V;f({top:H?Math.max(10,M.top-V-8):M.bottom+8,right:window.innerWidth-M.right,width:Math.max(M.width,288),maxHeight:H?F-20:R-20})}},[a]),v.useEffect(()=>{const M=R=>{m.current&&!m.current.contains(R.target)&&g.current&&!g.current.contains(R.target)&&l(!1)};if(a)return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[a]),v.useEffect(()=>{const M=R=>{g.current&&g.current.contains(R.target)||a&&l(!1)};return window.addEventListener("scroll",M,!0),()=>window.removeEventListener("scroll",M,!0)},[a]);const x=(M,R)=>new Date(M,R+1,0).getDate(),b=(M,R)=>new Date(M,R,1).getDay(),j=M=>M?new Date(M).toLocaleDateString("he-IL",{day:"numeric",month:"long",year:"numeric"}):"",w=M=>{const R=c.getFullYear(),F=c.getMonth(),V=`${R}-${String(F+1).padStart(2,"0")}-${String(M).padStart(2,"0")}`;t(V),l(!1)},_=()=>{d(M=>new Date(M.getFullYear(),M.getMonth()-1,1))},N=()=>{d(M=>new Date(M.getFullYear(),M.getMonth()+1,1))},C=M=>{if(!r)return!1;const R=c.getFullYear(),F=c.getMonth(),V=new Date(R,F,M),H=new Date(r);return H.setHours(0,0,0,0),V<H},A=M=>{const R=new Date;return c.getFullYear()===R.getFullYear()&&c.getMonth()===R.getMonth()&&M===R.getDate()},E=M=>{if(!e)return!1;const R=new Date(e);return c.getFullYear()===R.getFullYear()&&c.getMonth()===R.getMonth()&&M===R.getDate()},S=c.getFullYear(),T=c.getMonth(),D=x(S,T),P=b(S,T),I=[];for(let M=0;M<P;M++)I.push(null);for(let M=1;M<=D;M++)I.push(M);const $=s.jsxs("div",{ref:g,style:{position:"fixed",top:h.top,right:h.right,width:h.width,maxHeight:h.maxHeight,zIndex:99999},className:"bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-auto",children:[s.jsxs("div",{className:"bg-gradient-to-r from-brand-600 to-indigo-600 px-4 py-3 flex items-center justify-between",children:[s.jsx("button",{type:"button",onClick:N,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors text-white",children:s.jsx(j9,{className:"w-4 h-4"})}),s.jsx("div",{className:"text-center",children:s.jsxs("span",{className:"text-white font-bold",children:[Sde[T]," ",S]})}),s.jsx("button",{type:"button",onClick:_,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors text-white",children:s.jsx(ls,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 px-3 py-2 bg-slate-50 border-b border-slate-100",children:Nde.map((M,R)=>s.jsx("div",{className:"text-center text-xs font-bold text-slate-500",children:M},R))}),s.jsx("div",{className:"grid grid-cols-7 gap-1 p-3",children:I.map((M,R)=>s.jsx("div",{className:"aspect-square",children:M&&s.jsx("button",{type:"button",onClick:()=>!C(M)&&w(M),disabled:C(M),className:`w-full h-full rounded-lg text-sm font-medium transition-all flex items-center justify-center ${E(M)?"bg-brand-500 text-white shadow-lg shadow-brand-500/30":A(M)?"bg-brand-100 text-brand-700 font-bold":C(M)?"text-slate-300 cursor-not-allowed":"text-slate-700 hover:bg-slate-100"}`,children:M})},R))}),s.jsxs("div",{className:"px-3 pb-3 pt-1 flex gap-2",children:[s.jsx("button",{type:"button",onClick:()=>{t(new Date().toISOString().split("T")[0]),l(!1)},className:"flex-1 py-2.5 text-sm font-medium text-brand-600 bg-brand-50 hover:bg-brand-100 rounded-xl transition-colors",children:""}),s.jsx("button",{type:"button",onClick:()=>{const M=new Date;M.setDate(M.getDate()+1),t(M.toISOString().split("T")[0]),l(!1)},className:"flex-1 py-2.5 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-xl transition-colors",children:""}),e&&s.jsx("button",{type:"button",onClick:()=>{t(""),l(!1)},className:"px-4 py-2.5 text-sm font-medium text-rose-600 bg-rose-50 hover:bg-rose-100 rounded-xl transition-colors",children:s.jsx(Lt,{className:"w-4 h-4"})})]})]});return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{ref:m,type:"button",onClick:()=>l(!a),className:"w-full px-4 py-3 bg-gradient-to-r from-slate-50 to-white border-2 border-slate-200 rounded-xl text-right text-slate-800 font-medium cursor-pointer hover:border-brand-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-400 transition-all shadow-sm flex items-center justify-between gap-2",children:[s.jsx(wn,{className:"w-4 h-4 text-brand-400"}),s.jsx("span",{className:e?"text-slate-800":"text-slate-400",children:e?j(e):n})]}),a&&CT.createPortal($,document.body)]})},Ede=[{label:"",times:["08:00","09:00","10:00","11:00"]},{label:"",times:["12:00","13:00","14:00"]},{label:"",times:["15:00","16:00","17:00"]},{label:"",times:["18:00","19:00","20:00","21:00"]}],Ade=({value:e,onChange:t,placeholder:r=" "})=>{const[n,a]=v.useState(!1),[l,c]=v.useState({top:0,right:0,width:0,maxHeight:500}),d=v.useRef(null),h=v.useRef(null),[f,m]=e?e.split(":").map(Number):[10,0];v.useEffect(()=>{if(n&&d.current){const N=d.current.getBoundingClientRect(),C=window.innerHeight-N.bottom,A=N.top,E=420,S=C<E;c({top:S?Math.max(10,N.top-E-8):N.bottom+8,right:window.innerWidth-N.right,width:Math.max(N.width,288),maxHeight:S?A-20:C-20})}},[n]),v.useEffect(()=>{const N=C=>{d.current&&!d.current.contains(C.target)&&h.current&&!h.current.contains(C.target)&&a(!1)};if(n)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[n]),v.useEffect(()=>{const N=C=>{h.current&&h.current.contains(C.target)||n&&a(!1)};return window.addEventListener("scroll",N,!0),()=>window.removeEventListener("scroll",N,!0)},[n]);const g=(N,C)=>`${String(N).padStart(2,"0")}:${String(C).padStart(2,"0")}`,x=()=>{const N=(f+1)%24;t(g(N,m))},b=()=>{const N=(f-1+24)%24;t(g(N,m))},j=()=>{const N=(m+15)%60;t(g(f,N))},w=()=>{const N=(m-15+60)%60;t(g(f,N))},_=s.jsxs("div",{ref:h,style:{position:"fixed",top:l.top,right:l.right,width:l.width,maxHeight:l.maxHeight,zIndex:99999},className:"bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-auto",children:[s.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3",children:s.jsx("span",{className:"text-white font-bold",children:" "})}),s.jsxs("div",{className:"p-4 flex justify-center gap-4 border-b border-slate-100",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("button",{type:"button",onClick:x,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:s.jsx(eo,{className:"w-5 h-5 text-slate-600"})}),s.jsx("div",{className:"w-16 h-14 bg-gradient-to-b from-indigo-50 to-white border-2 border-indigo-200 rounded-xl flex items-center justify-center",children:s.jsx("span",{className:"text-2xl font-bold text-indigo-600",children:String(f).padStart(2,"0")})}),s.jsx("button",{type:"button",onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:s.jsx(Pt,{className:"w-5 h-5 text-slate-600"})}),s.jsx("span",{className:"text-[10px] text-slate-400 mt-1",children:""})]}),s.jsx("div",{className:"flex items-center",children:s.jsx("span",{className:"text-2xl font-bold text-slate-300",children:":"})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("button",{type:"button",onClick:j,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:s.jsx(eo,{className:"w-5 h-5 text-slate-600"})}),s.jsx("div",{className:"w-16 h-14 bg-gradient-to-b from-purple-50 to-white border-2 border-purple-200 rounded-xl flex items-center justify-center",children:s.jsx("span",{className:"text-2xl font-bold text-purple-600",children:String(m).padStart(2,"0")})}),s.jsx("button",{type:"button",onClick:w,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:s.jsx(Pt,{className:"w-5 h-5 text-slate-600"})}),s.jsx("span",{className:"text-[10px] text-slate-400 mt-1",children:""})]})]}),s.jsx("div",{className:"p-3 space-y-2 max-h-40 overflow-y-auto",children:Ede.map(N=>s.jsxs("div",{children:[s.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:N.label}),s.jsx("div",{className:"flex gap-1.5 mt-1",children:N.times.map(C=>s.jsx("button",{type:"button",onClick:()=>{t(C),a(!1)},className:`flex-1 py-1.5 rounded-lg text-xs font-medium transition-all ${e===C?"bg-indigo-500 text-white shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:C},C))})]},N.label))}),s.jsx("div",{className:"px-3 pb-3",children:s.jsxs("button",{type:"button",onClick:()=>a(!1),className:"w-full py-2.5 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold hover:from-indigo-700 hover:to-purple-700 transition-all shadow-lg shadow-indigo-500/20 flex items-center justify-center gap-2",children:[s.jsx(Or,{className:"w-4 h-4"}),""]})})]});return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{ref:d,type:"button",onClick:()=>a(!n),className:"w-full px-4 py-3 bg-gradient-to-r from-slate-50 to-white border-2 border-slate-200 rounded-xl text-right text-slate-800 font-medium cursor-pointer hover:border-indigo-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-400 transition-all shadow-sm flex items-center justify-between gap-2",children:[s.jsx(Pr,{className:"w-4 h-4 text-indigo-400"}),s.jsx("span",{className:e?"text-slate-800 font-bold text-lg":"text-slate-400",children:e||r})]}),n&&CT.createPortal(_,document.body)]})},Tde=({isOpen:e,onClose:t,userId:r,orgId:n,leads:a=[]})=>{const[l,c]=v.useState([]),[d,h]=v.useState(!1),[f,m]=v.useState(!1),[g,x]=v.useState(""),[b,j]=v.useState(""),[w,_]=v.useState(""),[N,C]=v.useState(""),[A,E]=v.useState("10:00"),[S,T]=v.useState("reminder"),[D,P]=v.useState(!1);v.useEffect(()=>{(async()=>{if(!(!r||!e)){h(!0);try{const{data:L,error:U}=await ge.from("notifications").select(`
            id,
            title,
            message,
            lead_id,
            scheduled_at,
            is_read,
            leads(name)
          `).eq("user_id",r).eq("type","reminder").not("scheduled_at","is",null).order("scheduled_at",{ascending:!0});if(U)throw U;c((L||[]).map(W=>{var le;return{...W,lead_name:(le=W.leads)==null?void 0:le.name}}))}catch(L){console.error("Failed to fetch reminders:",L)}finally{h(!1)}}})()},[r,e]);const I=()=>{x(""),j(""),_(""),C(""),E("10:00"),T("reminder"),m(!1)},$=async()=>{var H;if(!(!g||!N||!r||!n)){P(!0);try{const L=new Date(`${N}T${A}`).toISOString(),{data:U,error:W}=await ge.from("notifications").insert({user_id:r,organization_id:n,type:S,title:g,message:b||null,lead_id:w||null,scheduled_at:L,is_read:!1}).select().single();if(W)throw W;const le=(H=a.find(ve=>ve.id===w))==null?void 0:H.name;c(ve=>[...ve,{...U,lead_name:le}].sort((B,G)=>new Date(B.scheduled_at).getTime()-new Date(G.scheduled_at).getTime())),I()}catch(L){console.error("Failed to add reminder:",L)}finally{P(!1)}}},M=async H=>{try{await ge.from("notifications").delete().eq("id",H),c(L=>L.filter(U=>U.id!==H))}catch(L){console.error("Failed to delete reminder:",L)}},R=async H=>{await ge.from("notifications").update({is_read:!0}).eq("id",H),c(L=>L.filter(U=>U.id!==H))},F=H=>{const L=new Date(H),U=new Date,W=L.toDateString()===U.toDateString(),le=L.toDateString()===new Date(U.getTime()+864e5).toDateString(),ve=L.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"});return W?`  ${ve}`:le?`  ${ve}`:`${L.toLocaleDateString("he-IL")}  ${ve}`},V=H=>new Date(H)<new Date;return e?s.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-r from-brand-600 to-indigo-600 px-6 py-4 text-white flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:s.jsx(ai,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:" "}),s.jsxs("p",{className:"text-sm text-white/80",children:[l.length,"  "]})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:d?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(it,{className:"w-6 h-6 animate-spin text-brand-500"})}):s.jsxs(s.Fragment,{children:[f?s.jsxs("div",{className:"p-5 border-b border-slate-100 bg-gradient-to-b from-slate-50 to-white space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-slate-700 mb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>T==null?void 0:T("urgent_task"),className:`p-3 rounded-xl border-2 text-center transition-all ${S==="urgent_task"?"border-rose-400 bg-rose-50 text-rose-700":"border-slate-200 hover:border-rose-200 text-slate-600"}`,children:[s.jsx("span",{className:"text-lg mb-1 block",children:""}),s.jsx("span",{className:"text-xs font-medium",children:" "})]}),s.jsxs("button",{type:"button",onClick:()=>T==null?void 0:T("followup"),className:`p-3 rounded-xl border-2 text-center transition-all ${S==="followup"?"border-emerald-400 bg-emerald-50 text-emerald-700":"border-slate-200 hover:border-emerald-200 text-slate-600"}`,children:[s.jsx("span",{className:"text-lg mb-1 block",children:""}),s.jsx("span",{className:"text-xs font-medium",children:""})]}),s.jsxs("button",{type:"button",onClick:()=>T==null?void 0:T("reminder"),className:`p-3 rounded-xl border-2 text-center transition-all ${S==="reminder"?"border-amber-400 bg-amber-50 text-amber-700":"border-slate-200 hover:border-amber-200 text-slate-600"}`,children:[s.jsx("span",{className:"text-lg mb-1 block",children:""}),s.jsx("span",{className:"text-xs font-medium",children:""})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-slate-700 mb-1.5",children:""}),s.jsx("input",{type:"text",value:g,onChange:H=>x(H.target.value),placeholder:"  ?",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-slate-800 placeholder:text-slate-400"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-slate-700 mb-1.5",children:" ()"}),s.jsx("textarea",{value:b,onChange:H=>j(H.target.value),placeholder:" ...",rows:2,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 resize-none text-slate-800 placeholder:text-slate-400"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[s.jsx(wn,{className:"w-3.5 h-3.5 text-brand-500"}),"?"]}),s.jsx(Cde,{value:N,onChange:C,minDate:new Date().toISOString().split("T")[0],placeholder:" "})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[s.jsx(Pr,{className:"w-3.5 h-3.5 text-indigo-500"})," ?"]}),s.jsx(Ade,{value:A,onChange:E,placeholder:" "})]})]}),a.length>0&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-1.5 flex items-center gap-1",children:[s.jsx(Rn,{className:"w-3.5 h-3.5 text-slate-400"}),"  ()"]}),s.jsxs("select",{value:w,onChange:H=>_(H.target.value),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-slate-800 cursor-pointer hover:border-brand-300 transition-colors",children:[s.jsx("option",{value:"",children:""}),a.map(H=>s.jsx("option",{value:H.id,children:H.name},H.id))]})]}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{onClick:I,className:"flex-1 py-3 bg-white border border-slate-200 rounded-xl text-slate-600 font-medium hover:bg-slate-50 transition-colors",children:""}),s.jsxs("button",{onClick:$,disabled:!g||!N||D,className:"flex-1 py-3 bg-gradient-to-r from-brand-600 to-indigo-600 text-white rounded-xl font-bold hover:from-brand-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-brand-500/20 transition-all",children:[D?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(Nn,{className:"w-4 h-4"}),""]})]})]}):s.jsx("div",{className:"p-4 border-b border-slate-100",children:s.jsxs("button",{onClick:()=>m(!0),className:"w-full py-3 border-2 border-dashed border-slate-200 rounded-xl text-slate-500 hover:border-brand-300 hover:text-brand-600 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Nn,{className:"w-4 h-4"}),"  "]})}),l.length===0?s.jsxs("div",{className:"py-12 text-center text-slate-400",children:[s.jsx(Pr,{className:"w-10 h-10 mx-auto mb-3 opacity-30"}),s.jsx("p",{children:"  "}),s.jsx("p",{className:"text-sm mt-1",children:"  ,   "})]}):s.jsx("div",{className:"divide-y divide-slate-100",children:l.map(H=>s.jsxs("div",{className:`p-4 flex items-start gap-3 ${V(H.scheduled_at)?"bg-rose-50":""}`,children:[s.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${V(H.scheduled_at)?"bg-rose-100":"bg-brand-100"}`,children:s.jsx(Pr,{className:`w-5 h-5 ${V(H.scheduled_at)?"text-rose-600":"text-brand-600"}`})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-slate-800",children:H.title}),H.message&&s.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:H.message}),s.jsxs("div",{className:"flex items-center gap-3 mt-1.5 text-xs text-slate-400",children:[s.jsx("span",{className:V(H.scheduled_at)?"text-rose-500 font-medium":"",children:F(H.scheduled_at)}),H.lead_name&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Rn,{className:"w-3 h-3"}),H.lead_name]})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>R(H.id),className:"p-2 text-emerald-500 hover:bg-emerald-50 rounded-lg transition-colors",title:"",children:s.jsx(Ct,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>M(H.id),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",title:"",children:s.jsx(sa,{className:"w-4 h-4"})})]})]},H.id))})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-slate-200 bg-slate-50",children:s.jsx("button",{onClick:t,className:"w-full py-2.5 border border-slate-300 rounded-xl text-slate-600 hover:bg-white font-medium transition-colors",children:""})})]})}):null},Ode="modulepreload",Pde=function(e){return"/"+e},wE={},Dde=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let c=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=c(r.map(f=>{if(f=Pde(f),f in wE)return;wE[f]=!0;const m=f.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":Ode,m||(x.as="script"),x.crossOrigin="",x.href=f,h&&x.setAttribute("nonce",h),document.head.appendChild(x),m)return new Promise((b,j)=>{x.addEventListener("load",b),x.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return t().catch(l)})},Mde=({isOpen:e,onClose:t,organizationId:r,organizationName:n,onSuccess:a})=>{const[l,c]=v.useState(""),[d,h]=v.useState("rep"),[f,m]=v.useState(!1),[g,x]=v.useState(""),[b,j]=v.useState(""),[w,_]=v.useState(!1),N=async E=>{E.preventDefault(),m(!0),x(""),j("");try{const{data:{session:S}}=await Dde(()=>Promise.resolve().then(()=>zB),[]).then(I=>I.supabase.auth.getSession()),T=S==null?void 0:S.access_token;if(!T)throw new Error("No session found");const D=await fetch("/api/admin/invitations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`},body:JSON.stringify({email:l,organizationId:r,role:d})}),P=await D.json();if(!D.ok)throw new Error(P.error||"Failed to send invitation");j(P.invitation.inviteLink),c(""),a==null||a()}catch(S){x(S.message)}finally{m(!1)}},C=()=>{navigator.clipboard.writeText(b),_(!0),setTimeout(()=>_(!1),2e3)},A=()=>{c(""),h("rep"),x(""),j(""),t()};return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:A}),s.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-md mx-4 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center",children:s.jsx(hu,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("p",{className:"text-sm text-slate-500",children:n})]})]}),s.jsx("button",{onClick:A,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsx("div",{className:"p-6",children:b?s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:s.jsx(Or,{className:"w-8 h-8 text-emerald-500"})}),s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"  !"}),s.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"     "}),s.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 mb-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:b,readOnly:!0,className:"flex-1 bg-transparent text-sm text-slate-600 dark:text-slate-300 outline-none truncate"}),s.jsx("button",{onClick:C,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors",children:w?s.jsx(Or,{className:"w-4 h-4 text-emerald-500"}):s.jsx(p0,{className:"w-4 h-4 text-slate-400"})})]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:()=>j(""),children:" "}),s.jsx(je,{className:"flex-1",onClick:A,children:""})]})]}):s.jsxs("form",{onSubmit:N,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),s.jsx("input",{type:"email",value:l,onChange:E=>c(E.target.value),placeholder:"user@example.com",required:!0,className:"w-full pr-11 pl-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-slate-900 dark:text-white outline-none focus:ring-2 focus:ring-brand-500 transition-all",dir:"ltr"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:""}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:()=>h("rep"),className:`flex-1 py-3 px-4 rounded-xl border-2 transition-all text-sm font-medium ${d==="rep"?"border-brand-500 bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:border-slate-300"}`,children:" "}),s.jsx("button",{type:"button",onClick:()=>h("manager"),className:`flex-1 py-3 px-4 rounded-xl border-2 transition-all text-sm font-medium ${d==="manager"?"border-brand-500 bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:border-slate-300"}`,children:""})]})]}),g&&s.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:s.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:g})}),s.jsx(je,{type:"submit",className:"w-full",disabled:f||!l,children:f?s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"w-4 h-4 ml-2 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(gs,{className:"w-4 h-4 ml-2"})," "]})})]})})]})]}):null},Rde=({isOpen:e,onClose:t,orgId:r,orgName:n})=>{const[a,l]=v.useState(!0),[c,d]=v.useState(null),[h,f]=v.useState(""),[m,g]=v.useState(!1),[x,b]=v.useState(null),[j,w]=v.useState(""),[_,N]=v.useState(null);v.useEffect(()=>{e&&r&&C()},[e,r]);const C=async()=>{l(!0);const{data:{session:S}}=await ge.auth.getSession();if(S)try{const D=await(await fetch(`/api/admin/organizations/${r}/phone-config`,{headers:{Authorization:`Bearer ${S.access_token}`}})).json();D.success&&(d(D.config),f(D.config.business_line||""))}catch(T){console.error("Failed to load phone config:",T)}finally{l(!1)}},A=async()=>{g(!0);const{data:{session:S}}=await ge.auth.getSession();if(S)try{(await(await fetch(`/api/admin/organizations/${r}/phone-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S.access_token}`},body:JSON.stringify({twilio_phone_number:h})})).json()).success&&alert("Business Line Saved")}catch(T){console.error("Failed to save business line:",T),alert("Error saving")}finally{g(!1)}},E=async()=>{if(!x)return;g(!0);const{data:{session:S}}=await ge.auth.getSession();if(S)try{const T={twilio_phone_number:j};(await fetch(`/api/admin/users/${x.id}/phone-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S.access_token}`},body:JSON.stringify({config:T})})).ok&&(d(P=>P?{...P,users:P.users.map(I=>I.id===x.id?{...I,twilio_phone_number:j}:I)}:null),b(null))}catch(T){console.error("Failed to save user config:",T)}finally{g(!1)}};return e?s.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:[s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-4xl shadow-2xl max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-100 dark:border-slate-800",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[s.jsx(ft,{className:"w-5 h-5 text-indigo-500"})," "]}),s.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[" : ",s.jsx("span",{className:"font-semibold text-slate-700 dark:text-slate-300",children:n})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-slate-400",children:s.jsx(Lt,{className:"w-5 h-5"})})]}),a?s.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[400px]",children:s.jsx(it,{className:"w-8 h-8 animate-spin text-indigo-500"})}):s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-xl border border-slate-200 dark:border-slate-700",children:[s.jsxs("h4",{className:"font-medium text-slate-900 dark:text-white flex items-center gap-2 mb-4",children:[s.jsx(Na,{className:"w-4 h-4 text-indigo-500"}),"  (Business Line)"]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("input",{type:"text",placeholder:"+97250...",value:h,onChange:S=>f(S.target.value),className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white ltr",dir:"ltr"}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:" -Caller ID       ."})]}),s.jsxs(je,{onClick:A,disabled:m,children:[m?s.jsx(it,{className:"w-4 h-4 animate-spin"}):s.jsx(ol,{className:"w-4 h-4 ml-2"}),""]})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-slate-900 dark:text-white flex items-center gap-2 mb-4",children:[s.jsx(Rn,{className:"w-4 h-4 text-indigo-500"}),"  (",(c==null?void 0:c.users.length)||0,")"]}),s.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm text-right",children:[s.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-medium",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3",children:" "}),s.jsx("th",{className:"px-4 py-3",children:""}),s.jsx("th",{className:"px-4 py-3",children:""}),s.jsx("th",{className:"px-4 py-3",children:" "}),s.jsx("th",{className:"px-4 py-3",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:c==null?void 0:c.users.map(S=>{var T,D;return s.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[s.jsx("td",{className:"px-4 py-3 font-medium text-slate-900 dark:text-white",children:S.full_name}),s.jsx("td",{className:"px-4 py-3 text-slate-500",children:S.email}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${S.role==="manager"?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-700"}`,children:S.role})}),s.jsxs("td",{className:"px-4 py-3 font-mono ltr text-left",children:[S.twilio_phone_number||s.jsx("span",{className:"text-slate-400 italic",children:" "}),(D=(T=S.phone_rotator_config)==null?void 0:T.numbers)!=null&&D.length?s.jsxs("span",{className:"mr-2 text-xs bg-indigo-100 text-indigo-700 px-1.5 py-0.5 rounded",children:[S.phone_rotator_config.numbers.length," "]}):null]}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("button",{onClick:()=>{b(S),w(S.twilio_phone_number||"")},className:"text-indigo-600 hover:text-indigo-700 font-medium text-xs",children:""})})]},S.id)})})]})})]})]})]}),x&&s.jsx("div",{className:"absolute inset-0 z-[70] flex items-center justify-center bg-black/20 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 w-full max-w-sm shadow-2xl border border-slate-200 dark:border-slate-700",children:[s.jsxs("h4",{className:"font-bold text-slate-900 dark:text-white mb-4",children:["   ",x.full_name]}),s.jsx("input",{type:"text",value:j,onChange:S=>w(S.target.value),placeholder:"+97250...",className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 mb-4 ltr",dir:"ltr"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:()=>b(null),children:""}),s.jsx(je,{className:"flex-1",onClick:E,disabled:m,children:""})]})]})})]}):null},Ide=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,a]=v.useState("org"),[l,c]=v.useState(!1),[d,h]=v.useState(""),[f,m]=v.useState("free"),[g,x]=v.useState("sales"),[b,j]=v.useState(""),[w,_]=v.useState(""),[N,C]=v.useState(""),[A,E]=v.useState(!0),[S,T]=v.useState(""),[D,P]=v.useState(null);if(!e)return null;const I=()=>{if(n==="org"){if(!d.trim())return P("   ");a("admin")}else if(n==="admin"){if(!b.trim()||!w.trim())return P("   ");a("phone")}else n==="phone"&&a("review");P(null)},$=()=>{n==="admin"&&a("org"),n==="phone"&&a("admin"),n==="review"&&a("phone"),P(null)},M=async()=>{c(!0),P(null);try{const{data:{session:R}}=await ge.auth.getSession();if(!R)throw new Error("Not authenticated");const F=R.access_token,V=await fetch("/api/admin/organizations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({name:d,plan:f,center_type:g})}),H=await V.json();if(!V.ok)throw new Error(H.error||"Failed to create organization");const L=H.organizationId,U=await fetch("/api/admin/invitations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({email:b,organizationId:L,role:"manager"})});U.ok||console.error("Invite failed",await U.json()),S.trim()&&await fetch(`/api/admin/organizations/${L}/phone-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({twilio_phone_number:S})}),r(),t()}catch(R){P(R.message)}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-2xl shadow-2xl flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"  "}),s.jsx("div",{className:"flex gap-2 mt-2",children:["org","admin","phone","review"].map((R,F)=>s.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${["org","admin","phone","review"].indexOf(n)>=F?"bg-indigo-600":"bg-slate-200 dark:bg-slate-700"}`},R))})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsxs("div",{className:"p-8 overflow-y-auto flex-1",children:[D&&s.jsxs("div",{className:"mb-6 bg-rose-50 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400 p-4 rounded-xl text-sm flex items-center gap-2",children:[s.jsx(km,{className:"w-4 h-4"}),D]}),n==="org"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-100 dark:bg-indigo-900/30 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600",children:s.jsx(Na,{className:"w-8 h-8"})}),s.jsx("h3",{className:"text-lg font-bold",children:" "}),s.jsx("p",{className:"text-slate-500 text-sm",children:"  "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),s.jsx("input",{type:"text",value:d,onChange:R=>h(R.target.value),className:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500",placeholder:": Sales Team A",autoFocus:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),s.jsxs("select",{value:g,onChange:R=>x(R.target.value),className:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"sales",children:""}),s.jsx("option",{value:"support",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),s.jsxs("select",{value:f,onChange:R=>m(R.target.value),className:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"free",children:"Free"}),s.jsx("option",{value:"pro",children:"Pro"}),s.jsx("option",{value:"enterprise",children:"Enterprise"})]})]})]})]})]}),n==="admin"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-4 text-emerald-600",children:s.jsx(Rn,{className:"w-8 h-8"})}),s.jsx("h3",{className:"text-lg font-bold",children:" "}),s.jsx("p",{className:"text-slate-500 text-sm",children:"     "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),s.jsx("input",{type:"text",value:w,onChange:R=>_(R.target.value),className:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500",placeholder:" ",autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute right-3 top-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"email",value:b,onChange:R=>j(R.target.value),className:"w-full pr-10 pl-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"manager@example.com"})]})]}),s.jsxs("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-xl flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-800 rounded-lg text-indigo-600",children:s.jsx(gs,{className:"w-4 h-4"})}),s.jsx("p",{className:"text-xs text-indigo-800 dark:text-indigo-200 mt-1",children:"        .   -Manager  ."})]})]})]}),n==="phone"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center mx-auto mb-4 text-amber-600",children:s.jsx(ft,{className:"w-8 h-8"})}),s.jsx("h3",{className:"text-lg font-bold",children:" "}),s.jsx("p",{className:"text-slate-500 text-sm",children:"    ()"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"  (Business Line)"}),s.jsxs("div",{className:"relative",children:[s.jsx(UE,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400"}),s.jsx("input",{type:"text",value:S,onChange:R=>T(R.target.value),className:"w-full px-4 pl-10 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500 ltr",placeholder:"+972...",dir:"ltr"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"             ."})]}),s.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl",children:s.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:"             ."})})]})]}),n==="review"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-600",children:s.jsx(Ct,{className:"w-8 h-8"})}),s.jsx("h3",{className:"text-lg font-bold",children:" "})]}),s.jsxs("div",{className:"space-y-3 bg-slate-50 dark:bg-slate-800/50 p-6 rounded-2xl",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 dark:border-slate-700",children:[s.jsx("span",{className:"text-slate-500",children:""}),s.jsxs("span",{className:"font-bold",children:[d," (",g.toUpperCase(),")"]})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 dark:border-slate-700",children:[s.jsx("span",{className:"text-slate-500",children:""}),s.jsx($de,{variant:"brand",children:f.toUpperCase()})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 dark:border-slate-700",children:[s.jsx("span",{className:"text-slate-500",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-bold",children:w}),s.jsx("div",{className:"text-xs text-slate-400",children:b})]})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-slate-500",children:" "}),s.jsx("span",{className:"font-mono ltr",children:S||"---"})]})]})]})]}),s.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex justify-between bg-slate-50/50 dark:bg-slate-900/50 rounded-b-2xl",children:[s.jsxs(je,{variant:"secondary",onClick:$,disabled:l||n==="org",className:n==="org"?"invisible":"",children:[s.jsx(Zl,{className:"w-4 h-4 ml-2"}),""]}),n==="review"?s.jsxs(je,{onClick:M,disabled:l,className:"px-8",children:[l?s.jsx(it,{className:"w-4 h-4 animate-spin ml-2"}):s.jsx(Ct,{className:"w-4 h-4 ml-2"})," "]}):s.jsxs(je,{onClick:I,disabled:l,children:["",s.jsx(SE,{className:"w-4 h-4 mr-2"})]})]})]})})},$de=({children:e,variant:t})=>s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold bg-indigo-100 text-indigo-700",children:e}),Lde=({onLogout:e,onImpersonate:t})=>{var Zr,ws,dn,Ae,tt,pt;const[r,n]=v.useState([]),[a,l]=v.useState(null),[c,d]=v.useState(!0),[h,f]=v.useState(null),[m,g]=v.useState(""),[x,b]=v.useState("created_at"),[j,w]=v.useState("desc"),[_,N]=v.useState(!1),[C,A]=v.useState(null),[E,S]=v.useState(null),[T,D]=v.useState(null),[P,I]=v.useState(!1),[$,M]=v.useState(null),[R,F]=v.useState(""),[V,H]=v.useState("free"),[L,U]=v.useState("sales"),[W,le]=v.useState(""),[ve,B]=v.useState(null),[G,ie]=v.useState("free"),[he,_e]=v.useState("unassign"),[Ee,we]=v.useState([]),[ye,ee]=v.useState(!1),[ke,Te]=v.useState(!1),[J,Le]=v.useState(!1),[$e,ut]=v.useState(null),[yt,Dt]=v.useState(""),[Zt,dr]=v.useState([]),Y=async()=>{const{data:{session:te}}=await ge.auth.getSession();return{Authorization:`Bearer ${te==null?void 0:te.access_token}`,"Content-Type":"application/json"}},Z=async()=>{d(!0),f(null);try{const te=await Y(),ze=await fetch("/api/admin/organizations",{headers:te}),Pe=await ze.json();if(!ze.ok)throw new Error(Pe.error||"Failed to fetch organizations");n(Pe.organizations||[])}catch(te){f(te.message),console.error("[SuperAdmin] Fetch orgs error:",te)}finally{d(!1)}},fe=async()=>{try{const te=await Y(),ze=await fetch("/api/admin/verify-isolation",{headers:te}),Pe=await ze.json();if(!ze.ok)throw new Error(Pe.error);l(Pe.report)}catch(te){console.error("[SuperAdmin] Isolation report error:",te)}};v.useEffect(()=>{Z(),fe()},[]);const Ve=async()=>{if(ve){Te(!0);try{const te=await Y(),ze=await fetch(`/api/admin/organizations/${ve.id}/plan`,{method:"PATCH",headers:te,body:JSON.stringify({plan:G})}),Pe=await ze.json();if(!ze.ok)throw new Error(Pe.error);B(null),Z()}catch(te){alert(": "+te.message)}finally{Te(!1)}}},rt=async()=>{if(!(!E||W!=="DELETE")){Te(!0);try{const te=await Y(),ze=await fetch(`/api/admin/organizations/${E.id}`,{method:"DELETE",headers:te,body:JSON.stringify({confirmation:"DELETE"})}),Pe=await ze.json();if(!ze.ok)throw new Error(Pe.error);S(null),le(""),Z(),fe()}catch(te){alert(": "+te.message)}finally{Te(!1)}}},pe=async te=>{ee(!0);try{const ze=await Y(),Pe=await fetch(`/api/admin/organizations/${te}/users`,{headers:ze}),gt=await Pe.json();if(!Pe.ok)throw new Error(gt.error);we(gt.users||[])}catch(ze){console.error("[SuperAdmin] Fetch users error:",ze)}finally{ee(!1)}},qe=async()=>{if(!(!T||W!=="DELETE")){Te(!0);try{const te=await Y(),ze=await fetch(`/api/admin/users/${T.id}`,{method:"DELETE",headers:te,body:JSON.stringify({confirmation:"DELETE",leadAction:he})}),Pe=await ze.json();if(!ze.ok)throw new Error(Pe.error);D(null),le(""),C&&pe(C),Z(),fe()}catch(te){alert(": "+te.message)}finally{Te(!1)}}},nt=te=>{A(te),pe(te),ae(te)},ae=async te=>{var ze;try{const Pe=await Y(),gt=await fetch(`/api/admin/organizations/${te}/invitations`,{headers:Pe}),et=await gt.json();if(!gt.ok)throw new Error(et.error);dr(((ze=et.invitations)==null?void 0:ze.filter(Et=>!Et.accepted_at))||[])}catch(Pe){console.error("[SuperAdmin] Fetch invitations error:",Pe)}},Ne=(te,ze)=>{ut(te),Dt(ze),Le(!0)},Ge=()=>{C&&ae(C)},vt=r.filter(te=>te.name.toLowerCase().includes(m.toLowerCase())).sort((te,ze)=>{const Pe=te[x],gt=ze[x];return typeof Pe=="number"&&typeof gt=="number"?j==="asc"?Pe-gt:gt-Pe:j==="asc"?String(Pe).localeCompare(String(gt)):String(gt).localeCompare(String(Pe))}),st=r.reduce((te,ze)=>te+ze.user_count,0),mt=r.reduce((te,ze)=>te+ze.lead_count,0),wt=(a==null?void 0:a.total_issues)||0,ct=te=>{x===te?w(ze=>ze==="asc"?"desc":"asc"):(b(te),w("desc"))},dt=({field:te})=>x!==te?null:j==="asc"?s.jsx(eo,{className:"w-3 h-3"}):s.jsx(Pt,{className:"w-3 h-3"});return s.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 font-sans flex flex-col",dir:"rtl",children:[s.jsxs("header",{className:"bg-slate-900 text-white pt-6 pb-20 px-6 lg:px-8 border-b border-slate-800 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-[600px] h-[600px] bg-indigo-600/10 rounded-full blur-3xl -ml-20 -mt-20 pointer-events-none"}),s.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg border border-indigo-500/30 backdrop-blur-sm",children:s.jsx(jm,{className:"w-6 h-6 text-indigo-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"  "}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"  "]}),s.jsx("span",{children:""}),s.jsxs("span",{children:[r.length," "]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(je,{variant:"secondary",className:"hidden sm:flex bg-white/10 border-white/20 text-white hover:bg-white/20",onClick:()=>{Z(),fe()},children:[s.jsx(yw,{className:"w-4 h-4 ml-2"}),""]}),s.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-sm font-medium transition-colors border border-white/10",children:[s.jsx(bw,{className:"w-4 h-4 ml-2"}),""]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 p-5 rounded-xl",children:[s.jsx("div",{className:"flex justify-between items-start mb-4",children:s.jsx("div",{className:"p-2 rounded-lg bg-indigo-500/20 text-indigo-400",children:s.jsx(Na,{className:"w-5 h-5"})})}),s.jsx("p",{className:"text-sm text-slate-400 mb-1",children:" "}),s.jsx("p",{className:"text-2xl font-mono font-bold text-white",children:r.length})]}),s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 p-5 rounded-xl",children:[s.jsx("div",{className:"flex justify-between items-start mb-4",children:s.jsx("div",{className:"p-2 rounded-lg bg-emerald-500/20 text-emerald-400",children:s.jsx(Kr,{className:"w-5 h-5"})})}),s.jsx("p",{className:"text-sm text-slate-400 mb-1",children:'" '}),s.jsx("p",{className:"text-2xl font-mono font-bold text-white",children:st})]}),s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 p-5 rounded-xl",children:[s.jsx("div",{className:"flex justify-between items-start mb-4",children:s.jsx("div",{className:"p-2 rounded-lg bg-amber-500/20 text-amber-400",children:s.jsx(q9,{className:"w-5 h-5"})})}),s.jsx("p",{className:"text-sm text-slate-400 mb-1",children:'" '}),s.jsx("p",{className:"text-2xl font-mono font-bold text-white",children:mt})]}),s.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-sm border p-5 rounded-xl cursor-pointer transition-all hover:scale-105 ${wt>0?"border-rose-500/50 bg-rose-900/20":"border-emerald-500/50 bg-emerald-900/20"}`,onClick:()=>I(!0),children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:`p-2 rounded-lg ${wt>0?"bg-rose-500/20 text-rose-400":"bg-emerald-500/20 text-emerald-400"}`,children:wt>0?s.jsx(C2,{className:"w-5 h-5"}):s.jsx(Ct,{className:"w-5 h-5"})}),s.jsx("span",{className:"text-xs font-bold text-slate-400",children:" "})]}),s.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"  "}),s.jsx("p",{className:`text-2xl font-mono font-bold ${wt>0?"text-rose-400":"text-emerald-400"}`,children:wt})]})]})]})]}),s.jsx("main",{className:"flex-1 -mt-10 max-w-7xl mx-auto w-full px-6 lg:px-8 pb-12 relative z-20",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden flex flex-col min-h-[500px]",children:[s.jsxs("div",{className:"p-5 border-b border-slate-100 dark:border-slate-800 flex flex-col sm:flex-row justify-between items-center gap-4",children:[s.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:s.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:" "})}),s.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[s.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[s.jsx(na,{className:"w-4 h-4 absolute right-3 top-3 text-slate-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:m,onChange:te=>g(te.target.value),className:"w-full sm:w-64 pr-10 pl-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500"})]}),s.jsxs(je,{onClick:()=>N(!0),children:[s.jsx(Nn,{className:"w-4 h-4 ml-2"})," "]})]})]}),c?s.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(it,{className:"w-10 h-10 animate-spin text-indigo-500 mx-auto mb-4"}),s.jsx("p",{className:"text-slate-500",children:" ..."})]})}):h?s.jsxs("div",{className:"flex-1 flex items-center justify-center flex-col min-h-[400px] text-rose-500",children:[s.jsx(_n,{className:"w-10 h-10 mb-4"}),s.jsx("p",{children:h}),s.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"    Plateform Admin"})]}):s.jsxs("div",{className:"flex-1 overflow-x-auto",children:[s.jsxs("table",{className:"w-full text-right border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-xs text-slate-500 dark:text-slate-400 uppercase font-semibold border-b border-slate-100 dark:border-slate-800",children:[s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:text-indigo-600 text-right",onClick:()=>ct("name"),children:s.jsxs("div",{className:"flex items-center gap-1",children:["  ",s.jsx(dt,{field:"name"})]})}),s.jsx("th",{className:"px-6 py-4 text-center",children:""}),s.jsx("th",{className:"px-6 py-4 text-center",children:""}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:text-indigo-600 text-center",onClick:()=>ct("user_count"),children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[" ",s.jsx(dt,{field:"user_count"})]})}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:text-indigo-600 text-center",onClick:()=>ct("lead_count"),children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[" ",s.jsx(dt,{field:"lead_count"})]})}),s.jsx("th",{className:"px-6 py-4 cursor-pointer hover:text-indigo-600 text-right",onClick:()=>ct("created_at"),children:s.jsxs("div",{className:"flex items-center justify-start gap-1",children:["  ",s.jsx(dt,{field:"created_at"})]})}),s.jsx("th",{className:"px-6 py-4 text-left",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:vt.map(te=>{var ze;return s.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm shadow-sm",children:te.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:te.name}),s.jsxs("p",{className:"text-xs text-slate-500 font-mono",children:["ID: ",te.id.slice(0,8),"..."]})]})]})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx(qr,{variant:te.center_type==="support"?"purple":"neutral",children:te.center_type==="support"?"":""})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx(qr,{variant:te.plan==="enterprise"?"brand":te.plan==="pro"?"success":"secondary",children:((ze=te.plan)==null?void 0:ze.toUpperCase())||"FREE"})}),s.jsx("td",{className:"px-6 py-4 text-center text-sm text-slate-600 dark:text-slate-300",children:te.user_count}),s.jsx("td",{className:"px-6 py-4 text-center text-sm text-slate-600 dark:text-slate-300",children:te.lead_count}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx("span",{className:"text-sm text-slate-500",children:new Date(te.created_at).toLocaleDateString("he-IL")})}),s.jsx("td",{className:"px-6 py-4 text-left",children:s.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>M(te),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:" ",children:s.jsx(ft,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>nt(te.id),className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors",title:" ",children:s.jsx(wm,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>t(te.id,te.name,te.center_type),className:"p-2 text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 rounded-lg transition-colors",title:" ",children:s.jsx(TE,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>S(te),className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",title:" ",children:s.jsx(sa,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>{B(te),ie(te.plan||"free")},className:"p-2 text-slate-400 hover:text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20 rounded-lg transition-colors",title:" ",children:s.jsx(Iu,{className:"w-4 h-4"})})]})})]},te.id)})})]}),vt.length===0&&s.jsx("div",{className:"p-12 text-center text-slate-400",children:"   "})]}),s.jsx("div",{className:"px-6 py-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50 flex items-center justify-between",children:s.jsxs("p",{className:"text-xs text-slate-500",children:[" ",vt.length,"  ",r.length," "]})})]})}),$&&s.jsx(Rde,{isOpen:!0,onClose:()=>M(null),orgId:$.id,orgName:$.name}),s.jsx(Ide,{isOpen:_,onClose:()=>N(!1),onSuccess:()=>{N(!1),Z(),fe()}}),E&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-md shadow-2xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/30 rounded-xl",children:s.jsx(_n,{className:"w-6 h-6 text-rose-500"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-sm text-slate-500",children:"   "})]})]}),s.jsxs("div",{className:"bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-800 rounded-xl p-4 mb-4",children:[s.jsxs("p",{className:"text-sm text-rose-700 dark:text-rose-300",children:[" ",s.jsx("strong",{children:E.name})," :"]}),s.jsxs("ul",{className:"text-sm text-rose-600 dark:text-rose-400 mt-2 space-y-1",children:[s.jsxs("li",{children:["  ",E.user_count," "]}),s.jsxs("li",{children:["  ",E.lead_count," "]}),s.jsx("li",{children:"     "})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:[" ",s.jsx("span",{className:"font-mono bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:"DELETE"})," :"]}),s.jsx("input",{type:"text",value:W,onChange:te=>le(te.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono",placeholder:"DELETE"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:()=>{S(null),le("")},children:""}),s.jsx(je,{className:"flex-1 bg-rose-600 hover:bg-rose-700",onClick:rt,disabled:ke||W!=="DELETE",children:ke?s.jsx(it,{className:"w-4 h-4 animate-spin"}):" "})]})]})}),ve&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("button",{onClick:()=>B(null),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3 block",children:["   ",s.jsx("span",{className:"font-bold",children:ve.name})]}),s.jsx("div",{className:"flex flex-col gap-2",children:["free","pro","enterprise"].map(te=>s.jsxs("button",{onClick:()=>ie(te),className:`py-3 px-4 text-left rounded-xl border transition-all flex items-center justify-between ${G===te?"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-600 text-indigo-700 dark:text-indigo-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 hover:border-indigo-300"}`,children:[s.jsx("span",{className:"font-medium",children:te.toUpperCase()}),G===te&&s.jsx(Ct,{className:"w-4 h-4 text-indigo-600"})]},te))})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:()=>B(null),children:""}),s.jsx(je,{className:"flex-1",onClick:Ve,disabled:ke,children:ke?s.jsx(it,{className:"w-4 h-4 animate-spin"}):" "})]})]})}),C&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-2xl shadow-2xl max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:[" ",s.jsxs("span",{className:"text-sm font-normal text-slate-500 ml-2",children:["(",Ee.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(je,{size:"sm",onClick:()=>{const te=r.find(ze=>ze.id===C);te&&Ne(te.id,te.name)},children:[s.jsx(Nn,{className:"w-4 h-4 mr-1"})," "]}),s.jsx("button",{onClick:()=>{A(null),we([]),dr([])},className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]})]}),ye?s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsx(it,{className:"w-8 h-8 animate-spin text-indigo-500"})}):s.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[Zt.length>0&&s.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-amber-800 dark:text-amber-300 mb-3",children:["  (",Zt.length,")"]}),s.jsx("div",{className:"space-y-2",children:Zt.map(te=>s.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-slate-800 p-3 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:te.email}),s.jsxs("p",{className:"text-xs text-slate-500",children:[": ",te.role==="manager"?"":"","   : ",new Date(te.expires_at).toLocaleDateString("he-IL")]})]}),s.jsx(qr,{variant:"warning",children:""})]},te.id))})]}),s.jsxs("table",{className:"w-full text-right",dir:"rtl",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-xs text-slate-500 uppercase border-b border-slate-100 dark:border-slate-800",children:[s.jsx("th",{className:"pb-3 text-right",children:""}),s.jsx("th",{className:"pb-3 text-right",children:""}),s.jsx("th",{className:"pb-3 text-center",children:""}),s.jsx("th",{className:"pb-3 text-left",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:Ee.map(te=>{var ze;return s.jsxs("tr",{className:"group",children:[s.jsx("td",{className:"py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-slate-400 to-slate-600 flex items-center justify-center text-white text-xs font-bold",children:((ze=te.full_name)==null?void 0:ze.charAt(0))||"?"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:te.full_name||" "}),s.jsx("p",{className:"text-xs text-slate-400",children:te.email})]})]})}),s.jsx("td",{className:"py-3",children:s.jsx(qr,{variant:te.role==="manager"?"brand":te.role==="platform_admin"?"warning":"secondary",children:te.role})}),s.jsx("td",{className:"py-3 text-sm text-center text-slate-600 dark:text-slate-300",children:te.lead_count}),s.jsx("td",{className:"py-3 text-left",children:s.jsx("button",{onClick:()=>D(te),className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",children:s.jsx(sa,{className:"w-4 h-4"})})})]},te.id)})})]}),Ee.length===0&&s.jsx("div",{className:"p-8 text-center text-slate-400",children:"   "})]})]})}),T&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-md shadow-2xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/30 rounded-xl",children:s.jsx(_n,{className:"w-6 h-6 text-rose-500"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:" "}),s.jsx("p",{className:"text-sm text-slate-500",children:T.email})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:["   ",T.lead_count,"   ?"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl cursor-pointer hover:bg-slate-100",children:[s.jsx("input",{type:"radio",name:"leadAction",value:"unassign",checked:he==="unassign",onChange:()=>_e("unassign")}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:"  "}),s.jsx("p",{className:"text-xs text-slate-500",children:"    (  )"})]})]}),s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl cursor-pointer hover:bg-slate-100",children:[s.jsx("input",{type:"radio",name:"leadAction",value:"delete",checked:he==="delete",onChange:()=>_e("delete")}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-rose-600",children:" "}),s.jsx("p",{className:"text-xs text-slate-500",children:"   "})]})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:[" ",s.jsx("span",{className:"font-mono bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:"DELETE"})," :"]}),s.jsx("input",{type:"text",value:W,onChange:te=>le(te.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono",placeholder:"DELETE"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(je,{variant:"secondary",className:"flex-1",onClick:()=>{D(null),le("")},children:""}),s.jsx(je,{className:"flex-1 bg-rose-600 hover:bg-rose-700",onClick:qe,disabled:ke||W!=="DELETE",children:ke?s.jsx(it,{className:"w-4 h-4 animate-spin"}):" "})]})]})}),P&&a&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 w-full max-w-3xl shadow-2xl max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${wt>0?"bg-rose-100 dark:bg-rose-900/30":"bg-emerald-100 dark:bg-emerald-900/30"}`,children:wt>0?s.jsx(C2,{className:"w-5 h-5 text-rose-500"}):s.jsx(Ct,{className:"w-5 h-5 text-emerald-500"})}),s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"  "})]}),s.jsx("button",{onClick:()=>I(!1),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",children:s.jsx(Lt,{className:"w-5 h-5 text-slate-400"})})]}),s.jsxs("div",{className:"flex-1 overflow-auto space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a.total_organizations}),s.jsx("p",{className:"text-xs text-slate-500",children:""})]}),s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a.total_users}),s.jsx("p",{className:"text-xs text-slate-500",children:""})]}),s.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a.total_leads}),s.jsx("p",{className:"text-xs text-slate-500",children:""})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white",children:" :"}),s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${a.null_org_id_leads>0?"bg-rose-50 dark:bg-rose-900/20":"bg-emerald-50 dark:bg-emerald-900/20"}`,children:[s.jsx("span",{className:"text-sm",children:"    (organization_id)"}),s.jsx("span",{className:`font-bold ${a.null_org_id_leads>0?"text-rose-600":"text-emerald-600"}`,children:a.null_org_id_leads})]}),s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${a.null_org_id_users>0?"bg-rose-50 dark:bg-rose-900/20":"bg-emerald-50 dark:bg-emerald-900/20"}`,children:[s.jsx("span",{className:"text-sm",children:"    (organization_id)"}),s.jsx("span",{className:`font-bold ${a.null_org_id_users>0?"text-rose-600":"text-emerald-600"}`,children:a.null_org_id_users})]}),s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${(((Zr=a.orphan_org_ids)==null?void 0:Zr.length)||0)>0?"bg-rose-50 dark:bg-rose-900/20":"bg-emerald-50 dark:bg-emerald-900/20"}`,children:[s.jsx("span",{className:"text-sm",children:"    "}),s.jsx("span",{className:`font-bold ${(((ws=a.orphan_org_ids)==null?void 0:ws.length)||0)>0?"text-rose-600":"text-emerald-600"}`,children:((dn=a.orphan_org_ids)==null?void 0:dn.length)||0})]}),s.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${(((Ae=a.cross_org_assignments)==null?void 0:Ae.length)||0)>0?"bg-rose-50 dark:bg-rose-900/20":"bg-emerald-50 dark:bg-emerald-900/20"}`,children:[s.jsx("span",{className:"text-sm",children:"  (   )"}),s.jsx("span",{className:`font-bold ${(((tt=a.cross_org_assignments)==null?void 0:tt.length)||0)>0?"text-rose-600":"text-emerald-600"}`,children:((pt=a.cross_org_assignments)==null?void 0:pt.length)||0})]})]}),a.leads_per_org&&a.leads_per_org.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white mb-3",children:"  :"}),s.jsx("div",{className:"space-y-2",children:a.leads_per_org.map((te,ze)=>{var Pe;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-xl",children:[s.jsx("span",{className:"text-sm",children:te.org_name||((Pe=te.org_id)==null?void 0:Pe.slice(0,8))}),s.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:te.count})]},ze)})})]})]})]})}),s.jsx(Mde,{isOpen:J,onClose:()=>{Le(!1),ut(null),Dt("")},organizationId:$e||"",organizationName:yt,onSuccess:Ge})]})},ow=[{quote:"        3   .",author:" ",role:" ",company:' "',metric:"+24%",metricLabel:" ",initial:""},{quote:"'        .    .",author:" ",role:"  ",company:" ",metric:"+45%",metricLabel:" ",initial:""},{quote:"              .",author:" ",role:" ",company:" ",metric:"x2",metricLabel:" ",initial:""},{quote:"             .",author:" ",role:'" ',company:" ",metric:"+38%",metricLabel:" ",initial:""}],zde=[{icon:ft,title:"   ",desc:"AI    "},{icon:vr,title:" ",desc:"   "},{icon:hc,title:" ",desc:"  "},{icon:Kr,title:"  ",desc:"  "}],Bde=({onLogin:e})=>{const[t,r]=v.useState(""),[n,a]=v.useState(""),[l,c]=v.useState(!1),[d,h]=v.useState(!1),[f,m]=v.useState(0),[g,x]=v.useState(!1),[b,j]=v.useState(!1),[w,_]=v.useState({name:"",email:"",company:"",phone:"",message:""}),[N,C]=v.useState(!1),[A,E]=v.useState(!1);v.useEffect(()=>{const P=setInterval(()=>{x(!0),setTimeout(()=>{m(I=>(I+1)%ow.length),x(!1)},400)},6e3);return()=>clearInterval(P)},[]);const S=async P=>{if(P.preventDefault(),!t||!n){alert("   ");return}h(!0);try{const{data:I,error:$}=await ge.auth.signInWithPassword({email:t,password:n});if($){alert(" : "+$.message);return}const M=I==null?void 0:I.user;if(!M){alert(" :   .");return}let R=null,F=null;for(let H=1;H<=3;H++){const{data:L,error:U}=await ge.from("profiles").select("id, full_name, avatar_url, role, organization_id").eq("id",M.id).single();if(L){R=L;break}F=U,await new Promise(W=>setTimeout(W,600))}if(!R){console.error("Profile fetch failed:",F),alert("     .    .");return}const V=R.role==="platform_admin"?"super_admin":R.role==="manager"?"manager":"rep";console.log("[Login] User logged in with org:",R.organization_id),e({id:R.id,name:R.full_name||"User",role:R.role,avatar:R.avatar_url,type:V,organization_id:R.organization_id})}catch(I){console.error("Login Error:",I),alert("   .   .")}finally{h(!1)}},T=async P=>{P.preventDefault(),C(!0),await new Promise(I=>setTimeout(I,1500)),console.log("Contact form submitted:",w),C(!1),E(!0)},D=ow[f];return b?s.jsxs("div",{className:"min-h-screen flex w-full bg-white dark:bg-slate-950 font-sans overflow-hidden animate-in fade-in duration-300",children:[s.jsxs("div",{className:"w-full lg:w-1/2 min-h-screen flex flex-col justify-center items-center p-8 lg:p-16 relative z-10 bg-white dark:bg-slate-950",children:[s.jsxs("div",{className:"w-full max-w-md animate-in fade-in slide-in-from-right-4 duration-500",children:[s.jsxs("button",{onClick:()=>{j(!1),E(!1)},className:"flex items-center gap-2 text-slate-500 hover:text-brand-600 mb-8 transition-all hover:gap-3",children:[s.jsx(Zl,{className:"w-4 h-4"}),s.jsx("span",{children:" "})]}),s.jsxs("div",{className:"mb-8 text-center lg:text-right",children:[s.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-brand-600 to-brand-700 flex items-center justify-center text-white shadow-xl shadow-brand-500/20",children:s.jsx(x0,{className:"w-7 h-7"})}),s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight",children:"SalesFlow AI"})]}),s.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-3",children:"  "}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-base",children:"  ?     ."})]}),A?s.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-2xl p-8 text-center animate-in fade-in zoom-in",children:[s.jsx("div",{className:"w-16 h-16 bg-emerald-100 dark:bg-emerald-900/50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(yc,{className:"w-8 h-8 text-emerald-600"})}),s.jsx("h3",{className:"text-xl font-bold text-emerald-800 dark:text-emerald-200 mb-2",children:"  !"}),s.jsx("p",{className:"text-emerald-600 dark:text-emerald-400",children:"     ."})]}):s.jsxs("form",{onSubmit:T,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" "}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"text",required:!0,value:w.name,onChange:P=>_({...w,name:P.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400",placeholder:"   "}),s.jsx(Rn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"email",required:!0,value:w.email,onChange:P=>_({...w,email:P.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400",placeholder:"name@company.com",dir:"ltr"}),s.jsx(gs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"tel",value:w.phone,onChange:P=>_({...w,phone:P.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400",placeholder:"050-000-0000",dir:"ltr"}),s.jsx(ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"text",value:w.company,onChange:P=>_({...w,company:P.target.value}),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400",placeholder:" "}),s.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:" ()"}),s.jsx("div",{className:"relative group",children:s.jsx("textarea",{value:w.message,onChange:P=>_({...w,message:P.target.value}),rows:3,className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400 resize-none",placeholder:"    ..."})})]}),s.jsx(je,{type:"submit",disabled:N,className:"w-full py-3.5 text-base font-bold justify-center shadow-lg shadow-brand-500/20 hover:shadow-brand-500/30 hover:-translate-y-0.5 transition-all duration-300",children:N?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:["  ",s.jsx(yc,{className:"w-4 h-4 mr-2"})]})})]})]}),s.jsx("div",{className:"mt-auto pt-10 text-xs text-slate-400 text-center lg:text-right",children:" 2024 SalesFlow AI.   ."})]}),s.jsx(jE,{testimonial:D,currentTestimonial:f,isAnimating:g,setCurrentTestimonial:m,setIsAnimating:x})]}):s.jsxs("div",{className:"min-h-screen flex w-full bg-white dark:bg-slate-950 font-sans overflow-hidden",children:[s.jsx("div",{className:"w-full lg:w-1/2 min-h-screen flex flex-col justify-center items-center p-8 lg:p-16 relative z-10 bg-white dark:bg-slate-950",children:s.jsxs("div",{className:"w-full max-w-sm animate-in fade-in slide-in-from-bottom-4 duration-500",children:[s.jsxs("div",{className:"mb-10 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-brand-600 to-brand-700 flex items-center justify-center text-white shadow-xl shadow-brand-500/20",children:s.jsx(x0,{className:"w-7 h-7"})}),s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight",children:"SalesFlow AI"})]}),s.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-3",children:"  "}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-base",children:"      ."})]}),s.jsxs("form",{onSubmit:S,className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5",children:""}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"email",value:t,onChange:P=>r(P.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400 group-hover:border-slate-300 dark:group-hover:border-slate-700",placeholder:"name@company.com",dir:"ltr"}),s.jsx(gs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 group-focus-within:text-brand-500 transition-colors"})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:""}),s.jsx("a",{href:"#",className:"text-xs font-medium text-brand-600 hover:text-brand-700 dark:text-brand-400 transition-colors",children:" ?"})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:l?"text":"password",value:n,onChange:P=>a(P.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl text-sm outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all text-slate-900 dark:text-white placeholder-slate-400 group-hover:border-slate-300 dark:group-hover:border-slate-700",placeholder:"",dir:"ltr"}),s.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",children:l?s.jsx(OE,{className:"w-4 h-4"}):s.jsx(wm,{className:"w-4 h-4"})})]})]}),s.jsx(je,{type:"submit",disabled:d,className:"w-full py-3.5 text-base font-bold justify-center shadow-lg shadow-brand-500/20 hover:shadow-brand-500/30 hover:-translate-y-0.5 transition-all duration-300",children:d?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:["  ",s.jsx(Zl,{className:"w-4 h-4 mr-2 rotate-180"})]})})]}),s.jsxs("div",{className:"mt-8 p-4 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800 text-center",children:[s.jsx("p",{className:"text-base text-slate-600 dark:text-slate-400 mb-2",children:"   ?"}),s.jsx("button",{onClick:()=>j(!0),className:"text-lg font-bold text-brand-600 hover:text-brand-700 dark:text-brand-400 transition-colors underline decoration-2 underline-offset-4 hover:decoration-brand-400",children:"    "})]}),s.jsx("div",{className:"mt-10 text-xs text-slate-400 text-center",children:" 2024 SalesFlow AI.   ."})]})}),s.jsx(jE,{testimonial:D,currentTestimonial:f,isAnimating:g,setCurrentTestimonial:m,setIsAnimating:x})]})},jE=({testimonial:e,currentTestimonial:t,isAnimating:r,setCurrentTestimonial:n,setIsAnimating:a})=>s.jsxs("div",{className:"hidden lg:flex w-1/2 bg-slate-900 relative items-center justify-center overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900 via-slate-950 to-purple-900 z-0"}),s.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[600px] h-[600px] bg-brand-600/20 rounded-full blur-[120px] mix-blend-screen animate-pulse"}),s.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-purple-600/20 rounded-full blur-[120px] mix-blend-screen"}),s.jsx("div",{className:"absolute top-[50%] left-[50%] -translate-x-1/2 -translate-y-1/2 w-[400px] h-[400px] bg-emerald-600/10 rounded-full blur-[100px] mix-blend-screen"}),s.jsxs("div",{className:"relative z-10 max-w-lg w-full px-12 flex flex-col gap-6",children:[s.jsxs("div",{className:`bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-6 shadow-2xl relative overflow-hidden transition-all duration-500 ${r?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-brand-500/10 rounded-full blur-2xl"}),s.jsx(hL,{className:"w-8 h-8 text-brand-400/40 mb-3"}),s.jsxs("p",{className:"text-white text-base leading-relaxed mb-5",children:['"',e.quote,'"']}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:e.initial}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-white font-bold text-sm",children:e.author}),s.jsx("span",{className:"block text-indigo-300/80 text-xs",children:e.role})]})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center gap-1 bg-emerald-500/20 px-2.5 py-1 rounded-lg border border-emerald-500/30",children:[s.jsx(Lc,{className:"w-3.5 h-3.5 text-emerald-400"}),s.jsx("span",{className:"text-emerald-300 text-sm font-bold",children:e.metric})]}),s.jsx("span",{className:"text-emerald-200/50 text-[10px] mt-0.5 block",children:e.metricLabel})]})]}),s.jsx("div",{className:"flex justify-center gap-2 mt-5",children:ow.map((l,c)=>s.jsx("button",{onClick:()=>{a(!0),setTimeout(()=>{n(c),a(!1)},400)},className:`h-1.5 rounded-full transition-all duration-300 ${c===t?"bg-brand-400 w-6":"bg-white/20 hover:bg-white/40 w-1.5"}`},c))})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:zde.map((l,c)=>s.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:bg-white/10 transition-all group",children:[s.jsx(l.icon,{className:"w-5 h-5 text-brand-400 mb-2 group-hover:scale-110 transition-transform"}),s.jsx("h4",{className:"text-white font-semibold text-sm mb-0.5",children:l.title}),s.jsx("p",{className:"text-indigo-200/60 text-xs",children:l.desc})]},c))}),s.jsxs("div",{className:"flex justify-center gap-6 pt-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"block text-2xl font-bold text-white",children:"500+"}),s.jsx("span",{className:"text-indigo-300/60 text-xs",children:" "})]}),s.jsxs("div",{className:"text-center border-x border-white/10 px-6",children:[s.jsx("span",{className:"block text-2xl font-bold text-white",children:"2M+"}),s.jsx("span",{className:"text-indigo-300/60 text-xs",children:" "})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"block text-2xl font-bold text-white",children:"+35%"}),s.jsx("span",{className:"text-indigo-300/60 text-xs",children:" "})]})]})]}),s.jsx("div",{className:"absolute inset-0 opacity-20 mix-blend-overlay pointer-events-none",style:{backgroundImage:"radial-gradient(#fff 1px, transparent 1px)",backgroundSize:"32px 32px"}})]}),Ude=()=>{const{token:e}=WH(),t=qw(),[r,n]=v.useState(!0),[a,l]=v.useState(!1),[c,d]=v.useState(""),[h,f]=v.useState(!1),[m,g]=v.useState(!1),[x,b]=v.useState(null),[j,w]=v.useState({fullName:"",password:"",confirmPassword:""});v.useEffect(()=>{(async()=>{if(!e){d("   "),n(!1);return}try{const C=await fetch(`/api/invitations/${e}`),A=await C.json();if(!C.ok)throw new Error(A.error||"  ");b(A.invitation)}catch(C){d(C.message)}finally{n(!1)}})()},[e]);const _=async N=>{if(N.preventDefault(),j.password!==j.confirmPassword){d("  ");return}if(j.password.length<6){d("    6 ");return}l(!0),d("");try{const C=await fetch(`/api/invitations/${e}/accept`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:j.fullName,password:j.password})}),A=await C.json();if(!C.ok)throw new Error(A.error||"  ");f(!0),setTimeout(()=>{t("/login")},3e3)}catch(C){d(C.message)}finally{l(!1)}};return r?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(it,{className:"w-12 h-12 text-brand-400 animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-white/70",children:" ..."})]})}):c&&!x?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full text-center border border-white/20",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center",children:s.jsx(du,{className:"w-8 h-8 text-red-400"})}),s.jsx("h1",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsx("p",{className:"text-white/70 mb-6",children:c}),s.jsx(je,{onClick:()=>t("/login"),variant:"secondary",children:"  "})]})}):h?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full text-center border border-white/20",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-emerald-500/20 flex items-center justify-center",children:s.jsx(uw,{className:"w-8 h-8 text-emerald-400"})}),s.jsx("h1",{className:"text-xl font-bold text-white mb-2",children:" !"}),s.jsx("p",{className:"text-white/70 mb-2",children:"  "}),s.jsx("p",{className:"text-white/50 text-sm",children:"   ..."})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 max-w-md w-full border border-white/20",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center",children:s.jsx(Na,{className:"w-8 h-8 text-white"})}),s.jsxs("h1",{className:"text-2xl font-bold text-white mb-2",children:[" -",x==null?void 0:x.organizationName]}),s.jsxs("p",{className:"text-white/70",children:[" -",(x==null?void 0:x.role)==="manager"?"":" "]}),s.jsx("p",{className:"text-white/50 text-sm mt-1",dir:"ltr",children:x==null?void 0:x.email})]}),s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(Rn,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40"}),s.jsx("input",{type:"text",value:j.fullName,onChange:N=>w({...j,fullName:N.target.value}),placeholder:"  ",required:!0,className:"w-full pr-11 pl-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(b0,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40"}),s.jsx("input",{type:m?"text":"password",value:j.password,onChange:N=>w({...j,password:N.target.value}),placeholder:" 6 ",required:!0,minLength:6,className:"w-full pr-11 pl-11 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all",dir:"ltr"}),s.jsx("button",{type:"button",onClick:()=>g(!m),className:"absolute left-3 top-1/2 -translate-y-1/2 text-white/40 hover:text-white/60",children:m?s.jsx(OE,{className:"w-5 h-5"}):s.jsx(wm,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(b0,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40"}),s.jsx("input",{type:m?"text":"password",value:j.confirmPassword,onChange:N=>w({...j,confirmPassword:N.target.value}),placeholder:"  ",required:!0,className:"w-full pr-11 pl-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all",dir:"ltr"})]})]}),c&&s.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-xl",children:s.jsx("p",{className:"text-sm text-red-300",children:c})}),s.jsx(je,{type:"submit",className:"w-full py-3.5 bg-gradient-to-r from-brand-500 to-purple-600 hover:from-brand-600 hover:to-purple-700",disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx(it,{className:"w-4 h-4 ml-2 animate-spin"})," ..."]}):"  "})]}),s.jsxs("p",{className:"text-center text-white/50 text-sm mt-6",children:["   ?"," ",s.jsx("a",{href:"/login",className:"text-brand-400 hover:text-brand-300",children:""})]})]})})};function qde(){const[e,t]=v.useState(()=>(document.documentElement.classList.remove("dark"),!1)),r=()=>{t(ie=>{const he=!ie;return localStorage.setItem("isDarkMode",JSON.stringify(he)),he?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),he})};v.useEffect(()=>{console.log("[Theme] isDarkMode changed to:",e),e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e]);const[n,a]=v.useState(!1),[l,c]=v.useState("dashboard"),[d,h]=v.useState(!1),[f,m]=v.useState(!1),[g,x]=v.useState(!1),[b,j]=v.useState(null),[w,_]=v.useState(!0),[N,C]=v.useState(null),[A,E]=v.useState(null),S=(A==null?void 0:A.id)||(b==null?void 0:b.organization_id),T=v.useMemo(()=>b?{...b,organization_id:S||b.organization_id,center_type:(A==null?void 0:A.center_type)||b.center_type||"sales"}:null,[b,S,A==null?void 0:A.center_type]),{callStatus:D,startCall:P,hangup:I,callSummary:$,clearSummary:M,initDevice:R,isReady:F,activeLeadId:V,callDuration:H,transcripts:L}=Pm(),U=D==="connected"||D==="dialing",[W,le]=v.useState(!1);v.useEffect(()=>{(async()=>{var _e,Ee;try{_(!0);const{data:{session:we}}=await ge.auth.getSession();if(we!=null&&we.user){const{data:ye,error:ee}=await ge.from("profiles").select(`
              *,
              organization:organizations!organization_id(center_type)
            `).eq("id",we.user.id).single();if(ee){console.error("Error fetching profile:",ee),C(ee.message),await ge.auth.signOut();return}if(ye){const ke={id:ye.id,name:ye.full_name||"User",email:ye.email,avatar:ye.avatar_url,role:ye.role,type:ye.role==="platform_admin"?"super_admin":ye.role,organization_id:ye.organization_id,center_type:(Array.isArray(ye.organization)?(_e=ye.organization[0])==null?void 0:_e.center_type:(Ee=ye.organization)==null?void 0:Ee.center_type)||"sales"};j(ke),a(!0)}}}catch(we){console.error("Auth Error",we),C(we.message)}finally{_(!1)}})();const{data:{subscription:he}}=ge.auth.onAuthStateChange((_e,Ee)=>{Ee||(a(!1),j(null))});return()=>he.unsubscribe()},[]),v.useEffect(()=>{if(n&&!F){const ie=()=>{R(),document.removeEventListener("click",ie),document.removeEventListener("keydown",ie)};return document.addEventListener("click",ie,{once:!0}),document.addEventListener("keydown",ie,{once:!0}),()=>{document.removeEventListener("click",ie),document.removeEventListener("keydown",ie)}}},[n,F]),v.useEffect(()=>{$&&le(!0)},[$]);const ve=ie=>{j(ie),a(!0),c("dashboard")},B=async()=>{await ge.auth.signOut(),a(!1),j(null)},G=ie=>c(ie);return w?s.jsx("div",{className:"h-screen flex items-center justify-center",children:s.jsx(it,{className:"animate-spin w-8 h-8 text-indigo-600"})}):!n||!b?s.jsx(Bde,{onLogin:ve}):b.type==="super_admin"&&!A?s.jsx(Lde,{onLogout:B,onImpersonate:(ie,he,_e)=>E({id:ie,name:he,center_type:_e})}):s.jsx("div",{className:`min-h-screen ${e?"dark":""}`,children:s.jsxs("div",{className:"flex h-screen bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100 font-sans transition-colors duration-200 overflow-hidden",children:[s.jsx(u7,{activePage:l,onNavigate:G,userRole:b.type,centerType:T==null?void 0:T.center_type,isOpen:g,onClose:()=>x(!1)}),s.jsxs("div",{className:"flex flex-1 flex-col min-w-0",children:[s.jsx(WB,{user:b,isDarkMode:e,toggleTheme:r,onNavigate:G,onOpenChat:()=>h(!0),onOpenReminders:()=>m(!0),onToggleMobileMenu:()=>x(!g),onLogout:B}),A&&s.jsxs("div",{className:"bg-amber-500 text-white px-4 py-2 text-center text-sm font-bold flex justify-between items-center z-50 shadow-sm relative sticker top-0",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})," Viewing as Manager: ",A.name]}),s.jsx("button",{onClick:()=>E(null),className:"bg-black/20 hover:bg-black/30 px-3 py-1 rounded text-xs transition-colors",children:"Exit Shadow Mode"})]}),s.jsx("main",{className:"flex flex-1 overflow-hidden relative",children:l==="dashboard"?b.type==="manager"||A?s.jsx(Sce,{isDarkMode:e,orgId:(A==null?void 0:A.id)||b.organization_id,userName:b.name,centerType:T==null?void 0:T.center_type,onNavigate:G}):s.jsx(hce,{onStartCall:()=>{c("calls")},isDarkMode:e,userName:b.name,centerType:T==null?void 0:T.center_type,onNavigate:ie=>c(ie)}):l==="leads"?s.jsx(qce,{isDarkMode:e,orgId:S,user:T}):l==="pipeline"?s.jsx(Wce,{isDarkMode:e,currentUser:T}):l==="settings"?s.jsx(ode,{isDarkMode:e,user:b,onLogout:B,toggleTheme:r}):l==="tasks"?s.jsx(ude,{isDarkMode:e,currentUser:T}):l==="targets"?b.type==="manager"?s.jsx(fde,{isDarkMode:e,orgId:S}):s.jsx(mde,{isDarkMode:e,onStartCall:(ie,he)=>P(ie,b.id,he),currentUser:T}):l==="chat"?s.jsx(pde,{isDarkMode:e,currentUser:T}):l==="gamification"?s.jsx(kde,{userId:b.id,orgId:S}):s.jsx(Kq,{onStartCall:()=>{},isCallActive:U,onEndCall:I,currentUserId:b.id,orgId:S})})]}),s.jsx(gde,{currentUser:b,isOpen:d,onClose:()=>h(!1),orgId:S,activeContext:l==="calls"&&U?{type:"call",id:"c_active",label:" ",subLabel:"Running Call..."}:null}),s.jsx(mH,{leadName:V?"":"",leadId:V||"",callDuration:H,transcripts:L}),s.jsx(Tde,{isOpen:f,onClose:()=>m(!1),userId:b==null?void 0:b.id,orgId:S})]})})}function Fde(){return s.jsx(TV,{children:s.jsxs(lV,{children:[s.jsx(oy,{path:"/invite/:token",element:s.jsx(Ude,{})}),s.jsx(oy,{path:"*",element:s.jsx(Fq,{children:s.jsx(qde,{})})})]})})}const uR=document.getElementById("root");if(!uR)throw new Error("Could not find root element to mount to");const Hde=MI.createRoot(uR);Hde.render(s.jsx(Ur.StrictMode,{children:s.jsx(Fde,{})}));
